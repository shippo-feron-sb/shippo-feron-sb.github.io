(self.webpackChunk_shippo_feron=self.webpackChunk_shippo_feron||[]).push([[1478],{"./app/assets/carriers/dhl_express.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"6806ccde39008fc09aee75c78f040990.svg"},"./app/assets/carriers/fedex.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"ceca6c481f96ff5740c0c6c243f4405f.svg"},"./app/assets/carriers/ups.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"9b63d9637405200a9eb3dc38bc1c631c.svg"},"./app/assets/carriers/usps.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"3e56917ce9c7ee00563f723f6d0a7b53.svg"},"./app/assets/icon-notes.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"96f19044456b7cb6d52fd111cba95754.svg"},"./app/assets/icons/arrow-left.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"3b71b9d593f617edaacbb31ee2623092.svg"},"./app/assets/icons/arrow-right.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"faa8d22d0420197c0b80c3ce1c3671e0.svg"},"./app/assets/icons/arrow-sea600.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"a16c3c4c1f584ccb16684eb161ba30e6.svg"},"./app/assets/icons/exclamation-circle.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"e86b1aa96d824f8e505d50cb8b3add1e.svg"},"./app/assets/icons/exclamation_circle_yellow.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"2c1271f28b91b31033fe49290c1c563e.svg"},"./app/assets/icons/icon_alert_info_filled.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"44f7f9a5bc5af9c9ba37d05ca78458c2.svg"},"./app/assets/icons/icon_carrierparcel.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"0902662931e8ef36b5b4ac4b0278da6c.svg"},"./app/assets/icons/icon_check_gray.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"6410d663d1e03ff3814c237226e364fd.svg"},"./app/assets/icons/icon_close_dark_gray.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"11ea1e7b9e1a66b45e38548d461d3a95.svg"},"./app/assets/icons/icon_customdims.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"75ba0e943aecfae3952a06a031dbae7e.svg"},"./app/assets/icons/icon_customs_declaration.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"644d24dbf57bdc698e4b8697b67e7a4f.svg"},"./app/assets/icons/icon_error_frame.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"9d98980e1b5c7b3b2a8134d00658f8e0.svg"},"./app/assets/icons/icon_package.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"1bad3c57d9286dc9926dfa65b7ab3920.svg"},"./app/assets/icons/icon_splitment_arrow.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"d36b35bea3a334c173d2f3d07d21f316.svg"},"./app/assets/icons/icon_success_bg_green.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"8aba75c185fbd12ab2d7f797dabaf17c.svg"},"./app/assets/icons/icon_success_green_bg.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"ed56c338a93ff308dea76cb399ba66c0.svg"},"./app/assets/icons/parcel.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"56ab8a103d4bdd2f175b2e80db603b7c.svg"},"./app/assets/icons/plus/plus.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"fcd883ccaf779b32201c3855b562796c.svg"},"./app/assets/icons/question_circle_gray.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"1aae4e36e05eeeb09c57239478f5d557.svg"},"./app/assets/icons/refresh/refresh_gray.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"2f0983ff4287434738c56b9586adf501.svg"},"./app/assets/icons/refresh/refresh_green.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"2d4bb6dd55eb2b288efc3e6a949cdc26.svg"},"./app/assets/logo/shippo_logo_charcoal.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"bc86cacb2396451bff66be931f9fee11.svg"},"./app/assets/shops/icons/shippo.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"1010a0e58f5213024b35b02974494507.svg"},"./app/assets/shops/vector/wix.svg":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"cfab25b2a937d42cb7b2074c161f48cf.svg"},"./app/assets/register/godaddy.png":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"assets/2df62c2aba340f07b5eb082f6f0b0eb0.png"},"./app/assets/register/shopify.png":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"assets/e22e29f9e63b2fe25b246f2ba07b4676.png"},"./app/assets/register/square.png":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"assets/7341e990ef7dc4c225ea4453bc09a610.png"},"./app/assets/register/wix.png":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__.p+"assets/1fd1bc6ca9d2f9a0ff7635d71163fc05.png"},"./app/actions/auth.actions.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{BP:()=>finishRegister,EM:()=>initializeAnonymousGTM,I0:()=>clearAuthError,Jj:()=>registerSuccess,MA:()=>registerError,Sz:()=>userDidAuthenticate,Zd:()=>sendRegisterQuestionnaireError,g9:()=>resetPasswordSuccess,jb:()=>resendVerificationError,kz:()=>register,oT:()=>resendVerificationSuccess,ux:()=>sendRegisterQuestionnaireSuccess,vl:()=>resetPasswordError});var _constants__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./app/actions/constants.ts");function register(payload,next){return{payload,next,type:_constants__WEBPACK_IMPORTED_MODULE_0__.t.REGISTER}}function registerSuccess(sessionToken,next){return{payload:{sessionToken,next},type:_constants__WEBPACK_IMPORTED_MODULE_0__.t.REGISTER_SUCCESS}}function registerError(err){return{payload:{error:err},type:_constants__WEBPACK_IMPORTED_MODULE_0__.t.REGISTER_ERROR}}function resetPasswordSuccess(){return{type:_constants__WEBPACK_IMPORTED_MODULE_0__.t.RESET_PASSWORD_SUCCESS}}function resetPasswordError(err){return{payload:{error:err},type:_constants__WEBPACK_IMPORTED_MODULE_0__.t.RESET_PASSWORD_ERROR}}function resendVerificationSuccess(){return{type:_constants__WEBPACK_IMPORTED_MODULE_0__.t.RESEND_VERIFICATION_SUCCESS}}function resendVerificationError(err){return{payload:{error:err},type:_constants__WEBPACK_IMPORTED_MODULE_0__.t.RESEND_VERIFICATION_ERROR}}function userDidAuthenticate(payload){return{type:_constants__WEBPACK_IMPORTED_MODULE_0__.t.USER_DID_AUTHENTICATE,payload:{currentUser:payload.user}}}function initializeAnonymousGTM(){return{type:_constants__WEBPACK_IMPORTED_MODULE_0__.t.INITIALIZE_ANONYMOUS_TAG_MANAGER}}function sendRegisterQuestionnaireSuccess(){return{type:_constants__WEBPACK_IMPORTED_MODULE_0__.t.SEND_REGISTER_QUESTIONNAIRE_SUCCESS}}function sendRegisterQuestionnaireError(){return{type:_constants__WEBPACK_IMPORTED_MODULE_0__.t.SEND_REGISTER_QUESTIONNAIRE_ERROR}}function finishRegister(){return{type:_constants__WEBPACK_IMPORTED_MODULE_0__.t.FINISH_REGISTER}}function clearAuthError(){return{type:_constants__WEBPACK_IMPORTED_MODULE_0__.t.RESET_AUTH_ERROR}}},"./app/actions/stripe.actions.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Cb:()=>loadStripeError,D:()=>createElementError,F1:()=>onStripeElementChange,Ke:()=>createStripeTokenSuccess,OL:()=>cancelStripeFromSubmission,Pi:()=>loadStripeSuccess,Rw:()=>createStripeTokenError,h9:()=>setStripeElementEmpty,mh:()=>createElementSuccess,n:()=>createElement,nN:()=>clearStripeFormError,oy:()=>setStripeFormError});var _constants__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./app/actions/constants.ts");function loadStripeSuccess(){return{type:_constants__WEBPACK_IMPORTED_MODULE_0__.t.STRIPE_LOAD_SUCCESS}}function loadStripeError(errorMessage){return{errorMessage,type:_constants__WEBPACK_IMPORTED_MODULE_0__.t.STRIPE_LOAD_ERROR}}function createElement(numberElementId,expElementId,cvcElementId,cardNumberOptions,cardExpOptions,cardCvcOptions){return{type:_constants__WEBPACK_IMPORTED_MODULE_0__.t.STRIPE_CREATE_ELEMENT,payload:{numberElementId,expElementId,cvcElementId,cardNumberOptions,cardExpOptions,cardCvcOptions}}}function createElementSuccess(elementId){return{elementId,type:_constants__WEBPACK_IMPORTED_MODULE_0__.t.STRIPE_CREATE_ELEMENT_SUCCESS}}function createElementError(elementId,errorMessage){return{elementId,errorMessage,type:_constants__WEBPACK_IMPORTED_MODULE_0__.t.STRIPE_CREATE_ELEMENT_ERROR}}function onStripeElementChange(elementId,event){return{elementId,type:_constants__WEBPACK_IMPORTED_MODULE_0__.t.STRIPE_ELEMENT_ON_CHANGE,payload:{event}}}function createStripeTokenSuccess(elementId,token){return{elementId,type:_constants__WEBPACK_IMPORTED_MODULE_0__.t.STRIPE_CREATE_TOKEN_SUCCESS,payload:{token}}}function createStripeTokenError(elementId,errorMessage){return{elementId,errorMessage,type:_constants__WEBPACK_IMPORTED_MODULE_0__.t.STRIPE_CREATE_TOKEN_ERROR}}function setStripeFormError(elementId,errorMessage){return{elementId,type:_constants__WEBPACK_IMPORTED_MODULE_0__.t.STRIPE_SET_FORM_ERROR,payload:{errorMessage}}}function clearStripeFormError(elementId){return{elementId,type:_constants__WEBPACK_IMPORTED_MODULE_0__.t.STRIPE_CLEAR_FORM_ERROR}}function cancelStripeFromSubmission(elementId){return{elementId,type:_constants__WEBPACK_IMPORTED_MODULE_0__.t.STRIPE_CANCEL_FORM_SUBMISSION}}function setStripeElementEmpty(elementId,isEmpty){return{elementId,isEmpty,type:_constants__WEBPACK_IMPORTED_MODULE_0__.t.STRIPE_SET_ELEMENT_EMPTY}}},"./app/components/CountryFlag/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>components_CountryFlag});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),emotion_react_jsx_runtime_browser_esm=__webpack_require__("./node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js"),emotion_styled_browser_esm=__webpack_require__("./node_modules/@emotion/styled/dist/emotion-styled.browser.esm.js"),constants=__webpack_require__("./app/styles/constants.ts"),Flag=(0,emotion_styled_browser_esm.A)("span")(templateObject_1||(templateObject_1=(0,tslib_es6.ue)(["\n  border: 1px solid ",";\n  border-radius: 2px;\n  height: fit-content;\n  align-self: center;\n  line-height: 0;\n  min-width: 0.875rem;\n"],["\n  border: 1px solid ",";\n  border-radius: 2px;\n  height: fit-content;\n  align-self: center;\n  line-height: 0;\n  min-width: 0.875rem;\n"])),constants.Tj.gray100);var templateObject_1;const components_CountryFlag=function(_a){var className=_a.className,country=_a.country,props=(0,tslib_es6.Tt)(_a,["className","country"]);return(0,emotion_react_jsx_runtime_browser_esm.Y)(Flag,(0,tslib_es6.Cl)({className:"".concat(className||""," flag-icon flag-icon-").concat(country.toLocaleLowerCase())},props))}},"./app/components/OrderStatus/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{H:()=>OrderStatus_ReturnOrderStatus,A:()=>OrderStatus_OrderStatus});var templateObject_1,tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),emotion_react_jsx_runtime_browser_esm=__webpack_require__("./node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js"),Chip=__webpack_require__("./node_modules/@goshippo/components/esm/Chip/Chip.js"),react=__webpack_require__("./node_modules/react/index.js"),Order=__webpack_require__("./app/types/Order.ts"),translate=__webpack_require__("./app/utils/translate.ts"),styled=__webpack_require__("./node_modules/@mui/material/styles/styled.js"),colors=__webpack_require__("./node_modules/@goshippo/components/esm/styles/colors.js"),CancelledChipStyled=(0,styled.Ay)(Chip.A)(templateObject_1||(templateObject_1=(0,tslib_es6.ue)(["\n  background-color: ",";\n  color: ",";\n\n  & .custom-chip-icon.filled {\n    background-color: ",";\n  }\n"],["\n  background-color: ",";\n  color: ",";\n\n  & .custom-chip-icon.filled {\n    background-color: ",";\n  }\n"])),colors.T.secondary,colors.T.white,colors.T.white);const OrderStatus_OrderStatus=(0,translate.Tl)("orders")((function(_a){var status=_a.status,t=_a.t;if(!["PAID","AWAITPAY","SHIPPED","PARTIALLY_FULFILLED","CANCELLED"].includes(status))return null;return(0,emotion_react_jsx_runtime_browser_esm.Y)(react.Fragment,{children:function(){var defaultChipProps={size:"small",label:t("orders:status:order:".concat(status))};switch(status){case Order.Re.PAID:return(0,emotion_react_jsx_runtime_browser_esm.Y)(Chip.A,(0,tslib_es6.Cl)({},defaultChipProps,{color:"success"}));case Order.Re.SHIPPED:return(0,emotion_react_jsx_runtime_browser_esm.Y)(Chip.A,(0,tslib_es6.Cl)({},defaultChipProps,{color:"info"}));case Order.Re.PARTIALLY_FULFILLED:return(0,emotion_react_jsx_runtime_browser_esm.Y)(Chip.A,(0,tslib_es6.Cl)({},defaultChipProps,{color:"success",iconVariant:"outlined"}));case Order.Re.AWAITPAY:return(0,emotion_react_jsx_runtime_browser_esm.Y)(Chip.A,(0,tslib_es6.Cl)({},defaultChipProps,{color:"warning",iconVariant:"outlined"}));case Order.Re.CANCELLED:return(0,emotion_react_jsx_runtime_browser_esm.Y)(CancelledChipStyled,(0,tslib_es6.Cl)({},defaultChipProps,{iconVariant:"filled"}));default:return null}}()})}));const OrderStatus_ReturnOrderStatus=(0,translate.Tl)("orders")((function(){return(0,emotion_react_jsx_runtime_browser_esm.Y)(Chip.A,{size:"small",color:"info",sx:{paddingLeft:"0px"},icon:(0,emotion_react_jsx_runtime_browser_esm.Y)(emotion_react_jsx_runtime_browser_esm.FK,{}),label:(0,emotion_react_jsx_runtime_browser_esm.Y)(translate.x6,{i18nKey:"orders:status:order:RETURN"})})}))},"./app/components/Rules/RuleDescription.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var tslib__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js"),_constants_automationRuleForm__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./app/constants/automationRuleForm.ts"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),react_redux__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-redux/es/index.js"),redux__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/redux/es/redux.js"),_selectors_providers_selectors__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./app/selectors/providers.selectors.ts"),_utils_businessRules__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./app/utils/businessRules.ts"),_utils_fetchable__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./app/utils/fetchable.ts"),_utils_translate__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./app/utils/translate.ts");const __WEBPACK_DEFAULT_EXPORT__=(0,redux__WEBPACK_IMPORTED_MODULE_9__.Zz)((0,_utils_translate__WEBPACK_IMPORTED_MODULE_5__.Tl)("settings"))((function(props){var rules=props.rules,showTitle=props.showTitle,t=props.t,serviceLevelsByAccountRequest=(0,react_redux__WEBPACK_IMPORTED_MODULE_2__.d4)(_selectors_providers_selectors__WEBPACK_IMPORTED_MODULE_3__.eA);if(0===rules.length)return null;var actions=rules.map((function(rule){var _a,_b,_c,_d;if(rule.ruleType===_constants_automationRuleForm__WEBPACK_IMPORTED_MODULE_0__.X2.PARCEL_TEMPLATE&&rule.userParcelTemplate)return(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.FD)(react__WEBPACK_IMPORTED_MODULE_1__.Fragment,{children:["•"," ",(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.Y)("span",(0,tslib__WEBPACK_IMPORTED_MODULE_7__.Cl)({className:"italic"},{children:(null===(_a=rule.userParcelTemplate)||void 0===_a?void 0:_a.name)||(null===(_c=null===(_b=rule.userParcelTemplate)||void 0===_b?void 0:_b.carrierTemplate)||void 0===_c?void 0:_c.name)}))," ",t("automations.ruleDescriptions.actions.package"),(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.Y)("br",{})]},rule.objectId);if(rule.ruleType===_constants_automationRuleForm__WEBPACK_IMPORTED_MODULE_0__.X2.SERVICE_LEVEL&&rule.serviceLevelToken){var serviceLevelName=function(rule){var _a;if((0,_utils_fetchable__WEBPACK_IMPORTED_MODULE_8__.Fd)(serviceLevelsByAccountRequest)&&rule.serviceLevelToken){var providers=null!==(_a=(0,_utils_fetchable__WEBPACK_IMPORTED_MODULE_8__.Vn)(serviceLevelsByAccountRequest))&&void 0!==_a?_a:[];if(providers.length>0){rule.accountObjectId&&(providers=providers.filter((function(provider){return provider.objectId===rule.accountObjectId})));var provider=providers.find((function(provider){var _a;return null===(_a=provider.serviceLevels)||void 0===_a?void 0:_a.find((function(serviceLevel){return serviceLevel.token===rule.serviceLevelToken}))}));if(provider){var serviceLevel=provider.serviceLevels.find((function(serviceLevel){return serviceLevel.token===rule.serviceLevelToken}));if(serviceLevel)return null==serviceLevel?void 0:serviceLevel.name}}}return rule.serviceLevelToken?(0,_utils_businessRules__WEBPACK_IMPORTED_MODULE_4__.M4)(rule.serviceLevelToken):"N/A"}(rule);return(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.FD)(react__WEBPACK_IMPORTED_MODULE_1__.Fragment,{children:["• ",(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.Y)("span",(0,tslib__WEBPACK_IMPORTED_MODULE_7__.Cl)({className:"italic"},{children:serviceLevelName})),t("automations.ruleDescriptions.actions.serviceLevel"),(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.Y)("br",{})]},rule.objectId)}if(rule.ruleType===_constants_automationRuleForm__WEBPACK_IMPORTED_MODULE_0__.X2.SENDER_ADDRESS&&rule.senderAPIAddress){var senderAddress=null===(_d=rule.senderAPIAddress)||void 0===_d?void 0:_d.street1;return(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.FD)(react__WEBPACK_IMPORTED_MODULE_1__.Fragment,{children:["• ",(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.Y)("span",(0,tslib__WEBPACK_IMPORTED_MODULE_7__.Cl)({className:"italic"},{children:senderAddress})),t("automations.ruleDescriptions.actions.senderAddress"),(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.Y)("br",{})]},rule.objectId)}}));return(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.FD)("span",{children:[showTitle&&(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.FD)(_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.FK,{children:[function(rules){var titleBase=rules.length>1?(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.FD)(_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.FK,{children:[rules.length,t("automations.ruleDescriptions.automationsSuffix")]}):(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.FD)(_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.FK,{children:[t("automations.ruleDescriptions.automationsPrefix"),(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.Y)("span",(0,tslib__WEBPACK_IMPORTED_MODULE_7__.Cl)({className:"italic"},{children:rules[0].name}))]});return(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.FD)(_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.FK,{children:[titleBase,t("automations.ruleDescriptions.automationsActions")]})}(rules),(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.Y)("br",{})]}),actions]})}))},"./app/constants/plans.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{_h:()=>PAYG,c8:()=>STARTER_PLAN,yf:()=>PRO_PLAN});var PAYG="PAYG",PRO_PLAN="Pro Bronze",STARTER_PLAN="PAYG 30 Label Limit"},"./app/constants/register.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{G7:()=>referralStores,Mr:()=>partnerSettings,OI:()=>REG_PARTNER_KEY,hn:()=>EMAIL_KEY,jz:()=>EmbeddablesWix,xy:()=>registerWistiaHashedId});var _a,_assets_carriers_dhl_express_svg__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./app/assets/carriers/dhl_express.svg"),_assets_carriers_fedex_svg__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./app/assets/carriers/fedex.svg"),_assets_carriers_ups_svg__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./app/assets/carriers/ups.svg"),_assets_carriers_usps_svg__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./app/assets/carriers/usps.svg"),_assets_register_godaddy_png__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./app/assets/register/godaddy.png"),_assets_register_shopify_png__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./app/assets/register/shopify.png"),_assets_register_square_png__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./app/assets/register/square.png"),_assets_register_wix_png__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./app/assets/register/wix.png"),_assets_shops_logos_ebay_svg__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./app/assets/shops/logos/ebay.svg"),_assets_shops_logos_godaddy_svg__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./app/assets/shops/logos/godaddy.svg"),_assets_shops_logos_shopify_svg__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./app/assets/shops/logos/shopify.svg"),_assets_shops_logos_square_svg__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./app/assets/shops/logos/square.svg"),_assets_shops_vector_wix_svg__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./app/assets/shops/vector/wix.svg"),_types_Store__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./app/types/Store.ts"),REG_PARTNER_KEY="reg_partner",EMAIL_KEY="email",registerWistiaHashedId="64znjkvorx",EmbeddablesWix="embeddables-wix",shopify={logo:_assets_shops_logos_shopify_svg__WEBPACK_IMPORTED_MODULE_10__,alt:"Shopify - Logo",appUrl:"https://apps.shopify.com/shippo",margin:"2rem",rightContent:_assets_register_shopify_png__WEBPACK_IMPORTED_MODULE_5__,cobranded:!0},wix={logo:_assets_shops_vector_wix_svg__WEBPACK_IMPORTED_MODULE_12__,alt:"Wix - Logo",appUrl:"https://www.wix.com/app-market/shippo/overview",compact:!0,rightContent:_assets_register_wix_png__WEBPACK_IMPORTED_MODULE_7__,cobranded:!0},godaddy={logo:_assets_shops_logos_godaddy_svg__WEBPACK_IMPORTED_MODULE_9__,alt:"GoDaddy - Logo",rightContent:_assets_register_godaddy_png__WEBPACK_IMPORTED_MODULE_4__,cobranded:!1},square={logo:_assets_shops_logos_square_svg__WEBPACK_IMPORTED_MODULE_11__,alt:"Square - Logo",rightContent:_assets_register_square_png__WEBPACK_IMPORTED_MODULE_6__,cobranded:!1},weebly={logo:_assets_shops_logos_square_svg__WEBPACK_IMPORTED_MODULE_11__,alt:"Square - Logo",rightContent:_assets_register_square_png__WEBPACK_IMPORTED_MODULE_6__,cobranded:!1},ebay={logo:_assets_shops_logos_ebay_svg__WEBPACK_IMPORTED_MODULE_8__,alt:"eBay - Logo",compact:!0,cobranded:!0},usps={logo:_assets_carriers_usps_svg__WEBPACK_IMPORTED_MODULE_3__,alt:"USPS - Logo",compact:!1,width:"9rem",cobranded:!0},fedex={logo:_assets_carriers_fedex_svg__WEBPACK_IMPORTED_MODULE_1__,alt:"FedEx - Logo",compact:!1,width:"7rem",cobranded:!0},ups={logo:_assets_carriers_ups_svg__WEBPACK_IMPORTED_MODULE_2__,alt:"UPS - Logo",compact:!1,width:"5rem",height:"5rem",cobranded:!0},dhl_express={logo:_assets_carriers_dhl_express_svg__WEBPACK_IMPORTED_MODULE_0__,alt:"DHL Express - Logo",compact:!1,width:"5rem",margin:"2.188rem",cobranded:!0},partnerSettings=((_a={})[_types_Store__WEBPACK_IMPORTED_MODULE_13__.F8.Shopify.toLowerCase()]=shopify,_a[_types_Store__WEBPACK_IMPORTED_MODULE_13__.F8.Wix.toLowerCase()]=wix,_a[EmbeddablesWix]=wix,_a[_types_Store__WEBPACK_IMPORTED_MODULE_13__.F8.eBay.toLowerCase()]=ebay,_a[_types_Store__WEBPACK_IMPORTED_MODULE_13__.F8.Godaddy.toLowerCase()]=godaddy,_a[_types_Store__WEBPACK_IMPORTED_MODULE_13__.F8.Square.toLowerCase()]=square,_a[_types_Store__WEBPACK_IMPORTED_MODULE_13__.F8.Weebly.toLowerCase()]=weebly,_a.usps=usps,_a.fedex=fedex,_a.ups=ups,_a.dhl_express=dhl_express,_a),referralStores=[_types_Store__WEBPACK_IMPORTED_MODULE_13__.F8.Shopify.toLowerCase(),_types_Store__WEBPACK_IMPORTED_MODULE_13__.F8.Wix.toLowerCase(),_types_Store__WEBPACK_IMPORTED_MODULE_13__.F8.Godaddy.toLowerCase(),_types_Store__WEBPACK_IMPORTED_MODULE_13__.F8.Square.toLowerCase(),_types_Store__WEBPACK_IMPORTED_MODULE_13__.F8.Weebly.toLowerCase(),EmbeddablesWix]},"./app/constants/signatureConfirmation.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Md:()=>STANDARD_COST,mS:()=>getSignatureConfirmationOrDefault,zr:()=>ADULT_COST});var _a,_pages_Orders_Blackbeard_LabelPurchase_modules_types__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./app/pages/Orders/Blackbeard/LabelPurchase/modules/types.ts"),standardSignatureConfirmationOption={value:_pages_Orders_Blackbeard_LabelPurchase_modules_types__WEBPACK_IMPORTED_MODULE_0__.zT.STANDARD,label:"Anyone can sign"},adultSignatureConfirmationOption={value:_pages_Orders_Blackbeard_LabelPurchase_modules_types__WEBPACK_IMPORTED_MODULE_0__.zT.ADULT,label:"An adult must sign",addToolTip:!0},signatureConfirmationMap=((_a={})[_pages_Orders_Blackbeard_LabelPurchase_modules_types__WEBPACK_IMPORTED_MODULE_0__.zT.ADULT]=adultSignatureConfirmationOption,_a[_pages_Orders_Blackbeard_LabelPurchase_modules_types__WEBPACK_IMPORTED_MODULE_0__.zT.STANDARD]=standardSignatureConfirmationOption,_a),getSignatureConfirmationOrDefault=function(value){return value&&signatureConfirmationMap[value]||standardSignatureConfirmationOption},STANDARD_COST=2,ADULT_COST=5},"./app/contexts/DrawerProvider.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{T:()=>DrawerProvider,g:()=>useDrawerContext});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),emotion_react_jsx_runtime_browser_esm=__webpack_require__("./node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js"),react=__webpack_require__("./node_modules/react/index.js"),DrawerContext=(0,react.createContext)({isOpen:!1,footerOptions:{},setFooterOptions:function(){},setIsOpen:function(){}}),DrawerProvider=function(_a){var drawerInitialSettings=_a.drawerInitialSettings,children=_a.children,_b=function(_a){var _b=void 0===_a?{}:_a,_c=_b.isOpen,isOpen=void 0!==_c&&_c,_d=_b.footerOptions,footerOptions=void 0===_d?{}:_d,_e=(0,tslib_es6.zs)((0,react.useState)(isOpen),2),drawerIsOpen=_e[0],setDrawerIsOpen=_e[1],_f=(0,tslib_es6.zs)((0,react.useState)(footerOptions),2),drawerFooterOptions=_f[0],setDrawerFooterOptions=_f[1];return{isOpen:drawerIsOpen,setIsOpen:(0,react.useCallback)((function(value,callback){setDrawerIsOpen(value),callback&&callback()}),[setDrawerIsOpen]),footerOptions:drawerFooterOptions,setFooterOptions:setDrawerFooterOptions}}(drawerInitialSettings),isOpen=_b.isOpen,setIsOpen=_b.setIsOpen,footerOptions=_b.footerOptions,setFooterOptions=_b.setFooterOptions;return(0,emotion_react_jsx_runtime_browser_esm.Y)(DrawerContext.Provider,(0,tslib_es6.Cl)({value:{isOpen,setIsOpen,footerOptions,setFooterOptions}},{children}))},useDrawerContext=function(){return(0,react.useContext)(DrawerContext)}},"./app/hooks/useRequest.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>useRequest});var tslib__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),axios__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/axios/index.js"),axios__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_0__),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js");function useRequest(){var _this=this,_a=(0,tslib__WEBPACK_IMPORTED_MODULE_2__.zs)((0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!1),2),loading=_a[0],setLoading=_a[1],_b=(0,tslib__WEBPACK_IMPORTED_MODULE_2__.zs)((0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null),2),data=_b[0],setData=_b[1],_c=(0,tslib__WEBPACK_IMPORTED_MODULE_2__.zs)((0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null),2),error=_c[0],setError=_c[1],_d=(0,tslib__WEBPACK_IMPORTED_MODULE_2__.zs)((0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(void 0),2),errorDetails=_d[0],setErrorDetails=_d[1],unmountedRef=(0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(!1);(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((function(){return function(){unmountedRef.current=!0}}),[]);var reset=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(){setLoading(!1),setData(null),setError(null),setErrorDetails(void 0)}),[]),request=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(requestFunction){return setLoading(!0),setData(null),setError(null),(0,tslib__WEBPACK_IMPORTED_MODULE_2__.sH)(_this,void 0,void 0,(function(){var response,e_1;return(0,tslib__WEBPACK_IMPORTED_MODULE_2__.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,3]),[4,requestFunction()];case 1:return response=_a.sent(),unmountedRef.current?[2]:(setData(response),setLoading(!1),[3,3]);case 2:return e_1=_a.sent(),unmountedRef.current?[2]:(axios__WEBPACK_IMPORTED_MODULE_0___default().isAxiosError(e_1)?setError(e_1.message):setError((null==e_1?void 0:e_1.message)||"An error was encountered loading data"),setErrorDetails(e_1.response),setLoading(!1),[3,3]);case 3:return[2]}}))}))}),[]);return{request,reset,loading,data,error,errorDetails}}},"./app/pages/Onboarding2024/types.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{El:()=>ONBOARDING_2024_ROUTES,OZ:()=>ONBOARDING_2024_PLANS});var ONBOARDING_2024_ROUTES={plan:"/onboarding/plan",connectStore:"/onboarding/connect_store"},ONBOARDING_2024_PLANS={starter:"PAYG-Standard",developer:"PAYG-Developer",pro:"PRO"}},"./app/pages/Onboarding2024/utils/onboarding.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{VK:()=>getOnboarding2024FlagStorage,lg:()=>getOnboarding2024MonthlyVolume,CR:()=>setOnboarding2024InProgress,tu:()=>setOnboarding2024MonthlyVolume});__webpack_require__("./app/pages/Onboarding/onboarding.constants.ts");var _a,types=__webpack_require__("./app/pages/Onboarding2024/types.ts"),setOnboarding2024InProgress=((_a={})[types.El.plan]=[types.El.connectStore,"/settings/api"],_a[types.El.connectStore]=[types.El.plan,"/orders/create","/orders/csv-import"],function(value){localStorage.setItem("onboarding_2024_in_progress",value.toString())}),getOnboarding2024FlagStorage=function(){return localStorage.getItem("onboarding_2024_flag_storage")},setOnboarding2024MonthlyVolume=function(value){localStorage.setItem("onboarding_2024_monthly_volume",value)},getOnboarding2024MonthlyVolume=function(){return localStorage.getItem("onboarding_2024_monthly_volume")||""}},"./app/pages/Orders/All/CustomerShippingMethod/CustomerShippingMethodText.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var tslib__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const __WEBPACK_DEFAULT_EXPORT__=function(props){var shippingMethod=props.shippingMethod,isCostValid=props.isCostValid,amountTextWithCurrency=props.amountTextWithCurrency,_a=props.truncate,truncateProps=void 0!==_a&&_a?{className:"truncate"}:{};return(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Y)("span",(0,tslib__WEBPACK_IMPORTED_MODULE_1__.Cl)({},truncateProps,{children:'"'.concat(shippingMethod).concat(shippingMethod&&isCostValid?" - ":"").concat(isCostValid?amountTextWithCurrency:"",'"')}))}},"./app/pages/Orders/All/CustomerShippingMethod/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{q:()=>CustomerShippingMethod_CustomerShippingMethod,x:()=>CustomerShippingMethodText.A});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),emotion_react_jsx_runtime_browser_esm=__webpack_require__("./node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js"),Typography=__webpack_require__("./node_modules/@goshippo/components/esm/Typography/Typography.js"),shippoTheme=__webpack_require__("./node_modules/@goshippo/components/esm/styles/shippoTheme.js"),StickyNote2Outlined=__webpack_require__("./node_modules/@mui/icons-material/esm/StickyNote2Outlined.js"),Info=__webpack_require__("./node_modules/@mui/icons-material/esm/Info.js"),Popup=__webpack_require__("./app/components/Popup/index.ts"),react=__webpack_require__("./node_modules/react/index.js"),translate=__webpack_require__("./app/utils/translate.ts"),CustomerShippingMethodText=__webpack_require__("./app/pages/Orders/All/CustomerShippingMethod/CustomerShippingMethodText.tsx"),iconSx={height:"1rem",width:"1rem",mr:.5};const CustomerShippingMethod_CustomerShippingMethod=react.memo((0,translate.Tl)()((function(props){var t=props.t,method=props.shippingMethod,cost=props.shippingCost,currency=props.shippingCostCurrency,_a=props.disablePopup,disablePopup=void 0!==_a&&_a,isCostValid=Number(cost)>0;if(!method&&!isCostValid)return null;var amountTextWithCurrency=t("translations:currency",{value:{value:cost,currency_iso:currency}});return(0,emotion_react_jsx_runtime_browser_esm.FD)(Typography.A,(0,tslib_es6.Cl)({component:"div",className:"mt-1 grid items-center",variant:"caption",sx:{color:shippoTheme.A.palette.grey[900],gridTemplateColumns:"fit-content(100%) fit-content(100%)"}},{children:[disablePopup?(0,emotion_react_jsx_runtime_browser_esm.Y)(StickyNote2Outlined.A,{sx:iconSx}):(0,emotion_react_jsx_runtime_browser_esm.Y)(Popup.A,(0,tslib_es6.Cl)({wrapperClassName:"flex",trigger:(0,emotion_react_jsx_runtime_browser_esm.Y)(Info.A,{sx:iconSx}),on:"hover",position:"top center",hoverable:!0,inverted:!0},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(Typography.A,(0,tslib_es6.Cl)({component:"span",variant:"caption"},{children:[t("orders:calculateRates:tabs:shipmentInfo:shippingMethod"),(0,emotion_react_jsx_runtime_browser_esm.Y)(CustomerShippingMethodText.A,{shippingMethod:method,isCostValid,amountTextWithCurrency})]}))})),(0,emotion_react_jsx_runtime_browser_esm.Y)(CustomerShippingMethodText.A,{shippingMethod:method,isCostValid,amountTextWithCurrency,truncate:!0})]}))})))},"./app/pages/Orders/All/OrderDetailsPage/RatingErrors/RateWarningConstants.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{pn:()=>UPS_LARGE_PACKAGE_SURCHARGE,pp:()=>CUSTOMS_PHONE_WARNING,zt:()=>UPS_MAX_SIZE_SURCHARGE});var CUSTOMS_PHONE_WARNING="CUSTOMS_PHONE_WARNING",UPS_MAX_SIZE_SURCHARGE="UPS_MAX_SIZE_SURCHARGE",UPS_LARGE_PACKAGE_SURCHARGE="UPS_LARGE_PACKAGE_SURCHARGE"},"./app/pages/Orders/All/OrderDetailsPage/RatingErrors/getRateWarnings.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Ay:()=>__WEBPACK_DEFAULT_EXPORT__});var _constants_carriers__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./app/constants/carriers.ts"),_constants_distance__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./app/constants/distance.ts"),_constants_weight__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./app/constants/weight.ts"),convert_units__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/convert-units/lib/index.js"),_types_Address__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./app/types/Address.ts"),_types_CustomsDeclaration__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./app/types/CustomsDeclaration.ts"),_utils_segment__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./app/utils/segment/index.ts"),_RateWarningConstants__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./app/pages/Orders/All/OrderDetailsPage/RatingErrors/RateWarningConstants.ts"),_util__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./app/pages/Orders/All/OrderDetailsPage/RatingErrors/util.ts"),UPSWarningLink="https://www.UPS.com/assets/resources/webcontent/en_US/retail_rates.pdf#page=130",isPackageAboutToExceedUPSGirth=function(girthThresold,order,selectedRate){var _a,_b,_c,_d;if(!(null==selectedRate?void 0:selectedRate.provider)||(null==selectedRate?void 0:selectedRate.provider)!==_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.$5.name)return!1;var sorted=(0,_util__WEBPACK_IMPORTED_MODULE_7__.Z7)((null===(_a=order.parcel)||void 0===_a?void 0:_a.length)||"0",(null===(_b=order.parcel)||void 0===_b?void 0:_b.width)||"0",(null===(_c=order.parcel)||void 0===_c?void 0:_c.height)||"0"),distanceUnit=(null===(_d=order.parcel)||void 0===_d?void 0:_d.distanceUnit)||_constants_distance__WEBPACK_IMPORTED_MODULE_1__.k.IN,girth=parseFloat(convert_units__WEBPACK_IMPORTED_MODULE_3__(sorted.length).from(distanceUnit).to(_constants_distance__WEBPACK_IMPORTED_MODULE_1__.k.IN))+2*parseFloat(convert_units__WEBPACK_IMPORTED_MODULE_3__(sorted.width).from(distanceUnit).to(_constants_distance__WEBPACK_IMPORTED_MODULE_1__.k.IN))+2*parseFloat(convert_units__WEBPACK_IMPORTED_MODULE_3__(sorted.height).from(distanceUnit).to(_constants_distance__WEBPACK_IMPORTED_MODULE_1__.k.IN));return girth>=girthThresold*_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.WY&&girth<=girthThresold},isPackageAboutToExceedUPSLength=function(lengthThresold,order,selectedRate){var _a,_b,_c,_d;if(!(null==selectedRate?void 0:selectedRate.provider)||(null==selectedRate?void 0:selectedRate.provider)!==_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.$5.name)return!1;var sorted=(0,_util__WEBPACK_IMPORTED_MODULE_7__.Z7)((null===(_a=order.parcel)||void 0===_a?void 0:_a.length)||"0",(null===(_b=order.parcel)||void 0===_b?void 0:_b.width)||"0",(null===(_c=order.parcel)||void 0===_c?void 0:_c.height)||"0"),distanceUnit=(null===(_d=order.parcel)||void 0===_d?void 0:_d.distanceUnit)||_constants_distance__WEBPACK_IMPORTED_MODULE_1__.k.IN,length=parseFloat(convert_units__WEBPACK_IMPORTED_MODULE_3__(sorted.length).from(distanceUnit).to(_constants_distance__WEBPACK_IMPORTED_MODULE_1__.k.IN));return length>=lengthThresold*_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.WY&&length<=lengthThresold},trackWarning=function(warning,order_id){var kind=warning.kind,message=warning.message;(0,_utils_segment__WEBPACK_IMPORTED_MODULE_6__.u4)(_utils_segment__WEBPACK_IMPORTED_MODULE_6__.sV.ups_surcharge_warning,{kind,message,order_id})};const __WEBPACK_DEFAULT_EXPORT__=function(order,batchEntry,selectedRate){var warning,warnings=[],_a=(0,_types_Address__WEBPACK_IMPORTED_MODULE_4__.tS)(order,batchEntry),addressFrom=_a.addressFrom,addressTo=_a.addressTo,hasPhoneNumberRequiredWarning=(0,_types_CustomsDeclaration__WEBPACK_IMPORTED_MODULE_5__.e8)({addressFrom,addressTo}).hasPhoneNumberRequiredWarning;switch(!0){case function(order,selectedRate){var _a,_b;if(!(null==selectedRate?void 0:selectedRate.provider)||(null==selectedRate?void 0:selectedRate.provider)!==_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.$5.name)return!1;var weightUnit=(null===(_a=order.parcel)||void 0===_a?void 0:_a.weightUnit)||_constants_weight__WEBPACK_IMPORTED_MODULE_2__.VV.LB,weight=parseFloat(convert_units__WEBPACK_IMPORTED_MODULE_3__(null===(_b=order.parcel)||void 0===_b?void 0:_b.weight).from(weightUnit).to(_constants_weight__WEBPACK_IMPORTED_MODULE_2__.VV.LB));return weight>=_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.FO*_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.WY&&weight<=_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.FO}(order,selectedRate):warning={kind:_RateWarningConstants__WEBPACK_IMPORTED_MODULE_8__.pn,message:"orders:table:errors:packageAboutToExceedWeightWarningUPS",linkCopy:"orders:table:errors:learnMore",linkURL:UPSWarningLink,messageArgs:{weight:_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.WY.toString(),amount:_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.ht.toString()}},warnings.push(warning),trackWarning(warning,order.objectId);break;case isPackageAboutToExceedUPSGirth(_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.ID,order,selectedRate):warning={kind:_RateWarningConstants__WEBPACK_IMPORTED_MODULE_8__.pn,message:"orders:table:errors:largePackageAboutToExceedGirthWarningUPS",linkCopy:"orders:table:errors:learnWhenThisApplies",linkURL:UPSWarningLink,messageArgs:{girth:_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.ID.toString(),amount:_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.ht.toString()}},warnings.push(warning),trackWarning(warning,order.objectId);break;case isPackageAboutToExceedUPSLength(_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.CR,order,selectedRate):warning={kind:_RateWarningConstants__WEBPACK_IMPORTED_MODULE_8__.pn,message:"orders:table:errors:largePackageAboutToExceedLengthWarningUPS",linkCopy:"orders:table:errors:learnMore",linkURL:UPSWarningLink,messageArgs:{length:_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.CR.toString(),amount:_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.ht.toString()}},warnings.push(warning),trackWarning(warning,order.objectId);break;case isPackageAboutToExceedUPSGirth(_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.Lt,order,selectedRate):warning={kind:_RateWarningConstants__WEBPACK_IMPORTED_MODULE_8__.zt,message:"orders:table:errors:packageAboutToExceedGirthWarningUPS",linkCopy:"orders:table:errors:learnWhenThisApplies",linkURL:UPSWarningLink,messageArgs:{girth:_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.Lt.toString(),amount:_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.ht.toString()}},warnings.push(warning),trackWarning(warning,order.objectId);break;case isPackageAboutToExceedUPSLength(_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.RO,order,selectedRate):warning={kind:_RateWarningConstants__WEBPACK_IMPORTED_MODULE_8__.zt,message:"orders:table:errors:packageAboutToExceedLengthWarningUPS",linkCopy:"orders:table:errors:learnMore",linkURL:UPSWarningLink,messageArgs:{length:_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.RO.toString(),amount:_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.ht.toString()}},warnings.push(warning),trackWarning(warning,order.objectId)}return hasPhoneNumberRequiredWarning&&warnings.push({kind:_RateWarningConstants__WEBPACK_IMPORTED_MODULE_8__.pp,message:"orders:table:errors:ratesCustomsPhoneWarning",linkCopy:"orders:calculateRates:tabs:shipmentInfo:recipientAddressEdit"}),warnings}},"./app/pages/Orders/All/OrderDetailsPage/RatingErrors/util.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Gz:()=>deduplicateWarnings,KF:()=>getUPSWarningCardExpandableHeader,Lj:()=>separateUPSSurchargeWarnings,Z7:()=>sortDimension});var _constants_carriers__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./app/constants/carriers.ts"),_RateWarningConstants__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./app/pages/Orders/All/OrderDetailsPage/RatingErrors/RateWarningConstants.ts");function deduplicateWarnings(warnings){var warningsMap=warnings.reduce((function(accum,curr){return accum[curr.message]=curr,accum}),{});return Object.values(warningsMap)}function separateUPSSurchargeWarnings(warnings){var UPSWarnings=[],nonUPSSurchargeWarnings=[];return warnings.forEach((function(w,idx){w.kind===_RateWarningConstants__WEBPACK_IMPORTED_MODULE_1__.pn||w.kind===_RateWarningConstants__WEBPACK_IMPORTED_MODULE_1__.zt?UPSWarnings.push(warnings[idx]):nonUPSSurchargeWarnings.push(warnings[idx])})),{UPSWarnings,nonUPSSurchargeWarnings}}function getUPSWarningCardExpandableHeader(t,warningKind){switch(!0){case warningKind===_RateWarningConstants__WEBPACK_IMPORTED_MODULE_1__.zt:return t("orders:table:errors:surchargeTitleUPS");case warningKind===_RateWarningConstants__WEBPACK_IMPORTED_MODULE_1__.pn:return t("orders:table:errors:surchargeTitleUPSLargePackage",{amount:_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.ht.toString()});default:return""}}var sortDimension=function(length,width,height){var stringifiedDimensions=[length,width,height].map((function(i){return parseFloat(i)})).sort((function(a,b){return a-b})).map((function(i){return i.toString()}));return{length:stringifiedDimensions[2],width:stringifiedDimensions[1],height:stringifiedDimensions[0]}}},"./app/pages/Orders/Blackbeard/Drawers/AddressDrawer/AddressBookListItem.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{L:()=>AddressBookListItem,q:()=>StyledAddressBookListItem});var tslib__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_goshippo_components__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@mui/material/styles/styled.js"),_goshippo_components__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@goshippo/components/esm/Box/Box.js"),_goshippo_components__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@goshippo/components/esm/styles/shippoTheme.js"),_goshippo_components__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@goshippo/components/esm/styles/colors.js"),_goshippo_components__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@goshippo/components/esm/styles/elevations.js"),_goshippo_components__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@goshippo/components/esm/IconButton/IconButton.js"),_goshippo_components__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./node_modules/@goshippo/components/esm/Typography/Typography.js"),_goshippo_components__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./node_modules/@goshippo/components/esm/Alert/Alert.js"),_constants_countries__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./app/constants/countries.ts"),_components_customIcons__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./app/components/customIcons/index.ts"),_types_Address__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./app/types/Address.ts"),_styles_constants__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./app/styles/constants.ts");function getCityLine(city,state,zip){return"".concat(city).concat(state||zip?", ":"").concat(state).concat(state&&zip?" ":"").concat(zip)}var templateObject_1,StyledAddressBookListItem=(0,_goshippo_components__WEBPACK_IMPORTED_MODULE_5__.Ay)(_goshippo_components__WEBPACK_IMPORTED_MODULE_6__.A,{name:"AddressBookListItem",shouldForwardProp:function(propName){return!["isSelected","isClickable"].includes(propName)}})((function(_a){var isSelected=_a.isSelected,isClickable=_a.isClickable;return{padding:"".concat(_goshippo_components__WEBPACK_IMPORTED_MODULE_7__.A.spacing(1)," ").concat(_goshippo_components__WEBPACK_IMPORTED_MODULE_7__.A.spacing(2)),borderRadius:_goshippo_components__WEBPACK_IMPORTED_MODULE_7__.A.spacing(.5),border:"solid ".concat(isSelected?_goshippo_components__WEBPACK_IMPORTED_MODULE_8__.T.primary:_goshippo_components__WEBPACK_IMPORTED_MODULE_8__.T.borders),borderWidth:isSelected?"2px":"1px",cursor:isClickable?"pointer":"default",backgroundColor:isSelected?_goshippo_components__WEBPACK_IMPORTED_MODULE_8__.T.selectedBackground:_goshippo_components__WEBPACK_IMPORTED_MODULE_8__.T.white,":hover":{boxShadow:_goshippo_components__WEBPACK_IMPORTED_MODULE_9__.$[2]}}})),StyledIconButton=(0,_goshippo_components__WEBPACK_IMPORTED_MODULE_5__.Ay)(_goshippo_components__WEBPACK_IMPORTED_MODULE_10__.A,{name:"AddressBookListEditButton"})((function(){return{color:_goshippo_components__WEBPACK_IMPORTED_MODULE_8__.T.secondary,":hover":{backgroundColor:_goshippo_components__WEBPACK_IMPORTED_MODULE_8__.T.hoverFocus}}})),OverflowTextLine=(0,_goshippo_components__WEBPACK_IMPORTED_MODULE_5__.Ay)("span")(templateObject_1||(templateObject_1=(0,tslib__WEBPACK_IMPORTED_MODULE_11__.ue)(["\n  display: block;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n"],["\n  display: block;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n"]))),MAX_CHAR_PER_LINE=34;function AddressTextLine(_a){var elementId=_a.elementId,line1=_a.line1,line2=_a.line2,line1Style=_a.line1Style,line1WithStyle=(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Y)("span",(0,tslib__WEBPACK_IMPORTED_MODULE_11__.Cl)({style:line1Style},{children:line1})),line2WithSeparator=line1?" | ".concat(line2):line2;return line2&&(line1+line2WithSeparator).length>MAX_CHAR_PER_LINE?(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.FD)(_goshippo_components__WEBPACK_IMPORTED_MODULE_13__.A,(0,tslib__WEBPACK_IMPORTED_MODULE_11__.Cl)({component:"p",variant:"body",id:elementId},{children:[(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Y)(OverflowTextLine,{children:line1WithStyle}),(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Y)(OverflowTextLine,{children:line2})]})):line2?(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.FD)(_goshippo_components__WEBPACK_IMPORTED_MODULE_13__.A,(0,tslib__WEBPACK_IMPORTED_MODULE_11__.Cl)({component:"p",variant:"body",id:elementId},{children:[line1WithStyle,line2&&line2WithSeparator]})):(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Y)(_goshippo_components__WEBPACK_IMPORTED_MODULE_13__.A,(0,tslib__WEBPACK_IMPORTED_MODULE_11__.Cl)({component:"p",variant:"body",id:elementId},{children:(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Y)(OverflowTextLine,{children:line1WithStyle})}))}function AddressBookListItem(_a){var t=_a.t,address=_a.address,onEdit=_a.onEdit,onSelect=_a.onSelect,isSelected=_a.isSelected,name=address.name,company=address.company,email=address.email,phone=address.phone,street1=address.street1,street2=address.street2,streetNumber=address.streetNumber,state=address.state,zip=address.zip,country=address.country,city=address.city,requiredAddressFields=(0,_types_Address__WEBPACK_IMPORTED_MODULE_3__.UV)(country),isAddressComplete=(0,_types_Address__WEBPACK_IMPORTED_MODULE_3__.$v)(address,requiredAddressFields),handleOnEdit=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(evt){evt.stopPropagation(),onEdit(address)}),[onEdit,address]),handleOnSelect=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(){onSelect(address)}),[onSelect,address]),elementId="address-book-list-item-".concat(address.id);return(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.FD)(StyledAddressBookListItem,(0,tslib__WEBPACK_IMPORTED_MODULE_11__.Cl)({role:"listitem","aria-describedby":elementId,isSelected,isClickable:isAddressComplete,onClick:isAddressComplete?handleOnSelect:void 0},{children:[(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.FD)(_goshippo_components__WEBPACK_IMPORTED_MODULE_6__.A,(0,tslib__WEBPACK_IMPORTED_MODULE_11__.Cl)({display:"flex",justifyContent:"space-between",gap:_goshippo_components__WEBPACK_IMPORTED_MODULE_7__.A.spacing(1)},{children:[(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.FD)(_goshippo_components__WEBPACK_IMPORTED_MODULE_6__.A,(0,tslib__WEBPACK_IMPORTED_MODULE_11__.Cl)({overflow:"hidden"},{children:[(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Y)(AddressTextLine,{elementId,line1:name,line2:company,line1Style:{fontWeight:_styles_constants__WEBPACK_IMPORTED_MODULE_4__.Wy.medium}}),(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Y)(AddressTextLine,{line1:email,line2:phone}),(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.FD)(_goshippo_components__WEBPACK_IMPORTED_MODULE_13__.A,(0,tslib__WEBPACK_IMPORTED_MODULE_11__.Cl)({component:"p",variant:"body"},{children:[street1," ",streetNumber]})),street2?(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Y)(_goshippo_components__WEBPACK_IMPORTED_MODULE_13__.A,(0,tslib__WEBPACK_IMPORTED_MODULE_11__.Cl)({component:"p",variant:"body"},{children:street2})):null,(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Y)(_goshippo_components__WEBPACK_IMPORTED_MODULE_13__.A,(0,tslib__WEBPACK_IMPORTED_MODULE_11__.Cl)({component:"p",variant:"body"},{children:getCityLine(city,state,zip)})),country&&country.iso2!==_constants_countries__WEBPACK_IMPORTED_MODULE_1__.Xr.US.iso2?(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Y)(_goshippo_components__WEBPACK_IMPORTED_MODULE_13__.A,(0,tslib__WEBPACK_IMPORTED_MODULE_11__.Cl)({component:"p",variant:"body"},{children:country.name})):null]})),(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Y)(_goshippo_components__WEBPACK_IMPORTED_MODULE_6__.A,(0,tslib__WEBPACK_IMPORTED_MODULE_11__.Cl)({display:"flex",alignItems:"center",justifyContent:"center"},{children:(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Y)(StyledIconButton,(0,tslib__WEBPACK_IMPORTED_MODULE_11__.Cl)({onClick:handleOnEdit},{children:(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Y)(_components_customIcons__WEBPACK_IMPORTED_MODULE_2__.qN,{})}))}))]})),isAddressComplete?null:(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Y)(_goshippo_components__WEBPACK_IMPORTED_MODULE_14__.A,(0,tslib__WEBPACK_IMPORTED_MODULE_11__.Cl)({severity:"error",sx:{mt:_goshippo_components__WEBPACK_IMPORTED_MODULE_7__.A.spacing(1)}},{children:t("address-form:missingInfo")}))]}))}},"./app/pages/Orders/Blackbeard/Drawers/LabelPurchaseDrawer/orderErrors.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{uF:()=>getOrderErrors});var tslib__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),date_fns__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/date-fns/esm/isSameDay/index.js"),_types_Address__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./app/types/Address.ts"),_types_CustomsDeclaration__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./app/types/CustomsDeclaration.ts"),_types_Order__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./app/types/Order.ts"),_types_OrderBatchEntry__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./app/types/OrderBatchEntry.ts"),getOrderErrors=function(selectedOrders,batchEntries,ordersData,mostCommonShipmentDate,selectedOrdersAddresses,defaultUserAddress,ratesByShipmentObjectID){var carrierParcelNoRatesErrors=0,customsErrors=0,dateErrors=0,senderErrors=0,returnErrors=0,recipientErrors=0,packageErrors=0,returnAddresses=selectedOrdersAddresses.returnAddresses,senderAddresses=selectedOrdersAddresses.senderAddresses,hasNoSenderAddresses=0===senderAddresses.length,hasIncompleteSenderAddress=senderAddresses.some((function(address){return(0,_types_Address__WEBPACK_IMPORTED_MODULE_0__.X2)(address)}));(hasNoSenderAddresses||hasIncompleteSenderAddress)&&senderErrors++;var hasNoReturnAddresses=0===returnAddresses.length,hasIncompleteReturnAddress=returnAddresses.some((function(address){return(0,_types_Address__WEBPACK_IMPORTED_MODULE_0__.X2)(address)}));return(hasNoReturnAddresses||hasIncompleteReturnAddress)&&returnErrors++,Object.entries(selectedOrders).forEach((function(_a){var _b=(0,tslib__WEBPACK_IMPORTED_MODULE_4__.zs)(_a,2),orderId=_b[0];if(!_b[1].length){var order=ordersData[orderId];orderHasCustomsError(order,void 0,defaultUserAddress)&&customsErrors++,orderHasShipmentDateError(mostCommonShipmentDate)&&dateErrors++,orderHasRecipientError(order)&&recipientErrors++,orderHasPackageError(order)&&packageErrors++}})),batchEntries.forEach((function(batchEntry){var order=ordersData[batchEntry.orderObjectId];orderHasCarrierParcelNoRatesError(batchEntry,ratesByShipmentObjectID)&&carrierParcelNoRatesErrors++,orderHasCustomsError(order,batchEntry,defaultUserAddress)&&customsErrors++,orderHasShipmentDateError(mostCommonShipmentDate,batchEntry)&&dateErrors++,orderHasRecipientError(order,batchEntry)&&recipientErrors++,orderHasPackageError(order,batchEntry)&&packageErrors++})),{carrierParcelNoRatesErrors,customsErrors,recipientErrors,senderErrors,returnErrors,packageErrors,dateErrors}},orderHasCarrierParcelNoRatesError=function(batchEntry,ratesByShipmentObjectID){var _a;return(null===(_a=batchEntry.parcel)||void 0===_a?void 0:_a.carrierParcelTemplate)&&batchEntry.shipmentObjectId&&ratesByShipmentObjectID&&batchEntry.shipmentObjectId in ratesByShipmentObjectID&&0===ratesByShipmentObjectID[batchEntry.shipmentObjectId].length},orderHasCustomsError=function(order,batchEntry,defaultUserAddress){var _a,_b,isBypassCustoms=!!(null===(_a=null==batchEntry?void 0:batchEntry.extras)||void 0===_a?void 0:_a.isBypassCustoms),requiresCustoms=batchEntry?(0,_types_OrderBatchEntry__WEBPACK_IMPORTED_MODULE_3__.p2)(batchEntry)&&!isBypassCustoms:(0,_types_Order__WEBPACK_IMPORTED_MODULE_2__.p2)(order,defaultUserAddress),customsItems=(null===(_b=null==batchEntry?void 0:batchEntry.customsItems)||void 0===_b?void 0:_b.length)?batchEntry.customsItems:[];return requiresCustoms&&!(0,_types_Order__WEBPACK_IMPORTED_MODULE_2__.sf)(order)&&!customsItems.length},orderHasShipmentDateError=function(mostCommonShipmentDate,batchEntry){return!(0,date_fns__WEBPACK_IMPORTED_MODULE_5__.default)(mostCommonShipmentDate,(null==batchEntry?void 0:batchEntry.shipmentDate)?batchEntry.shipmentDate.toDate():new Date)},orderHasPackageError=function(order,batchEntry){var _a,_b,_c,_d,hasParcelError=!(null==batchEntry?void 0:batchEntry.parcel),hasParcelWeightErrors=batchEntry?!(Number(null===(_a=batchEntry.parcel)||void 0===_a?void 0:_a.weight)>0&&(null===(_b=batchEntry.parcel)||void 0===_b?void 0:_b.weightUnit)):!(Number(null===(_c=null==order?void 0:order.parcel)||void 0===_c?void 0:_c.weight)>0&&(null===(_d=null==order?void 0:order.parcel)||void 0===_d?void 0:_d.weightUnit)),batchEntryErrors=(null==batchEntry?void 0:batchEntry.errors)?(0,tslib__WEBPACK_IMPORTED_MODULE_4__.fX)([],(0,tslib__WEBPACK_IMPORTED_MODULE_4__.zs)(batchEntry.errors),!1):[],orderErrors=0===(null==batchEntry?void 0:batchEntry.partialFulfillmentRank)||0===(null==order?void 0:order.partialFulfillmentRequests.length)?(0,tslib__WEBPACK_IMPORTED_MODULE_4__.fX)([],(0,tslib__WEBPACK_IMPORTED_MODULE_4__.zs)(order.errors),!1):[],hasExceededPackageWeightError=!!(batchEntryErrors.length?batchEntryErrors:orderErrors).find((function(error){return"order_weight_exceeded"===error.code}));return hasParcelError||hasParcelWeightErrors||hasExceededPackageWeightError},orderHasRecipientError=function(order,batchEntry){var _a=(0,_types_Address__WEBPACK_IMPORTED_MODULE_0__.tS)(order,batchEntry),addressFrom=_a.addressFrom,addressTo=_a.addressTo;return!!(0,_types_CustomsDeclaration__WEBPACK_IMPORTED_MODULE_1__.e8)({addressFrom,addressTo}).hasPhoneNumberRequiredError||!(batchEntry&&!(0,_types_Address__WEBPACK_IMPORTED_MODULE_0__.X2)(null==batchEntry?void 0:batchEntry.addressTo))&&!!(0,_types_Address__WEBPACK_IMPORTED_MODULE_0__.X2)(null==order?void 0:order.toAddress)}},"./app/pages/Orders/Blackbeard/Drawers/LabelPurchaseDrawer/utils.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Bc:()=>singleOrMultiSelectionShouldShowCustoms,GZ:()=>batchEntriesOrdersCountMessage,Yt:()=>getSelectedFulfilledOrders,ut:()=>singleOrderMessage});var tslib__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_types_CustomsDeclaration__WEBPACK_IMPORTED_MODULE_1__=(__webpack_require__("./app/constants/currency.ts"),__webpack_require__("./app/types/CustomsDeclaration.ts")),_utils_batchEntryRendering__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./app/utils/batchEntryRendering.ts");function batchEntriesOrdersCountMessage(selectedOrdersCount,batchEntriesToBuyCount,t){return 0===selectedOrdersCount?"":t("orders:actions:multi:readyToBuy",{count:batchEntriesToBuyCount,total:selectedOrdersCount})}function getTruncatedOrderNumber(orderNumber,maxLength){return void 0===maxLength&&(maxLength=25),orderNumber.length>maxLength?"...".concat(orderNumber.slice(-maxLength)):orderNumber}function singleOrderMessage(t,orderNumber,isReturnLabel){if(void 0===isReturnLabel&&(isReturnLabel=!1),orderNumber){var truncatedOrderNumber=getTruncatedOrderNumber(orderNumber);return isReturnLabel?"".concat(t("orders:drawers:buyLabel:forOrder")," ").concat(truncatedOrderNumber):truncatedOrderNumber}}function getSelectedFulfilledOrders(batchEntryIds,ordersData,batchEntryData){var ordersDataHashmap=ordersData.reduce((function(accum,curr){return accum[curr.objectId]=curr,accum}),{}),selectedBatchEntries=function getSelectedBatchEntriesById(batchEntryIds,batchEntryData){return batchEntryIds.map((function(id){return batchEntryData[id]})).filter((function(be){return!!be}))}(batchEntryIds,batchEntryData);return selectedBatchEntries.filter((function(batchEntry){var order=ordersDataHashmap[batchEntry.orderObjectId];return!!order&&!batchEntry.isReturn&&(0,_utils_batchEntryRendering__WEBPACK_IMPORTED_MODULE_2__.WO)(order,!1,batchEntry)}))}function singleOrMultiSelectionShouldShowCustoms(batchEntries,ordersData,selectedOrders,defaultUserAddress){var e_1,_a,e_2,_b;try{for(var _c=(0,tslib__WEBPACK_IMPORTED_MODULE_3__.Ju)(Object.entries(selectedOrders)),_d=_c.next();!_d.done;_d=_c.next()){var _e=(0,tslib__WEBPACK_IMPORTED_MODULE_3__.zs)(_d.value,2),orderId=_e[0];if(!_e[1].length){var order=ordersData[orderId];if(order){var fromAddress=order.addressFrom||defaultUserAddress;if(order.toAddress&&fromAddress&&(0,_types_CustomsDeclaration__WEBPACK_IMPORTED_MODULE_1__.p2)(order.toAddress,fromAddress))return!0}}}}catch(e_1_1){e_1={error:e_1_1}}finally{try{_d&&!_d.done&&(_a=_c.return)&&_a.call(_c)}finally{if(e_1)throw e_1.error}}try{for(var batchEntries_1=(0,tslib__WEBPACK_IMPORTED_MODULE_3__.Ju)(batchEntries),batchEntries_1_1=batchEntries_1.next();!batchEntries_1_1.done;batchEntries_1_1=batchEntries_1.next()){var entry=batchEntries_1_1.value;if(entry.addressFrom&&entry.addressTo&&(0,_types_CustomsDeclaration__WEBPACK_IMPORTED_MODULE_1__.p2)(entry.addressTo,entry.addressFrom))return!0}}catch(e_2_1){e_2={error:e_2_1}}finally{try{batchEntries_1_1&&!batchEntries_1_1.done&&(_b=batchEntries_1.return)&&_b.call(batchEntries_1)}finally{if(e_2)throw e_2.error}}return!1}},"./app/pages/Orders/Blackbeard/LabelPurchase/modules/Card/Card.styled.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Q_:()=>CardContainer,hT:()=>CardAccordion,k1:()=>CardContentWithNormalPadding,t:()=>CardAccordionSummary});var templateObject_1,templateObject_2,templateObject_3,tslib__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_goshippo_components__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@mui/material/styles/styled.js"),_goshippo_components__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@goshippo/components/esm/Box/Box.js"),_goshippo_components__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@goshippo/components/esm/styles/colors.js"),_goshippo_components__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@goshippo/components/esm/Accordion/Accordion.js"),_goshippo_components__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@goshippo/components/esm/Accordion/AccordionSummary/AccordionSummary.js"),_goshippo_components__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@goshippo/components/esm/styles/shippoTheme.js"),_goshippo_components__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@goshippo/components/esm/CardContent/CardContent.js"),CardContainer=(0,_goshippo_components__WEBPACK_IMPORTED_MODULE_0__.Ay)(_goshippo_components__WEBPACK_IMPORTED_MODULE_1__.A)((function(){return{border:"1px solid",borderColor:_goshippo_components__WEBPACK_IMPORTED_MODULE_2__.T.gray30,borderRadius:"4px"}})),CardAccordion=(0,_goshippo_components__WEBPACK_IMPORTED_MODULE_0__.Ay)(_goshippo_components__WEBPACK_IMPORTED_MODULE_3__.A)(templateObject_1||(templateObject_1=(0,tslib__WEBPACK_IMPORTED_MODULE_4__.ue)(["\n  padding: 0;\n  border-bottom: 0;\n"],["\n  padding: 0;\n  border-bottom: 0;\n"]))),CardAccordionSummary=(0,_goshippo_components__WEBPACK_IMPORTED_MODULE_0__.Ay)(_goshippo_components__WEBPACK_IMPORTED_MODULE_5__.A)(templateObject_2||(templateObject_2=(0,tslib__WEBPACK_IMPORTED_MODULE_4__.ue)(["\n  .MuiAccordionSummary-content {\n    max-width: calc(100% - "," * 2);\n    margin: ",";\n\n    display: grid;\n    grid-template-columns: calc(100% / 3) calc(100% / 3 * 2);\n    align-items: center;\n  }\n\n  & .MuiAccordionSummary-expandIconWrapper {\n    margin-right: 1.5rem;\n  }\n"],["\n  .MuiAccordionSummary-content {\n    max-width: calc(100% - "," * 2);\n    margin: ",";\n\n    display: grid;\n    grid-template-columns: calc(100% / 3) calc(100% / 3 * 2);\n    align-items: center;\n  }\n\n  & .MuiAccordionSummary-expandIconWrapper {\n    margin-right: 1.5rem;\n  }\n"])),"1rem","1rem"),CardContentWithNormalPadding=((0,_goshippo_components__WEBPACK_IMPORTED_MODULE_0__.Ay)(_goshippo_components__WEBPACK_IMPORTED_MODULE_1__.A)(templateObject_3||(templateObject_3=(0,tslib__WEBPACK_IMPORTED_MODULE_4__.ue)(["\n  padding: 1rem;\n  border-bottom: 1px solid ",";\n  &:first-of-type {\n    border-top: none;\n  }\n  &:last-of-type {\n    border-bottom: 0;\n  }\n"],["\n  padding: 1rem;\n  border-bottom: 1px solid ",";\n  &:first-of-type {\n    border-top: none;\n  }\n  &:last-of-type {\n    border-bottom: 0;\n  }\n"])),_goshippo_components__WEBPACK_IMPORTED_MODULE_6__.A.palette.grey[300]),(0,_goshippo_components__WEBPACK_IMPORTED_MODULE_0__.Ay)(_goshippo_components__WEBPACK_IMPORTED_MODULE_7__.A)((function(_a){return{":last-child":{paddingBottom:_a.theme.spacing(2)}}})))},"./app/pages/Orders/Blackbeard/LabelPurchase/modules/Card/CardSummaryButton.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>Card_CardSummaryButton});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),emotion_react_jsx_runtime_browser_esm=__webpack_require__("./node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js"),Stack=__webpack_require__("./node_modules/@goshippo/components/esm/Stack/Stack.js"),CheckCircle=__webpack_require__("./node_modules/@mui/icons-material/esm/CheckCircle.js"),shippoTheme=__webpack_require__("./node_modules/@goshippo/components/esm/styles/shippoTheme.js"),colors=__webpack_require__("./node_modules/@goshippo/components/esm/styles/colors.js"),ExpandLess=__webpack_require__("./node_modules/@mui/icons-material/esm/ExpandLess.js"),ExpandMore=__webpack_require__("./node_modules/@mui/icons-material/esm/ExpandMore.js"),Box=__webpack_require__("./node_modules/@goshippo/components/esm/Box/Box.js"),Card=__webpack_require__("./node_modules/@goshippo/libraries/dist/esm/LabelPurchaseModules/Card/index.js"),react=__webpack_require__("./node_modules/react/index.js");const Card_useSaved=function(_a){var isUpdating=_a.isUpdating,_b=(0,tslib_es6.zs)((0,react.useState)(!1),2),isJustSaved=_b[0],setIsJustSaved=_b[1],isUpdatingPreviousRef=(0,react.useRef)(isUpdating);return isUpdatingPreviousRef.current&&!isUpdating&&(setIsJustSaved(!0),setTimeout((function(){setIsJustSaved(!1)}),1200)),isUpdatingPreviousRef.current=isUpdating,{showSaved:isJustSaved}};const Card_CardSummaryButton=function(_a){var isError=_a.isError,isOpen=_a.isOpen,text=_a.text,isUpdating=_a.isUpdating,savedText=_a.savedText,hasUnsavedChanges=_a.hasUnsavedChanges,color=isError||hasUnsavedChanges?"error":"secondary",variant=isError?"contained":"text",buttonContent=Card_useSaved({isUpdating:!!isUpdating}).showSaved&&!hasUnsavedChanges?(0,emotion_react_jsx_runtime_browser_esm.FD)(Stack.A,(0,tslib_es6.Cl)({direction:"row",alignContent:"center"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(CheckCircle.A,{sx:{marginRight:shippoTheme.A.spacing(1),color:"".concat(colors.T.primary," !important")}}),savedText]})):text;return(0,emotion_react_jsx_runtime_browser_esm.Y)(Card.V.vN,(0,tslib_es6.Cl)({hasError:isError,variant,color,size:"small",endIcon:isOpen?(0,emotion_react_jsx_runtime_browser_esm.Y)(ExpandLess.A,{fontSize:"large","data-testid":"expand-less-icon"}):(0,emotion_react_jsx_runtime_browser_esm.Y)(ExpandMore.A,{fontSize:"large","data-testid":"expand-more-icon"}),"data-testid":isError?"card-summary-error-button":"card-summary-button"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Box.A,{children:buttonContent})}))}},"./app/pages/Orders/Blackbeard/LabelPurchase/modules/Card/SelectableCard.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var tslib__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js"),_goshippo_components__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@mui/material/styles/styled.js"),_goshippo_components__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@goshippo/components/esm/Card/Card.js"),_goshippo_components__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@goshippo/components/esm/styles/colors.js"),_goshippo_components__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@goshippo/components/esm/styles/elevations.js"),_Card_styled__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./app/pages/Orders/Blackbeard/LabelPurchase/modules/Card/Card.styled.tsx"),StyledCard=(0,_goshippo_components__WEBPACK_IMPORTED_MODULE_1__.Ay)((function(_a){_a.isSelected;var props=(0,tslib__WEBPACK_IMPORTED_MODULE_2__.Tt)(_a,["isSelected"]);return(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.Y)(_goshippo_components__WEBPACK_IMPORTED_MODULE_4__.A,(0,tslib__WEBPACK_IMPORTED_MODULE_2__.Cl)({},props))}))(templateObject_1||(templateObject_1=(0,tslib__WEBPACK_IMPORTED_MODULE_2__.ue)(["\n  ",";\n  cursor: pointer;\n  &:hover {\n    box-shadow: ",";\n  }\n  &:focus {\n    box-shadow: 0px 0px 0px 4px ",";\n  }\n  &:focus-visible {\n    box-shadow: 0px 0px 0px 4px ",";\n    outline: none;\n  }\n"],["\n  ",";\n  cursor: pointer;\n  &:hover {\n    box-shadow: ",";\n  }\n  &:focus {\n    box-shadow: 0px 0px 0px 4px ",";\n  }\n  &:focus-visible {\n    box-shadow: 0px 0px 0px 4px ",";\n    outline: none;\n  }\n"])),(function(props){return props.isSelected?"":{backgroundColor:_goshippo_components__WEBPACK_IMPORTED_MODULE_5__.T.accent.background.success,borderColor:_goshippo_components__WEBPACK_IMPORTED_MODULE_5__.T.accent.foreground.success,borderWidth:2}}),_goshippo_components__WEBPACK_IMPORTED_MODULE_6__.$[2],_goshippo_components__WEBPACK_IMPORTED_MODULE_5__.T.borderFocus,_goshippo_components__WEBPACK_IMPORTED_MODULE_5__.T.borderFocus);const __WEBPACK_DEFAULT_EXPORT__=function(_a){var children=_a.children,isSelected=_a.isSelected,handleKeyboardEvents=_a.handleKeyboardEvents,rate=_a.rate,cardProps=(0,tslib__WEBPACK_IMPORTED_MODULE_2__.Tt)(_a,["children","isSelected","handleKeyboardEvents","rate"]);return(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.Y)(StyledCard,(0,tslib__WEBPACK_IMPORTED_MODULE_2__.Cl)({tabIndex:0,onKeyDown:function(e){handleKeyboardEvents&&rate&&handleKeyboardEvents(e,rate)},isSelected:!isSelected},cardProps,{children:(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.Y)(_Card_styled__WEBPACK_IMPORTED_MODULE_0__.k1,{children})}))};var templateObject_1},"./app/pages/Orders/Blackbeard/LabelPurchase/modules/CarrierIconMui.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var tslib__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js"),_goshippo_components__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@goshippo/components/esm/Badge/Badge.js"),_goshippo_components__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@goshippo/components/esm/styles/colors.js"),_constants_carriers__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./app/constants/carriers.ts");const __WEBPACK_DEFAULT_EXPORT__=function(_a){var _b,provider=_a.provider,count=_a.count,size=_a.size;_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.bK[provider]&&(provider=_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.bK[provider]);var icon=null===(_b=_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.Ay.find((function(x){return x.name.toLowerCase()===provider.toLowerCase()})))||void 0===_b?void 0:_b.icon,sizeOrDefault=size||40;return(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Y)(_goshippo_components__WEBPACK_IMPORTED_MODULE_2__.A,(0,tslib__WEBPACK_IMPORTED_MODULE_3__.Cl)({color:"default",sx:{".MuiBadge-badge":{backgroundColor:_goshippo_components__WEBPACK_IMPORTED_MODULE_4__.T.secondary,color:_goshippo_components__WEBPACK_IMPORTED_MODULE_4__.T.white}},badgeContent:count},{children:(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Y)("img",{style:{width:"".concat(sizeOrDefault,"px"),height:"".concat(sizeOrDefault,"px"),borderRadius:"0.125rem"},alt:provider,src:icon})}))}},"./app/pages/Orders/Blackbeard/LabelPurchase/modules/ShipmentExtrasCard/utils.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{kB:()=>getInsuranceCost,dc:()=>utils_insuranceModalContent,jX:()=>utils_insuredAmountFromLineItems,Eo:()=>utils_lineItemsFromPartialOrder,EA:()=>paramsForOnSaveInsurance});var lodash=__webpack_require__("./node_modules/lodash/lodash.js"),tslib_es6=(__webpack_require__("./app/utils/segment/index.ts"),__webpack_require__("./node_modules/tslib/tslib.es6.mjs")),constants_currency=__webpack_require__("./app/constants/currency.ts"),index_umd=__webpack_require__("./node_modules/country-to-currency/index.umd.js"),index_umd_default=__webpack_require__.n(index_umd);function orderCurrency(currencyIso){return currencyIso?constants_currency.q[currencyIso]:void 0}var DEFAULT_INSURANCE_MODAL_AMOUNT=125,DEFAULT_INSURANCE_MODAL_AMOUNTS={USD:125,CAD:150,GBP:100,MXN:2e3,EUR:100};function insuranceFormCurrencyAndAmount(extrasInsurance,order,partialOrderLineItems,batchEntry){var _a,_b,_c,_d,itemCurrencies,currency;if((null==extrasInsurance?void 0:extrasInsurance.currency)&&constants_currency.q[extrasInsurance.currency.iso])return{currency:extrasInsurance.currency,amount:+(null==extrasInsurance?void 0:extrasInsurance.amount)||DEFAULT_INSURANCE_MODAL_AMOUNTS[extrasInsurance.currency.iso]||DEFAULT_INSURANCE_MODAL_AMOUNT};if(partialOrderLineItems){var partialOrderCurrencies=(0,tslib_es6.fX)([],(0,tslib_es6.zs)(new Set(partialOrderLineItems.map((function(lineItem){return lineItem.currency})).filter((function(lineItem){return!!(null==lineItem?void 0:lineItem.iso)})))),!1);if(1===partialOrderCurrencies.length)return{currency:partialOrderCurrencies[0],amount:partialOrderLineItems.reduce((function(acc,curr){return acc+ +curr.totalAmount}),0)||DEFAULT_INSURANCE_MODAL_AMOUNT}}if((null==order?void 0:order.lineItems)&&order.lineItems.length>0&&1===(itemCurrencies=(0,tslib_es6.fX)([],(0,tslib_es6.zs)(new Set(order.lineItems.map((function(lineItem){return lineItem.currency})).filter((function(lineItem){return!!(null==lineItem?void 0:lineItem.iso)})))),!1)).length)return{currency:itemCurrencies[0],amount:order.lineItems.reduce((function(acc,curr){return acc+ +curr.totalAmount}),0)||DEFAULT_INSURANCE_MODAL_AMOUNT};if((null==batchEntry?void 0:batchEntry.customsItems)&&batchEntry.customsItems.length>0&&1===(itemCurrencies=(0,tslib_es6.fX)([],(0,tslib_es6.zs)(new Set(batchEntry.customsItems.map((function(customsItem){return customsItem.valueCurrency})).filter((function(customsItem){return!!(null==customsItem?void 0:customsItem.iso)})))),!1)).length)return{currency:itemCurrencies[0],amount:batchEntry.customsItems.reduce((function(acc,curr){return acc+ +curr.valueAmount}),0)||DEFAULT_INSURANCE_MODAL_AMOUNT};return(null==order?void 0:order.currency)&&orderCurrency(order.currency)?{currency:currency=orderCurrency(order.currency)||constants_currency.q.USD,amount:+((null==order?void 0:order.totalPrice)||(null==order?void 0:order.subtotalPrice)||"")||DEFAULT_INSURANCE_MODAL_AMOUNTS[currency.iso]||DEFAULT_INSURANCE_MODAL_AMOUNT}:(null===(_b=null===(_a=null==batchEntry?void 0:batchEntry.addressFrom)||void 0===_a?void 0:_a.country)||void 0===_b?void 0:_b.iso2)&&index_umd_default()[batchEntry.addressFrom.country.iso2]?{currency:currency=constants_currency.q[index_umd_default()[batchEntry.addressFrom.country.iso2]]||constants_currency.q.USD,amount:DEFAULT_INSURANCE_MODAL_AMOUNTS[currency.iso]||DEFAULT_INSURANCE_MODAL_AMOUNT}:(null===(_d=null===(_c=null==order?void 0:order.addressFrom)||void 0===_c?void 0:_c.country)||void 0===_d?void 0:_d.iso2)&&index_umd_default()[order.addressFrom.country.iso2]?{currency:currency=constants_currency.q[index_umd_default()[order.addressFrom.country.iso2]]||constants_currency.q.USD,amount:DEFAULT_INSURANCE_MODAL_AMOUNTS[currency.iso]||DEFAULT_INSURANCE_MODAL_AMOUNT}:{currency:constants_currency.q.USD,amount:DEFAULT_INSURANCE_MODAL_AMOUNTS.USD}}var paramsForOnSaveInsurance=function(newInsuranceValues){return{insurance:newInsuranceValues.hasInsurance?{amount:"".concat(newInsuranceValues.amount.replace(/,/g,"")),currency:newInsuranceValues.currency,useImportedAmount:!1}:null}},utils_insuredAmountFromLineItems=function(lineItems){var output=null==lineItems?void 0:lineItems.map((function(i){return+i.totalAmount})).reduce((function(curr,accum){return curr+accum}),0);return(0,lodash.isFinite)(output)?output:0},utils_insuranceModalContent=function(extrasInsurance,order,partialOrderLineItems,batchEntry){var currencyAndAmount=insuranceFormCurrencyAndAmount(extrasInsurance,order,partialOrderLineItems,batchEntry);return{hasInsurance:!!extrasInsurance,amount:"".concat(currencyAndAmount.amount),useImportedAmount:!1,currency:currencyAndAmount.currency}},utils_lineItemsFromPartialOrder=function(orderLineItems,batchEntryLineItems){if(orderLineItems&&batchEntryLineItems){var targetLineItems=batchEntryLineItems.reduce((function(accum,curr){return accum[curr.objectId]=!0,accum}),{}),output=orderLineItems.filter((function(lineItem){return!!targetLineItems[lineItem.objectId]}));return output.length?output:void 0}},getInsuranceCost=function(userInsuranceRate,declaredValue,rateCost,numOrdersSelected){return void 0===rateCost&&(rateCost=0),void 0===numOrdersSelected&&(numOrdersSelected=1),(numOrdersSelected*declaredValue+rateCost)*userInsuranceRate}},"./app/pages/Orders/Blackbeard/LabelPurchase/modules/types.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";var _a,_b,_c,_d;__webpack_require__.d(__webpack_exports__,{Mx:()=>TransitCarrier,Uf:()=>carrierTransitTimeRange,nB:()=>SelectedParcelType,tf:()=>blackbeardDistanceUnit,zT:()=>blackbeardSignatureConfirmation});var blackbeardDistanceUnit={CM:"cm",IN:"in",MM:"mm"};var TransitCarrier,SelectedParcelType=function(){function SelectedParcelType(oneOffBoxOrTubeSelected,oneOffPolymailerSelected,selectedUserParcelTemplate,selectedCarrierParcelTemplate){this.oneOffBoxOrTubeSelected=oneOffBoxOrTubeSelected,this.oneOffPolymailerSelected=oneOffPolymailerSelected,this.selectedUserParcelTemplate=selectedUserParcelTemplate,this.selectedCarrierParcelTemplate=selectedCarrierParcelTemplate}return SelectedParcelType.unselected=function(){return new SelectedParcelType(!1,!1)},SelectedParcelType.selectCustomBoxOrTube=function(){return new SelectedParcelType(!0,!1)},SelectedParcelType.selectCustomPolymailer=function(){return new SelectedParcelType(!1,!0)},SelectedParcelType.selectUserParcelTemplate=function(template){return new SelectedParcelType(!1,!1,template)},SelectedParcelType.selectCarrierParcelTemplate=function(template){return new SelectedParcelType(!1,!1,void 0,template)},SelectedParcelType.prototype.selectFromTemplate=function(userTemplate,carrierTemplate){return userTemplate||carrierTemplate?new SelectedParcelType(!1,!1,userTemplate,carrierTemplate):this},SelectedParcelType.prototype.isUnselected=function(){return!this.isCustomSelected()&&!this.isTemplateSelected()},SelectedParcelType.prototype.isCustomSelected=function(){return this.isCustomBoxOrTubeSelected()||this.isCustomPolymailerSelected()},SelectedParcelType.prototype.isTemplateSelected=function(){return this.isUserParcelTemplateSelected()||this.isCarrierParcelTemplateSelected()},SelectedParcelType.prototype.isCustomBoxOrTubeSelected=function(){return this.oneOffBoxOrTubeSelected},SelectedParcelType.prototype.isCustomPolymailerSelected=function(){return this.oneOffPolymailerSelected},SelectedParcelType.prototype.isUserParcelTemplateSelected=function(){return void 0!==this.selectedUserParcelTemplate},SelectedParcelType.prototype.isCarrierParcelTemplateSelected=function(){return void 0!==this.selectedCarrierParcelTemplate},SelectedParcelType.prototype.getSelectedUserParcelTemplate=function(){return this.selectedUserParcelTemplate},SelectedParcelType.prototype.getSelectedCarrierParcelTemplate=function(){return this.selectedCarrierParcelTemplate},SelectedParcelType.prototype.getSelectedParcelTemplate=function(){return this.isUserParcelTemplateSelected()?this.getSelectedUserParcelTemplate():this.getSelectedCarrierParcelTemplate()},SelectedParcelType.prototype.isEqual=function(other){return this.isUnselected()?other.isUnselected():this.isCustomBoxOrTubeSelected()?other.isCustomBoxOrTubeSelected():this.isCustomPolymailerSelected()?other.isCustomPolymailerSelected():JSON.stringify(this.getSelectedParcelTemplate())===JSON.stringify(other.getSelectedParcelTemplate())},SelectedParcelType}(),blackbeardSignatureConfirmation={STANDARD:"STANDARD",ADULT:"ADULT",CERTIFIED:"CERTIFIED",INDIRECT:"INDIRECT",CARRIER_CONFIRMATION:"CARRIER_CONFIRMATION"};!function(TransitCarrier){TransitCarrier.USPS="USPS",TransitCarrier.UPS="UPS",TransitCarrier.FedEx="FedEx"}(TransitCarrier||(TransitCarrier={}));var USPS_GroundAdvantage="usps_ground_advantage",USPS_PriorityMail="usps_priority_mail",USPS_PriorityMailExpress="usps_priority_mail_express",UPS_Ground="ups_ground",UPS_GroundSaver="ups_ground_saver",FedEx_HomeDelivery="fedex_home_delivery",FedEx_TwoDay="fedex_2_day",FedEx_GroundEconomy="fedex_ground_economy",carrierTransitTimeRange=((_a={})[TransitCarrier.USPS]=((_b={})[USPS_GroundAdvantage]={min:2,max:5,type:"business"},_b[USPS_PriorityMail]={min:1,max:3,type:"business"},_b[USPS_PriorityMailExpress]={min:2,max:2,type:"calendar"},_b),_a[TransitCarrier.UPS]=((_c={})[UPS_Ground]={min:1,max:5,type:"business"},_c[UPS_GroundSaver]={min:2,max:7,type:"business"},_c),_a[TransitCarrier.FedEx]=((_d={})[FedEx_HomeDelivery]={min:1,max:5,type:"business"},_d[FedEx_TwoDay]={min:2,max:2,type:"business"},_d[FedEx_GroundEconomy]={min:2,max:7,type:"business"},_d),_a)},"./app/pages/Orders/Blackbeard/LabelPurchase/modules/utils.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{HU:()=>getTransitTimeMax,WM:()=>getRateValueTranslated,WW:()=>shouldUseKeep,gG:()=>getEstimatedDaysTranslated});var _constants_currency__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./app/constants/currency.ts"),_types__WEBPACK_IMPORTED_MODULE_4__=(__webpack_require__("./app/constants/signatureConfirmation.ts"),__webpack_require__("./app/types/SignatureConfirmation.ts"),__webpack_require__("./app/pages/Orders/Blackbeard/LabelPurchase/modules/ShipmentExtrasCard/utils.ts"),__webpack_require__("./app/pages/Orders/Blackbeard/LabelPurchase/modules/types.ts")),date_fns__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/date-fns/esm/getDay/index.js"),getEstimatedDaysTranslated=function(estimatedDays,t){return estimatedDays?t("translations:day",{count:estimatedDays}):t("orders:calculateRates:rates:info:etaUnavailable")},getRateValueTranslated=function(amount,currency,t){var noValue="".concat(_constants_currency__WEBPACK_IMPORTED_MODULE_0__.q[currency].symbol,"—");return Number(amount)?t("translations:currency",{value:{value:Number(amount),currency_iso:currency}}):noValue};function shouldUseKeep(mixedSelection){return mixedSelection&&mixedSelection.numberWithInsurance>0&&mixedSelection.numberSelected>1}function calculatePackageTimelines(eta,meanDays){var meanDaysRounded=Math.round(meanDays);return meanDaysRounded<eta?{status:"early",days:eta-meanDaysRounded}:meanDaysRounded>eta?{status:"late",days:meanDaysRounded-eta}:{status:"on time",days:0}}var isTransitCarrier=function(value){var normalizedValue=value.replace(/\s+/g,"");return Object.values(_types__WEBPACK_IMPORTED_MODULE_4__.Mx).includes(normalizedValue)};function getTransitTimeMax(carrierName,serviceLevel,eta,rateTransitServiceLevel,rateTransitLevelMean){if(isTransitCarrier(carrierName)&&function serviceLevelExists(carrier,serviceLevelStr){if(!isTransitCarrier(carrier))return!1;var carrierEnumValue=carrier.replace(/\s+/g,""),serviceLevels=_types__WEBPACK_IMPORTED_MODULE_4__.Uf[carrierEnumValue];return Object.keys(serviceLevels).includes(serviceLevelStr)}(carrierName,serviceLevel)&&rateTransitLevelMean&&rateTransitServiceLevel===serviceLevel){var transitRange=_types__WEBPACK_IMPORTED_MODULE_4__.Uf[carrierName][serviceLevel];if("business"===transitRange.type)if(eta<=function calculateBusinessDayMax(startDate,max){var dayOfWeek=(0,date_fns__WEBPACK_IMPORTED_MODULE_5__.default)(startDate);return 6===dayOfWeek?max+=2:0===dayOfWeek&&(max+=1),max}(new Date,transitRange.max)){var _a=calculatePackageTimelines(eta,rateTransitLevelMean);return{status:_a.status,days:_a.days}}if(!(eta>transitRange.max)){var _b=calculatePackageTimelines(eta,rateTransitLevelMean);return{status:_b.status,days:_b.days}}}}},"./app/pages/Orders/Blackbeard/hooks/hooks/useRefreshRates.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>useRefreshRates});var tslib__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_actions_orders_actions__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./app/actions/orders.actions.ts"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),react_redux__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-redux/es/index.js"),react_router_dom__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/react-router/esm/react-router.js"),_selectors_batch_entry_composite_selectors__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./app/selectors/batch-entry.composite.selectors.ts"),_selectors_batch_entry_selectors__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./app/selectors/batch-entry.selectors.ts"),_utils_segment__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./app/utils/segment/index.ts"),_types_utils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./app/pages/Orders/Blackbeard/types/utils.ts"),isOrderSelectionValid=function(orderSelection){var orders=Object.keys(orderSelection),batchEntries=Object.values(orderSelection);return orders.length>0&&batchEntries.length>0&&batchEntries[0].length>0};function useRefreshRates(orderSelection){var dispatch=(0,react_redux__WEBPACK_IMPORTED_MODULE_2__.wA)(),history=(0,react_router_dom__WEBPACK_IMPORTED_MODULE_7__.W6)(),params=(0,react_router_dom__WEBPACK_IMPORTED_MODULE_7__.g)(),_a=(0,tslib__WEBPACK_IMPORTED_MODULE_8__.zs)((0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!1),2),isRefreshing=_a[0],setIsRefreshing=_a[1],batchEntries=(0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)((function(){return isOrderSelectionValid(orderSelection)?Object.values(orderSelection).flat():[]}),[orderSelection]),getBatchEntryIsCompleted=(0,_selectors_batch_entry_selectors__WEBPACK_IMPORTED_MODULE_4__.WX)(),getIsBatchEntryProcessingShipment=(0,_selectors_batch_entry_selectors__WEBPACK_IMPORTED_MODULE_4__.gx)(),getShipmentIsLoadingFromBatchEntry=(0,_selectors_batch_entry_composite_selectors__WEBPACK_IMPORTED_MODULE_3__.$T)(),completedEntries=(0,react_redux__WEBPACK_IMPORTED_MODULE_2__.d4)((function(state){return getBatchEntryIsCompleted(state,{batchEntryIds:batchEntries})}),_types_utils__WEBPACK_IMPORTED_MODULE_6__.t7),processingEntries=(0,react_redux__WEBPACK_IMPORTED_MODULE_2__.d4)((function(state){return getIsBatchEntryProcessingShipment(state,{batchEntryIds:batchEntries})}),_types_utils__WEBPACK_IMPORTED_MODULE_6__.t7),loadingEntries=(0,react_redux__WEBPACK_IMPORTED_MODULE_2__.d4)((function(state){return getShipmentIsLoadingFromBatchEntry(state,{batchEntryIds:batchEntries})}),_types_utils__WEBPACK_IMPORTED_MODULE_6__.t7),newBatchEntry=(0,react_redux__WEBPACK_IMPORTED_MODULE_2__.d4)((function(state){return(0,_selectors_batch_entry_selectors__WEBPACK_IMPORTED_MODULE_4__.rk)(state,{orderObjectId:params.orderId})}),_types_utils__WEBPACK_IMPORTED_MODULE_6__.t7);(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((function(){setIsRefreshing((function(oldValue){var newValue=0===batchEntries.length||!completedEntries&&(processingEntries||loadingEntries);return params.orderId&&batchEntries.length>0&&newBatchEntry.indexOf(batchEntries[0])<0&&!oldValue&&oldValue!==newValue&&history.push("/orders/".concat(params.orderId)),newValue}))}),[completedEntries,processingEntries,loadingEntries,batchEntries,params.orderId,newBatchEntry,history]);var selectedThingsCount=Object.entries(orderSelection).reduce((function(count,_a){var _b=(0,tslib__WEBPACK_IMPORTED_MODULE_8__.zs)(_a,2);_b[0];return count+(_b[1].length||1)}),0);return{handleRefresh:(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(event){event.preventDefault(),event.stopPropagation(),(0,_utils_segment__WEBPACK_IMPORTED_MODULE_5__.u4)("Carrier Rates Updated",{orders_selected:selectedThingsCount}),dispatch((0,_actions_orders_actions__WEBPACK_IMPORTED_MODULE_0__.lN)(orderSelection))}),[dispatch,orderSelection,selectedThingsCount]),isRefreshing,batchEntries}}},"./app/pages/Shipments/ShipmentsPage/ShipmentsTable/util.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{iM:()=>trackingStatusFieldToObject});__webpack_require__("./app/types/Order.ts"),__webpack_require__("./app/types/Transaction.ts");function trackingStatusFieldToObject(trackingStatus,isReturn,isNewReturnExperience){if(trackingStatus){var splitStatus=trackingStatus.split(": ");if(splitStatus.length<2)return{title:splitStatus[0].trim()};var title=splitStatus[0].trim();if("pre-transit"===title.toLowerCase()&&(title="Pre-transit"),isReturn&&isNewReturnExperience)switch(title.toLowerCase()){case"pre-transit":title="".concat(title," return");break;case"in transit":case"in-transit":title="Return in transit";break;case"delivered":title="Return delivered";break;case"failure":title="Return failure"}return{title,description:splitStatus.slice(1).join(": ").trim()}}}},"./app/pages/common/EmbeddableAuth/embeddable-helpers.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Ie:()=>checkForEmbeddableUser,i_:()=>refreshWithUTMParameters,jY:()=>getEmbeddableUser});var tslib__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/lodash/lodash.js"),qs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/qs/lib/index.js"),AcceptedInstallIntents=["bm-flow","bm-stores-orders","bm-stores-orders-list"],checkForEmbeddableUser=function(queryString){var queryParams=qs__WEBPACK_IMPORTED_MODULE_1__.parse(queryString,{ignoreQueryPrefix:!0,decoder:decodeURIComponent});return!!(queryParams.installIntent&&AcceptedInstallIntents.includes(queryParams.installIntent)||window.location.search.includes("Embed"))&&(localStorage.setItem("shippo_embeddable_user","true"),!0)},getEmbeddableUser=function(){return"true"===localStorage.getItem("shippo_embeddable_user")},refreshWithUTMParameters=function(utmSource,embeddable){var currentParams=qs__WEBPACK_IMPORTED_MODULE_1__.parse(window.location.search.substring(1)),newParams=(0,tslib__WEBPACK_IMPORTED_MODULE_2__.Cl)({utm_source:"".concat(embeddable?"Embeddables-":"").concat((0,lodash__WEBPACK_IMPORTED_MODULE_0__.capitalize)(utmSource)),utm_medium:"partner-app-store"},currentParams);window.location.assign("".concat(window.location.origin).concat(window.location.pathname,"?").concat(qs__WEBPACK_IMPORTED_MODULE_1__.stringify(newParams)))}},"./app/pages/common/EmbeddableAuth/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Os:()=>EmbeddableAuth_PartnerHeader,Ie:()=>embeddable_helpers.Ie,jY:()=>embeddable_helpers.jY});var embeddable_helpers=__webpack_require__("./app/pages/common/EmbeddableAuth/embeddable-helpers.ts"),tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),emotion_react_jsx_runtime_browser_esm=__webpack_require__("./node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js"),emotion_styled_browser_esm=__webpack_require__("./node_modules/@emotion/styled/dist/emotion-styled.browser.esm.js"),colors=__webpack_require__("./node_modules/@goshippo/components/esm/styles/colors.js"),shippo_logo_charcoal=__webpack_require__("./app/assets/logo/shippo_logo_charcoal.svg"),register=__webpack_require__("./app/constants/register.ts"),responsive=__webpack_require__("./app/constants/responsive.ts"),LogoWrapper=(0,emotion_styled_browser_esm.A)("header")(templateObject_1||(templateObject_1=(0,tslib_es6.ue)(["\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  width: 100%;\n  flex-shrink: 0;\n  background-color: ",";\n  padding: 2.5rem 0;\n\n  @media (max-width: ","px) {\n    padding: 1.5rem 0;\n    a {\n      display: block;\n    }\n  }\n"],["\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  width: 100%;\n  flex-shrink: 0;\n  background-color: ",";\n  padding: 2.5rem 0;\n\n  @media (max-width: ","px) {\n    padding: 1.5rem 0;\n    a {\n      display: block;\n    }\n  }\n"])),colors.T.white,responsive.P.Tablet),ShippoLogo=(0,emotion_styled_browser_esm.A)("img")(templateObject_2||(templateObject_2=(0,tslib_es6.ue)(["\n  height: auto;\n  width: 7.75rem;\n  margin-left: 2.5rem;\n  @media (max-width: ","px) {\n    width: 6.25rem;\n    margin-left: 1.5rem;\n  }\n"],["\n  height: auto;\n  width: 7.75rem;\n  margin-left: 2.5rem;\n  @media (max-width: ","px) {\n    width: 6.25rem;\n    margin-left: 1.5rem;\n  }\n"])),responsive.P.Tablet),PartnerLogo=(0,emotion_styled_browser_esm.A)("img")(templateObject_3||(templateObject_3=(0,tslib_es6.ue)(["\n  height: auto;\n  width: 2.5rem;\n"],["\n  height: auto;\n  width: 2.5rem;\n"]))),LogoDivider=(0,emotion_styled_browser_esm.A)("hr")(templateObject_4||(templateObject_4=(0,tslib_es6.ue)(["\n  height: 3rem;\n  margin: 0 1rem;\n  border: 0.5px solid ",";\n  @media (max-width: ","px) {\n    height: 2rem;\n    margin: 0 1rem;\n  }\n"],["\n  height: 3rem;\n  margin: 0 1rem;\n  border: 0.5px solid ",";\n  @media (max-width: ","px) {\n    height: 2rem;\n    margin: 0 1rem;\n  }\n"])),colors.T.borders,responsive.P.Tablet);const EmbeddableAuth_PartnerHeader=function(_a){var partner=_a.partner,partnerSetting=partner?register.Mr[partner]:void 0;return(0,emotion_react_jsx_runtime_browser_esm.FD)(LogoWrapper,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(ShippoLogo,{"data-name":"logo",src:shippo_logo_charcoal,alt:"Shippo - Logo"}),partnerSetting&&(0,emotion_react_jsx_runtime_browser_esm.FD)(emotion_react_jsx_runtime_browser_esm.FK,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(LogoDivider,{}),(0,emotion_react_jsx_runtime_browser_esm.Y)(PartnerLogo,{src:partnerSetting.logo,alt:partnerSetting.alt})]})]})};var templateObject_1,templateObject_2,templateObject_3,templateObject_4},"./app/selectors/auth.selectors.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{E:()=>getAuthStore,Z:()=>getTemporaryToken});var reselect__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/reselect/es/index.js"),getAuthStore=function(state){return state.auth},getTemporaryToken=(0,reselect__WEBPACK_IMPORTED_MODULE_0__.createSelector)(getAuthStore,(function(authStore){return authStore.sessionToken}))},"./app/selectors/plans.selectors.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{P8:()=>getCurrentPlan,R3:()=>getUserHasFullAccess,YJ:()=>getIsInStarterPlan});var moment__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/moment/moment.js"),reselect__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/reselect/es/index.js"),_stores_selectors__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./app/selectors/stores.selectors.ts"),_constants_plans__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./app/constants/plans.ts"),getPlansStore=function(state){return state.plans},getCurrentPlan=(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getPlansStore,(function(plansStore){return plansStore.currentPlan})),getNextPlan=(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getPlansStore,(function(plansStore){return plansStore.nextPlan})),getSelectedPlan=(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getCurrentPlan,getNextPlan,(function(currentPlan,nextPlan){return nextPlan||currentPlan})),getFetchPricingPlansRequest=((0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getPlansStore,(function(plansStore){return plansStore.adjustedPlan})),(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getPlansStore,(function(plansStore){return plansStore.currentPlan?plansStore.currentPlan.plan.displayName:null})),(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getPlansStore,(function(plansStore){return!!plansStore.nextPlan})),(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getPlansStore,(function(plansStore){return plansStore.fetchPlanRequest})),(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getPlansStore,(function(plansStore){return plansStore.fetchPricingPlansRequest}))),planStartDate=((0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getFetchPricingPlansRequest,(function(fetchPricingPlansRequest){return"success"!==fetchPricingPlansRequest.kind?[]:fetchPricingPlansRequest.data.filter((function(plan){return"MONTHLY"===plan.billingFrequency})).sort((function(a,b){return a.numberOfLabelsIncluded-b.numberOfLabelsIncluded}))})),(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getFetchPricingPlansRequest,(function(fetchPricingPlansRequest){return"success"!==fetchPricingPlansRequest.kind?[]:fetchPricingPlansRequest.data.filter((function(plan){return"YEARLY"===plan.billingFrequency})).sort((function(a,b){return a.numberOfLabelsIncluded-b.numberOfLabelsIncluded}))})),function(currentPlan){return currentPlan?currentPlan.startDate:moment__WEBPACK_IMPORTED_MODULE_0__()}),planEndDate=((0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getCurrentPlan,(function(currentPlan){return planStartDate(currentPlan)})),(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getNextPlan,(function(nextPlan){return planStartDate(nextPlan)})),function(currentPlan){return currentPlan?currentPlan.endDate:moment__WEBPACK_IMPORTED_MODULE_0__()}),billingFrequency=((0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getCurrentPlan,(function(currentPlan){return planEndDate(currentPlan)})),(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getNextPlan,(function(nextPlan){return planEndDate(nextPlan)})),(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getPlansStore,(function(plansStore){var currentPlan=plansStore.currentPlan,nextPlan=plansStore.nextPlan;return(null==nextPlan?void 0:nextPlan.nextBillingDate)?nextPlan.nextBillingDate:(null==currentPlan?void 0:currentPlan.nextBillingDate)?currentPlan.nextBillingDate:null})),function(currentPlan){return currentPlan?currentPlan.plan.billingFrequency:""}),numberOfLabelsIncluded=((0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getNextPlan,(function(nextPlan){return billingFrequency(nextPlan)})),(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getCurrentPlan,(function(currentPlan){return billingFrequency(currentPlan)})),(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getCurrentPlan,(function(currentPlan){return currentPlan?function(currentPlan){return currentPlan.plan.originalSubscriptionPrice}(currentPlan):null})),function(currentPlan){return currentPlan?currentPlan.plan.numberOfLabelsIncluded:-1}),getUserHasFullAccess=((0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getNextPlan,(function(nextPlan){return numberOfLabelsIncluded(nextPlan)})),(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getCurrentPlan,(function(currentPlan){return numberOfLabelsIncluded(currentPlan)})),(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getCurrentPlan,(function(currentPlan){return function(currentPlan){return currentPlan.plan.numberOfSeats}(currentPlan)})),(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getPlansStore,(function(plansStore){return plansStore.setPlanRequest})),(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getCurrentPlan,(function(currentPlan){return function(currentPlan){return currentPlan&&(currentPlan.plan.isPro||currentPlan.plan.isFullAccess)||!1}(currentPlan)}))),isInPremierPlan=((0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getCurrentPlan,(function(currentPlan){return function(currentPlan){return!!(currentPlan&&currentPlan.plan&&currentPlan.plan.isPro)&&currentPlan.plan.displayName.toUpperCase().includes("GROWTH")}(currentPlan)})),function(currentPlan){if(currentPlan){var displayName=currentPlan.plan.displayName;return displayName.toUpperCase().includes("PREMIER")||displayName.toUpperCase().includes("PREMIUM")}return!1}),getIsInPremierPlan=(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getCurrentPlan,(function(currentPlan){return isInPremierPlan(currentPlan)})),isInProfessionalPlan=function(currentPlan){var _a;return!!currentPlan&&(!!(null===(_a=currentPlan.plan)||void 0===_a?void 0:_a.isPro)&&!isInPremierPlan(currentPlan))},isInStarterPlan=((0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getNextPlan,getIsInPremierPlan,(function(nextPlan){return isInProfessionalPlan(nextPlan)})),(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getSelectedPlan,(function(selectedPlan){return isInProfessionalPlan(selectedPlan)})),(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getCurrentPlan,getIsInPremierPlan,(function(currentPlan){return isInProfessionalPlan(currentPlan)})),function(currentPlan){if(currentPlan){var displayName=currentPlan.plan.displayName;return displayName.toUpperCase().includes("STARTER")||displayName.toUpperCase().includes(_constants_plans__WEBPACK_IMPORTED_MODULE_3__._h)||displayName.toUpperCase().includes("GRANDFATHER")}return!1}),getIsInStarterPlan=((0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getNextPlan,(function(nextPlan){return isInStarterPlan(nextPlan)})),(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getSelectedPlan,(function(selectedPlan){return isInStarterPlan(selectedPlan)})),(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getCurrentPlan,(function(currentPlan){return isInStarterPlan(currentPlan)}))),isInTrialPlan=((0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getCurrentPlan,(function(currentPlan){return function(currentPlan){return currentPlan&&isInTrialPlan(currentPlan)?moment__WEBPACK_IMPORTED_MODULE_0__(currentPlan.endDate).diff(moment__WEBPACK_IMPORTED_MODULE_0__(),"days"):0}(currentPlan)})),function(currentPlan){return!!currentPlan&&currentPlan.plan.isFreeTrial}),getIsInWixProPlan=((0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getCurrentPlan,(function(currentPlan){return isInTrialPlan(currentPlan)})),(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getCurrentPlan,_stores_selectors__WEBPACK_IMPORTED_MODULE_1__._J,(function(currentPlan,isWixConnected){return"Pro Free"===(null==currentPlan?void 0:currentPlan.plan.displayName)&&isWixConnected})));(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getIsInWixProPlan,getCurrentPlan,(function(isInWixProPlan,currentPlan){return isInWixProPlan&&void 0!==(null==currentPlan?void 0:currentPlan.startDate)&&moment__WEBPACK_IMPORTED_MODULE_0__().diff(currentPlan.startDate,"days")<3})),(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getPlansStore,(function(state){return state.hasClosedWixProPlanNotification})),(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getPlansStore,(function(plansStore){return plansStore.closeAccountModalIsOpen})),(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getPlansStore,(function(plansStore){return plansStore.closeAccountError})),(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getPlansStore,(function(plansStore){var request=plansStore.fetchPlanRequest;return"success"===(null==request?void 0:request.kind)})),(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getPlansStore,(function(plansStore){var _a,_b;return(null===(_b=null===(_a=null==plansStore?void 0:plansStore.currentPlan)||void 0===_a?void 0:_a.plan)||void 0===_b?void 0:_b.name)===_constants_plans__WEBPACK_IMPORTED_MODULE_3__._h})),(0,reselect__WEBPACK_IMPORTED_MODULE_2__.createSelector)(getPlansStore,(function(plansStore){var _a,_b;return(null===(_b=null===(_a=null==plansStore?void 0:plansStore.currentPlan)||void 0===_a?void 0:_a.plan)||void 0===_b?void 0:_b.name)===_constants_plans__WEBPACK_IMPORTED_MODULE_3__.c8}))},"./app/selectors/stores.selectors.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{RT:()=>hasStoreConnected,Z1:()=>isEBayConnected,_J:()=>isWixConnected,o$:()=>getConnectedStores});var reselect__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/reselect/es/index.js"),_types_Store__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./app/types/Store.ts"),getStoresStore=function(state){return state.stores},getStores=(0,reselect__WEBPACK_IMPORTED_MODULE_1__.createSelector)(getStoresStore,(function(storesStore){return Object.values(storesStore.data)})),getConnectedStores=((0,reselect__WEBPACK_IMPORTED_MODULE_1__.createSelector)(getStoresStore,(function(storesStore){return storesStore.isLoaded})),(0,reselect__WEBPACK_IMPORTED_MODULE_1__.createSelector)(getStores,(function(stores){return filterForConnectedStores(stores)}))),isWixConnected=(0,reselect__WEBPACK_IMPORTED_MODULE_1__.createSelector)(getConnectedStores,(function(stores){return isStoreConnected(stores,_types_Store__WEBPACK_IMPORTED_MODULE_0__.F8.Wix)})),isEBayConnected=((0,reselect__WEBPACK_IMPORTED_MODULE_1__.createSelector)(getConnectedStores,(function(stores){return isStoreConnected(stores,_types_Store__WEBPACK_IMPORTED_MODULE_0__.F8.Godaddy)})),(0,reselect__WEBPACK_IMPORTED_MODULE_1__.createSelector)(getConnectedStores,(function(stores){return isStoreConnected(stores,_types_Store__WEBPACK_IMPORTED_MODULE_0__.F8.eBay)}))),filterForConnectedStores=function(stores){return stores.filter((function(store){var _a;return(null===(_a=null==store?void 0:store.status)||void 0===_a?void 0:_a.name)===_types_Store__WEBPACK_IMPORTED_MODULE_0__.Hu.Connected}))},isStoreConnected=function(connectedStores,storeName){return!!connectedStores.find((function(store){var _a;return(null===(_a=null==store?void 0:store.storePlatform)||void 0===_a?void 0:_a.name)===storeName}))},hasStoreConnected=((0,reselect__WEBPACK_IMPORTED_MODULE_1__.createSelector)(getConnectedStores,(function(connectedStores){return connectedStores.length>0&&connectedStores[0].storePlatform&&connectedStores[0].storePlatform.name?connectedStores[0].storePlatform.name:""})),(0,reselect__WEBPACK_IMPORTED_MODULE_1__.createSelector)(getConnectedStores,(function(connectedStores){return connectedStores.length>0})));(0,reselect__WEBPACK_IMPORTED_MODULE_1__.createSelector)(getStoresStore,(function(storesStore){return storesStore.isDisconnectingStore})),(0,reselect__WEBPACK_IMPORTED_MODULE_1__.createSelector)(getConnectedStores,(function(connectedStores){return connectedStores.length}))},"./app/services/stores.service.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{CF:()=>fetchLegacyStores,UW:()=>editStore,hO:()=>fetchStores,yw:()=>disconnectStore});var tslib__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_services_api__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./app/services/api.ts"),_utils_humps__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./app/utils/humps.ts");function fetchStores(){return _services_api__WEBPACK_IMPORTED_MODULE_0__.Ay.get("ui/stores?connected=True&results=50")}function fetchLegacyStores(){return _services_api__WEBPACK_IMPORTED_MODULE_0__.Ay.get("ui/shops")}function disconnectStore(storeName,objectId){return _services_api__WEBPACK_IMPORTED_MODULE_0__.Ay.post("ui/stores/disconnect",{store_name:storeName,object_id:objectId})}function editStore(store){return _services_api__WEBPACK_IMPORTED_MODULE_0__.Ay.put("ui/stores/".concat(store.objectId),(0,tslib__WEBPACK_IMPORTED_MODULE_1__.Cl)({},(0,_utils_humps__WEBPACK_IMPORTED_MODULE_2__.I)(store)))}},"./app/utils/batchEntryRendering.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{GE:()=>getOldExperienceTransaction,MY:()=>noRatesErrorState,WO:()=>isRowEntryFulfilled,lo:()=>getShouldRenderOldExperienceData,nr:()=>lineItemsFromBatchEntry,s0:()=>isPartialParentRow});var tslib__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_types_Order__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./app/types/Order.ts"),_types_OrdersBatch__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./app/types/OrdersBatch.ts"),_sentry_browser__WEBPACK_IMPORTED_MODULE_3__=(__webpack_require__("./app/types/Transaction.ts"),__webpack_require__("./node_modules/@sentry/browser/node_modules/@sentry/core/esm/exports.js"));function getOldExperienceTransaction(transactions,batchEntry){return(null==batchEntry?void 0:batchEntry.transactionObjectId)?transactions.find((function(t){return t.objectId===batchEntry.transactionObjectId})):transactions[transactions.length-1]}function getShouldRenderOldExperienceData(order,batchEntry){var isFulfilledWithCompleteOrErrorBatchEntry=function getIsFulfilledWithCompleteOrErrorBatchEntry(order,batchEntry){return!(!(0,_types_Order__WEBPACK_IMPORTED_MODULE_0__.sf)(order)||!batchEntry||[_types_OrdersBatch__WEBPACK_IMPORTED_MODULE_1__.DO.COMPLETE_SHIPMENT,_types_OrdersBatch__WEBPACK_IMPORTED_MODULE_1__.DO.PENDING,_types_OrdersBatch__WEBPACK_IMPORTED_MODULE_1__.DO.PROCESSING_SHIPMENT].includes(batchEntry.objectStatus)||0!==batchEntry.partialFulfillmentRank)}(order,batchEntry);return((0,_types_Order__WEBPACK_IMPORTED_MODULE_0__.Pt)(order)&&!batchEntry||isFulfilledWithCompleteOrErrorBatchEntry)&&!(0,_types_Order__WEBPACK_IMPORTED_MODULE_0__.Gy)(order)}function noRatesErrorState(batchEntry,shipment){return!!(batchEntry&&batchEntry.objectStatus===_types_OrdersBatch__WEBPACK_IMPORTED_MODULE_1__.DO.COMPLETE_SHIPMENT&&shipment&&0===shipment.rates.length&&shipment.messages.length>0)}function isPartialParentRow(ordersRenderData){return"partial-parent"===ordersRenderData.kind}function isRowEntryFulfilled(order,partialParentRow,batchEntry){var hasCompleteBatchEntry=batchEntry&&batchEntry.objectStatus===_types_OrdersBatch__WEBPACK_IMPORTED_MODULE_1__.DO.COMPLETE_TRANSACTION;return partialParentRow&&(0,_types_Order__WEBPACK_IMPORTED_MODULE_0__._g)(order)||(0,_types_Order__WEBPACK_IMPORTED_MODULE_0__.Pt)(order)||(0,_types_Order__WEBPACK_IMPORTED_MODULE_0__.sf)(order)&&hasCompleteBatchEntry}function lineItemsFromBatchEntry(order,batchEntry){if(!batchEntry||0===batchEntry.lineItems.length)return order.lineItems;var orderLineItemMap=order.lineItems.reduce((function(accum,li){return accum[li.objectId]=li,accum}),{});return batchEntry.lineItems.filter((function(lineItem){var isLineItemOnOrderMap=orderLineItemMap[lineItem.objectId];return isLineItemOnOrderMap||_sentry_browser__WEBPACK_IMPORTED_MODULE_3__.Cp(new Error("Missing line item ".concat(lineItem.objectId," on batch entry: ").concat(batchEntry.id))),isLineItemOnOrderMap})).reduce((function(list,lineItemLite){var lineItem=orderLineItemMap[lineItemLite.objectId],quantity=lineItemLite.quantity;return list.push((0,tslib__WEBPACK_IMPORTED_MODULE_4__.Cl)((0,tslib__WEBPACK_IMPORTED_MODULE_4__.Cl)({},lineItem),{quantity,totalAmount:(0,_types_Order__WEBPACK_IMPORTED_MODULE_0__.YN)(lineItem.unitAmount,quantity),totalWeight:(0,_types_Order__WEBPACK_IMPORTED_MODULE_0__.YN)(lineItem.unitWeight,quantity)})),list}),[])}},"./app/utils/humps.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{I:()=>decamelizeKeys,b:()=>camelizeKeys});var camelize=function(string){return obj=string,(obj-=0)==obj?string:(string=string.replace(/[-_\s]+(.)?/g,(function(_match,chr){return chr?chr.toUpperCase():""}))).substr(0,1).toLowerCase()+string.substr(1);var obj},decamelize=function(string,options){return function(string,options){var separator=(options=options||{}).separator||"_",split=options.split||/(?=[A-Z])/;return string.split(split).join(separator)}(string,options).toLowerCase()},_processKeys=function(convert,obj,options){if(!function(obj){return obj===Object(obj)}(obj)||function(obj){return"[object Date]"===toString.call(obj)}(obj)||function(obj){return"[object RegExp]"===toString.call(obj)}(obj)||function(obj){return"[object Boolean]"===toString.call(obj)}(obj)||function(obj){return"function"==typeof obj}(obj))return obj;var output,i=0,l=0;if(function(obj){return"[object Array]"===toString.call(obj)}(obj))for(output=[],l=obj.length;i<l;i++)output.push(_processKeys(convert,obj[i],options));else for(var key in output={},obj)Object.prototype.hasOwnProperty.call(obj,key)&&(output[convert(key,options)]=_processKeys(convert,obj[key],options));return output},_processor=function(convert,options){var callback=options&&"process"in options?options.process:options;return"function"!=typeof callback?convert:function(string,options){return callback(string,convert,options)}},camelizeKeys=function(object,options){return _processKeys(_processor(camelize,options),object,options)},decamelizeKeys=function(object,options){return _processKeys(_processor(decamelize,options),object,options)}},"./app/utils/orderValidation.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{c:()=>getPackageErrors,u:()=>getOrderErrors});var tslib__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");function getOrderErrors(order,batchEntry){var batchEntryErrors=(null==batchEntry?void 0:batchEntry.errors)?(0,tslib__WEBPACK_IMPORTED_MODULE_0__.fX)([],(0,tslib__WEBPACK_IMPORTED_MODULE_0__.zs)(batchEntry.errors),!1):[],orderErrors=0===(null==batchEntry?void 0:batchEntry.partialFulfillmentRank)||0===order.partialFulfillmentRequests.length?(0,tslib__WEBPACK_IMPORTED_MODULE_0__.fX)([],(0,tslib__WEBPACK_IMPORTED_MODULE_0__.zs)(order.errors||[]),!1):[];return batchEntryErrors.length?batchEntryErrors:orderErrors}function getPackageErrors(t,hasValidSenderAddress,hasPhoneNumberRequiredError,order,batchEntry,addressFrom){var _a,_b,_c,_d,errors=[];batchEntry&&!batchEntry.parcel||!batchEntry&&!order.parcel?errors.push(t("orders:table:errors:missingParcelInfo")):(batchEntry?Number(null===(_a=null==batchEntry?void 0:batchEntry.parcel)||void 0===_a?void 0:_a.weight)>0&&(null===(_b=null==batchEntry?void 0:batchEntry.parcel)||void 0===_b?void 0:_b.weightUnit):Number(null===(_c=null==order?void 0:order.parcel)||void 0===_c?void 0:_c.weight)>0&&(null===(_d=null==order?void 0:order.parcel)||void 0===_d?void 0:_d.weightUnit))||errors.push(t("orders:table:errors:missingParcelWeight"));return order.toAddress||(null==batchEntry?void 0:batchEntry.addressTo)||errors.push(t("orders:table:errors:missingRecipientAddress")),hasValidSenderAddress||addressFrom||errors.push(t("orders:table:errors:missingSenderAddress")),hasPhoneNumberRequiredError&&errors.push(t("orders:calculateRates:rates:errors:senderPhoneNumber")),errors}},"./app/utils/url.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{K:()=>getTopLevelDomain});var lodash_es_takeRight__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/lodash-es/takeRight.js"),getTopLevelDomain=function(url){try{var matches=url.match(/:\/\/(www[0-9]?\.)?(.[^/:]+)/i),domain=matches&&matches[2];if(!domain)return null;var splitDomain=domain&&domain.split(".");return(0,lodash_es_takeRight__WEBPACK_IMPORTED_MODULE_0__.A)(splitDomain,2).join(".")}catch(error){return null}}},"./app/pages/Orders/Blackbeard/Drawers/AddressDrawer/AddressMultiselectDrawer.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Regular:()=>Regular,default:()=>AddressMultiselectDrawer_stories});var settings_service_namespaceObject={};__webpack_require__.r(settings_service_namespaceObject),__webpack_require__.d(settings_service_namespaceObject,{closeAccount:()=>closeAccount,default:()=>settings_service,fetchLabelSettings:()=>settings_service_fetchLabelSettings,saveDefaultServiceLevel:()=>saveDefaultServiceLevel,saveLabelSettings:()=>saveLabelSettings});var packages_service_namespaceObject={};__webpack_require__.r(packages_service_namespaceObject),__webpack_require__.d(packages_service_namespaceObject,{create:()=>create,createOldExperience:()=>createOldExperience,del:()=>del,delOldExperience:()=>delOldExperience,get:()=>packages_service_get,put:()=>packages_service_put,update:()=>update,updateOldExperience:()=>updateOldExperience});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),emotion_react_jsx_runtime_browser_esm=__webpack_require__("./node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js"),es=__webpack_require__("./node_modules/react-redux/es/index.js"),redux=__webpack_require__("./node_modules/redux/es/redux.js"),utils_translate=__webpack_require__("./app/utils/translate.ts"),reducers=__webpack_require__("./app/reducers/index.ts"),lodash=__webpack_require__("./node_modules/lodash/lodash.js"),react=__webpack_require__("./node_modules/react/index.js"),MobileAndDesktopDrawer=__webpack_require__("./node_modules/@goshippo/libraries/dist/esm/shared/MobileAndDesktopDrawer/index.js"),DrawerProvider=__webpack_require__("./app/contexts/DrawerProvider.tsx"),countries=__webpack_require__("./node_modules/@goshippo/libraries/dist/esm/constants/countries.js"),states=__webpack_require__("./node_modules/@goshippo/libraries/dist/esm/constants/states.js"),orders_actions=__webpack_require__("./app/actions/orders.actions.ts"),address_actions=__webpack_require__("./app/actions/address.actions.ts"),addressBook=__webpack_require__("./app/constants/addressBook.ts"),reselect_es=__webpack_require__("./node_modules/reselect/es/index.js"),address_selectors=__webpack_require__("./app/selectors/address.selectors.ts"),batch_entry_composite_selectors=__webpack_require__("./app/selectors/batch-entry.composite.selectors.ts"),user_selectors=__webpack_require__("./app/selectors/user.selectors.ts"),utils_observability=__webpack_require__("./app/utils/observability/index.ts"),getNamedAddressBook=(0,reselect_es.createSelector)([function(state){return state.address.addressBookInstances},function(_,addressBookName){return addressBookName}],(function(instances,addressBookName){return instances[addressBookName]})),getAddressBookInitialized=(0,reselect_es.createSelector)(getNamedAddressBook,(function(instance){return!!(null==instance?void 0:instance.initialized)})),getCurrentAction=(0,reselect_es.createSelector)(getNamedAddressBook,(function(instance){return(null==instance?void 0:instance.currentAction)||null})),getCombineSenderReturnAddresses=(0,reselect_es.createSelector)(getNamedAddressBook,(function(instance){return!!(null==instance?void 0:instance.combineSenderReturnAddresses)}));function useAddressBook(addressBookName){var _a=function useAddressBookSelectors(addressBookName){var addresses=(0,es.d4)(address_selectors.tS),addressesList=(0,react.useMemo)((function(){return Object.values(addresses)}),[addresses]),selectedAddresses=(0,es.d4)((function(state){return(0,address_selectors.Ae)(state,{addressBookName})})),currentAction=(0,es.d4)((function(state){return getCurrentAction(state,addressBookName)})),initialized=(0,es.d4)((function(state){return getAddressBookInitialized(state,addressBookName)})),combineSenderReturnAddresses=(0,es.d4)((function(state){return getCombineSenderReturnAddresses(state,addressBookName)})),isSenderAddressValid=(0,es.d4)(user_selectors.Oz),isSelectedSenderInSavedAddresses=(0,es.d4)((function(state){return(0,address_selectors.A1)(state,{addressBookName,addressKey:addressBook.y9})})),isSelectedReturnInSavedAddresses=(0,es.d4)((function(state){return(0,address_selectors.A1)(state,{addressBookName,addressKey:addressBook.lj})})),areAllSenderReturnAddressesEqual=(0,es.d4)(batch_entry_composite_selectors.lu),addressErrorMessage=(0,es.d4)(address_selectors.sH);return{addresses,addressesList,addressErrorMessage,selectedAddresses,currentAction,initialized,combineSenderReturnAddresses,isSenderAddressValid,isSelectedSenderInSavedAddresses,isSelectedReturnInSavedAddresses,areAllSenderReturnAddressesEqual}}(addressBookName),addresses=_a.addresses,addressesList=_a.addressesList,selectedAddresses=_a.selectedAddresses,currentAction=_a.currentAction,initialized=_a.initialized,combineSenderReturnAddresses=_a.combineSenderReturnAddresses,isSenderAddressValid=_a.isSenderAddressValid,isSelectedSenderInSavedAddresses=_a.isSelectedSenderInSavedAddresses,isSelectedReturnInSavedAddresses=_a.isSelectedReturnInSavedAddresses,areAllSenderReturnAddressesEqual=_a.areAllSenderReturnAddressesEqual,addressBookCallbacks=function useAddressBookCallbacks(addressBookName,combineSenderReturnAddresses){var dispatch=(0,es.wA)(),initializeAddressBook=(0,react.useCallback)((function(addresses,combineSenderReturnAddresses){dispatch((0,address_actions.gX)(addressBookName,addresses,combineSenderReturnAddresses))}),[addressBookName,dispatch]),selectAddress=(0,react.useCallback)((function(key,address){dispatch((0,address_actions.YK)(addressBookName,key,address))}),[addressBookName,dispatch]),onSelectAddressForOrders=(0,react.useCallback)((function(addressType,orderSelection,newAddress,trackingReference){utils_observability.O.startEvent("RATE_REFRESH_LABEL_DRAWER_ADDRESS_CARD");var dupedNewAddress=(0,tslib_es6.Cl)({},newAddress);dupedNewAddress.id&&delete dupedNewAddress.id,dispatch((0,orders_actions.kR)({orderSelection,addressType,address:dupedNewAddress,combineSenderReturnAddresses:!1,createUserAddress:!1,source:"",trackingReference})),dispatch((0,address_actions.YK)(addressBookName,addressType,dupedNewAddress))}),[addressBookName,dispatch]),clearAddress=(0,react.useCallback)((function(key){dispatch((0,address_actions.Vl)(addressBookName,key))}),[addressBookName,dispatch]),fetchAddresses=(0,react.useCallback)((function(){dispatch((0,address_actions.ls)())}),[dispatch]),toggleCombineSenderReturnAddresses=(0,react.useCallback)((function(){return dispatch((0,address_actions.Fd)(addressBookName))}),[addressBookName,dispatch]),clearAddressBook=(0,react.useCallback)((function(){dispatch((0,address_actions.OK)(addressBookName))}),[addressBookName,dispatch]),onAddressBookConsumerMounted=(0,react.useCallback)((function(initialAddresses){void 0===initialAddresses&&(initialAddresses={}),(0,address_actions.gX)(addressBookName,initialAddresses)}),[addressBookName]),onSubmitEditedAddress=(0,react.useCallback)((function(orderSelection,newAddress,addressType,_a,trackingReference){var useAsReturn=_a.useAsReturn,shouldSaveAddress=_a.shouldSaveAddress;useAsReturn!==combineSenderReturnAddresses&&toggleCombineSenderReturnAddresses(),selectAddress(addressType,newAddress),orderSelection&&dispatch((0,orders_actions.kR)({orderSelection,addressType,address:newAddress,combineSenderReturnAddresses:useAsReturn,createUserAddress:shouldSaveAddress,source:addressBookName,trackingReference})),addressType===addressBook.y9&&useAsReturn&&(selectAddress(addressBook.lj,newAddress),orderSelection&&dispatch((0,orders_actions.kR)({orderSelection,addressType:addressBook.lj,address:newAddress,combineSenderReturnAddresses:useAsReturn,createUserAddress:!1,source:addressBookName,trackingReference})))}),[addressBookName,combineSenderReturnAddresses,dispatch,selectAddress,toggleCombineSenderReturnAddresses]),onSubmitEditAddressBookAddress=(0,react.useCallback)((function(payload){dispatch((0,address_actions.h_)(payload))}),[address_actions.h_,dispatch]);return{initializeAddressBook,selectAddress,onSelectAddressForOrders,clearAddress,fetchAddresses,toggleCombineSenderReturnAddresses,clearAddressBook,onAddressBookConsumerMounted,onSubmitEditedAddress,onSubmitEditAddressBookAddress}}(addressBookName,combineSenderReturnAddresses),fetchAddresses=addressBookCallbacks.fetchAddresses,clearAddressBook=addressBookCallbacks.clearAddressBook;return(0,react.useEffect)((function(){return fetchAddresses(),function(){clearAddressBook()}}),[clearAddressBook,fetchAddresses]),(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},addressBookCallbacks),{addresses,addressesList,areAllSenderReturnAddressesEqual,currentAction,initialized,isSenderAddressValid,isSelectedSenderInSavedAddresses,isSelectedReturnInSavedAddresses,selectedAddresses,combineSenderReturnAddresses})}var orders_selectors=__webpack_require__("./app/selectors/orders.selectors.ts"),Address=__webpack_require__("./app/types/Address.ts"),getAddressFromAddressBook=function(address,addresses){var matchingAddressBookEntry=address&&Object.values(addresses).find((function(a){return(0,Address.fq)(a,address)}));return(null==matchingAddressBookEntry?void 0:matchingAddressBookEntry.id)||address||null};var constants_countries=__webpack_require__("./app/constants/countries.ts"),flatten=__webpack_require__("./node_modules/lodash-es/flatten.js"),emotion_react_browser_esm=__webpack_require__("./node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),emotion_styled_browser_esm=__webpack_require__("./node_modules/@emotion/styled/dist/emotion-styled.browser.esm.js"),styles_colors=__webpack_require__("./node_modules/@goshippo/components/esm/styles/colors.js"),constants=__webpack_require__("./app/actions/constants.ts");function fetchServiceLevelsByAccount(){return{type:constants.t.FETCH_SERVICE_LEVELS_BY_ACCOUNT}}var icon_splitment_arrow=__webpack_require__("./app/assets/icons/icon_splitment_arrow.svg"),CountryFlag=__webpack_require__("./app/components/CountryFlag/index.ts"),AddressText=__webpack_require__("./app/components/AddressText/index.ts"),Link=__webpack_require__("./app/components/Link/index.ts"),exclamation_circle_yellow=__webpack_require__("./app/assets/icons/exclamation_circle_yellow.svg"),styles_constants=__webpack_require__("./app/styles/constants.ts"),RequiredText=(0,emotion_styled_browser_esm.A)("div")(templateObject_1||(templateObject_1=(0,tslib_es6.ue)(["\n  color: ",";\n  font-size: 0.875rem;\n"],["\n  color: ",";\n  font-size: 0.875rem;\n"])),styles_constants.Tj.macaroni900);var templateObject_1;const components_OrderInfoHeader=(0,utils_translate.Tl)("orders")((function(props){var title=props.title,required=props.required,t=props.t;return(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"flex justify-between items-center"},{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"flex items-center leading-6"},{children:[required?(0,emotion_react_jsx_runtime_browser_esm.Y)("img",{alt:"",src:exclamation_circle_yellow,className:"h-4 mr-2"}):null,(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"font-medium text-base"},{children:title}))]})),required?(0,emotion_react_jsx_runtime_browser_esm.Y)(RequiredText,{children:t("orders:errors:popup:required")}):null]}))}));var Description=(0,emotion_styled_browser_esm.A)("div")(OrderError_templateObject_1||(OrderError_templateObject_1=(0,tslib_es6.ue)(["\n  line-height: 1.25rem;\n  font-size: 0.75rem;\n  color: ",";\n  padding-top: 0.5rem;\n  text-align: center;\n"],["\n  line-height: 1.25rem;\n  font-size: 0.75rem;\n  color: ",";\n  padding-top: 0.5rem;\n  text-align: center;\n"])),styles_constants.Tj.gray400);var OrderError_templateObject_1;const components_OrderError=function(props){var title=props.title,description=props.description;return(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(components_OrderInfoHeader,{title,required:!0}),(0,emotion_react_jsx_runtime_browser_esm.Y)(Description,{children:description})]})};var plus=__webpack_require__("./app/assets/icons/plus/plus.svg");const components_PlusButton=function(props){var onClick=props.onClick,dataAnalytics=props.dataAnalytics,children=props.children;return(0,emotion_react_jsx_runtime_browser_esm.FD)("button",(0,tslib_es6.Cl)({onClick,className:"flex items-center border-none bg-transparent cursor-pointer p-0 focus:outline-none","data-analytics":dataAnalytics},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("img",{alt:"",className:"h-6",src:plus}),children]}))};var components_Popup=__webpack_require__("./app/components/Popup/index.ts"),context=__webpack_require__("./app/components/withAddressBook/context.ts"),AddressValue=(0,emotion_styled_browser_esm.A)("div")(CustomerInfo_templateObject_1||(CustomerInfo_templateObject_1=(0,tslib_es6.ue)(["\n  word-break: break-word;\n  color: ",";\n  font-size: 0.875rem;\n"],["\n  word-break: break-word;\n  color: ",";\n  font-size: 0.875rem;\n"])),styles_constants.Tj.gray1000),NormalAddressValue=(0,emotion_styled_browser_esm.A)(AddressValue)(templateObject_2||(templateObject_2=(0,tslib_es6.ue)(["\n  font-weight: ",";\n"],["\n  font-weight: ",";\n"])),styles_constants.Wy.normal),PrimaryCellContentText=(0,emotion_styled_browser_esm.A)("div")(templateObject_3||(templateObject_3=(0,tslib_es6.ue)(["\n  color: ",";\n  font-size: 0.875rem;\n  line-height: 1.25rem;\n  font-weight: ",";\n  word-break: break-word;\n  display: -webkit-box;\n  -webkit-line-clamp: 1;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n"],["\n  color: ",";\n  font-size: 0.875rem;\n  line-height: 1.25rem;\n  font-weight: ",";\n  word-break: break-word;\n  display: -webkit-box;\n  -webkit-line-clamp: 1;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n"])),styles_constants.Tj.gray1000,styles_constants.Wy.medium),SecondaryCellContentText=(0,emotion_styled_browser_esm.A)("div")(templateObject_4||(templateObject_4=(0,tslib_es6.ue)(["\n  color: ",";\n  font-size: 0.8125rem;\n  line-height: 1.25rem;\n  font-weight: ",";\n  word-break: break-word;\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n"],["\n  color: ",";\n  font-size: 0.8125rem;\n  line-height: 1.25rem;\n  font-weight: ",";\n  word-break: break-word;\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n"])),styles_constants.Tj.gray700,styles_constants.Wy.normal),PopupContainer=(0,emotion_styled_browser_esm.A)("div")(templateObject_5||(templateObject_5=(0,tslib_es6.ue)(["\n  width: 15rem;\n"],["\n  width: 15rem;\n"]))),RecipientAddressTriggerWrapper=(0,emotion_styled_browser_esm.A)("div")(templateObject_6||(templateObject_6=(0,tslib_es6.ue)(["\n  min-height: ",";\n"],["\n  min-height: ",";\n"])),styles_constants.df);const CustomerInfo=(0,utils_translate.Tl)("orders")((function(props){var triggerContent,popupContent,orderSelection=props.orderSelection,t=props.t,address=props.address,addressBookContext=react.useContext(context.o),handleOpenAddressModal=react.useCallback((function(mode){return function(e){e.stopPropagation(),address&&"edit"===mode?(addressBookContext.selectAddress(addressBook.i1,address),addressBookContext.openEditAddress(addressBook.i1,orderSelection)):"create"===mode&&addressBookContext.openCreateAddress(addressBook.i1,orderSelection)}}),[address,orderSelection]);if(address){var zip=address.country&&"US"===address.country.iso2?(0,Address.dY)(address.zip):address.zip,countryCode=address.country&&address.country.iso2;triggerContent=props.shortenedAddress?(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"flex h-full p-2 mx-0.5"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(CountryFlag.A,{country:countryCode||"US",className:"mr-3"}),(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"flex flex-col self-center"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(PrimaryCellContentText,(0,tslib_es6.Cl)({className:"".concat(styles_constants.xW.fulfilledOrderText," w-full")},{children:address.name})),(0,emotion_react_jsx_runtime_browser_esm.Y)(SecondaryCellContentText,(0,tslib_es6.Cl)({className:"mt-1"},{children:"".concat(address.city,", ").concat(address.state," ").concat(zip)}))]}))]})):(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(NormalAddressValue,(0,tslib_es6.Cl)({className:styles_constants.xW.fulfilledOrderText},{children:address.name})),(0,emotion_react_jsx_runtime_browser_esm.Y)("span",{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(AddressValue,(0,tslib_es6.Cl)({className:styles_constants.xW.fulfilledOrderText},{children:[address.city," ",address.state," ",address.zip," ",address.country?address.country.iso2:""]}))})]}),popupContent=(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(AddressText.A,{address,showContact:!0,showNameOrCompany:!0}),(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"flex flex-row-reverse leading-6 text-sm pt-2 font-medium"},{children:orderSelection&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Link.tp,(0,tslib_es6.Cl)({onClick:handleOpenAddressModal("edit")},{children:t("orders:address:editRecipient")}))}))]})}else{if(!orderSelection)return null;triggerContent=(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"-ml-1 p-4"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(components_PlusButton,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"leading-4 font-medium text-sm text-left"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Link.tp,{children:t("orders:address:addRecipient")})}))})})),popupContent=(0,emotion_react_jsx_runtime_browser_esm.Y)(components_OrderError,{title:t("orders:errors:popup:recipient:title"),description:t("orders:errors:popup:recipient:description")})}return(0,emotion_react_jsx_runtime_browser_esm.Y)(RecipientAddressTriggerWrapper,(0,tslib_es6.Cl)({"data-e2e":"recipient-address",className:"h-full w-full flex items-center",onClick:address?void 0:handleOpenAddressModal("create")},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Popup.A,(0,tslib_es6.Cl)({trigger:triggerContent,on:"hover",position:"bottom center",hoverable:!0,flowing:!0,wrapperClassName:"w-full h-full flex flex-col justify-center",wrapperStyle:{minHeight:styles_constants.df}},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(PopupContainer,{children:popupContent})}))}))}));var CustomerInfo_templateObject_1,templateObject_2,templateObject_3,templateObject_4,templateObject_5,templateObject_6,Labels_Link=(0,emotion_styled_browser_esm.A)("a")(Labels_templateObject_1||(Labels_templateObject_1=(0,tslib_es6.ue)(["\n  display: block;\n  color: ",";\n  text-decoration: underline;\n\n  & > i {\n    margin-right: 5px;\n  }\n"],["\n  display: block;\n  color: ",";\n  text-decoration: underline;\n\n  & > i {\n    margin-right: 5px;\n  }\n"])),styles_constants.Tj.gray600);(0,emotion_styled_browser_esm.A)(Labels_Link)(Labels_templateObject_2||(Labels_templateObject_2=(0,tslib_es6.ue)(["\n  margin-top: 8px;\n"],["\n  margin-top: 8px;\n"])));var Labels_templateObject_1,Labels_templateObject_2,LineItemText=(0,emotion_styled_browser_esm.A)("div")(LineItems_templateObject_1||(LineItems_templateObject_1=(0,tslib_es6.ue)(["\n  line-height: 18px;\n  word-break: break-word;\n"],["\n  line-height: 18px;\n  word-break: break-word;\n"])));const LineItems=(0,utils_translate.Tl)(["orders"])((function LineItemsCell(props){var lineItem,variantText,fullItemText,needsTruncate,itemText,renderTotal=function(total){if(!total)return null;var currency=props.t("translations:currency",{value:{value:total,currency_iso:props.currency}});return(0,emotion_react_jsx_runtime_browser_esm.FD)("div",{children:["(",currency," total)"]})},renderLineItem=function(lineItem,index){var variantText=lineItem.variantTitle?" - ".concat(lineItem.variantTitle):"",itemText="".concat(lineItem.title).concat(variantText);return(0,emotion_react_jsx_runtime_browser_esm.FD)(LineItemText,{children:[lineItem.quantity," x ",itemText,renderTotal(Number(lineItem.totalAmount))]},"".concat(lineItem.title,"-").concat(index))},lineItems=props.data;if(!(lineItems&&lineItems.length>0))return null;if(1===lineItems.length)return lineItem=lineItems[0],variantText=lineItem.variantTitle?" - ".concat(lineItem.variantTitle):"",fullItemText="".concat(lineItem.title).concat(variantText),needsTruncate=fullItemText.length>=25,itemText=needsTruncate?"".concat(fullItemText.substring(0,25),"..."):fullItemText,needsTruncate?(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Popup.A,(0,tslib_es6.Cl)({inverted:!0,size:"mini",position:"top center",trigger:(0,emotion_react_jsx_runtime_browser_esm.FD)("span",{children:[lineItem.quantity," x ",itemText]})},{children:renderLineItem(lineItem,0)})),renderTotal(props.total)]}):(0,emotion_react_jsx_runtime_browser_esm.FD)(LineItemText,{children:[lineItem.quantity," x ",itemText,renderTotal(props.total)]});var multipleLineItemsText=props.t("table.multipleLineItems");return(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Popup.A,(0,tslib_es6.Cl)({inverted:!0,size:"mini",position:"top center",trigger:(0,emotion_react_jsx_runtime_browser_esm.Y)("span",{children:multipleLineItemsText})},{children:lineItems.map(renderLineItem)})),renderTotal(props.total)]})}));var LineItems_templateObject_1,is_prop_valid_browser_esm=__webpack_require__("./node_modules/@emotion/is-prop-valid/dist/is-prop-valid.browser.esm.js"),icon_notes=__webpack_require__("./app/assets/icon-notes.svg"),TruncatedTextWrapper=(0,emotion_styled_browser_esm.A)("p")(TruncatedText_templateObject_1||(TruncatedText_templateObject_1=(0,tslib_es6.ue)(["\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n  margin: 0;\n\n  ","\n"],["\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n  margin: 0;\n\n  ","\n"])),(function(props){return props.customStyles||""}));var TruncatedText_templateObject_1;const components_TruncatedText=function(props){return(0,emotion_react_jsx_runtime_browser_esm.Y)(TruncatedTextWrapper,(0,tslib_es6.Cl)({customStyles:props.customStyles},{children:props.children}))};var constants_currency=__webpack_require__("./app/constants/currency.ts"),index_browser=__webpack_require__("./node_modules/nanoid/index.browser.js"),LineItem=__webpack_require__("./app/types/LineItem.ts"),OrderBatchEntry=__webpack_require__("./app/types/OrderBatchEntry.ts"),list=__webpack_require__("./app/utils/list.ts"),LineItemTextContainer=(0,emotion_styled_browser_esm.A)("div")(LineItemsNew_templateObject_1||(LineItemsNew_templateObject_1=(0,tslib_es6.ue)(["\n  font-size: 13px;\n  font-weight: ",";\n  line-height: 18px;\n  word-break: break-word;\n  width: 100%;\n  flex-direction: column;\n  display: flex;\n  justify-content: center;\n  color: ",";\n"],["\n  font-size: 13px;\n  font-weight: ",";\n  line-height: 18px;\n  word-break: break-word;\n  width: 100%;\n  flex-direction: column;\n  display: flex;\n  justify-content: center;\n  color: ",";\n"])),styles_constants.Wy.normal,styles_constants.Tj.gray700),TotalText=(0,emotion_styled_browser_esm.A)("div",{shouldForwardProp:is_prop_valid_browser_esm.A})(LineItemsNew_templateObject_2||(LineItemsNew_templateObject_2=(0,tslib_es6.ue)(["\n  color: ",";\n  font-size: ",";\n  font-weight: ",";\n  line-height: 1.25rem;\n  word-break: break-word;\n"],["\n  color: ",";\n  font-size: ",";\n  font-weight: ",";\n  line-height: 1.25rem;\n  word-break: break-word;\n"])),styles_constants.Tj.gray1000,(function(props){return props.inTooltip?"1rem":".875rem"}),styles_constants.Wy.medium),NoLineItemText=(0,emotion_styled_browser_esm.A)("div")(LineItemsNew_templateObject_3||(LineItemsNew_templateObject_3=(0,tslib_es6.ue)(["\n  color: ",";\n  font-weight: ",";\n  line-height: 18px;\n  word-break: break-word;\n  min-height: ",";\n"],["\n  color: ",";\n  font-weight: ",";\n  line-height: 18px;\n  word-break: break-word;\n  min-height: ",";\n"])),styles_constants.Tj.form.disabledLabelFontColor,styles_constants.Wy.normal,styles_constants.df),ItemQuantity=(0,emotion_styled_browser_esm.A)("div")(LineItemsNew_templateObject_4||(LineItemsNew_templateObject_4=(0,tslib_es6.ue)(["\n  line-height: 20px;\n  font-weight: ",";\n  font-size: 13px;\n  width: 19px;\n  height: 12px;\n  text-align: center;\n  padding: 4px;\n  margin-right: 8px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  background: ",";\n  color: ",";\n  border-radius: 6px;\n"],["\n  line-height: 20px;\n  font-weight: ",";\n  font-size: 13px;\n  width: 19px;\n  height: 12px;\n  text-align: center;\n  padding: 4px;\n  margin-right: 8px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  background: ",";\n  color: ",";\n  border-radius: 6px;\n"])),styles_constants.Wy.medium,styles_constants.Tj.gray50,styles_constants.Tj.gray700),ItemText=(0,emotion_styled_browser_esm.A)("p")(LineItemsNew_templateObject_5||(LineItemsNew_templateObject_5=(0,tslib_es6.ue)(["\n  font-weight: ",";\n  font-size: 14px;\n  color: ",";\n  margin: 0;\n"],["\n  font-weight: ",";\n  font-size: 14px;\n  color: ",";\n  margin: 0;\n"])),styles_constants.Wy.medium,styles_constants.Tj.gray1000),ItemSku=(0,emotion_styled_browser_esm.A)("div")(LineItemsNew_templateObject_6||(LineItemsNew_templateObject_6=(0,tslib_es6.ue)(["\n  line-height: 20px;\n  font-size: 13px;\n  font-weight: ",";\n  color: ",";\n"],["\n  line-height: 20px;\n  font-size: 13px;\n  font-weight: ",";\n  color: ",";\n"])),styles_constants.Wy.normal,styles_constants.Tj.gray700),LineItemContainer=(0,emotion_styled_browser_esm.A)("div")(templateObject_7||(templateObject_7=(0,tslib_es6.ue)(["\n  margin: 12px 0;\n  display: flex;\n"],["\n  margin: 12px 0;\n  display: flex;\n"]))),ToolTipContainer=(0,emotion_styled_browser_esm.A)("div")(templateObject_8||(templateObject_8=(0,tslib_es6.ue)(["\n  padding: 12px 16px;\n  width: 272px;\n  max-height: 480px;\n  overflow-y: auto;\n"],["\n  padding: 12px 16px;\n  width: 272px;\n  max-height: 480px;\n  overflow-y: auto;\n"]))),WeightValueContainer=(0,emotion_styled_browser_esm.A)("div")(templateObject_9||(templateObject_9=(0,tslib_es6.ue)(["\n  margin-top: 0.25rem;\n  display: flex;\n  flex-direction: row;\n  font-size: 0.8125rem;\n  color: ",";\n"],["\n  margin-top: 0.25rem;\n  display: flex;\n  flex-direction: row;\n  font-size: 0.8125rem;\n  color: ",";\n"])),styles_constants.Tj.gray700),WeightValue=(0,emotion_styled_browser_esm.A)("span")(templateObject_10||(templateObject_10=(0,tslib_es6.ue)(["\n  margin-right: 8px;\n"],["\n  margin-right: 8px;\n"]))),NotesContainer=(0,emotion_styled_browser_esm.A)("div")(templateObject_11||(templateObject_11=(0,tslib_es6.ue)(["\n  background: ",";\n  border: 1px solid ",";\n  box-sizing: border-box;\n  border-radius: 4px;\n  padding: 12px;\n  margin-top: 1rem;\n"],["\n  background: ",";\n  border: 1px solid ",";\n  box-sizing: border-box;\n  border-radius: 4px;\n  padding: 12px;\n  margin-top: 1rem;\n"])),styles_constants.Tj.gray25,styles_constants.Tj.containerBorderColor),FlexTitleContainer=(0,emotion_styled_browser_esm.A)("div")(templateObject_12||(templateObject_12=(0,tslib_es6.ue)(["\n  display: flex;\n  flex-direction: row;\n"],["\n  display: flex;\n  flex-direction: row;\n"]))),NoteIcon=(0,emotion_styled_browser_esm.A)("img")(templateObject_13||(templateObject_13=(0,tslib_es6.ue)(["\n  margin-left: 4px;\n  vertical-align: middle;\n  padding-bottom: 2px;\n"],["\n  margin-left: 4px;\n  vertical-align: middle;\n  padding-bottom: 2px;\n"]))),NotesTitle=(0,emotion_styled_browser_esm.A)("div")(templateObject_14||(templateObject_14=(0,tslib_es6.ue)(["\n  margin-left: 8px;\n  font-size: 12px;\n  text-transform: uppercase;\n  color: ",";\n  font-weight: ",";\n"],["\n  margin-left: 8px;\n  font-size: 12px;\n  text-transform: uppercase;\n  color: ",";\n  font-weight: ",";\n"])),styles_constants.Tj.gray700,styles_constants.Wy.normal),NotesText=(0,emotion_styled_browser_esm.A)("div")(templateObject_15||(templateObject_15=(0,tslib_es6.ue)(["\n  margin-top: 10px;\n  font-size: 13px;\n  line-height: 20px;\n  color: ",";\n  font-weight: ",";\n  word-break: break-word;\n"],["\n  margin-top: 10px;\n  font-size: 13px;\n  line-height: 20px;\n  color: ",";\n  font-weight: ",";\n  word-break: break-word;\n"])),styles_constants.Tj.gray1000,styles_constants.Wy.normal),LineItemsCellContent=(0,emotion_styled_browser_esm.A)("div")(templateObject_16||(templateObject_16=(0,tslib_es6.ue)(["\n  min-height: ",";\n"],["\n  min-height: ",";\n"])),styles_constants.df),LineItemsPopupTrigger=(0,emotion_styled_browser_esm.A)("div")(templateObject_17||(templateObject_17=(0,tslib_es6.ue)(["\n  min-height: ",";\n"],["\n  min-height: ",";\n"])),styles_constants.df),getLineItemQuantity=function(partialFulfillmentRequestLineItemObjectIdToQuantityMap,lineItem,hasBatchEntryLineItems){var quantity=lineItem.quantity;if(hasBatchEntryLineItems){var foundQuantity=partialFulfillmentRequestLineItemObjectIdToQuantityMap[lineItem.objectId];!foundQuantity&&isNaN(foundQuantity)||(quantity=foundQuantity)}return quantity};const LineItemsNew=(0,redux.Zz)((0,utils_translate.Tl)("orders"),react.memo)((function(props){var _a,batchEntry=props.batchEntry,order=props.order,t=props.t,orderLineItemsMap=(0,list.fL)(order.lineItems),batchEntryLineItems=(0,react.useMemo)((function(){return(null==batchEntry?void 0:batchEntry.lineItems)||[]}),[batchEntry]),lineItems=(0,react.useMemo)((function(){return batchEntryLineItems.length>0?batchEntryLineItems.map((function(beli){return orderLineItemsMap[beli.objectId]})).filter((function(x){return x})):order.lineItems}),[batchEntryLineItems,order.lineItems,orderLineItemsMap]),hasLineItems=lineItems.length>0,partialFulfillmentRequestLineItemObjectIdToQuantityMap=(0,react.useMemo)((function(){return batchEntryLineItems.reduce((function(acc,curr){var _a;return(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},acc),((_a={})[curr.objectId]=curr.quantity,_a))}),{})}),[batchEntryLineItems]),getItemText=(0,react.useCallback)((function(lineItems,totalQuantity,inTooltip){if(!inTooltip&&lineItems&&lineItems.length<3){var customStyles_1=1===lineItems.length?{display:"-webkit-box;",WebkitBoxOrient:"vertical",WebkitLineClamp:"2",whiteSpace:"normal"}:{};return lineItems.map((function(lineItem){var variantText=lineItem.variantTitle?" - ".concat(lineItem.variantTitle):"",quantity=getLineItemQuantity(partialFulfillmentRequestLineItemObjectIdToQuantityMap,lineItem,!!batchEntryLineItems.length);return(0,emotion_react_jsx_runtime_browser_esm.FD)(components_TruncatedText,(0,tslib_es6.Cl)({customStyles:customStyles_1},{children:[quantity,"x ",lineItem.title," ",variantText]}),(0,index_browser.Ak)())}))}return"".concat(t("orders:table:totalItems",{count:totalQuantity}))}),[batchEntryLineItems.length,partialFulfillmentRequestLineItemObjectIdToQuantityMap,t]),renderTotalLine=react.useCallback((function(lineItems,inTooltip){if(void 0===inTooltip&&(inTooltip=!1),!lineItems)return null;var itemsTotalAmount=(0,LineItem._)(lineItems),totalQuantity=(0,LineItem.WG)(lineItems),partialFulfillmentRequestTotalValue=(0,OrderBatchEntry.S0)(batchEntryLineItems,lineItems),orderTotalAmount=!!order.partialFulfillmentRequests.length&&partialFulfillmentRequestTotalValue||order.totalPrice,currency=order.currency||constants_currency.q.USD.iso,formattedTotal=t("translations:currency",{value:{value:orderTotalAmount||itemsTotalAmount,currency_iso:currency}}),totalValue=formattedTotal?"".concat(formattedTotal):"";batchEntryLineItems.length&&(totalQuantity=batchEntryLineItems.reduce((function(summedQuantity,li){return summedQuantity+li.quantity}),0));var itemText=getItemText(lineItems,totalQuantity,inTooltip),lineItemWeight=order.partialFulfillmentRequests.length?(0,OrderBatchEntry.f2)(batchEntryLineItems,order.lineItems):order.weight;return(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"leading-5 w-full"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(TotalText,(0,tslib_es6.Cl)({className:"".concat(styles_constants.xW.fulfilledOrderText),inTooltip},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"block"},{children:itemText}))})),(0,emotion_react_jsx_runtime_browser_esm.FD)(WeightValueContainer,{children:[lineItemWeight&&order.weightUnit&&(0,emotion_react_jsx_runtime_browser_esm.Y)(WeightValue,{children:"".concat(lineItemWeight," ").concat(order.weightUnit)}),(0,emotion_react_jsx_runtime_browser_esm.Y)("span",{children:totalValue}),order.notes&&!inTooltip&&(0,emotion_react_jsx_runtime_browser_esm.Y)("span",{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(NoteIcon,{className:"ml-2",src:icon_notes},"orderNotes")})]})]}))}),[batchEntryLineItems,order.partialFulfillmentRequests.length,order.totalPrice,order.currency,order.lineItems,order.weight,order.weightUnit,order.notes,t,getItemText]),renderTooltipLineItem=react.useCallback((function(lineItem){var variantText=lineItem.variantTitle?" - ".concat(lineItem.variantTitle):"",itemText="".concat(lineItem.title).concat(variantText),sku=lineItem.sku,quantity=getLineItemQuantity(partialFulfillmentRequestLineItemObjectIdToQuantityMap,lineItem,!!(null==batchEntryLineItems?void 0:batchEntryLineItems.length));return(0,emotion_react_jsx_runtime_browser_esm.FD)(LineItemContainer,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(ItemQuantity,{children:quantity>99?"99+":"".concat(quantity)}),(0,emotion_react_jsx_runtime_browser_esm.FD)(LineItemTextContainer,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(ItemText,{children:itemText}),sku&&(0,emotion_react_jsx_runtime_browser_esm.Y)(ItemSku,{children:sku})]})]},(0,index_browser.Ak)())}),[null==batchEntryLineItems?void 0:batchEntryLineItems.length,partialFulfillmentRequestLineItemObjectIdToQuantityMap]),renderOrderNotes=react.useCallback((function(order){if(order.notes)return(0,emotion_react_jsx_runtime_browser_esm.FD)(NotesContainer,{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(FlexTitleContainer,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(NoteIcon,{src:icon_notes},"orderNotes"),(0,emotion_react_jsx_runtime_browser_esm.Y)(NotesTitle,{children:"Notes"})]}),(0,emotion_react_jsx_runtime_browser_esm.Y)(NotesText,{children:order.notes})]})}),[order]),renderPackingSlipNoteBlock=react.useCallback((function(packingSlipText){if(packingSlipText)return(0,emotion_react_jsx_runtime_browser_esm.Y)(NotesContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(FlexTitleContainer,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(NoteIcon,{src:icon_notes},"orderNotes"),(0,emotion_react_jsx_runtime_browser_esm.Y)(NotesTitle,{children:t("orders:table:packingSlipNoteAdded")})]})})}),[order]);return hasLineItems?(0,emotion_react_jsx_runtime_browser_esm.Y)(LineItemsCellContent,(0,tslib_es6.Cl)({className:"h-full w-full"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Popup.A,(0,tslib_es6.Cl)({trigger:(0,emotion_react_jsx_runtime_browser_esm.Y)(LineItemsPopupTrigger,(0,tslib_es6.Cl)({className:"h-full p-2 mx-0.5 flex items-center box-border"},{children:renderTotalLine(lineItems)})),on:"hover",position:"bottom center",wrapperClassName:"w-full h-full",wrapperStyle:{minHeight:styles_constants.df},style:{padding:0},hoverable:!0,flowing:!0},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(ToolTipContainer,{children:[renderTotalLine(lineItems,!0),lineItems.map(renderTooltipLineItem),renderOrderNotes(order),renderPackingSlipNoteBlock(null===(_a=null==batchEntry?void 0:batchEntry.extras)||void 0===_a?void 0:_a.packingSlipText)]})}))})):(0,emotion_react_jsx_runtime_browser_esm.Y)(NoLineItemText,(0,tslib_es6.Cl)({className:"px-2 h-full flex items-center"},{children:t("orders:table:noItems")}))}));var LineItemsNew_templateObject_1,LineItemsNew_templateObject_2,LineItemsNew_templateObject_3,LineItemsNew_templateObject_4,LineItemsNew_templateObject_5,LineItemsNew_templateObject_6,templateObject_7,templateObject_8,templateObject_9,templateObject_10,templateObject_11,templateObject_12,templateObject_13,templateObject_14,templateObject_15,templateObject_16,templateObject_17;function showDialog(props,dialogType){return{payload:{props,dialogType},type:constants.t.DIALOG_SHOW}}var Button=__webpack_require__("./app/components/Button/Button.tsx"),Spinner=__webpack_require__("./app/components/Spinner/index.ts"),SpinnerContainer=(0,emotion_styled_browser_esm.A)("div")(withLoader_templateObject_1||(withLoader_templateObject_1=(0,tslib_es6.ue)(["\n  width: 100%;\n  text-align: center;\n"],["\n  width: 100%;\n  text-align: center;\n"])));var withLoader_templateObject_1;const components_withLoader=function withLoader(Component){return function(props){var isLoading=props.isLoading,componentProps=(0,tslib_es6.Tt)(props,["isLoading"]);return isLoading?(0,emotion_react_jsx_runtime_browser_esm.Y)(SpinnerContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Spinner.hQ,{})}):(0,emotion_react_jsx_runtime_browser_esm.Y)(Component,(0,tslib_es6.Cl)({},componentProps))}};var orders_batch_selectors=__webpack_require__("./app/selectors/orders-batch.selectors.ts"),ErrorButton=(0,emotion_styled_browser_esm.A)(Button.Ay)(ViewErrorsButton_templateObject_1||(ViewErrorsButton_templateObject_1=(0,tslib_es6.ue)(["\n  color: ",";\n  background: transparent;\n  border: 1px solid ",";\n"],["\n  color: ",";\n  background: transparent;\n  border: 1px solid ",";\n"])),styles_constants.Tj.secondary,styles_constants.Tj.secondary),ErrorText=(0,emotion_styled_browser_esm.A)("span")(ViewErrorsButton_templateObject_2||(ViewErrorsButton_templateObject_2=(0,tslib_es6.ue)(["\n  vertical-align: middle;\n  color: ",";\n  font-size: 13px;\n  font-weight: 300;\n"],["\n  vertical-align: middle;\n  color: ",";\n  font-size: 13px;\n  font-weight: 300;\n"])),styles_constants.Tj.gray400),ViewErrorsButton_ViewErrorsButton=function(_super){function ViewErrorsButton(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.openErrorDialog=function(e){e.stopPropagation();var messages=_this.props.messages.map((function(message){return message.text}));return _this.props.showErrorDialog({messages,closeButtonText:"Close"})},_this}return(0,tslib_es6.C6)(ViewErrorsButton,_super),ViewErrorsButton.prototype.render=function(){return(0,emotion_react_jsx_runtime_browser_esm.Y)(ErrorButton,(0,tslib_es6.Cl)({onClick:this.openErrorDialog},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(ErrorText,{children:"View Errors"})}))},ViewErrorsButton}(react.Component);(0,redux.Zz)((0,es.Ng)((function(state,ownProps){var errorProps={options:[],messages:[{text:"Error encountered while retrieving rates"}]},order=(0,orders_batch_selectors.r$)(state,ownProps);return order.errors&&order.errors.length>0&&(errorProps.messages=order.errors.map((function(error){return{text:error.message}}))),errorProps}),(function(dispatch){return{showErrorDialog:function(errorDialogProps){return dispatch(showDialog(errorDialogProps,"error"))}}})),components_withLoader)(ViewErrorsButton_ViewErrorsButton);var ViewErrorsButton_templateObject_1,ViewErrorsButton_templateObject_2;(0,emotion_styled_browser_esm.A)("div")(OrderErrors_templateObject_1||(OrderErrors_templateObject_1=(0,tslib_es6.ue)(["\n  display: flex;\n  justify-content: flex-end;\n"],["\n  display: flex;\n  justify-content: flex-end;\n"])));var OrderErrors_templateObject_1;var OrderStatus=__webpack_require__("./app/components/OrderStatus/index.ts"),RuleDescription=__webpack_require__("./app/components/Rules/RuleDescription.tsx"),icons=__webpack_require__("./app/constants/icons.ts"),Order=__webpack_require__("./app/types/Order.ts"),OrderNumberWithDate_OrderNumber=(0,emotion_styled_browser_esm.A)("span")(OrderNumberWithDate_templateObject_1||(OrderNumberWithDate_templateObject_1=(0,tslib_es6.ue)(["\n  font-size: 0.875rem;\n  color: ",";\n  font-weight: ",";\n  word-break: break-word;\n  display: -webkit-box;\n  -webkit-line-clamp: 1;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n"],["\n  font-size: 0.875rem;\n  color: ",";\n  font-weight: ",";\n  word-break: break-word;\n  display: -webkit-box;\n  -webkit-line-clamp: 1;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n"])),styles_constants.Tj.gray1000,styles_constants.Wy.medium),DateIcon=(0,emotion_styled_browser_esm.A)("img")(OrderNumberWithDate_templateObject_2||(OrderNumberWithDate_templateObject_2=(0,tslib_es6.ue)(["\n  width: 1.5rem;\n  height: 1.5rem;\n"],["\n  width: 1.5rem;\n  height: 1.5rem;\n"]))),LightningBoltIcon=(0,emotion_styled_browser_esm.A)("img")(OrderNumberWithDate_templateObject_3||(OrderNumberWithDate_templateObject_3=(0,tslib_es6.ue)(["\n  margin-right: 0.5rem;\n"],["\n  margin-right: 0.5rem;\n"]))),ActionText=(0,emotion_styled_browser_esm.A)("div")(OrderNumberWithDate_templateObject_4||(OrderNumberWithDate_templateObject_4=(0,tslib_es6.ue)(["\n  color: ",";\n"],["\n  color: ",";\n"])),styles_constants.Tj.gray700),OrderNumberPopupContent=(0,emotion_styled_browser_esm.A)("div")(OrderNumberWithDate_templateObject_5||(OrderNumberWithDate_templateObject_5=(0,tslib_es6.ue)(["\n  word-break: break-word;\n  max-width: 272px;\n  font-size: 1rem;\n  font-weight: ",";\n  line-height: 1.5rem;\n"],["\n  word-break: break-word;\n  max-width: 272px;\n  font-size: 1rem;\n  font-weight: ",";\n  line-height: 1.5rem;\n"])),styles_constants.Wy.medium),OrderDate=(0,emotion_styled_browser_esm.A)("span")(OrderNumberWithDate_templateObject_6||(OrderNumberWithDate_templateObject_6=(0,tslib_es6.ue)(["\n  font-size: 0.8125rem;\n"],["\n  font-size: 0.8125rem;\n"]))),DateWithIcon=(0,emotion_styled_browser_esm.A)("div")(OrderNumberWithDate_templateObject_7||(OrderNumberWithDate_templateObject_7=(0,tslib_es6.ue)(["\n  font-size: 0.8125rem;\n  line-height: 1.25rem;\n  font-weight: ",";\n  color: ",";\n"],["\n  font-size: 0.8125rem;\n  line-height: 1.25rem;\n  font-weight: ",";\n  color: ",";\n"])),styles_constants.Wy.normal,styles_constants.Tj.gray700),OrderNumberContainer=(0,emotion_styled_browser_esm.A)("div")(OrderNumberWithDate_templateObject_8||(OrderNumberWithDate_templateObject_8=(0,tslib_es6.ue)(["\n  line-height: 1.125rem;\n  &:hover {\n    .order-number-text {\n      text-decoration: underline;\n    }\n  }\n"],["\n  line-height: 1.125rem;\n  &:hover {\n    .order-number-text {\n      text-decoration: underline;\n    }\n  }\n"]))),getIsBatchEntryTransactionSuccess=(0,batch_entry_composite_selectors.sc)(),getIsOrderPartiallyFulfilled=(0,orders_selectors.YC)();const cells_OrderNumberWithDate=function(props){var _a,_b,data=props.data,isBatchEntryTransactionSuccess=(0,es.d4)((function(state){var _a;return getIsBatchEntryTransactionSuccess(state,{batchEntryId:"partial-parent"!==data.kind&&(null===(_a=data.batchEntry)||void 0===_a?void 0:_a.id)||-1})})),isOrderPartiallyFulfilled=(0,es.d4)((function(state){return getIsOrderPartiallyFulfilled(state,{orderObjectId:data.order.objectId})})),_c=data.order,orderNumber=_c.orderNumber,orderStatus=_c.orderStatus,placedAt=_c.placedAt,totalPartialFulfillments=_c.totalPartialFulfillments,batchEntryRules=null===(_b=null===(_a=data.batchEntry)||void 0===_a?void 0:_a.rules)||void 0===_b?void 0:_b.filter((function(rule){return null==rule?void 0:rule.name}));switch(data.kind){case"partial-parent":case"single":var orderNumberElement=orderNumber?(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderNumberWithDate_OrderNumber,(0,tslib_es6.Cl)({className:"".concat(styles_constants.xW.fulfilledOrderText," order-number-text my-1")},{children:orderNumber})):"-";return(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Popup.A,(0,tslib_es6.Cl)({trigger:(0,emotion_react_jsx_runtime_browser_esm.FD)(OrderNumberContainer,(0,tslib_es6.Cl)({className:"h-full"},{children:[orderNumberElement,(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"".concat(styles_constants.xW.fulfilledOrderText," flex items-center flex-wrap w-full")},{children:[batchEntryRules&&batchEntryRules.length>0&&(0,emotion_react_jsx_runtime_browser_esm.Y)("img",{src:icons.l2,className:"mr-1",alt:"Order has automation actions"}),(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderDate,(0,tslib_es6.Cl)({className:"mr-1"},{children:placedAt.format(placedAt.localeData().longDateFormat("L").replace(/YYYY/g,"YY"))})),(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderStatus.A,{status:isOrderPartiallyFulfilled?Order.Re.PARTIALLY_FULFILLED:orderStatus})]}))]})),on:"hover",position:"bottom center",hoverable:!0,wrapperClassName:"order-number-cell"},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(OrderNumberPopupContent,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderStatus.A,{status:isOrderPartiallyFulfilled?Order.Re.PARTIALLY_FULFILLED:orderStatus}),!!orderNumber&&(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"mt-1"},{children:"Order ".concat(orderNumber)})),batchEntryRules&&batchEntryRules.length>0&&(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"flex items-start"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(LightningBoltIcon,{src:icons.l2}),(0,emotion_react_jsx_runtime_browser_esm.Y)(ActionText,(0,tslib_es6.Cl)({className:"text-sm font-normal leading-5"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(RuleDescription.A,{showTitle:!0,rules:batchEntryRules})}))]})),(0,emotion_react_jsx_runtime_browser_esm.FD)(DateWithIcon,(0,tslib_es6.Cl)({className:"flex items-center mt-1"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(DateIcon,{src:icons.ki}),placedAt.format("L")]}))]})}));case"partial-child":var fulfillmentRequestStatus=isBatchEntryTransactionSuccess?Order.Re.SHIPPED:Order.Re.UNKNOWN;return(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"pl-2"},{children:["Shipment ".concat(data.batchEntry.partialFulfillmentRank," of ").concat(totalPartialFulfillments),(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderStatus.A,{status:fulfillmentRequestStatus})]}))}};var OrderNumberWithDate_templateObject_1,OrderNumberWithDate_templateObject_2,OrderNumberWithDate_templateObject_3,OrderNumberWithDate_templateObject_4,OrderNumberWithDate_templateObject_5,OrderNumberWithDate_templateObject_6,OrderNumberWithDate_templateObject_7,OrderNumberWithDate_templateObject_8,epages=__webpack_require__("./app/assets/shops/icons/epages.svg"),amazon=__webpack_require__("./app/assets/shops/icons/amazon.svg"),bigcommerce=__webpack_require__("./app/assets/shops/icons/bigcommerce.svg"),channeladvisor=__webpack_require__("./app/assets/shops/icons/channeladvisor.svg"),ebay=__webpack_require__("./app/assets/shops/icons/ebay.svg"),etsy=__webpack_require__("./app/assets/shops/icons/etsy.svg"),godaddy=__webpack_require__("./app/assets/shops/icons/godaddy.svg"),magento=__webpack_require__("./app/assets/shops/icons/magento.svg"),magento2=__webpack_require__("./app/assets/shops/icons/magento2.svg"),shippo=__webpack_require__("./app/assets/shops/icons/shippo.svg"),shopify=__webpack_require__("./app/assets/shops/icons/shopify.svg"),spree=__webpack_require__("./app/assets/shops/icons/spree.svg"),square=__webpack_require__("./app/assets/shops/icons/square.svg"),squarespace=__webpack_require__("./app/assets/shops/icons/squarespace.svg"),stripe=__webpack_require__("./app/assets/shops/icons/stripe.svg"),weebly=__webpack_require__("./app/assets/shops/icons/weebly.svg"),wix=__webpack_require__("./app/assets/shops/icons/wix.svg"),woocommerce=__webpack_require__("./app/assets/shops/icons/woocommerce.svg"),walmart=__webpack_require__("./app/assets/shops/icons/walmart.svg");function shopAppImage(shopAppName){if(shopAppName)switch(shopAppName.toUpperCase()){case"AMAZON":return amazon;case"ETSY":return etsy;case"SHOPIFY":return shopify;case"BIGCOMMERCE":return bigcommerce;case"MAGENTO":return magento2;case"MAGENTO_2":return magento;case"SPREECOMMERCE":return spree;case"SHIPPO":return shippo;case"STRIPERELAY":return stripe;case"EPAGES":return epages;case"GODADDY":return godaddy;case"WEEBLY":return weebly;case"WOOCOMMERCE":return woocommerce;case"EBAY":return ebay;case"CHANNELADVISOR":return channeladvisor;case"SQUARESPACE":return squarespace;case"WIX":return wix;case"SQUARE":return square;case"WALMART":return walmart}return""}var ShopImg=(0,emotion_styled_browser_esm.A)("img")(OrderShopImage_templateObject_1||(OrderShopImage_templateObject_1=(0,tslib_es6.ue)(["\n  height: 16px;\n"],["\n  height: 16px;\n"])));const cells_OrderShopImage=function(_a){var shopImage=shopAppImage(_a.shopApp);return(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"flex px-1"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(ShopImg,{src:shopImage})}))};var OrderShopImage_templateObject_1,Checkbox=__webpack_require__("./app/components/Checkbox/Checkbox.tsx"),getFeatureTestStore=function(state){return state.featureTests},getIsOldExpChosen=((0,reselect_es.createSelector)(getFeatureTestStore,(function(featureTestStore){return featureTestStore.isLoading})),(0,reselect_es.createSelector)(getFeatureTestStore,(function(featureTests){return!!featureTests.testVariantByFeature["Choose New Experience Test"]})),(0,reselect_es.createSelector)(getFeatureTestStore,(function(featureTests){var newExpChosenVariant=featureTests.testVariantByFeature["Choose New Experience Test"];return!!newExpChosenVariant&&"New Experience Chosen"===newExpChosenVariant.name})),(0,reselect_es.createSelector)(getFeatureTestStore,(function(featureTests){var newExpChosenVariant=featureTests.testVariantByFeature["Choose New Experience Test"];return!!newExpChosenVariant&&"Old Experience Chosen"===newExpChosenVariant.name}))),getAllFeatureTestVariantNames=((0,reselect_es.createSelector)(getFeatureTestStore,(function(featureTests){return isInTestVariant(featureTests)("One Dollar Billing Threshold","One Dollar Billing Threshold Enabled")})),(0,reselect_es.createSelector)(getFeatureTestStore,(function(featureTests){return featureTests.testVariants.reduce((function(variantNames,featTest){return(0,tslib_es6.fX)((0,tslib_es6.fX)([],(0,tslib_es6.zs)(variantNames),!1),[featTest.featureTestVariant.name],!1)}),[])}))),isInTestVariant=function(featureTests){return function(testName,variantName){var userVariant=featureTests.testVariantByFeature[testName];return!!userVariant&&userVariant.name===variantName}};const OrderCheckbox_container=(0,es.Ng)((function(state,ownProps){var orderObjectId=ownProps.orderObjectId,batchEntryId=ownProps.batchEntryId,isOldExpChosen=getIsOldExpChosen(state),isOrderSelected=(0,orders_selectors.q2)(state,{orderObjectId}),isBatchEntrySelected=batchEntryId&&(0,orders_selectors.qf)(state,{batchEntryId,orderObjectId}),order=(0,orders_selectors.yD)(state,ownProps),areAllPartialFulfillmentRequestsSelected=(0,batch_entry_composite_selectors.w3)(state,{orderObjectId}),areSomePartialFulfillmentRequestsSelected=(0,batch_entry_composite_selectors.tQ)(state,{orderObjectId}),isChecked=(0,Order.Cm)(order)?areAllPartialFulfillmentRequestsSelected:isOrderSelected;return{checked:!isOldExpChosen&&(0,Order.Cm)(order)&&areSomePartialFulfillmentRequestsSelected&&!areAllPartialFulfillmentRequestsSelected&&!batchEntryId?"partial":isBatchEntrySelected||(isOrderSelected&&isOldExpChosen?isOrderSelected:isChecked)}}))(Checkbox.Ay);var SingleFulfillmentWrapper=emotion_styled_browser_esm.A.div(OrderInfoCell_templateObject_1||(OrderInfoCell_templateObject_1=(0,tslib_es6.ue)(["\n  min-height: 72px;\n  margin: 0 0.25rem;\n"],["\n  min-height: 72px;\n  margin: 0 0.25rem;\n"]))),PartialFulfillmentShipmentWrapper=emotion_styled_browser_esm.A.div(OrderInfoCell_templateObject_2||(OrderInfoCell_templateObject_2=(0,tslib_es6.ue)(["\n  left: -1.5rem;\n  margin-right: -1.5rem;\n  padding-left: 1.75rem;\n"],["\n  left: -1.5rem;\n  margin-right: -1.5rem;\n  padding-left: 1.75rem;\n"]))),PartialFulfillmentCheckboxWrapper=emotion_styled_browser_esm.A.div(OrderInfoCell_templateObject_3||(OrderInfoCell_templateObject_3=(0,tslib_es6.ue)(["\n  top: 0;\n  left: 0;\n  /* Prevents hovering on sibling from covering contents */\n  z-index: ",";\n"],["\n  top: 0;\n  left: 0;\n  /* Prevents hovering on sibling from covering contents */\n  z-index: ",";\n"])),styles_constants.N2.base);const cells_OrderInfoCell=function(props){var data=props.data,rowIndex=props.rowIndex,onSplitOrderCheckboxClick=props.onSplitOrderCheckboxClick,onSplitOrderCheckboxChange=props.onSplitOrderCheckboxChange;switch(data.kind){case"partial-child":var checkboxID="orders-table-row-checkbox-split-".concat(rowIndex);return(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"flex items-center h-full w-full"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(PartialFulfillmentCheckboxWrapper,(0,tslib_es6.Cl)({className:"relative w-6 h-full flex items-center justify-center cursor-pointer ml-1",onClick:function(rowIndex){return function(e){e.stopPropagation(),onSplitOrderCheckboxChange(rowIndex)()}}(rowIndex)},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)("label",(0,tslib_es6.Cl)({htmlFor:checkboxID,onClick:onSplitOrderCheckboxClick},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderCheckbox_container,{id:checkboxID,orderObjectId:data.order.objectId,batchEntryId:data.batchEntry.id,dataPendo:"orders-select-row",onChange:onSplitOrderCheckboxChange(rowIndex)})}))})),(0,emotion_react_jsx_runtime_browser_esm.Y)(PartialFulfillmentShipmentWrapper,(0,tslib_es6.Cl)({className:"relative flex flex-1 items-center pr-3 h-full w-full"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(cells_OrderNumberWithDate,{data})}))]}));case"partial-parent":case"single":var shopApp=data.order.shopApp||null;return shopApp?(0,emotion_react_jsx_runtime_browser_esm.FD)(SingleFulfillmentWrapper,(0,tslib_es6.Cl)({className:"flex items-center h-full cursor-pointer mx-0.5"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"w-6 h-full flex items-center justify-center"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(cells_OrderShopImage,{shopApp})})),(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"flex items-center p-2 h-full w-full"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(cells_OrderNumberWithDate,{data})}))]})):null}};var OrderInfoCell_templateObject_1,OrderInfoCell_templateObject_2,OrderInfoCell_templateObject_3,IconContainer=(0,emotion_styled_browser_esm.A)("div")(OrderIcon_templateObject_1||(OrderIcon_templateObject_1=(0,tslib_es6.ue)(["\n  text-align: center;\n  width: 100%;\n"],["\n  text-align: center;\n  width: 100%;\n"]))),Icon=(0,emotion_styled_browser_esm.A)("i")(OrderIcon_templateObject_2||(OrderIcon_templateObject_2=(0,tslib_es6.ue)(["\n  color: ",";\n  ",";\n  ",";\n  ",";\n  ",";\n  cursor: ",";\n"],["\n  color: ",";\n  ",";\n  ",";\n  ",";\n  ",";\n  cursor: ",";\n"])),styles_constants.Tj.disabledIcon,(function(props){return props.ok?"color: ".concat(styles_constants.Tj.primary,";"):""}),(function(props){return props.error?"color: ".concat(styles_constants.Tj.dangerRed,";"):""}),(function(props){return props.info?"color: #555;":""}),(function(props){return props.warning?"color: ".concat(styles_constants.Tj.macaroni700,";"):""}),(function(props){return props.error?"pointer":"normal"}));const OrderIcon_OrderIcon=function(props){var orderIcon=(0,emotion_react_jsx_runtime_browser_esm.Y)(IconContainer,(0,tslib_es6.Cl)({onClick:props.onClick,"data-pendo":props.dataPendo},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Icon,{className:props.className,ok:props.ok,error:props.error,info:props.info})}));return props.tooltipText&&(orderIcon=(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Popup.A,(0,tslib_es6.Cl)({inverted:!0,size:"mini",position:"top center",trigger:orderIcon},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)("span",(0,tslib_es6.Cl)({className:"relative block"},{children:props.tooltipText}))}))),orderIcon};var OrderIcon_templateObject_1,OrderIcon_templateObject_2;const cells_OrderError=(0,utils_translate.Tl)()((function(props){if(props.order.errors&&0===props.order.errors.length)return null;var errors;return(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderIcon_OrderIcon,{className:"fa fa-exclamation-triangle",tooltipText:props.t("orders:table:invalidMessage"),onClick:(errors=props.order.errors,function(evt){evt.stopPropagation();var messages=errors.map((function(error){return error.message}));if(props.onErrorClick)return props.onErrorClick({messages})}),dataPendo:"orders-status-error",error:!0})}));var _a,fulfillmentStatusIcons=((_a={})[Order.Re.AWAITPAY]="truck",_a[Order.Re.PAID]="truck",_a[Order.Re.PARTIALLY_FULFILLED]="archive",_a[Order.Re.SHIPPED]="truck",_a[Order.Re.REFUNDED]="",_a[Order.Re.CANCELLED]="",_a[Order.Re.UNKNOWN]="",_a[Order.Re.GENERIC]="truck",_a[Order.Re.VALID]="",_a[Order.Re.INVALID]="",_a);const cells_OrderFulfillmentStatus=(0,utils_translate.Tl)("orders")((function(props){var fulfillmentStatusIcon=fulfillmentStatusIcons[props.order.orderStatus]||"";return fulfillmentStatusIcon?(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderIcon_OrderIcon,{className:"fa fa-".concat(fulfillmentStatusIcon),tooltipText:props.t("orders:status:fulfillment:".concat(props.order.orderStatus)),ok:(0,Order.sf)(props.order)||(0,Order.AJ)(props.order)}):null}));var OrderNotes_IconContainer=(0,emotion_styled_browser_esm.A)("div")(OrderNotes_templateObject_1||(OrderNotes_templateObject_1=(0,tslib_es6.ue)(["\n  text-align: center;\n  width: 100%;\n"],["\n  text-align: center;\n  width: 100%;\n"]))),OrderNotes_NoteIcon=(0,emotion_styled_browser_esm.A)("img")(OrderNotes_templateObject_2||(OrderNotes_templateObject_2=(0,tslib_es6.ue)(["\n  vertical-align: middle;\n  padding-bottom: 2px;\n"],["\n  vertical-align: middle;\n  padding-bottom: 2px;\n"])));const cells_OrderNotes=function(props){return props.notes?(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Popup.A,(0,tslib_es6.Cl)({inverted:!0,size:"mini",position:"top center",trigger:(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderNotes_IconContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderNotes_NoteIcon,{src:icon_notes},"orderNotes")})},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"block relative"},{children:props.notes}))})):null};var OrderNotes_templateObject_1,OrderNotes_templateObject_2,OrderNumberWithImage_ShopImg=(0,emotion_styled_browser_esm.A)("img")(OrderNumberWithImage_templateObject_1||(OrderNumberWithImage_templateObject_1=(0,tslib_es6.ue)(["\n  vertical-align: middle;\n  margin-right: 8px;\n"],["\n  vertical-align: middle;\n  margin-right: 8px;\n"]))),OrderNumberWithImage_OrderNumber=(0,emotion_styled_browser_esm.A)("span")(OrderNumberWithImage_templateObject_2||(OrderNumberWithImage_templateObject_2=(0,tslib_es6.ue)(["\n  vertical-align: middle;\n  word-break: break-word;\n"],["\n  vertical-align: middle;\n  word-break: break-word;\n"])));const OrderNumberWithImage=function OrderNumberWithImageCell(props){var order=props.order,orderNumber=order.orderNumber,shopImage=shopAppImage(order.shopApp);return(0,emotion_react_jsx_runtime_browser_esm.FD)("div",{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderNumberWithImage_ShopImg,{src:shopImage}),orderNumber&&(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Popup.A,(0,tslib_es6.Cl)({inverted:!0,size:"mini",position:"top center",trigger:(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderNumberWithImage_OrderNumber,{children:orderNumber})},{children:orderNumber}))]})};var OrderNumberWithImage_templateObject_1,OrderNumberWithImage_templateObject_2,components_Button=__webpack_require__("./app/components/Button/index.ts"),Modal=__webpack_require__("./app/components/Modal/index.ts"),options=__webpack_require__("./app/components/Select/options.ts"),Label=__webpack_require__("./app/components/Label/Label.tsx"),capitalize=__webpack_require__("./node_modules/lodash-es/capitalize.js"),OptionsContainer=(0,emotion_styled_browser_esm.A)("div")(Radio_templateObject_1||(Radio_templateObject_1=(0,tslib_es6.ue)(["\n  display: flex;\n\n  & > div {\n    margin-right: 13px;\n  }\n\n  & > div:last-child {\n    margin-right: 0;\n  }\n"],["\n  display: flex;\n\n  & > div {\n    margin-right: 13px;\n  }\n\n  & > div:last-child {\n    margin-right: 0;\n  }\n"]))),RadioInput=(0,emotion_styled_browser_esm.A)("input")(Radio_templateObject_2||(Radio_templateObject_2=(0,tslib_es6.ue)(["\n  margin: 0;\n  margin-right: 5px;\n  position: relative;\n  &:checked::after {\n    content: '';\n    display: block;\n    position: relative;\n    background: ",";\n    width: 7px;\n    height: 7px;\n    border: 0;\n    border-radius: 50%;\n    top: 3px;\n    left: 3px;\n  }\n  &:checked::before {\n    content: '';\n    display: block;\n    position: absolute;\n    background: white;\n    border: 1px solid ",";\n    width: 11px;\n    height: 11px;\n    border-radius: 50%;\n    top: 0px;\n    left: 0px;\n  }\n"],["\n  margin: 0;\n  margin-right: 5px;\n  position: relative;\n  &:checked::after {\n    content: '';\n    display: block;\n    position: relative;\n    background: ",";\n    width: 7px;\n    height: 7px;\n    border: 0;\n    border-radius: 50%;\n    top: 3px;\n    left: 3px;\n  }\n  &:checked::before {\n    content: '';\n    display: block;\n    position: absolute;\n    background: white;\n    border: 1px solid ",";\n    width: 11px;\n    height: 11px;\n    border-radius: 50%;\n    top: 0px;\n    left: 0px;\n  }\n"])),styles_constants.Tj.forest700,styles_constants.Tj.forest700),RadioLabel=(0,emotion_styled_browser_esm.A)("label")(Radio_templateObject_3||(Radio_templateObject_3=(0,tslib_es6.ue)(["\n  color: ",";\n  padding: ",";\n  cursor: pointer;\n"],["\n  color: ",";\n  padding: ",";\n  cursor: pointer;\n"])),(function(props){return props.disabled?styles_constants.Tj.form.disabledLabelFontColor:styles_constants.Tj.black}),(function(props){return props.vertical?"8px 0":"0"})),RadioContainer=(0,emotion_styled_browser_esm.A)("div")(Radio_templateObject_4||(Radio_templateObject_4=(0,tslib_es6.ue)(["\n  display: flex;\n  align-items: center;\n"],["\n  display: flex;\n  align-items: center;\n"])));const Radio_Radio=function(props){var name=props.name,label=props.label,onChange=props.onChange,options=props.options,value=props.value,dataAnalytics=props.dataAnalytics,toolTipContent=props.toolTipContent,disabled=props.disabled,onChangeCallback=react.useCallback((function(evt){var option=options.find((function(option){return option.value===evt.target.value}));if(option)return onChange(option,evt)}),[]);return(0,emotion_react_jsx_runtime_browser_esm.FD)("div",{children:[label&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Label.A,(0,tslib_es6.Cl)({},props.labelProps,{children:label})),(0,emotion_react_jsx_runtime_browser_esm.Y)(OptionsContainer,(0,tslib_es6.Cl)({className:props.className,style:props.vertical?{flexDirection:"column",alignItems:"flex-start"}:{flexDirection:"row",alignItems:"center"}},{children:null==options?void 0:options.map((function(option,idx){var _a,_b;return(0,emotion_react_jsx_runtime_browser_esm.FD)(RadioContainer,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(RadioInput,{type:"radio",name,id:option.label,value:String(option.value),checked:option.value===(null==value?void 0:value.value),disabled,onChange:onChangeCallback,"data-analytics":dataAnalytics&&"".concat(dataAnalytics).concat((0,capitalize.A)(null===(_a=option.value)||void 0===_a?void 0:_a.toString()),"Input")}),(0,emotion_react_jsx_runtime_browser_esm.Y)(RadioLabel,(0,tslib_es6.Cl)({disabled,htmlFor:option.label,"data-analytics":dataAnalytics&&"".concat(dataAnalytics).concat((0,capitalize.A)(null===(_b=option.value)||void 0===_b?void 0:_b.toString()),"Label"),vertical:props.vertical},{children:option.label})),option.addToolTip&&toolTipContent]},idx)}))}))]})};var Radio_templateObject_1,Radio_templateObject_2,Radio_templateObject_3,Radio_templateObject_4;const Radio_RadioField=react.memo((function(props){var input=props.input,meta=props.meta,hideErrors=props.hideErrors,selectProps=(0,tslib_es6.Tt)(props,["input","meta","hideErrors"]),errorMessage=!hideErrors&&meta&&meta.touched&&meta.error?meta.error:null;return(0,emotion_react_jsx_runtime_browser_esm.Y)(Radio_Radio,(0,tslib_es6.Cl)({value:input.value,onChange:input.onChange,name:input.name},selectProps,{errorMessage}))})),components_Radio=Radio_Radio;var SelectButton=__webpack_require__("./app/components/SelectButton/index.ts"),constants_form=__webpack_require__("./app/constants/form.ts"),SelectButtonStyled=(0,emotion_styled_browser_esm.A)("button")(SelectLink_templateObject_1||(SelectLink_templateObject_1=(0,tslib_es6.ue)(["\n  background: transparent;\n  border: none;\n  font-family: ",";\n  ",";\n  text-align: left;\n  font-size: 14px;\n  color: ",";\n  position: relative;\n  outline: none;\n  text-decoration: underline;\n  cursor: pointer;\n  line-height: 19px;\n  display: inline-block;\n\n  :focus,\n  &:active {\n    border-color: ",";\n  }\n\n  :disabled {\n    background-color: ",";\n    border-color: ",";\n  }\n"],["\n  background: transparent;\n  border: none;\n  font-family: ",";\n  ",";\n  text-align: left;\n  font-size: 14px;\n  color: ",";\n  position: relative;\n  outline: none;\n  text-decoration: underline;\n  cursor: pointer;\n  line-height: 19px;\n  display: inline-block;\n\n  :focus,\n  &:active {\n    border-color: ",";\n  }\n\n  :disabled {\n    background-color: ",";\n    border-color: ",";\n  }\n"])),styles_constants.mw,(function(props){return props.responsive?"width: 100%;":"width: ".concat(props.size,"px;")}),(function(props){return props.hasOptionSelected?styles_constants.Tj.gray600:styles_constants.Tj.placeholderColor}),styles_constants.Tj.primaryAlternative,styles_constants.Tj.form.greyDisabled,styles_constants.Tj.form.greyDisabledBorder),StyledIcon=(0,emotion_styled_browser_esm.A)("i")(SelectLink_templateObject_2||(SelectLink_templateObject_2=(0,tslib_es6.ue)(["\n  margin-left: 4px;\n  font-size: 12px;\n  color: ",";\n"],["\n  margin-left: 4px;\n  font-size: 12px;\n  color: ",";\n"])),styles_constants.Tj.placeholderColor);const SelectLink=function(props){var children=props.children,disabled=props.disabled,onClick=props.onClick,hasOptionSelected=props.hasOptionSelected,size=props.size,responsive=props.responsive,className=props.className,tabIndex=props.tabIndex,isMultiSelect=props.isMultiSelect,dataAnalytics=props.dataAnalytics,dataPendo=props.dataPendo,dataE2E=props.dataE2E,dataTestid=props.dataTestid,buttonRef=props.buttonRef,linkSize=size||constants_form.YI.medium;return(0,emotion_react_jsx_runtime_browser_esm.FD)(SelectButtonStyled,(0,tslib_es6.Cl)({disabled:!!disabled,onClick,hasOptionSelected:!!hasOptionSelected,size:linkSize,type:"button",responsive,className,tabIndex,isMultiSelect,"data-analytics":dataAnalytics,"data-pendo":dataPendo,"data-e2e":dataE2E,"data-testid":dataTestid,ref:buttonRef},{children:[children,(0,emotion_react_jsx_runtime_browser_esm.Y)(StyledIcon,{className:"fa fa-chevron-down"})]}))};var SelectLink_templateObject_1,SelectLink_templateObject_2;const components_SelectLink=SelectLink;var keys=__webpack_require__("./app/constants/keys.ts"),react_dom=__webpack_require__("./node_modules/react-dom/index.js"),Dropdown=__webpack_require__("./app/components/Dropdown/index.ts"),SelectList=(0,emotion_styled_browser_esm.A)("ul")(Select_templateObject_1||(Select_templateObject_1=(0,tslib_es6.ue)(["\n  padding: 0;\n  margin: 0;\n  max-height: 300px;\n  overflow-y: auto;\n"],["\n  padding: 0;\n  margin: 0;\n  max-height: 300px;\n  overflow-y: auto;\n"]))),disabledOptionStyle=(0,emotion_react_browser_esm.AH)(Select_templateObject_2||(Select_templateObject_2=(0,tslib_es6.ue)(["\n  cursor: default;\n  color: ",";\n  font-weight: ",";\n"],["\n  cursor: default;\n  color: ",";\n  font-weight: ",";\n"])),styles_constants.Tj.gray300,styles_constants.Wy.normal),Option=(0,emotion_styled_browser_esm.A)("li")(Select_templateObject_3||(Select_templateObject_3=(0,tslib_es6.ue)(["\n  padding: 8px 0 8px 30px;\n  font-size: 14px;\n  line-height: 14px;\n  color: ",";\n  ",";\n  ",";\n  position: relative;\n  cursor: pointer;\n  ",";\n\n  :first-of-type {\n    margin-top: 8px;\n  }\n\n  :last-of-type {\n    margin-bottom: 8px;\n  }\n"],["\n  padding: 8px 0 8px 30px;\n  font-size: 14px;\n  line-height: 14px;\n  color: ",";\n  ",";\n  ",";\n  position: relative;\n  cursor: pointer;\n  ",";\n\n  :first-of-type {\n    margin-top: 8px;\n  }\n\n  :last-of-type {\n    margin-bottom: 8px;\n  }\n"])),styles_constants.Tj.fontColor,(function(props){return props.isActive?"font-weight: ".concat(styles_constants.Wy.medium,";"):""}),(function(props){return props.isHighlighted?"background-color: ".concat(styles_constants.Tj.gray25,";"):""}),(function(_a){return _a.disabled?disabledOptionStyle:""})),Select_SpinnerContainer=(0,emotion_styled_browser_esm.A)("div")(Select_templateObject_4||(Select_templateObject_4=(0,tslib_es6.ue)(["\n  width: 100%;\n  text-align: center;\n  overflow: hidden;\n"],["\n  width: 100%;\n  text-align: center;\n  overflow: hidden;\n"]))),OptionSelectedIcon=(0,emotion_styled_browser_esm.A)("span")(Select_templateObject_5||(Select_templateObject_5=(0,tslib_es6.ue)(["\n  position: absolute;\n  left: 12px;\n  font-size: 10px;\n  line-height: 15px;\n"],["\n  position: absolute;\n  left: 12px;\n  font-size: 10px;\n  line-height: 15px;\n"]))),OptionDeleteIcon=(0,emotion_styled_browser_esm.A)("span")(Select_templateObject_6||(Select_templateObject_6=(0,tslib_es6.ue)(["\n  position: absolute;\n  right: 12px;\n  font-size: 10px;\n  line-height: 15px;\n"],["\n  position: absolute;\n  right: 12px;\n  font-size: 10px;\n  line-height: 15px;\n"]))),ErrorMessage=(0,emotion_styled_browser_esm.A)("div")(Select_templateObject_7||(Select_templateObject_7=(0,tslib_es6.ue)(["\n  font-size: 12px;\n  color: ",";\n  margin-top: 5px;\n"],["\n  font-size: 12px;\n  color: ",";\n  margin-top: 5px;\n"])),styles_constants.Tj.dangerRed),Container=(0,emotion_styled_browser_esm.A)("div")(Select_templateObject_8||(Select_templateObject_8=(0,tslib_es6.ue)(["\n  display: ",";\n"],["\n  display: ",";\n"])),(function(_a){return _a.responsive?"block":"inline-block"})),Select=function(_super){function Select(props){var _this=_super.call(this,props)||this;return _this.trigger=null,_this.selectOption=function(option){var onChange=_this.props.onChange,disabled=option.disabled;!disabled&&onChange&&onChange(option),disabled||_this.onClose()},_this.onClose=function(){_this.setState({isOpen:!1,highlightedOptionIndex:0})},_this.onClickOutside=function(evt){-1===evt.propagationPath().indexOf(react_dom.findDOMNode(_this.trigger))&&_this.setState({isOpen:!1})},_this.onClick=function(evt){evt.stopPropagation(),_this.setState({isOpen:!_this.state.isOpen})},_this.setHighlightedIndex=function(index,disabled){return function(){disabled||_this.setState({highlightedOptionIndex:index})}},_this.onKeyDown=function(evt){var options=_this.props.options,highlightedOptionIndex=_this.state.highlightedOptionIndex;switch(evt.key){case keys.D.ArrowDown:if(!_this.state.isOpen)return _this.onClick(evt);if(evt.preventDefault(),evt.stopPropagation(),options){var optionsLength_1=options.length;return _this.setState((function(state){return(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},state),{highlightedOptionIndex:state.highlightedOptionIndex+1>=optionsLength_1-1?optionsLength_1-1:state.highlightedOptionIndex+1})}))}break;case keys.D.ArrowUp:return evt.preventDefault(),evt.stopPropagation(),_this.setState((function(state){return(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},state),{highlightedOptionIndex:state.highlightedOptionIndex-1<0?0:state.highlightedOptionIndex-1})}));case keys.D.Enter:var disabled=(options&&options[highlightedOptionIndex]||{disabled:!1}).disabled;if(!_this.state.isOpen&&!disabled)return _this.onClick(evt);if(evt.preventDefault(),evt.stopPropagation(),options&&!disabled)return _this.selectOption(options[highlightedOptionIndex]);break;case keys.D.Escape:case keys.D.Tab:return _this.onClose()}},_this.setTriggerRef=function(node){return _this.trigger=node},_this.renderSelectList=function(){if(!_this.props.options)return null;var Spinner=_this.props.spinnerComponent||null,spinner=_this.props.displaySpinner?(0,emotion_react_jsx_runtime_browser_esm.Y)(Select_SpinnerContainer,{children:Spinner&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Spinner,{})}):null;return(0,emotion_react_jsx_runtime_browser_esm.FD)(SelectList,(0,tslib_es6.Cl)({width:_this.props.size},{children:[_this.props.options.map(_this.renderDropdownOption),spinner]}))},_this.createOnDeleteCallback=function(value,label){return function(evt){_this.props.onDelete&&_this.props.onDelete(value,label,evt)}},_this.renderDropdownOption=function(option,index){var deleteIcon,disabled=option.disabled,selectedOption=_this.props.value,_a=_this.props,dataPendo=_a.dataPendo,optionDataAnalytics=_a.optionDataAnalytics,optionDataPendo=_a.optionDataPendo,selectedIcon=null,optionIsActive=!1;return!disabled&&selectedOption&&option.value===selectedOption.value&&(selectedIcon=(0,emotion_react_jsx_runtime_browser_esm.Y)(OptionSelectedIcon,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)("i",{className:"fa fa-check"})}),optionIsActive=!0),deleteIcon=(0,emotion_react_jsx_runtime_browser_esm.Y)(OptionDeleteIcon,(0,tslib_es6.Cl)({onClick:_this.createOnDeleteCallback(option.value,option.label)},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)("i",{className:"fa fa-trash"})})),(0,emotion_react_jsx_runtime_browser_esm.FD)(Option,(0,tslib_es6.Cl)({isActive:optionIsActive,onClick:_this.selectOption.bind(_this,option),isHighlighted:_this.state.highlightedOptionIndex===index,onMouseEnter:_this.setHighlightedIndex(index,disabled),"data-analytics":optionDataAnalytics,"data-pendo":optionDataPendo||dataPendo,disabled},{children:[selectedIcon,option.label,option.isDeletable?deleteIcon:null]}),String(option.value))},_this.state={isOpen:!1,highlightedOptionIndex:0},_this}return(0,tslib_es6.C6)(Select,_super),Select.prototype.renderErrorMessage=function(){var errorMessage=this.props.errorMessage;return errorMessage?(0,emotion_react_jsx_runtime_browser_esm.Y)(ErrorMessage,{children:errorMessage}):null},Select.prototype.render=function(){var _this=this,_a=this.props,disabled=_a.disabled,placeholder=_a.placeholder,invalid=_a.invalid,customLabel=_a.customLabel,label=_a.label,size=_a.size,responsive=_a.responsive,renderSelectButtonContent=_a.renderSelectButtonContent,tabIndex=_a.tabIndex,useLinkButton=_a.useLinkButton,height=_a.height,postOptionsContent=_a.postOptionsContent,dataAnalytics=_a.dataAnalytics,dataE2E=_a.dataE2E,dataTestid=_a.dataTestid,className=_a.className,selectedOption=this.props.value,buttonText=selectedOption?selectedOption.label:placeholder;buttonText=renderSelectButtonContent?renderSelectButtonContent(selectedOption):buttonText;var ButtonComponent=useLinkButton?components_SelectLink:SelectButton.A,labelComponent=label?(0,emotion_react_jsx_runtime_browser_esm.Y)(Label.A,(0,tslib_es6.Cl)({},this.props.labelProps,{children:label})):null;return customLabel&&(labelComponent=customLabel),(0,emotion_react_jsx_runtime_browser_esm.FD)(Container,(0,tslib_es6.Cl)({className,"data-e2e":dataE2E,onKeyDown:this.onKeyDown,responsive},{children:[labelComponent,(0,emotion_react_jsx_runtime_browser_esm.FD)(Dropdown.A,(0,tslib_es6.Cl)({className,triggerComponent:function(){return(0,emotion_react_jsx_runtime_browser_esm.Y)(ButtonComponent,(0,tslib_es6.Cl)({disabled,onClick:_this.onClick,hasOptionSelected:!!selectedOption,size,responsive,tabIndex,invalid,height,dataAnalytics,dataPendo:_this.props.dataPendo,dataTestid,buttonRef:_this.setTriggerRef,className},{children:buttonText}))},isOpen:this.state.isOpen||this.props.isOpen,onClose:this.onClose,minWidth:size,onClickOutside:this.onClickOutside},{children:[this.renderSelectList(),postOptionsContent]})),this.renderErrorMessage()]}))},Select.defaultProps={value:null,size:constants_form.YI.medium,useLinkButton:!1},Select}(react.Component),SelectField=(function(_super){function SelectWithRadio(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.renderSelectList=function(){if(!_this.props.options)return null;var Spinner=_this.props.spinnerComponent||null,spinner=_this.props.displaySpinner?(0,emotion_react_jsx_runtime_browser_esm.Y)(Select_SpinnerContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Spinner,{})}):null;return(0,emotion_react_jsx_runtime_browser_esm.FD)(SelectList,(0,tslib_es6.Cl)({width:_this.props.size},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Radio,{className:_this.props.className,vertical:!0,htmlFor:"selectRadio",options:_this.props.options,value:_this.props.value,onChange:_this.selectOption,name:"selectRadio"}),spinner]}))},_this}(0,tslib_es6.C6)(SelectWithRadio,_super)}(Select),function(props){var input=props.input,meta=props.meta,hideErrors=props.hideErrors,selectProps=(0,tslib_es6.Tt)(props,["input","meta","hideErrors"]),errorMessage=!hideErrors&&meta&&meta.touched&&meta.error?meta.error:null;return(0,emotion_react_jsx_runtime_browser_esm.Y)(Select,(0,tslib_es6.Cl)({value:input.value,onChange:input.onChange},selectProps,{"data-e2e":selectProps.dataE2E,errorMessage}))});const Select_Select=Select;var Select_templateObject_1,Select_templateObject_2,Select_templateObject_3,Select_templateObject_4,Select_templateObject_5,Select_templateObject_6,Select_templateObject_7,Select_templateObject_8;const components_Select=Select_Select;var isSubmitting=__webpack_require__("./node_modules/redux-form/es/isSubmitting.js"),isInvalid=__webpack_require__("./node_modules/redux-form/es/isInvalid.js"),redux_form_es=__webpack_require__("./node_modules/redux-form/es/index.js"),batch_entry_selectors=__webpack_require__("./app/selectors/batch-entry.selectors.ts"),Parcel=__webpack_require__("./app/types/Parcel.ts"),schema=__webpack_require__("./app/utils/segment/schema.ts"),TrackingHelper=__webpack_require__("./app/utils/TrackingHelper/index.ts"),types=__webpack_require__("./app/utils/TrackingHelper/types.ts"),ComposedPackageWeightDimensionsWarning=(0,utils_translate.Tl)()((function(_a){var t=_a.t;return(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{children:t("orders:calculateRates:tabs:shipmentInfo:packageWeightDimensionsWarning")})}));const Tabs_PackageWeightDimensionsWarning=ComposedPackageWeightDimensionsWarning;function parcel_template_actions_fetchParcelTemplates(){return{type:constants.t.PARCEL_TEMPLATE_FETCH}}function fetchParcelTemplatesSuccess(payload){return{payload,type:constants.t.PARCEL_TEMPLATE_FETCH_SUCCESS}}function fetchCarrierParcelTemplatesSuccess(payload){return{payload,type:constants.t.CARRIER_PARCEL_TEMPLATE_FETCH_SUCCESS}}var FormError_FormError=__webpack_require__("./app/components/FormError/FormError.tsx"),emotion_element_c39617d8_browser_esm=__webpack_require__("./node_modules/@emotion/react/dist/emotion-element-c39617d8.browser.esm.js"),responsive=__webpack_require__("./app/constants/responsive.ts"),StyledInputContainer=(0,emotion_styled_browser_esm.A)("div")(InputExtended_templateObject_1||(InputExtended_templateObject_1=(0,tslib_es6.ue)(["\n  border-radius: 3px;\n  background-color: ",";\n  border: 1px solid ",";\n  color: ",";\n\n  ",";\n  ",";\n  /* Input is 35px.. subtracting by 2 because 2 extra pixels are added by the borders 1px */\n  height: ","px;\n  width: 100%;\n  @media screen and (min-width: ","px) {\n    /* width: ","; */\n    width: 74px;\n  }\n  display: flex;\n  align-items: center;\n"],["\n  border-radius: 3px;\n  background-color: ",";\n  border: 1px solid ",";\n  color: ",";\n\n  ",";\n  ",";\n  /* Input is 35px.. subtracting by 2 because 2 extra pixels are added by the borders 1px */\n  height: ","px;\n  width: 100%;\n  @media screen and (min-width: ","px) {\n    /* width: ","; */\n    width: 74px;\n  }\n  display: flex;\n  align-items: center;\n"])),(function(props){return props.theme.backgroundColor}),(function(props){return props.theme.borderColor}),(function(props){return props.theme.color}),(function(props){return props.hasPrefix?"":"padding-left: 10px"}),(function(props){return props.hasSuffix?"":"padding-right: 10px"}),constants_form.hx.medium-2,responsive.P.Mobile,styles_constants.vi.inputWidth),StyledInput=(0,emotion_styled_browser_esm.A)("input")(InputExtended_templateObject_2||(InputExtended_templateObject_2=(0,tslib_es6.ue)(["\n  font-size: 14px;\n  height: 18px;\n  line-height: 18px;\n  border: none;\n  width: 100%;\n  outline: none;\n  overflow: hidden;\n  ",";\n\n  ::placeholder {\n    /* Chrome, Firefox, Opera, Safari 10.1+ */\n    color: ",";\n    opacity: 1; /* Firefox */\n  }\n\n  ::-ms-input-placeholder {\n    /* Microsoft Edge */\n    color: ",";\n  }\n\n  :-ms-input-placeholder {\n    /* Internet Explorer 10-11 */\n    color: ",";\n  }\n\n  :focus,\n  :active {\n    border-color: inherit;\n  }\n\n  :disabled {\n    background-color: inherit;\n    color: inherit;\n  }\n"],["\n  font-size: 14px;\n  height: 18px;\n  line-height: 18px;\n  border: none;\n  width: 100%;\n  outline: none;\n  overflow: hidden;\n  ",";\n\n  ::placeholder {\n    /* Chrome, Firefox, Opera, Safari 10.1+ */\n    color: ",";\n    opacity: 1; /* Firefox */\n  }\n\n  ::-ms-input-placeholder {\n    /* Microsoft Edge */\n    color: ",";\n  }\n\n  :-ms-input-placeholder {\n    /* Internet Explorer 10-11 */\n    color: ",";\n  }\n\n  :focus,\n  :active {\n    border-color: inherit;\n  }\n\n  :disabled {\n    background-color: inherit;\n    color: inherit;\n  }\n"])),(function(props){return props.theme.isRightAligned?"text-align: right;":""}),styles_constants.Tj.form.placeholderFontColor,styles_constants.Tj.form.placeholderFontColor,styles_constants.Tj.form.placeholderFontColor),Prefix=(0,emotion_styled_browser_esm.A)("div")(InputExtended_templateObject_3||(InputExtended_templateObject_3=(0,tslib_es6.ue)(["\n  height: 20px;\n  width: 20px;\n  background-color: ",";\n  border-radius: 2px;\n  text-align: center;\n  font-size: 13px;\n  line-height: 20px;\n  margin: 0 5px 0 6px;\n"],["\n  height: 20px;\n  width: 20px;\n  background-color: ",";\n  border-radius: 2px;\n  text-align: center;\n  font-size: 13px;\n  line-height: 20px;\n  margin: 0 5px 0 6px;\n"])),styles_constants.Tj.gray25),InputExtended=function(_super){function InputExtended(props){var _this=_super.call(this,props)||this;return _this.onInputFocus=function(){_this.setState({isFocused:!0}),_this.props.onFocus&&_this.props.onFocus()},_this.onInputBlur=function(){_this.setState({isFocused:!1}),_this.props.onBlur&&_this.props.onBlur()},_this.getTheme=function(){var theme={backgroundColor:"inherit",borderColor:styles_constants.Tj.form.greyBorder,color:styles_constants.Tj.form.fontColor,isRightAligned:!!_this.props.isRightAligned};return _this.props.isInvalid&&(theme.borderColor=styles_constants.Tj.dangerRed),_this.state.isFocused&&(theme.borderColor=styles_constants.Tj.primaryAlternative),_this.props.disabled&&(theme.backgroundColor=styles_constants.Tj.form.greyDisabled,theme.borderColor=styles_constants.Tj.form.greyDisabled,theme.color=styles_constants.Tj.form.disabledLabelFontColor),theme},_this.state={isFocused:!1},_this}return(0,tslib_es6.C6)(InputExtended,_super),InputExtended.prototype.render=function(){var props=this.props,id=props.id,inputRef=props.inputRef,value=props.value,onChange=props.onChange,placeholder=props.placeholder,disabled=props.disabled,type=props.type,inputMode=props.inputMode,autoComplete=props.autoComplete,tabIndex=props.tabIndex,isAutoFocus=props.isAutoFocus,onKeyDown=props.onKeyDown,renderPrefix=props.renderPrefix,renderSuffix=props.renderSuffix,dataPendo=props.dataPendo,dataE2E=props.dataE2E,dataAnalytics=props.dataAnalytics,inputProps={id,value,onChange,placeholder,tabIndex,onKeyDown,autoComplete,disabled,type:type||"text",inputMode,onFocus:this.onInputFocus,onBlur:this.onInputBlur,autoFocus:isAutoFocus};return(0,emotion_react_jsx_runtime_browser_esm.Y)(emotion_element_c39617d8_browser_esm.a,(0,tslib_es6.Cl)({theme:this.getTheme()},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(StyledInputContainer,(0,tslib_es6.Cl)({className:props.className,isResponsive:props.isResponsive,hasPrefix:!!renderPrefix,hasSuffix:!!renderSuffix},{children:[renderPrefix?renderPrefix(value):null,(0,emotion_react_jsx_runtime_browser_esm.Y)(StyledInput,(0,tslib_es6.Cl)({},inputProps,{ref:inputRef,"data-pendo":dataPendo,"data-e2e":dataE2E,"data-analytics":dataAnalytics})),renderSuffix?renderSuffix(value):null]}))}))},InputExtended}(react.PureComponent),InputExtendedField=function(props){var input=props.input,meta=props.meta,inputProps=(0,tslib_es6.Tt)(props,["input","meta"]),invalid=meta&&meta.touched&&meta.error,errors=invalid?meta.error:null;return(0,emotion_react_jsx_runtime_browser_esm.Y)(InputExtended,(0,tslib_es6.Cl)({value:input.value,onChange:input.onChange,isInvalid:invalid},inputProps,{children:errors}))};var InputExtended_templateObject_1,InputExtended_templateObject_2,InputExtended_templateObject_3;const components_InputExtended=InputExtended;function closeModal(){return{type:constants.t.SETTINGS_CLOSE_SAVE_PACKAGE_TEMPLATE_MODAL}}var icon_carrierparcel=__webpack_require__("./app/assets/icons/icon_carrierparcel.svg"),icon_customdims=__webpack_require__("./app/assets/icons/icon_customdims.svg"),BackButtonContainer=(0,emotion_styled_browser_esm.A)("div")(BackButton_templateObject_1||(BackButton_templateObject_1=(0,tslib_es6.ue)(["\n  display: flex;\n  padding: 14px 24px 14px 24px;\n  border-bottom: 1px solid #efefef;\n  margin-bottom: 14px;\n  cursor: pointer;\n  color: ",";\n  font-size: 14px;\n  align-items: center;\n  font-weight: ",";\n\n  i {\n    color: ",";\n    margin-right: 14px;\n  }\n"],["\n  display: flex;\n  padding: 14px 24px 14px 24px;\n  border-bottom: 1px solid #efefef;\n  margin-bottom: 14px;\n  cursor: pointer;\n  color: ",";\n  font-size: 14px;\n  align-items: center;\n  font-weight: ",";\n\n  i {\n    color: ",";\n    margin-right: 14px;\n  }\n"])),styles_constants.Tj.fontColor,styles_constants.Wy.medium,styles_constants.Tj.placeholderColor);var BackButton_templateObject_1;const ParcelSelect_BackButton=function(props){return(0,emotion_react_jsx_runtime_browser_esm.FD)(BackButtonContainer,(0,tslib_es6.Cl)({onClick:props.onClick},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("i",{className:"fa fa-chevron-left"}),"Carrier Provided Parcels"]}))};var icon_package=__webpack_require__("./app/assets/icons/icon_package.svg"),parcel=__webpack_require__("./app/assets/icons/parcel.svg"),ParcelTemplate=__webpack_require__("./app/types/ParcelTemplate.ts"),FlexWrapper=(0,emotion_styled_browser_esm.A)("div")(ListItem_templateObject_1||(ListItem_templateObject_1=(0,tslib_es6.ue)(["\n  display: flex;\n  justify-content: center;\n  align-items: flex-start;\n  flex-direction: column;\n"],["\n  display: flex;\n  justify-content: center;\n  align-items: flex-start;\n  flex-direction: column;\n"]))),StyledListItem=(0,emotion_styled_browser_esm.A)("li")(ListItem_templateObject_2||(ListItem_templateObject_2=(0,tslib_es6.ue)(["\n  margin: 0;\n  padding: 8px 24px;\n  cursor: pointer;\n  transition: background-color 100ms;\n  font-size: 14px;\n  line-height: 1.8;\n  color: ",";\n  display: flex;\n  align-items: center;\n\n  :hover {\n    background-color: ",";\n  }\n"],["\n  margin: 0;\n  padding: 8px 24px;\n  cursor: pointer;\n  transition: background-color 100ms;\n  font-size: 14px;\n  line-height: 1.8;\n  color: ",";\n  display: flex;\n  align-items: center;\n\n  :hover {\n    background-color: ",";\n  }\n"])),styles_constants.Tj.fontColor,styles_constants.Tj.almostWhite),BoxIconFigure=(0,emotion_styled_browser_esm.A)("figure")(ListItem_templateObject_3||(ListItem_templateObject_3=(0,tslib_es6.ue)(["\n  margin: 0 24px 0 0;\n  display: flex;\n  align-items: center;\n\n  img {\n    width: ",";\n  }\n"],["\n  margin: 0 24px 0 0;\n  display: flex;\n  align-items: center;\n\n  img {\n    width: ",";\n  }\n"])),(function(props){return props.isCarrier?"45px":"25px"})),ListItemSubtitle=(0,emotion_styled_browser_esm.A)("div")(ListItem_templateObject_4||(ListItem_templateObject_4=(0,tslib_es6.ue)(["\n  font-weight: 300;\n  line-height: 1;\n"],["\n  font-weight: 300;\n  line-height: 1;\n"])));var ListItem_templateObject_1,ListItem_templateObject_2,ListItem_templateObject_3,ListItem_templateObject_4;const ParcelSelect_ListItem=function(props){var figure=props.icon?(0,emotion_react_jsx_runtime_browser_esm.Y)(BoxIconFigure,(0,tslib_es6.Cl)({isCarrier:props.isCarrier},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)("img",{src:props.icon,alt:""})})):null;return(0,emotion_react_jsx_runtime_browser_esm.FD)(StyledListItem,(0,tslib_es6.Cl)({onClick:props.onClick,"data-pendo":props.dataPendo,"data-analytics":props.dataAnalytics},{children:[figure,(0,emotion_react_jsx_runtime_browser_esm.FD)(FlexWrapper,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{children:props.children}),(0,emotion_react_jsx_runtime_browser_esm.Y)(ListItemSubtitle,{children:props.subtitle})]})]}))};var Wrapper=(0,emotion_styled_browser_esm.A)("div")(SectionTitle_templateObject_1||(SectionTitle_templateObject_1=(0,tslib_es6.ue)(["\n  display: flex;\n  align-items: center;\n  padding: 0 24px;\n"],["\n  display: flex;\n  align-items: center;\n  padding: 0 24px;\n"]))),Title=(0,emotion_styled_browser_esm.A)("h3")(SectionTitle_templateObject_2||(SectionTitle_templateObject_2=(0,tslib_es6.ue)(["\n  font-size: 11px;\n  font-weight: ",";\n  padding-right: 8px;\n  color: ",";\n"],["\n  font-size: 11px;\n  font-weight: ",";\n  padding-right: 8px;\n  color: ",";\n"])),styles_constants.Wy.medium,styles_constants.Tj.loblolly),Line=(0,emotion_styled_browser_esm.A)("div")(SectionTitle_templateObject_3||(SectionTitle_templateObject_3=(0,tslib_es6.ue)(["\n  border: 1px solid #efefef;\n  flex: 1;\n"],["\n  border: 1px solid #efefef;\n  flex: 1;\n"]))),FAIcon=(0,emotion_styled_browser_esm.A)("i")(SectionTitle_templateObject_4||(SectionTitle_templateObject_4=(0,tslib_es6.ue)(["\n  padding-left: 1px;\n  padding-top: 2px;\n  cursor: pointer;\n  color: ",";\n"],["\n  padding-left: 1px;\n  padding-top: 2px;\n  cursor: pointer;\n  color: ",";\n"])),styles_constants.Tj.primaryAlternative),SectionTitle_IconContainer=(0,emotion_styled_browser_esm.A)("div")(SectionTitle_templateObject_5||(SectionTitle_templateObject_5=(0,tslib_es6.ue)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  margin-left: 8px;\n  width: 20px;\n  height: 20px;\n  line-height: 22px;\n  border-radius: 50%;\n  box-shadow: 0 2px 4px 0 rgba(214, 214, 214);\n"],["\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  margin-left: 8px;\n  width: 20px;\n  height: 20px;\n  line-height: 22px;\n  border-radius: 50%;\n  box-shadow: 0 2px 4px 0 rgba(214, 214, 214);\n"])));var SectionTitle_templateObject_1,SectionTitle_templateObject_2,SectionTitle_templateObject_3,SectionTitle_templateObject_4,SectionTitle_templateObject_5;const ParcelSelect_SectionTitle=function(props){return(0,emotion_react_jsx_runtime_browser_esm.FD)(Wrapper,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Title,{children:props.children}),(0,emotion_react_jsx_runtime_browser_esm.Y)(Line,{}),props.onAddPackageClick&&(0,emotion_react_jsx_runtime_browser_esm.Y)(SectionTitle_IconContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(FAIcon,{className:"fa fa-plus",onClick:props.onAddPackageClick})})]})};var List=(0,emotion_styled_browser_esm.A)("ul")(CustomParcelTemplate_templateObject_1||(CustomParcelTemplate_templateObject_1=(0,tslib_es6.ue)(["\n  margin: 0;\n  padding: 0;\n"],["\n  margin: 0;\n  padding: 0;\n"]))),ZeroStateWrapper=(0,emotion_styled_browser_esm.A)("div")(CustomParcelTemplate_templateObject_2||(CustomParcelTemplate_templateObject_2=(0,tslib_es6.ue)(["\n  display: flex;\n  padding: 0 24px 24px 24px;\n"],["\n  display: flex;\n  padding: 0 24px 24px 24px;\n"]))),ZeroStateContainer=(0,emotion_styled_browser_esm.A)("div")(CustomParcelTemplate_templateObject_3||(CustomParcelTemplate_templateObject_3=(0,tslib_es6.ue)(["\n  border-radius: 3px;\n  background-color: #f7fafc;\n  width: 100%;\n  height: 140px;\n  @media screen and (min-width: ","px) {\n    height: 120px;\n  }\n  display: flex;\n  align-items: center;\n  flex-direction: column;\n  padding: 24px;\n"],["\n  border-radius: 3px;\n  background-color: #f7fafc;\n  width: 100%;\n  height: 140px;\n  @media screen and (min-width: ","px) {\n    height: 120px;\n  }\n  display: flex;\n  align-items: center;\n  flex-direction: column;\n  padding: 24px;\n"])),responsive.P.SmallMobile),PackageIconContainer=(0,emotion_styled_browser_esm.A)("div")(CustomParcelTemplate_templateObject_4||(CustomParcelTemplate_templateObject_4=(0,tslib_es6.ue)(["\n  height: 48px;\n  width: 48px;\n  min-width: 48px;\n  min-height: 48px;\n  background-color: ",";\n  box-shadow: 0 2px 4px 0 rgba(214, 214, 214, 0.5);\n  border-radius: 50%;\n\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n"],["\n  height: 48px;\n  width: 48px;\n  min-width: 48px;\n  min-height: 48px;\n  background-color: ",";\n  box-shadow: 0 2px 4px 0 rgba(214, 214, 214, 0.5);\n  border-radius: 50%;\n\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n"])),styles_constants.Tj.white),ZeroStateHelpText=(0,emotion_styled_browser_esm.A)("div")(CustomParcelTemplate_templateObject_5||(CustomParcelTemplate_templateObject_5=(0,tslib_es6.ue)(["\n  text-align: center;\n  padding: 10px 0;\n"],["\n  text-align: center;\n  padding: 10px 0;\n"]))),CreatePackageLink=(0,emotion_styled_browser_esm.A)("div")(CustomParcelTemplate_templateObject_6||(CustomParcelTemplate_templateObject_6=(0,tslib_es6.ue)(["\n  color: ",";\n  cursor: pointer;\n"],["\n  color: ",";\n  cursor: pointer;\n"])),styles_constants.Tj.primaryAlternative),CustomParcelTemplate=function(_super){function CustomParcelTemplate(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.getParcelTemplateSubtitle=function(parcelTemplate){var dimensionsProvider=parcelTemplate.carrierTemplate&&!parcelTemplate.carrierTemplate.isVariableDimensions?parcelTemplate.carrierTemplate:parcelTemplate,weightString=parcelTemplate.weight?", ".concat((0,ParcelTemplate.E_)(parcelTemplate)):"";return"".concat((0,ParcelTemplate.$)(dimensionsProvider)).concat(weightString)},_this.renderParcelTemplates=function(parcelTemplate){var _a=_this.props,onOptionSelection=_a.onOptionSelection,dataAnalytics=_a.dataAnalytics;return(0,emotion_react_jsx_runtime_browser_esm.Y)(ParcelSelect_ListItem,(0,tslib_es6.Cl)({icon:parcel,subtitle:_this.getParcelTemplateSubtitle(parcelTemplate),onClick:onOptionSelection.bind(_this,parcelTemplate),dataPendo:"parcel-select-template",dataAnalytics},{children:(0,ParcelTemplate.mG)(parcelTemplate)}),parcelTemplate.objectId)},_this.handleCreatePackageClick=function(){_this.props.openSavePackageTemplateModal()},_this}return(0,tslib_es6.C6)(CustomParcelTemplate,_super),CustomParcelTemplate.prototype.render=function(){var _a=this.props,parcelTemplates=_a.parcelTemplates,showZeroState=_a.showZeroState;return(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(ParcelSelect_SectionTitle,(0,tslib_es6.Cl)({onAddPackageClick:showZeroState?this.handleCreatePackageClick:void 0},{children:"Choose from package templates"})),parcelTemplates.length>0?(0,emotion_react_jsx_runtime_browser_esm.Y)(List,{children:parcelTemplates.map(this.renderParcelTemplates)}):showZeroState&&(0,emotion_react_jsx_runtime_browser_esm.Y)(ZeroStateWrapper,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(ZeroStateContainer,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(PackageIconContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)("img",{src:icon_package,alt:""})}),(0,emotion_react_jsx_runtime_browser_esm.Y)(ZeroStateHelpText,{children:"Package templates allow you to save your packaging measurements for easy re-use"}),(0,emotion_react_jsx_runtime_browser_esm.Y)(CreatePackageLink,(0,tslib_es6.Cl)({onClick:this.handleCreatePackageClick},{children:"+ Create Package Template"}))]})})]})},CustomParcelTemplate}(react.Component);const ParcelSelect_CustomParcelTemplate=CustomParcelTemplate;var CustomParcelTemplate_templateObject_1,CustomParcelTemplate_templateObject_2,CustomParcelTemplate_templateObject_3,CustomParcelTemplate_templateObject_4,CustomParcelTemplate_templateObject_5,CustomParcelTemplate_templateObject_6,SelectButtonContent_FlexWrapper=(0,emotion_styled_browser_esm.A)("div")(SelectButtonContent_templateObject_1||(SelectButtonContent_templateObject_1=(0,tslib_es6.ue)(["\n  display: flex;\n  align-items: center;\n  margin-left: 6px;\n  font-family: ",";\n"],["\n  display: flex;\n  align-items: center;\n  margin-left: 6px;\n  font-family: ",";\n"])),styles_constants.mw),SelectButtonContent_OptionSelectedIcon=(0,emotion_styled_browser_esm.A)(SelectButtonContent_FlexWrapper)(SelectButtonContent_templateObject_2||(SelectButtonContent_templateObject_2=(0,tslib_es6.ue)(["\n  margin-right: 12px;\n  padding-right: 12px;\n  padding-left: 8px;\n  border-right: 1px solid ",";\n  height: 32px;\n\n  img {\n    width: 16px;\n  }\n"],["\n  margin-right: 12px;\n  padding-right: 12px;\n  padding-left: 8px;\n  border-right: 1px solid ",";\n  height: 32px;\n\n  img {\n    width: 16px;\n  }\n"])),styles_constants.Tj.gray50);const SelectButtonContent_SelectButtonContent=function(props){var selectedParcel=props.selectedParcel,isUsingCustomDimensions=props.isUsingCustomDimensions,hideIcon=props.hideIcon,hideDimensions=props.hideDimensions,initialContentString=props.initialContentString,dimensionProvider=selectedParcel&&selectedParcel.carrierTemplate?selectedParcel.carrierTemplate:selectedParcel,content="",icon=parcel;if(isUsingCustomDimensions)content="Custom Dimensions",icon=icon_customdims;else if(selectedParcel&&(selectedParcel&&selectedParcel.isVariableDimensions||selectedParcel.objectId&&selectedParcel.carrierTemplate&&selectedParcel.carrierTemplate.isVariableDimensions))content="".concat((0,ParcelTemplate.mG)(selectedParcel)),selectedParcel.objectId||(icon=icon_carrierparcel);else if(selectedParcel){var dimensions=(0,ParcelTemplate.$)(dimensionProvider);content="".concat((0,ParcelTemplate.mG)(selectedParcel)," ").concat(dimensions&&!hideDimensions?"(".concat(dimensions,")"):""),selectedParcel.objectId||(icon=icon_carrierparcel)}else content=initialContentString||"Select Template or Enter Dimensions...";var selectIcon=hideIcon||!selectedParcel&&!isUsingCustomDimensions?null:(0,emotion_react_jsx_runtime_browser_esm.Y)(SelectButtonContent_OptionSelectedIcon,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)("img",{src:icon,alt:""})});return(0,emotion_react_jsx_runtime_browser_esm.FD)(SelectButtonContent_FlexWrapper,{children:[selectIcon,content]})};var SelectButtonContent_templateObject_1,SelectButtonContent_templateObject_2,carriers=__webpack_require__("./app/constants/carriers.ts"),utils=__webpack_require__("./app/utils/TrackingHelper/utils.ts"),ParcelSelect_Container=(0,emotion_styled_browser_esm.A)("div")(ParcelSelect_templateObject_1||(ParcelSelect_templateObject_1=(0,tslib_es6.ue)(["\n  display: flex;\n  align-items: center;\n  width: 100%;\n"],["\n  display: flex;\n  align-items: center;\n  width: 100%;\n"]))),GreenSpinnerWithMargin=(0,emotion_styled_browser_esm.A)(Spinner.hQ)(ParcelSelect_templateObject_2||(ParcelSelect_templateObject_2=(0,tslib_es6.ue)(["\n  margin-left: 5px;\n"],["\n  margin-left: 5px;\n"]))),ParcelSelect_Wrapper=(0,emotion_styled_browser_esm.A)("div")(ParcelSelect_templateObject_3||(ParcelSelect_templateObject_3=(0,tslib_es6.ue)(["\n  width: 100%;\n  overflow: auto;\n  max-height: 260px;\n  position: relative;\n  background-color: ",";\n"],["\n  width: 100%;\n  overflow: auto;\n  max-height: 260px;\n  position: relative;\n  background-color: ",";\n"])),styles_constants.Tj.white),ListSection=(0,emotion_styled_browser_esm.A)("section")(ParcelSelect_templateObject_4||(ParcelSelect_templateObject_4=(0,tslib_es6.ue)(["\n  width: 100%;\n  margin: 0;\n  padding: 5px 0 0 0;\n  box-sizing: border-box;\n  height: ",";\n"],["\n  width: 100%;\n  margin: 0;\n  padding: 5px 0 0 0;\n  box-sizing: border-box;\n  height: ",";\n"])),(function(props){return props.isExpanded?"500px":"auto"})),ParcelSelect_List=(0,emotion_styled_browser_esm.A)("ul")(ParcelSelect_templateObject_5||(ParcelSelect_templateObject_5=(0,tslib_es6.ue)(["\n  margin: 0;\n  padding: 0;\n"],["\n  margin: 0;\n  padding: 0;\n"]))),ListIcon=(0,emotion_styled_browser_esm.A)("img")(ParcelSelect_templateObject_6||(ParcelSelect_templateObject_6=(0,tslib_es6.ue)(["\n  padding-right: 12px;\n  vertical-align: middle;\n  padding-bottom: 2px;\n"],["\n  padding-right: 12px;\n  vertical-align: middle;\n  padding-bottom: 2px;\n"]))),FormErrorWithMarginTop=(0,emotion_styled_browser_esm.A)(FormError_FormError.A)(ParcelSelect_templateObject_7||(ParcelSelect_templateObject_7=(0,tslib_es6.ue)(["\n  margin-top: 5px;\n  font-size: 12px;\n  color: ",";\n"],["\n  margin-top: 5px;\n  font-size: 12px;\n  color: ",";\n"])),styles_constants.Tj.dangerRed),CustomSelectButton=(0,emotion_styled_browser_esm.A)(SelectButton.A)(ParcelSelect_templateObject_8||(ParcelSelect_templateObject_8=(0,tslib_es6.ue)(["\n  color: ",";\n  ",";\n  ",";\n"],["\n  color: ",";\n  ",";\n  ",";\n"])),styles_constants.Tj.fontColor,(function(_a){return _a.customSelectButtonStyle}),(function(props){return props.invalid?"border: 1px solid ".concat(styles_constants.Tj.dangerRed):""})),ParcelSelect=function(_super){function ParcelSelect(props){var _this=_super.call(this,props)||this;return _this.triggerRef=null,_this.setTriggerRef=function(node){return _this.triggerRef=node},_this.handleClickOutside=function(evt){-1===evt.propagationPath().indexOf(react_dom.findDOMNode(_this.triggerRef))&&_this.setState({isExpanded:!1,isDropdownOpen:!1})},_this.handleSelectButtonClick=function(){if(!_this.props.isLoadingParcels&&!_this.props.disabled){_this.setState({isDropdownOpen:!_this.state.isDropdownOpen});var trackingReference=TrackingHelper.U.getTrackingReference(types.wK.name,_this.props.appLocation,{parcelId:void 0,isAutoSave:!1,isQuickSelect:!1});(0,utils.bT)(trackingReference,types.wK.operations.BROWSED,{parcelId:void 0})}},_this.handleOptionSelection=function(option){var onChange=_this.props.onChange,parcelOption=option;if(onChange&&(onChange(option),null==parcelOption?void 0:parcelOption.objectId)){var trackingReference=TrackingHelper.U.getTrackingReference(types.wK.name,_this.props.appLocation,{parcelId:null==parcelOption?void 0:parcelOption.objectId,isAutoSave:!1,isQuickSelect:!1});(0,utils.bT)(trackingReference,types.wK.operations.ADDED,{parcelId:null==parcelOption?void 0:parcelOption.objectId})}_this.setState({isDropdownOpen:!1,isExpanded:!1})},_this.goBack=function(){_this.setState({isExpanded:!1})},_this.handleCustomDimensionsSelected=function(){var _a=_this.props,onCustomDimensionsSelected=_a.onCustomDimensionsSelected,onChange=_a.onChange;onCustomDimensionsSelected&&onCustomDimensionsSelected(),onChange&&onChange(null),_this.setState({isDropdownOpen:!1})},_this.expandList=function(evt){evt.stopPropagation(),evt.preventDefault(),_this.setState({isExpanded:!0})},_this.onKeyDown=function(evt){switch(evt.key){case keys.D.Escape:case keys.D.Tab:return _this.setState({isDropdownOpen:!1,highlightedOptionIndex:0,isExpanded:!1})}},_this.renderOptions=function(){if(_this.state.isExpanded)return null;var _a=_this.props,omitCustomParcelTemplate=_a.omitCustomParcelTemplate,openSavePackageTemplateModal=_a.openSavePackageTemplateModal,parcelTemplates=_a.parcelTemplates,showZeroState=_a.showZeroState,dataAnalyticsContext=_a.dataAnalyticsContext;return(0,emotion_react_jsx_runtime_browser_esm.FD)(ListSection,(0,tslib_es6.Cl)({isExpanded:_this.state.isExpanded,size:_this.props.size},{children:[!_this.props.disableCustomDimensions&&(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(ParcelSelect_SectionTitle,{children:"New package"}),(0,emotion_react_jsx_runtime_browser_esm.FD)(ParcelSelect_List,{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(ParcelSelect_ListItem,(0,tslib_es6.Cl)({onClick:_this.handleCustomDimensionsSelected,dataPendo:"package-select-custom",dataAnalytics:dataAnalyticsContext&&"".concat(dataAnalyticsContext,"CustomDimensions-click-selectOption")},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(ListIcon,{src:icon_customdims,alt:""})," Enter Custom Dimensions"]})),(0,emotion_react_jsx_runtime_browser_esm.FD)(ParcelSelect_ListItem,(0,tslib_es6.Cl)({onClick:_this.expandList,dataAnalytics:dataAnalyticsContext&&"".concat(dataAnalyticsContext,"Carrier-click-selectOption")},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(ListIcon,{src:icon_carrierparcel,alt:""})," Carrier Provided Parcels"]}))]})]}),omitCustomParcelTemplate?null:(0,emotion_react_jsx_runtime_browser_esm.Y)(ParcelSelect_CustomParcelTemplate,{onOptionSelection:_this.handleOptionSelection,openSavePackageTemplateModal,parcelTemplates,showZeroState,dataAnalytics:dataAnalyticsContext&&"".concat(dataAnalyticsContext,"PackageTemplate-click-selectOption")})]}))},_this.renderCarrierParcelTemplateItem=function(carrier,carrierParcelTemplate){var dataAnalyticsContext=_this.props.dataAnalyticsContext;return(0,emotion_react_jsx_runtime_browser_esm.Y)(ParcelSelect_ListItem,(0,tslib_es6.Cl)({icon:carrier.imgTrademark?carrier.imgTrademark:carrier.img,isCarrier:!0,subtitle:(0,ParcelTemplate.$)(carrierParcelTemplate),onClick:_this.handleOptionSelection.bind(_this,carrierParcelTemplate),dataPendo:"package-select-carrier",dataAnalytics:dataAnalyticsContext&&"".concat(dataAnalyticsContext,"Carrier-click-selectOption")},{children:carrierParcelTemplate.name}),carrierParcelTemplate.token)},_this.renderCarrierParcelTemplate=function(carrier,carrierParcelTemplates){return(0,emotion_react_jsx_runtime_browser_esm.FD)("div",{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(ParcelSelect_SectionTitle,{children:carrier.name}),(0,emotion_react_jsx_runtime_browser_esm.Y)(ParcelSelect_List,{children:carrierParcelTemplates.map((function(parcelTemplate){return _this.renderCarrierParcelTemplateItem(carrier,parcelTemplate)}))})]},carrier.id)},_this.renderCarrierParcelTemplates=function(){return Object.keys(_this.props.carrierParcelTemplates).map((function(key){var carrier=carriers.Ps[key]||{name:key,id:key,token:key,img:""};return _this.renderCarrierParcelTemplate(carrier,_this.props.carrierParcelTemplates[key])}))},_this.renderExpandedOptions=function(){return _this.state.isExpanded?(0,emotion_react_jsx_runtime_browser_esm.FD)(ListSection,(0,tslib_es6.Cl)({isExpanded:_this.state.isExpanded,size:_this.props.size},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(ParcelSelect_BackButton,{onClick:_this.goBack}),_this.renderCarrierParcelTemplates()]})):null},_this.state={isExpanded:!1,isDropdownOpen:!1,highlightedOptionIndex:0},_this}return(0,tslib_es6.C6)(ParcelSelect,_super),ParcelSelect.prototype.render=function(){var _this=this,isDropdownOpen=this.state.isDropdownOpen,_a=this.props,customSelectButtonStyle=_a.customSelectButtonStyle,size=_a.size,selectedParcel=_a.selectedParcel,isUsingCustomDimensions=_a.isUsingCustomDimensions,tabIndex=_a.tabIndex,className=_a.className,disabled=_a.disabled,isLoadingParcels=_a.isLoadingParcels,initialContentString=_a.initialContentString,loader=(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"flex items-center"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(GreenSpinnerWithMargin,{})})),triggerComponentContent=(0,emotion_react_jsx_runtime_browser_esm.Y)(SelectButtonContent_SelectButtonContent,{selectedParcel,isUsingCustomDimensions,initialContentString,hideIcon:!0,hideDimensions:!0});return(0,emotion_react_jsx_runtime_browser_esm.Y)(ParcelSelect_Container,(0,tslib_es6.Cl)({className,onKeyDown:this.onKeyDown},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Dropdown.A,(0,tslib_es6.Cl)({size,triggerComponent:function(){return(0,emotion_react_jsx_runtime_browser_esm.Y)(CustomSelectButton,(0,tslib_es6.Cl)({customSelectButtonStyle,invalid:_this.props.invalid,hasOptionSelected:!!selectedParcel,onClick:_this.handleSelectButtonClick,size,tabIndex,disabled:isLoadingParcels||disabled,responsive:!0},{children:isLoadingParcels?loader:triggerComponentContent}))},isOpen:isDropdownOpen,onClickOutside:this.handleClickOutside,ref:this.setTriggerRef},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(ParcelSelect_Wrapper,(0,tslib_es6.Cl)({size,onKeyDown:this.onKeyDown,tabIndex:0},{children:[this.renderOptions(),this.renderExpandedOptions()]}))}))}))},ParcelSelect.defaultProps={size:constants_form.YI.medlarge},ParcelSelect}(react.Component);var ParcelSelect_templateObject_1,ParcelSelect_templateObject_2,ParcelSelect_templateObject_3,ParcelSelect_templateObject_4,ParcelSelect_templateObject_5,ParcelSelect_templateObject_6,ParcelSelect_templateObject_7,ParcelSelect_templateObject_8;const components_ParcelSelect=ParcelSelect;var dist=__webpack_require__("./node_modules/re-reselect/dist/index.js"),getTemplateTokenFromProps=function(_,props){return props.templateToken},getParcelTemplateStore=function(state){return state.parcelTemplate},parcel_template_selectors_getParcelTemplates=(0,reselect_es.createSelector)(getParcelTemplateStore,(function(parcelTemplateStore){return(0,tslib_es6.fX)([],(0,tslib_es6.zs)(parcelTemplateStore.parcelTemplates),!1).sort((function(a,b){var _a,_b,_c,_d,dateComparison=(null!==(_b=null===(_a=b.objectCreated)||void 0===_a?void 0:_a.getTime())&&void 0!==_b?_b:0)-(null!==(_d=null===(_c=a.objectCreated)||void 0===_c?void 0:_c.getTime())&&void 0!==_d?_d:0);if(0!==dateComparison)return dateComparison;var aName=(0,ParcelTemplate.mG)(a),bName=(0,ParcelTemplate.mG)(b);return aName&&bName?aName.localeCompare(bName):0}))})),parcel_template_selectors_getCarrierParcelTemplates=(0,reselect_es.createSelector)(getParcelTemplateStore,(function(parcelTemplateStore){return parcelTemplateStore.carrierParcelTemplates})),parcel_template_selectors_isLoadingParcels=(0,reselect_es.createSelector)(getParcelTemplateStore,(function(parcelTemplateStore){return parcelTemplateStore.isLoadingCarrierParcelTemplates&&parcelTemplateStore.isLoadingParcelTemplates})),isDeleting=(0,reselect_es.createSelector)(getParcelTemplateStore,(function(parcelTemplatesStore){return parcelTemplatesStore.isDeleting})),ParcelSelect_container_mapStateToProps=((0,dist.createCachedSelector)(parcel_template_selectors_getCarrierParcelTemplates,getTemplateTokenFromProps,(function(carrierParcelTemplates,templateToken){var e_1,_a,carrierParcelTemplate=null,carriers=Object.keys(carrierParcelTemplates);try{for(var carriers_1=(0,tslib_es6.Ju)(carriers),carriers_1_1=carriers_1.next();!carriers_1_1.done;carriers_1_1=carriers_1.next()){if(null!==(carrierParcelTemplate=carrierParcelTemplates[carriers_1_1.value].find((function(carrierParcelTemplate){return carrierParcelTemplate.token===templateToken}))||null))break}}catch(e_1_1){e_1={error:e_1_1}}finally{try{carriers_1_1&&!carriers_1_1.done&&(_a=carriers_1.return)&&_a.call(carriers_1)}finally{if(e_1)throw e_1.error}}return carrierParcelTemplate}))(getTemplateTokenFromProps),(0,reselect_es.createSelector)(parcel_template_selectors_getParcelTemplates,(function(_,props){return props.parcelTemplateId}),(function(parcelTemplates,parcelTemplateId){return parcelTemplates.find((function(parcelTemplate){return parcelTemplate.objectId===parcelTemplateId}))||null})),(0,reselect_es.createSelector)(parcel_template_selectors_getParcelTemplates,(function(parcelTemplates){return parcelTemplates.some((function(parcelTemplate){return parcelTemplate.isDefault}))})),(0,reselect_es.createSelector)(parcel_template_selectors_getParcelTemplates,(function(parcelTemplates){return parcelTemplates.find((function(parcelTemplate){return parcelTemplate.isDefault}))})),function(state){return{parcelTemplates:parcel_template_selectors_getParcelTemplates(state),carrierParcelTemplates:parcel_template_selectors_getCarrierParcelTemplates(state),isLoadingParcels:parcel_template_selectors_isLoadingParcels(state)}}),ParcelSelect_container_mapDispatchToProps=function(dispatch){return{openSavePackageTemplateModal:function(){return dispatch(function openModal(parcelTemplate){return void 0===parcelTemplate&&(parcelTemplate=null),{parcelTemplate,type:constants.t.SETTINGS_OPEN_SAVE_PACKAGE_TEMPLATE_MODAL}}())}}};(0,es.Ng)(ParcelSelect_container_mapStateToProps,ParcelSelect_container_mapDispatchToProps)(components_ParcelSelect);var ParcelSelectFieldContainer=(0,es.Ng)(ParcelSelect_container_mapStateToProps,ParcelSelect_container_mapDispatchToProps)((function(props){var input=props.input,meta=props.meta,parcelSelectProps=(0,tslib_es6.Tt)(props,["input","meta"]),errors=meta.touched&&meta.error?(0,emotion_react_jsx_runtime_browser_esm.Y)(FormErrorWithMarginTop,{children:meta.error}):null;return(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(ParcelSelect,(0,tslib_es6.Cl)({selectedParcel:input.value,onChange:input.onChange,invalid:!!errors},parcelSelectProps)),errors]})}));var PackageTemplateRadioGroup_styled_templateObject_1,Field=__webpack_require__("./node_modules/redux-form/es/Field.js"),FormSection=__webpack_require__("./node_modules/redux-form/es/FormSection.js"),getFormValues=__webpack_require__("./node_modules/redux-form/es/getFormValues.js"),getFormMeta=__webpack_require__("./node_modules/redux-form/es/getFormMeta.js"),getFormSyncErrors=__webpack_require__("./node_modules/redux-form/es/getFormSyncErrors.js"),FormGroup=(0,emotion_styled_browser_esm.A)("div")(PackageTemplateRadioGroup_styled_templateObject_1||(PackageTemplateRadioGroup_styled_templateObject_1=(0,tslib_es6.ue)(["\n  margin: 1.5rem 0;\n  i {\n    margin: 0.25rem 0 0 0.5rem;\n    cursor: pointer;\n  }\n"],["\n  margin: 1.5rem 0;\n  i {\n    margin: 0.25rem 0 0 0.5rem;\n    cursor: pointer;\n  }\n"]))),ComposedPackageTemplateRadioGroup=(0,utils_translate.Tl)("orders")((function(_a){var onChangeCallback=_a.onChangeCallback,dimensionType=_a.dimensionType,t=_a.t,input=_a.input,selectedProps=(0,tslib_es6.Tt)(_a,["onChangeCallback","dimensionType","t","input"]),updatePackageRadio=react.useCallback((function(val){onChangeCallback(val)}),[]),PackageTooltip=(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Popup.A,(0,tslib_es6.Cl)({on:"hover",inverted:!0,size:"mini",position:"top center",trigger:(0,emotion_react_jsx_runtime_browser_esm.Y)("i",{className:"fa fa-question-circle"})},{children:t("orders:packageDimensionTypes:polymailerTooltipText")}));return(0,emotion_react_jsx_runtime_browser_esm.Y)(FormGroup,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Radio,(0,tslib_es6.Cl)({name:"packageDimensionType",onChange:updatePackageRadio,value:dimensionType||input.value,vertical:!0,toolTipContent:PackageTooltip},selectedProps))})}));const PackageTemplateChooser_PackageTemplateRadioGroup=ComposedPackageTemplateRadioGroup;var allowKeyboardNumberInput=function(event){["Backspace","Delete","ArrowLeft","ArrowRight","Tab","Enter","Home","End",".","0","1","2","3","4","5","6","7","8","9"].includes(event.key)||event.ctrlKey||event.preventDefault()},InlineFieldContainer=(0,emotion_styled_browser_esm.A)("div")(PackageTemplateChooser_templateObject_1||(PackageTemplateChooser_templateObject_1=(0,tslib_es6.ue)(["\n  margin-left: 10px;\n  display: flex;\n  align-items: center;\n"],["\n  margin-left: 10px;\n  display: flex;\n  align-items: center;\n"]))),MaxContentLabel=(0,emotion_styled_browser_esm.A)("div")(PackageTemplateChooser_templateObject_2||(PackageTemplateChooser_templateObject_2=(0,tslib_es6.ue)(["\n  width: max-content;\n"],["\n  width: max-content;\n"]))),FieldsWrapper=(0,emotion_styled_browser_esm.A)("div")(PackageTemplateChooser_templateObject_3||(PackageTemplateChooser_templateObject_3=(0,tslib_es6.ue)(["\n  display: flex;\n  margin: 8px 0 8px 0;\n  align-items: flex-start;\n  @media screen and (min-width: ","px) {\n    flex-wrap: wrap;\n  }\n"],["\n  display: flex;\n  margin: 8px 0 8px 0;\n  align-items: flex-start;\n  @media screen and (min-width: ","px) {\n    flex-wrap: wrap;\n  }\n"])),responsive.P.Mobile),XContainer=(0,emotion_styled_browser_esm.A)("div")(PackageTemplateChooser_templateObject_4||(PackageTemplateChooser_templateObject_4=(0,tslib_es6.ue)(["\n  line-height: ",";\n  width: 8px;\n  margin: 0 10px;\n"],["\n  line-height: ",";\n  width: 8px;\n  margin: 0 10px;\n"])),styles_constants.vi.inputHeight),FieldLabel=(0,emotion_styled_browser_esm.A)("div")(PackageTemplateChooser_templateObject_5||(PackageTemplateChooser_templateObject_5=(0,tslib_es6.ue)(["\n  color: ",";\n  font-weight: normal;\n  margin: 15px 0 0 0;\n"],["\n  color: ",";\n  font-weight: normal;\n  margin: 15px 0 0 0;\n"])),styles_constants.Tj.gray700),Subtext=(0,emotion_styled_browser_esm.A)("div")(PackageTemplateChooser_templateObject_6||(PackageTemplateChooser_templateObject_6=(0,tslib_es6.ue)(["\n  display: flex;\n  align-items: center;\n  color: ",";\n  font-size: 0.75rem;\n  line-height: 1.25rem;\n"],["\n  display: flex;\n  align-items: center;\n  color: ",";\n  font-size: 0.75rem;\n  line-height: 1.25rem;\n"])),styles_constants.Tj.gray400),InputExtendedReduxFormField=Field.A,PackageTemplateChooser=function(_super){function PackageTemplateChooser(props){var _this=_super.call(this,props)||this;return _this.weightInput=react.createRef(),_this.packageTypesOptions=[{label:_this.props.t("orders:packageDimensionTypes:boxRadioLabel"),value:"box"},{label:_this.props.t("orders:packageDimensionTypes:boxPolymailerLabel"),value:"polymailer",addToolTip:!0}],_this.onUseImportedWeightChange=function(){var _a;isNaN(Number(_this.props.importedWeight))?_this.props.changePackageWeight(""):_this.props.changePackageWeight((null===(_a=_this.props.importedWeight)||void 0===_a?void 0:_a.toString())||""),_this.props.importedWeightOption&&_this.props.changePackageWeightUnit(_this.props.importedWeightOption)},_this.handleCustomDimensionsSelected=function(){return _this.props.onCustomDimensionsSelected(!0)},_this.onParcelTemplateSelected=function(value){var _a;if(!value)return _this.setState({shouldShowRadioGroup:!0}),_this.props.removeSelectedParcelTemplate(),_this.props.onCarrierTemplateWithCustomDimensionsSelected(!1),_this.props.onCustomDimensionsSelected(!0);(value.name||value.carrierTemplate&&value.carrierTemplate.name)&&(_this.setState({shouldShowRadioGroup:!1}),value.isVariableDimensions?(_this.props.onCarrierTemplateWithCustomDimensionsSelected(!0),_this.props.onCustomDimensionsSelected(!1)):(null===(_a=_this.weightInput.current)||void 0===_a||_a.focus(),_this.props.onCarrierTemplateWithCustomDimensionsSelected(!1),_this.props.onCustomDimensionsSelected(!1)),value.weight&&value.weightUnit&&(_this.props.changePackageWeight(value.weight.toString()),_this.props.changePackageWeightUnit(options.Ay.commonWeightOptions[value.weightUnit]),_this.props.changeUseImportedWeight(!1)))},_this.packageTemplateRadioChange=function(option){_this.setState({packageDimensionType:option},(function(){var setHeightValue=_this.getHeightValueByDistanceUnit();_this.props.changePackageHeight(setHeightValue)})),_this.props.changePackageDimenstionType(option)},_this.getHeightValueByDistanceUnit=function(){var _a,_b,_c,_d;return"polymailer"===(null===(_b=null===(_a=_this.state)||void 0===_a?void 0:_a.packageDimensionType)||void 0===_b?void 0:_b.value)?"mm"===(null===(_c=_this.props)||void 0===_c?void 0:_c.getCurrentDistanceUnit.value)?6.35:"cm"===(null===(_d=_this.props)||void 0===_d?void 0:_d.getCurrentDistanceUnit.value)?.635:.25:0},_this.state={packageDimensionType:null,shouldShowRadioGroup:!0},_this}return(0,tslib_es6.C6)(PackageTemplateChooser,_super),PackageTemplateChooser.prototype.componentDidMount=function(){var _a=this.props,editingCustomTemplate=_a.editingCustomTemplate,selectedParcelTemplate=_a.selectedParcelTemplate,onCustomDimensionsSelected=_a.onCustomDimensionsSelected,onCarrierTemplateWithCustomDimensionsSelected=_a.onCarrierTemplateWithCustomDimensionsSelected;this.props.fetchCarrierParcelTemplates();var selectedPolymailerHeightInches=!(!(null==selectedParcelTemplate?void 0:selectedParcelTemplate.distanceUnit)||"in"!==(null==selectedParcelTemplate?void 0:selectedParcelTemplate.distanceUnit)||!(null==selectedParcelTemplate?void 0:selectedParcelTemplate.height)||.25!==selectedParcelTemplate.height),selectedPolymailerHeightCm=!(!(null==selectedParcelTemplate?void 0:selectedParcelTemplate.distanceUnit)||"cm"!==(null==selectedParcelTemplate?void 0:selectedParcelTemplate.distanceUnit)||!(null==selectedParcelTemplate?void 0:selectedParcelTemplate.height)||.635!==selectedParcelTemplate.height),selectedPolymailerHeightMm=!(!(null==selectedParcelTemplate?void 0:selectedParcelTemplate.distanceUnit)||"mm"!==(null==selectedParcelTemplate?void 0:selectedParcelTemplate.distanceUnit)||!(null==selectedParcelTemplate?void 0:selectedParcelTemplate.height)||6.35!==selectedParcelTemplate.height);(selectedPolymailerHeightInches||selectedPolymailerHeightCm||selectedPolymailerHeightMm)&&this.setState({packageDimensionType:this.packageTypesOptions[1]}),editingCustomTemplate?!selectedParcelTemplate||selectedParcelTemplate&&(0,ParcelTemplate.MS)(selectedParcelTemplate)&&null===selectedParcelTemplate.carrierTemplate?(onCustomDimensionsSelected(!0),this.setState({shouldShowRadioGroup:!0})):selectedParcelTemplate&&(0,ParcelTemplate.MS)(selectedParcelTemplate)&&selectedParcelTemplate.carrierTemplate&&selectedParcelTemplate.carrierTemplate.isVariableDimensions&&onCarrierTemplateWithCustomDimensionsSelected(!0):(this.props.fetchParcelTemplates(),selectedParcelTemplate||onCustomDimensionsSelected(!0)),this.props.isWeightRequired&&this.props.changeIsWeightRequired(this.props.isWeightRequired),selectedParcelTemplate&&(0,ParcelTemplate.MS)(selectedParcelTemplate)&&null!==selectedParcelTemplate.carrierTemplate&&this.setState({shouldShowRadioGroup:!1})},PackageTemplateChooser.prototype.componentDidUpdate=function(prevProps){var _a,_b,getCurrentDistanceUnit=this.props.getCurrentDistanceUnit;if(prevProps.getCurrentDistanceUnit!==getCurrentDistanceUnit&&"polymailer"===(null===(_b=null===(_a=this.state)||void 0===_a?void 0:_a.packageDimensionType)||void 0===_b?void 0:_b.value)){var setHeightValue=this.getHeightValueByDistanceUnit();this.props.changePackageHeight(setHeightValue)}},PackageTemplateChooser.prototype.renderDimensions=function(){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k=this.props,isUsingCustomDimensions=_k.isUsingCustomDimensions,selectedParcelTemplate=_k.selectedParcelTemplate,startingTabIndex=_k.startingTabIndex,carrierTemplatewithCustomDimensions=_k.carrierTemplatewithCustomDimensions,dataAnalyticsContext=_k.dataAnalyticsContext,t=_k.t,dimensions=null;if(isUsingCustomDimensions||carrierTemplatewithCustomDimensions){var _l=this.props,formMetaData=_l.formMetaData,formSyncErrors=_l.formSyncErrors,customDimensions=formMetaData.customDimensions,lengthTouched=null===(_a=null==customDimensions?void 0:customDimensions.length)||void 0===_a?void 0:_a.touched,widthTouched=null===(_b=null==customDimensions?void 0:customDimensions.width)||void 0===_b?void 0:_b.touched,heightTouched=null===(_c=null==customDimensions?void 0:customDimensions.height)||void 0===_c?void 0:_c.touched,unitTouched=null===(_d=null==customDimensions?void 0:customDimensions.distanceUnit)||void 0===_d?void 0:_d.touched,errors=null;if(lengthTouched&&(null===(_e=formSyncErrors.customDimensions)||void 0===_e?void 0:_e.length)){var errorMessage=formSyncErrors.customDimensions.length;errors=(0,emotion_react_jsx_runtime_browser_esm.Y)(FormError_FormError.A,{children:errorMessage})}else if(widthTouched&&(null===(_f=formSyncErrors.customDimensions)||void 0===_f?void 0:_f.width)){errorMessage=formSyncErrors.customDimensions.width;errors=(0,emotion_react_jsx_runtime_browser_esm.Y)(FormError_FormError.A,{children:errorMessage})}else if(heightTouched&&(null===(_g=formSyncErrors.customDimensions)||void 0===_g?void 0:_g.height)){errorMessage=formSyncErrors.customDimensions.height;errors=(0,emotion_react_jsx_runtime_browser_esm.Y)(FormError_FormError.A,{children:errorMessage})}else if(unitTouched&&(null===(_h=formSyncErrors.customDimensions)||void 0===_h?void 0:_h.distanceUnit)){errorMessage=formSyncErrors.customDimensions.distanceUnit;errors=(0,emotion_react_jsx_runtime_browser_esm.Y)(FormError_FormError.A,{children:errorMessage})}var renderPrefixWithText=function(text){return function(){return(0,emotion_react_jsx_runtime_browser_esm.Y)(Prefix,{children:text})}};dimensions=carrierTemplatewithCustomDimensions?(0,emotion_react_jsx_runtime_browser_esm.FD)(FormSection.A,(0,tslib_es6.Cl)({name:"customDimensions"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(FieldLabel,{children:t("orders:calculateRates:tabs:shipmentInfo:dimensions")}),(0,emotion_react_jsx_runtime_browser_esm.FD)(FieldsWrapper,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(InputExtendedReduxFormField,{name:"length",component:InputExtendedField,tabIndex:startingTabIndex,renderPrefix:renderPrefixWithText("L"),dataAnalytics:dataAnalyticsContext&&"".concat(dataAnalyticsContext,"PackageInfoCustomDimensions-click-lengthInput"),isResponsive:!0,isRightAligned:!0,inputMode:"decimal"}),(0,emotion_react_jsx_runtime_browser_esm.Y)(XContainer,{children:"X"}),(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{name:"width",hideErrors:!0,component:InputExtendedField,size:constants_form.YI.xs,tabIndex:startingTabIndex,renderPrefix:renderPrefixWithText("W"),isResponsive:!0,isRightAligned:!0,dataAnalytics:dataAnalyticsContext&&"".concat(dataAnalyticsContext,"PackageInfoCustomDimensions-click-widthInput"),dataE2E:"parcel-form-customdims-width",inputMode:"decimal"}),(0,emotion_react_jsx_runtime_browser_esm.Y)(InlineFieldContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{name:"distanceUnit",hideErrors:!0,component:SelectField,height:constants_form.hx.medium,options:options.Ay.distanceOptions,placeholder:"Unit",size:constants_form.YI.xs,tabIndex:startingTabIndex,dataAnalytics:dataAnalyticsContext&&"".concat(dataAnalyticsContext,"PackageInfoCustomDimensions-click-lengthUnitsSelect"),optionDataAnalytics:dataAnalyticsContext&&"".concat(dataAnalyticsContext,"PackageInfoCustomDimensions-click-lengthUnitOption")})})]}),(0,emotion_react_jsx_runtime_browser_esm.Y)(Subtext,{children:t("orders:calculateRates:tabs:shipmentInfo:customDimensionsSubtext")}),errors]})):(0,emotion_react_jsx_runtime_browser_esm.FD)(FormSection.A,(0,tslib_es6.Cl)({name:"customDimensions"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(FieldLabel,{children:t("orders:calculateRates:tabs:shipmentInfo:dimensions")}),(0,emotion_react_jsx_runtime_browser_esm.FD)(FieldsWrapper,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{name:"length",component:InputExtendedField,size:constants_form.YI.xs,hideErrors:!0,autofocus:!0,tabIndex:startingTabIndex,renderPrefix:renderPrefixWithText("L"),isResponsive:!0,isRightAligned:!0,dataE2E:"parcel-form-customdims-length",onKeyDown:allowKeyboardNumberInput,dataAnalytics:dataAnalyticsContext&&"".concat(dataAnalyticsContext,"PackageInfoCustomDimensions-click-lengthInput"),inputMode:"decimal"}),(0,emotion_react_jsx_runtime_browser_esm.Y)(XContainer,{children:"X"}),(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{name:"width",hideErrors:!0,component:InputExtendedField,size:constants_form.YI.xs,tabIndex:startingTabIndex,renderPrefix:renderPrefixWithText("W"),isResponsive:!0,isRightAligned:!0,dataE2E:"parcel-form-customdims-width",onKeyDown:allowKeyboardNumberInput,dataAnalytics:dataAnalyticsContext&&"".concat(dataAnalyticsContext,"PackageInfoCustomDimensions-click-widthInput"),inputMode:"decimal"}),("polymailer"!==(null===(_j=this.state.packageDimensionType)||void 0===_j?void 0:_j.value)||!this.props.shouldShowPolymailer)&&(0,emotion_react_jsx_runtime_browser_esm.FD)(emotion_react_jsx_runtime_browser_esm.FK,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(XContainer,{children:"X"}),(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{name:"height",hideErrors:!0,component:InputExtendedField,size:constants_form.YI.xs,tabIndex:startingTabIndex,renderPrefix:renderPrefixWithText("H"),isResponsive:!0,isRightAligned:!0,dataE2E:"parcel-form-customdims-height",onKeyDown:allowKeyboardNumberInput,dataAnalytics:dataAnalyticsContext&&"".concat(dataAnalyticsContext,"PackageInfoCustomDimensions-click-heightInput"),inputMode:"decimal"})]}),(0,emotion_react_jsx_runtime_browser_esm.Y)(InlineFieldContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{name:"distanceUnit",hideErrors:!0,component:SelectField,height:constants_form.hx.medium,options:options.Ay.distanceOptions,placeholder:"Unit",size:constants_form.YI.xs,tabIndex:startingTabIndex,dataAnalytics:dataAnalyticsContext&&"".concat(dataAnalyticsContext,"PackageInfoCustomDimensions-click-lengthUnitsSelect"),optionDataAnalytics:dataAnalyticsContext&&"".concat(dataAnalyticsContext,"PackageInfoCustomDimensions-click-lengthUnitOption")})})]}),(0,emotion_react_jsx_runtime_browser_esm.Y)(Subtext,{children:t("orders:calculateRates:tabs:shipmentInfo:customDimensionsSubtext")}),errors]}))}else if(selectedParcelTemplate){var dimensionsProvider=(0,ParcelTemplate.MS)(selectedParcelTemplate)&&selectedParcelTemplate.carrierTemplate&&!selectedParcelTemplate.carrierTemplate.isVariableDimensions?selectedParcelTemplate.carrierTemplate:selectedParcelTemplate;dimensions=(0,emotion_react_jsx_runtime_browser_esm.FD)(Subtext,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"mr-1"},{children:t("orders:calculateRates:tabs:shipmentInfo:dimensionsSubtext")})),(0,emotion_react_jsx_runtime_browser_esm.Y)(FieldsWrapper,{children:(0,ParcelTemplate.$)(dimensionsProvider)})]})}return dimensions},PackageTemplateChooser.prototype.renderWeight=function(){var _a,_b=this.props,startingTabIndex=_b.startingTabIndex,useImportedOrderWeight=_b.useImportedOrderWeight,someOrderHasImportedWeight=_b.someOrderHasImportedWeight,isWeightRequired=_b.isWeightRequired,formMetaData=_b.formMetaData,formSyncErrors=_b.formSyncErrors,importedWeight=_b.importedWeight,dataAnalyticsContext=_b.dataAnalyticsContext,t=_b.t,label="".concat(t("orders:calculateRates:tabs:shipmentInfo:packageWeightLabel")).concat(isWeightRequired?"":" (".concat(t("orders:calculateRates:tabs:shipmentInfo:optionalLabel"),")")),errorMessage=formSyncErrors.weight||formSyncErrors.weightUnit,errors=(null===(_a=null==formMetaData?void 0:formMetaData.weight)||void 0===_a?void 0:_a.touched)&&errorMessage?(0,emotion_react_jsx_runtime_browser_esm.Y)(FormError_FormError.A,{children:errorMessage}):null,importedWeightIsNaN=isNaN(Number(importedWeight));return(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(FieldLabel,{children:label}),(0,emotion_react_jsx_runtime_browser_esm.FD)(FieldsWrapper,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{name:"weight",inputRef:this.weightInput,component:InputExtendedField,placeholder:importedWeightIsNaN&&importedWeight||"Weight",size:constants_form.YI.xs,autofocus:!0,disabled:useImportedOrderWeight,tabIndex:startingTabIndex,dataPendo:"package-weight",hideErrors:!0,isResponsive:!0,isRightAligned:!0,dataE2E:"parcel-form-weight",onKeyDown:allowKeyboardNumberInput,dataAnalytics:dataAnalyticsContext&&"".concat(dataAnalyticsContext,"PackageInfo-click-weightInput"),inputMode:"decimal"}),(0,emotion_react_jsx_runtime_browser_esm.Y)(InlineFieldContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{name:"weightUnit",component:SelectField,height:constants_form.hx.medium,options:options.Ay.weightOptions,placeholder:"Unit",size:constants_form.YI.xs,disabled:useImportedOrderWeight,tabIndex:startingTabIndex,dataPendo:"package-weight-unit",dataAnalytics:dataAnalyticsContext&&"".concat(dataAnalyticsContext,"PackageInfo-click-weightUnitSelect"),optionDataAnalytics:dataAnalyticsContext&&"".concat(dataAnalyticsContext,"PackageInfo-click-weightUnitOption"),hideErrors:!0})}),someOrderHasImportedWeight&&(0,emotion_react_jsx_runtime_browser_esm.Y)(InlineFieldContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{name:"useImportedOrderWeight",component:Checkbox.Yh,labelPosition:"right",label:(0,emotion_react_jsx_runtime_browser_esm.Y)(MaxContentLabel,{children:t("orders:calculateRates:tabs:shipmentInfo:useImportedWeight")}),size:constants_form.YI.xs,tabIndex:startingTabIndex,dataPendo:"package-use-imported-weight",dataAnalytics:dataAnalyticsContext&&"".concat(dataAnalyticsContext,"PackageInfo-click-importedWeightCheckbox"),onChange:this.onUseImportedWeightChange})})]}),errors,(0,emotion_react_jsx_runtime_browser_esm.Y)(Subtext,{children:t("orders:calculateRates:tabs:shipmentInfo:includesPackaging")})]})},PackageTemplateChooser.prototype.render=function(){return(0,emotion_react_jsx_runtime_browser_esm.Y)(emotion_react_jsx_runtime_browser_esm.FK,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{name:"parcelTemplate",component:ParcelSelectFieldContainer,onCustomDimensionsSelected:this.handleCustomDimensionsSelected,isUsingCustomDimensions:this.props.isUsingCustomDimensions,onChange:this.onParcelTemplateSelected,disabled:this.props.disableDropdown,omitCustomParcelTemplate:this.props.editingCustomTemplate,tabIndex:this.props.startingTabIndex,dataPendo:"package-select",showZeroState:this.props.showZeroState,dataAnalyticsContext:this.props.dataAnalyticsContext&&"".concat(this.props.dataAnalyticsContext,"PackageInfo"),appLocation:this.props.appLocation}),this.state.shouldShowRadioGroup&&this.props.shouldShowPolymailer&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{name:"packageDimensionType",component:PackageTemplateChooser_PackageTemplateRadioGroup,options:this.packageTypesOptions,onChangeCallback:this.packageTemplateRadioChange,dimensionType:this.state.packageDimensionType?this.state.packageDimensionType:this.packageTypesOptions[0]}),this.renderDimensions(),this.renderWeight()]})})},PackageTemplateChooser}(react.Component);const PackageTemplateChooser_PackageTemplateChooser=(0,redux.Zz)((0,es.Ng)((function(state,ownProps){var _a,_b,_c,formValues=(0,getFormValues.A)(ownProps.formName)(state);return(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},(0,user_selectors.Og)(state)),{formMetaData:(0,getFormMeta.A)(ownProps.formName)(state),formSyncErrors:(0,getFormSyncErrors.A)(ownProps.formName)(state),isUsingCustomDimensions:(null===(_a=null==formValues?void 0:formValues.extras)||void 0===_a?void 0:_a.isUsingCustomDimensions)||!1,selectedParcelTemplate:(null==formValues?void 0:formValues.parcelTemplate)||null,getCurrentDistanceUnit:(null===(_b=null==formValues?void 0:formValues.customDimensions)||void 0===_b?void 0:_b.distanceUnit)||null,useImportedOrderWeight:(null==formValues?void 0:formValues.useImportedOrderWeight)||!1,carrierTemplatewithCustomDimensions:(null===(_c=null==formValues?void 0:formValues.extras)||void 0===_c?void 0:_c.carrierTemplateWithCustomDimensions)||!1})}),(function(dispatch,ownProps){return{fetchParcelTemplates:function(){return dispatch(parcel_template_actions_fetchParcelTemplates())},fetchCarrierParcelTemplates:function(){return dispatch(function parcel_template_actions_fetchCarrierParcelTemplates(){return{type:constants.t.CARRIER_PARCEL_TEMPLATE_FETCH}}())},onCustomDimensionsSelected:function(selected){return dispatch((0,redux_form_es.Zg)(ownProps.formName,"extras.isUsingCustomDimensions",selected))},onCarrierTemplateWithCustomDimensionsSelected:function(selected){return dispatch((0,redux_form_es.Zg)(ownProps.formName,"extras.carrierTemplateWithCustomDimensions",selected))},changePackageWeight:function(packageWeight){return dispatch((0,redux_form_es.Zg)(ownProps.formName,"weight",packageWeight))},changePackageDimenstionType:function(packageDimensionType){return dispatch((0,redux_form_es.Zg)(ownProps.formName,"packageDimensionType",packageDimensionType))},changePackageWeightUnit:function(packageWeightUnitOption){return dispatch((0,redux_form_es.Zg)(ownProps.formName,"weightUnit",packageWeightUnitOption))},changeParcelTemplateName:function(parcelTemplateName){return dispatch((0,redux_form_es.Zg)(ownProps.formName,"parcelTemplateName",parcelTemplateName))},changePackageTemplateIsSetDefault:function(isDefault){return dispatch((0,redux_form_es.Zg)(ownProps.formName,"isDefault",isDefault))},changeIsWeightRequired:function(isWeightRequired){return dispatch((0,redux_form_es.Zg)(ownProps.formName,"extras.isWeightRequired",isWeightRequired))},changePackageForm:function(formValues){dispatch((0,redux_form_es.n_)(ownProps.formName,formValues))},changePackageHeight:function(heightValue){return dispatch((0,redux_form_es.Zg)(ownProps.formName,"customDimensions.height",heightValue))},changeUseImportedWeight:function(useImportedWeight){return dispatch((0,redux_form_es.Zg)(ownProps.formName,"useImportedOrderWeight",useImportedWeight))},removeSelectedParcelTemplate:function(){return dispatch((0,redux_form_es.Zg)(ownProps.formName,"parcelTemplate",null))}}})),(0,utils_translate.Tl)("orders"))(PackageTemplateChooser);var PackageTemplateChooser_templateObject_1,PackageTemplateChooser_templateObject_2,PackageTemplateChooser_templateObject_3,PackageTemplateChooser_templateObject_4,PackageTemplateChooser_templateObject_5,PackageTemplateChooser_templateObject_6,recipientTypeOptions=[{value:"CONSUMER",label:"Consumer"},{value:"LICENSEE",label:"Licensee"}],distance=__webpack_require__("./app/constants/distance.ts"),weight=__webpack_require__("./app/constants/weight.ts");function getInitialFormValues(templateData,userConfigDefaults,batchEntry,initialExtrasValues,useImportedWeight,initialWeight){var _a,_b;void 0===useImportedWeight&&(useImportedWeight=!1),void 0===initialWeight&&(initialWeight="");var fallbackMassUnit=userConfigDefaults.defaultMassUnit||weight.VV.LB,fallbackDistanceUnit=userConfigDefaults.defaultDistanceUnit||distance.k.IN,inBatchMode=!batchEntry,packageWeight=null===(_a=null==batchEntry?void 0:batchEntry.parcel)||void 0===_a?void 0:_a.weight,packageWeightUnit=(null===(_b=null==batchEntry?void 0:batchEntry.parcel)||void 0===_b?void 0:_b.weightUnit)||weight.VV.LB,extrasInitialFormValues={alcohol:(null==initialExtrasValues?void 0:initialExtrasValues.alcohol)||{containsAlcohol:!1,recipientType:recipientTypeOptions[0]},dryIce:(null==initialExtrasValues?void 0:initialExtrasValues.dryIce)||{containsDryIce:!1,weight:"",weightUnitId:weight.FU[userConfigDefaults.defaultMassUnit||weight.VV.LB],packageWeight:inBatchMode?void 0:packageWeight,packageWeightUnit,inBatchMode},hazmat:{containsHazmat:!!(null==initialExtrasValues?void 0:initialExtrasValues.hazmat.containsHazmat),containsBiologicalMaterial:!!(null==initialExtrasValues?void 0:initialExtrasValues.hazmat.containsBiologicalMaterial),containsLithiumBatteries:!!(null==initialExtrasValues?void 0:initialExtrasValues.hazmat.containsLithiumBatteries)},isReturnRequested:(null==initialExtrasValues?void 0:initialExtrasValues.isReturnRequested)||!1};return templateData?(0,tslib_es6.Cl)({parcelTemplate:templateData.objectId?templateData:templateData.carrierTemplate,weight:templateData.weight?templateData.weight.toString():"",weightUnit:options.Ay.commonWeightOptions[templateData.weightUnit||fallbackMassUnit],customDimensions:{width:templateData.width.toString(),length:templateData.length.toString(),height:templateData.height.toString(),distanceUnit:options.Ay.commonDistanceOptions[templateData.distanceUnit||fallbackDistanceUnit]},extras:{isUsingCustomDimensions:!(templateData.objectId||templateData.carrierTemplate),carrierTemplateWithCustomDimensions:!(!templateData.carrierTemplate||!templateData.carrierTemplate.isVariableDimensions||templateData.objectId)},useImportedOrderWeight:useImportedWeight},extrasInitialFormValues):(0,tslib_es6.Cl)({parcelTemplate:null,weight:isNaN(Number(initialWeight))?"":initialWeight,weightUnit:options.Ay.commonWeightOptions[fallbackMassUnit],packageDimensionType:null,customDimensions:{width:"",length:"",height:"",distanceUnit:options.Ay.commonDistanceOptions[fallbackDistanceUnit]},extras:{isUsingCustomDimensions:!0,carrierTemplateWithCustomDimensions:!1},useImportedOrderWeight:useImportedWeight},extrasInitialFormValues)}var dist_es=__webpack_require__("./node_modules/i18next/dist/es/index.js"),isNil=__webpack_require__("./node_modules/ramda/es/isNil.js"),validations=__webpack_require__("./app/utils/validations.ts"),validateExtras=function(values){var errors={dryIce:null};return values.dryIce?(errors.dryIce=function(values){var t,path,dryIceErrTranslations={WeightErr:(t=dist_es.t)("".concat(path="orders:additionalServices:errs:dryIce",":weightGtZero")),PackageInfoMissingErr:t("".concat(path,":missingPackageInfo")),GreaterThanPackageWeightErr:t("".concat(path,":dryIceGtPackageWeight"))},weight=values.weight,dryIceForm=values.dryIce,packageWeight=weight||dryIceForm.packageWeight;if(dryIceForm.containsDryIce){if(!dryIceForm.weight||!(0,validations.aM)(dryIceForm.weight)||!(0,validations.EA)(dryIceForm.weight)||parseFloat(dryIceForm.weight)<=0)return{weight:dryIceErrTranslations.WeightErr};if(dryIceForm.inBatchMode)return null;if((0,isNil.A)(packageWeight))return{weight:dryIceErrTranslations.PackageInfoMissingErr};if(Number.parseFloat(dryIceForm.weight)>Number.parseFloat(packageWeight))return{weight:dryIceErrTranslations.GreaterThanPackageWeightErr}}return null}(values),errors):errors};const PackageTemplateChooser_validate=function(values){var errors={weight:null,weightUnit:null,parcelTemplate:null,customDimensions:{width:null,length:null,height:null}};if(values.parcelTemplate||!values.extras||values.extras.isUsingCustomDimensions||(errors.parcelTemplate="Please select a parcel template or enter custom dimensions."),values.extras&&values.extras.isWeightRequired&&!values.weight&&!values.useImportedOrderWeight&&(errors.weight="Please enter the package weight"),values.weight&&!(0,validations.M3)(values.weight,4)&&(errors.weight="Weight must not be more than 4 decimal places (ex. 0.0001)"),!values.weight||(0,validations.aM)(values.weight)&&(0,validations.EA)(values.weight)||(errors.weight="Weight must be greater than 0"),values.weight&&!values.weightUnit&&(errors.weightUnit="Please select a weight unit"),values.extras&&values.extras.isUsingCustomDimensions&&values.customDimensions&&(values.customDimensions.width?(!(0,validations.aM)(values.customDimensions.width)||+values.customDimensions.width<=0)&&(errors.customDimensions.width="Width must be greater than 0"):errors.customDimensions.width="Width is required",values.customDimensions.length?(!(0,validations.aM)(values.customDimensions.length)||+values.customDimensions.length<=0)&&(errors.customDimensions.length="Length must be greater than 0"):errors.customDimensions.length="Length is required",values.customDimensions.height?(!(0,validations.aM)(values.customDimensions.height)||+values.customDimensions.height<=0)&&(errors.customDimensions.height="Height must be greater than 0"):errors.customDimensions.height="Height is required",values.customDimensions.distanceUnit||(errors.customDimensions.distanceUnit="Please select a distance unit")),values.extras&&values.customDimensions&&values.extras.carrierTemplateWithCustomDimensions&&(values.customDimensions.width?(!(0,validations.aM)(values.customDimensions.width)||+values.customDimensions.width<=0)&&(errors.customDimensions.width="Width must be greater than 0"):errors.customDimensions.width="Width is required",values.customDimensions.length?(!(0,validations.aM)(values.customDimensions.length)||+values.customDimensions.length<=0)&&(errors.customDimensions.length="Length must be greater than 0"):errors.customDimensions.length="Length is required",values.parcelTemplate&&("Soft Pack"===values.parcelTemplate.name||(0,ParcelTemplate.MS)(values.parcelTemplate)&&values.parcelTemplate.carrierTemplate&&"Soft Pack"===values.parcelTemplate.carrierTemplate.name))){var sumLengthWidth=+values.customDimensions.length+ +values.customDimensions.width;values.customDimensions.distanceUnit.value.toString()===distance.k.IN?(+values.customDimensions.length>18?errors.customDimensions.length="For USPS Soft Pack, length cannot be greater than 18 inches":+values.customDimensions.width>18&&(errors.customDimensions.width="For USPS Soft Pack, width cannot be greater than 18 inches"),sumLengthWidth>36&&(errors.customDimensions.length=errors.customDimensions.width="The combined length and width cannot exceed 36 inches. For Soft Packs that exceed 36 inches, please use Custom Dimensions.")):values.customDimensions.distanceUnit.value.toString()===distance.k.CM&&(+values.customDimensions.length>45.72?errors.customDimensions.length="For USPS Soft Pack, length cannot be greater than 45.72 cm":+values.customDimensions.width>45.72&&(errors.customDimensions.width="For USPS Soft Pack, width cannot be greater than 45.72 cm"),sumLengthWidth>91.44&&(errors.customDimensions.length=errors.customDimensions.width="The combined length and width cannot exceed 91.44 cm. For Soft Packs that exceed 91.44 cm, please use Custom Dimensions."))}return errors};var AdditionalServicesFormStyles_templateObject_1,AdditionalServicesFormStyles_templateObject_2,AdditionalServicesFormStyles_templateObject_3,AdditionalServicesFormStyles_templateObject_4,AdditionalServicesFormStyles_templateObject_5,AdditionalServicesFormStyles_templateObject_6,AdditionalServicesFormStyles_templateObject_7,AdditionalServicesFormStyles_templateObject_8,AdditionalServicesFormStyles_templateObject_9,AdditionalServicesFormStyles_templateObject_10,Typography=__webpack_require__("./node_modules/@goshippo/components/esm/Typography/Typography.js"),shippoTheme=__webpack_require__("./node_modules/@goshippo/components/esm/styles/shippoTheme.js"),TextField=__webpack_require__("./node_modules/@goshippo/components/esm/TextField/TextField.js"),MenuItem=__webpack_require__("./node_modules/@goshippo/components/esm/MenuItem/MenuItem.js"),Divider=__webpack_require__("./node_modules/@goshippo/components/esm/Divider/Divider.js"),components_Checkbox=__webpack_require__("./app/components/Checkbox/index.ts"),Input=__webpack_require__("./app/components/Input/index.ts"),hazmatHelpUrl="https://support.goshippo.com/hc/en-us/articles/15969609312539-How-to-Ship-HAZMAT-with-USPS",DryIceWeightContainer=((0,emotion_styled_browser_esm.A)("div")(AdditionalServicesFormStyles_templateObject_1||(AdditionalServicesFormStyles_templateObject_1=(0,tslib_es6.ue)(["\n  margin-top: 0.5rem;\n  font-size: 0.875rem;\n"],["\n  margin-top: 0.5rem;\n  font-size: 0.875rem;\n"]))),(0,emotion_styled_browser_esm.A)("div")(AdditionalServicesFormStyles_templateObject_2||(AdditionalServicesFormStyles_templateObject_2=(0,tslib_es6.ue)(["\n  width: 9.375rem;\n"],["\n  width: 9.375rem;\n"])))),Subsection=((0,emotion_styled_browser_esm.A)("div")(AdditionalServicesFormStyles_templateObject_3||(AdditionalServicesFormStyles_templateObject_3=(0,tslib_es6.ue)(["\n  margin-top: 0.3125rem;\n  margin-bottom: 0.9375rem;\n"],["\n  margin-top: 0.3125rem;\n  margin-bottom: 0.9375rem;\n"]))),(0,emotion_styled_browser_esm.A)("p")(AdditionalServicesFormStyles_templateObject_4||(AdditionalServicesFormStyles_templateObject_4=(0,tslib_es6.ue)(["\n  margin: 0.3125rem 0 0 0;\n  font-size: 0.75rem;\n  color: ",";\n"],["\n  margin: 0.3125rem 0 0 0;\n  font-size: 0.75rem;\n  color: ",";\n"])),styles_constants.Tj.form.fontColor),(0,emotion_styled_browser_esm.A)("div")(AdditionalServicesFormStyles_templateObject_5||(AdditionalServicesFormStyles_templateObject_5=(0,tslib_es6.ue)(["\n  color: ",";\n  font-size: 0.75rem;\n  line-height: 1.125rem;\n  font-weight: ",";\n"],["\n  color: ",";\n  font-size: 0.75rem;\n  line-height: 1.125rem;\n  font-weight: ",";\n"])),styles_constants.Tj.gray300,styles_constants.Wy.medium),(0,emotion_styled_browser_esm.A)("div")(AdditionalServicesFormStyles_templateObject_6||(AdditionalServicesFormStyles_templateObject_6=(0,tslib_es6.ue)(["\n  color: ",";\n  font-size: 0.75rem;\n  line-height: 1.25rem;\n"],["\n  color: ",";\n  font-size: 0.75rem;\n  line-height: 1.25rem;\n"])),styles_constants.Tj.gray500),(0,emotion_styled_browser_esm.A)("div")(AdditionalServicesFormStyles_templateObject_7||(AdditionalServicesFormStyles_templateObject_7=(0,tslib_es6.ue)(["\n  margin-top: 0.25rem;\n  padding-left: 1.5rem;\n\n  label {\n    padding: 2px 0;\n  }\n"],["\n  margin-top: 0.25rem;\n  padding-left: 1.5rem;\n\n  label {\n    padding: 2px 0;\n  }\n"])))),DisclaimerText=((0,emotion_styled_browser_esm.A)("div")(AdditionalServicesFormStyles_templateObject_8||(AdditionalServicesFormStyles_templateObject_8=(0,tslib_es6.ue)(["\n  text-align: right;\n  padding-top: 0.75rem;\n"],["\n  text-align: right;\n  padding-top: 0.75rem;\n"]))),(0,emotion_styled_browser_esm.A)(components_Button.vM)(AdditionalServicesFormStyles_templateObject_9||(AdditionalServicesFormStyles_templateObject_9=(0,tslib_es6.ue)(["\n  margin-right: 0.625rem;\n"],["\n  margin-right: 0.625rem;\n"]))),(0,emotion_styled_browser_esm.A)("div")(AdditionalServicesFormStyles_templateObject_10||(AdditionalServicesFormStyles_templateObject_10=(0,tslib_es6.ue)(["\n  font-size: 0.75rem;\n"],["\n  font-size: 0.75rem;\n"])))),Fields=__webpack_require__("./node_modules/redux-form/es/Fields.js"),props_selectors=__webpack_require__("./app/selectors/props.selectors.ts"),lib=__webpack_require__("./node_modules/qs/lib/index.js"),getLocation=(0,reselect_es.createSelector)((function(state){return state.router}),(function(routerStore){return routerStore.location})),getQS=(0,reselect_es.createSelector)(getLocation,(function(location){return location.search})),getParsedQS=(0,reselect_es.createSelector)(getQS,(function(querystring){return lib.parse(querystring.substring(1))})),getPathname=(0,reselect_es.createSelector)(getLocation,(function(location){return location.pathname})),getQSResults=(0,reselect_es.createSelector)(getParsedQS,(function(queryParams){return queryParams.results})),getQSHidden=(0,reselect_es.createSelector)(getParsedQS,(function(queryParams){return!!queryParams.hidden})),getQSOrderStatus=(0,reselect_es.createSelector)(getParsedQS,(function(queryParams){return queryParams.order_status})),getQSSortBy=((0,reselect_es.createSelector)(getParsedQS,(function(queryParams){return queryParams.sort||""})),(0,reselect_es.createSelector)(getParsedQS,(function(queryParams){return queryParams.sort_by||""}))),getQSOrderBy=(0,reselect_es.createSelector)(getParsedQS,(function(queryParams){return queryParams.order_by||""})),getQSWeightUnit=((0,reselect_es.createSelector)(getParsedQS,(function(queryParams){return Number(queryParams.page||"1")})),(0,reselect_es.createSelector)(getParsedQS,(function(queryParams){return queryParams.weight_unit}))),getQSWeightLt=(0,reselect_es.createSelector)(getParsedQS,(function(queryParams){return queryParams.weight_lt})),getQSWeightGt=(0,reselect_es.createSelector)(getParsedQS,(function(queryParams){return queryParams.weight_gt})),getQSShippingMethod=(0,reselect_es.createSelector)(getParsedQS,(function(queryParams){return queryParams.shipping_method}));var PackageExtrasForm_templateObject_1,PackageExtrasForm_templateObject_2,getQSItem=(0,reselect_es.createSelector)(getParsedQS,(function(queryParams){return function sortedQSitems(items){if(items)return"string"==typeof items?[items]:Array.isArray(items)?items.sort():Object.values(items).sort()}(queryParams.item)})),getQSIsInternational=(0,reselect_es.createSelector)(getParsedQS,(function(queryParams){return queryParams.is_international})),getQSShopApp=(0,reselect_es.createSelector)(getParsedQS,(function(queryParams){return queryParams.shop_app})),getQSStartDate=(0,reselect_es.createSelector)(getParsedQS,(function(queryParams){return queryParams.start_date})),getQSEndDate=(0,reselect_es.createSelector)(getParsedQS,(function(queryParams){return queryParams.end_date})),getQSSaved=(0,reselect_es.createSelector)(getParsedQS,(function(queryParams){return queryParams.saved})),getQSQ=(0,reselect_es.createSelector)(getParsedQS,(function(queryParams){return queryParams.q})),getOrderFiltersValues=(0,reselect_es.createSelector)(getQSIsInternational,getQSShippingMethod,getQSShopApp,getQSStartDate,getQSEndDate,getQSWeightUnit,getQSWeightLt,getQSWeightGt,getQSOrderStatus,getQSQ,getQSSortBy,getQSOrderBy,getQSItem,(function(isInternational,shippingMethod,shopApp,startDate,endDate,weightUnit,weightLt,weightGt,orderStatus,q,SortBy,OrderBy,item){return{order_status:orderStatus,is_international:isInternational,shipping_method:shippingMethod,shop_app:shopApp,start_date:startDate,end_date:endDate,weight_unit:weightUnit,weight_lt:weightLt,weight_gt:weightGt,order_by:OrderBy,sort_by:SortBy,q,item}})),getNotEmptyOrdersFilters=(0,reselect_es.createSelector)(getOrderFiltersValues,(function(ordersFiltersValues){return Object.keys(ordersFiltersValues).filter((function(key){return ordersFiltersValues[key]}))})),getCrossBorderOrdersObjectIds=((0,reselect_es.createSelector)(orders_selectors.SP,getQSResults,(function(totalOrders,fetchCount){return Math.ceil(totalOrders/Number(fetchCount||"25"))})),(0,reselect_es.createSelector)(user_selectors.GA,orders_selectors.Sv,props_selectors.Kz,(function(defaultSenderAddress,orderData,orderIds){return orderIds.filter((function(orderId){return!orderData[orderId]||(0,Order.p2)(orderData[orderId],defaultSenderAddress)}))}))),ExtrasBox=(0,emotion_styled_browser_esm.A)("div")(PackageExtrasForm_templateObject_1||(PackageExtrasForm_templateObject_1=(0,tslib_es6.ue)(["\n  padding: 1rem 1rem 0 0;\n"],["\n  padding: 1rem 1rem 0 0;\n"]))),ExtraContainer=(0,emotion_styled_browser_esm.A)("div")(PackageExtrasForm_templateObject_2||(PackageExtrasForm_templateObject_2=(0,tslib_es6.ue)(["\n  margin-bottom: 0.5rem;\n"],["\n  margin-bottom: 0.5rem;\n"]))),AlcoholFields=function(fields){var t=dist_es.t,submitting=(0,es.d4)((function(state){return(0,isSubmitting.A)(constants_form.n6)(state)}));return(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{id:"package-extras-contains-alcohol",name:"containsAlcohol",component:components_Checkbox.Y,label:t("orders:additionalServices:containsAlcohol"),disabled:submitting,dataAnalytics:"".concat("orders_table_batchBar","ShipmentOptions-click-alcoholCheckbox")}),fields.containsAlcohol.input.value&&(0,emotion_react_jsx_runtime_browser_esm.FD)(Subsection,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,(0,tslib_es6.Cl)({},fields.recipientType.input,{name:"recipientType",component:Radio_RadioField,disabled:submitting,label:t("orders:additionalServices:alcoholRecipientType"),options:recipientTypeOptions,dataAnalytics:"".concat("orders_table_batchBar","ShipmentOptions-click-alcoholRecipiantRadio"),responsive:!0})),(0,emotion_react_jsx_runtime_browser_esm.Y)(DisclaimerText,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(utils_translate.x6,(0,tslib_es6.Cl)({i18nKey:"orders:additionalServices:alcoholDisclaimer"},{children:["Compliant account with UPS or FedEx is required. For more info,",(0,emotion_react_jsx_runtime_browser_esm.Y)(Link.tp,(0,tslib_es6.Cl)({href:"https://support.goshippo.com/hc/en-us/articles/360042823431",target:"_blank",rel:"noreferrer noopener"},{children:"visit our FAQ"})),"."]}))})]})]})},DryIceFields=function(fields){var t=dist_es.t,submitting=(0,es.d4)((function(state){return(0,isSubmitting.A)(constants_form.n6)(state)})),defaultMassUnit=(0,es.d4)(user_selectors.Og).defaultMassUnit;return(0,emotion_react_jsx_runtime_browser_esm.FD)(emotion_react_jsx_runtime_browser_esm.FK,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{id:"package-extras-contains-dry-ice",name:"containsDryIce",component:components_Checkbox.Y,label:t("orders:additionalServices:dryIce"),disabled:submitting,dataAnalytics:"".concat("orders_table_batchBar","ShipmentOptions-click-dryIceCheckbox"),dataPendo:"service-dry-ice"}),fields.containsDryIce.input.value&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Subsection,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(DryIceWeightContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,(0,tslib_es6.Cl)({},fields.weight.input,{name:"weight",component:Input.FO,disabled:submitting,placeholder:t("orders:additionalServices:dryIceInputPlaceholder"),label:"".concat(t("orders:additionalServices:dryIceInputLabel")," (").concat(defaultMassUnit,")"),labelProps:{required:!0},responsive:!0,dataAnalytics:"".concat("orders_table_batchBar","ShipmentOptions-input-dryIceWeight"),dataPendo:"dry-ice-weight"}))})})]})},HazmatFields=function(fields){var _a,t=dist_es.t,submitting=(0,es.d4)((function(state){return(0,isSubmitting.A)(constants_form.n6)(state)})),formValues=(0,es.d4)((function(state){return(0,getFormValues.A)(constants_form.n6)(state)})),showReturnLabelClassification=!!formValues.isReturnRequested&&!!(null===(_a=formValues.hazmat)||void 0===_a?void 0:_a.containsHazmat);react.useEffect((function(){fields.containsBiologicalMaterial.input.onChange(!!fields.containsBiologicalMaterial.input.value&&showReturnLabelClassification)}),[showReturnLabelClassification]),react.useEffect((function(){fields.containsLithiumBatteries.input.onChange(!1)}),[]);return(0,emotion_react_jsx_runtime_browser_esm.FD)(emotion_react_jsx_runtime_browser_esm.FK,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{id:"package-extras-contains-hazmat",name:"containsHazmat",component:components_Checkbox.Y,label:t("orders:additionalServices:hazmat"),disabled:submitting,dataAnalytics:"".concat("orders_table_batchBar","ShipmentOptions-click-hazmatCheckbox")}),(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,(0,tslib_es6.Cl)({style:{display:"none"}},fields.containsBiologicalMaterial.input,{id:"package-extras-contains-hazmat-biomat",name:"containsBiologicalMaterial",component:"input",type:"checkbox",label:"hazmat biomat",disabled:submitting})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,(0,tslib_es6.Cl)({style:{display:"none"}},fields.containsLithiumBatteries.input,{id:"package-extras-contains-hazmat-biomat",name:"containsLithiumBatteries",component:"input",type:"checkbox",label:"hazmat lithium bat",disabled:submitting,checked:!1})),(0,emotion_react_jsx_runtime_browser_esm.FD)(Subsection,{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(Typography.A,(0,tslib_es6.Cl)({variant:"caption",component:"p",sx:{fontSize:shippoTheme.A.spacing(1.75),color:styles_constants.Tj.gray700}},{children:[t("orders:additionalServices:hazmatSubtext"),(0,emotion_react_jsx_runtime_browser_esm.Y)("a",(0,tslib_es6.Cl)({target:"_blank",rel:"noreferrer",href:hazmatHelpUrl,style:{marginLeft:shippoTheme.A.spacing(.5),color:styles_constants.Tj.primary,fontSize:shippoTheme.A.spacing(1.75)}},{children:t("orders:additionalServices:hazmatLearnMore")}))]})),showReturnLabelClassification&&(0,emotion_react_jsx_runtime_browser_esm.FD)(TextField.A,(0,tslib_es6.Cl)({sx:{marginTop:shippoTheme.A.spacing(2)},select:!0,disabled:submitting,required:!0,onChange:function(event){fields.containsBiologicalMaterial.input.onChange("true"===event.target.value)},fullWidth:!0,value:(!!fields.containsBiologicalMaterial.input.value).toString(),label:t("orders:additionalServices:returnLabelClassificationField")},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(MenuItem.A,(0,tslib_es6.Cl)({value:"false"},{children:t("orders:additionalServices:generalHazmat")})),(0,emotion_react_jsx_runtime_browser_esm.Y)(MenuItem.A,(0,tslib_es6.Cl)({value:"true"},{children:t("orders:additionalServices:biologicalMaterial")}))]}))]})]})},HazmatCrossBorderFields=function(fields){var t=dist_es.t,submitting=(0,es.d4)((function(state){return(0,isSubmitting.A)(constants_form.n6)(state)}));return react.useEffect((function(){fields.containsLithiumBatteries.input.onChange(!!fields.containsHazmat.input.value)}),[fields.containsHazmat.input.value]),react.useEffect((function(){fields.containsBiologicalMaterial.input.onChange(!1)}),[]),(0,emotion_react_jsx_runtime_browser_esm.FD)(emotion_react_jsx_runtime_browser_esm.FK,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{id:"package-extras-contains-hazmat",name:"containsHazmat",component:components_Checkbox.Y,label:t("orders:additionalServices:lithiumBatteries"),disabled:submitting,dataAnalytics:"".concat("orders_table_batchBar","ShipmentOptions-click-hazmatCheckbox"),value:fields.containsHazmat.input.value}),(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,(0,tslib_es6.Cl)({style:{display:"none"}},fields.containsBiologicalMaterial.input,{id:"package-extras-contains-hazmat-biomat",name:"containsBiologicalMaterial",component:"input",type:"checkbox",label:"hazmat biomat",checked:!1,disabled:submitting})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,(0,tslib_es6.Cl)({style:{display:"none"}},fields.containsLithiumBatteries.input,{id:"package-extras-contains-hazmat-biomat",name:"containsLithiumBatteries",component:"input",type:"checkbox",label:"hazmat lithium bat",disabled:submitting})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Subsection,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(Typography.A,(0,tslib_es6.Cl)({variant:"caption",component:"p",sx:{color:styles_constants.Tj.gray700,fontSize:shippoTheme.A.spacing(1.75)}},{children:[t("orders:additionalServices:hazmatSubtext"),(0,emotion_react_jsx_runtime_browser_esm.Y)("a",(0,tslib_es6.Cl)({target:"_blank",rel:"noreferrer",href:hazmatHelpUrl,style:{marginLeft:shippoTheme.A.spacing(.5),color:styles_constants.Tj.forest700,fontSize:shippoTheme.A.spacing(1.75)}},{children:t("orders:additionalServices:hazmatLearnMore")}))]}))})]})},HazmatFieldsDisabled=function(fields){var t=dist_es.t;return(0,emotion_react_jsx_runtime_browser_esm.FD)(emotion_react_jsx_runtime_browser_esm.FK,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{id:"package-extras-contains-hazmat",name:"containsHazmat",component:components_Checkbox.Y,label:t("orders:additionalServices:hazmat"),disabled:!0,dataAnalytics:"".concat("orders_table_batchBar","ShipmentOptions-click-hazmatCheckbox"),checked:!1}),(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,(0,tslib_es6.Cl)({style:{display:"none"}},fields.containsBiologicalMaterial.input,{id:"package-extras-contains-hazmat-biomat",name:"containsBiologicalMaterial",component:"input",type:"checkbox",label:"hazmat biomat",checked:!1})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,(0,tslib_es6.Cl)({style:{display:"none"}},fields.containsLithiumBatteries.input,{id:"package-extras-contains-hazmat-biomat",name:"containsLithiumBatteries",component:"input",type:"checkbox",label:"hazmat lithium bat",checked:!1}))]})},HazmatFieldsDisabledCrossBorder=function(fields){var t=dist_es.t;return(0,emotion_react_jsx_runtime_browser_esm.FD)(emotion_react_jsx_runtime_browser_esm.FK,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{id:"package-extras-contains-hazmat",name:"containsHazmat",component:components_Checkbox.Y,label:t("orders:additionalServices:lithiumBatteries"),disabled:!0,dataAnalytics:"".concat("orders_table_batchBar","ShipmentOptions-click-hazmatCheckbox"),checked:!1}),(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,(0,tslib_es6.Cl)({style:{display:"none"}},fields.containsBiologicalMaterial.input,{id:"package-extras-contains-hazmat-biomat",name:"containsBiologicalMaterial",component:"input",type:"checkbox",label:"hazmat biomat",checked:!1})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,(0,tslib_es6.Cl)({style:{display:"none"}},fields.containsLithiumBatteries.input,{id:"package-extras-contains-hazmat-biomat",name:"containsLithiumBatteries",component:"input",type:"checkbox",label:"hazmat lithium bat",checked:!1}))]})},HazmatFieldWrapper=function(_a){var crossBorderOrderObjectIds=_a.crossBorderOrderObjectIds,disableHazmat=_a.disableHazmat,isInternational=crossBorderOrderObjectIds.length>0;return(0,emotion_react_jsx_runtime_browser_esm.Y)(FormSection.A,(0,tslib_es6.Cl)({name:"hazmat",disa:!0},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Fields.A,{names:["containsHazmat","containsBiologicalMaterial","containsLithiumBatteries"],component:disableHazmat?isInternational?HazmatFieldsDisabledCrossBorder:HazmatFieldsDisabled:isInternational?HazmatCrossBorderFields:HazmatFields})}))},IsReturnRequested=function(_a){var orderObjectIds=_a.orderObjectIds,crossBorderOrderObjectIds=_a.crossBorderOrderObjectIds,t=dist_es.t,isDisabled=(0,react.useMemo)((function(){return crossBorderOrderObjectIds.length===orderObjectIds.length}),[crossBorderOrderObjectIds,orderObjectIds]),tooltipText=(0,react.useMemo)((function(){return crossBorderOrderObjectIds.length>0&&crossBorderOrderObjectIds.length<orderObjectIds.length?t("orders:additionalServices:notEligibleForReturnBulk"):1===orderObjectIds.length&&isDisabled?t("orders:additionalServices:notEligibleForReturn"):void 0}),[crossBorderOrderObjectIds,orderObjectIds,isDisabled]);return(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{id:"package-extras-is-return-requested",name:"isReturnRequested",component:components_Checkbox.Y,label:t("orders:additionalServices:returns"),tooltipText,disabled:isDisabled,dataAnalytics:"".concat("orders_table_batchBar","ShipmentOptions-click-returnLabelCheckbox"),dataPendo:"service-return-label"})},PackageExtrasForm=function(_a){var orderSelection=_a.orderSelection,orderObjectIds=(0,react.useMemo)((function(){return orderSelection?Object.keys(orderSelection):[]}),[orderSelection]),crossBorderOrderObjectIds=(0,es.d4)((function(state){return getCrossBorderOrdersObjectIds(state,{orderObjectIds})})),batchEntryIds=[];orderObjectIds.forEach((function(orderObjectId){batchEntryIds=(0,tslib_es6.fX)((0,tslib_es6.fX)([],(0,tslib_es6.zs)(batchEntryIds),!1),(0,tslib_es6.zs)(orderSelection[orderObjectId]),!1)}));var batchEntries=(0,es.d4)((function(state){return(0,batch_entry_selectors.uq)(state,{batchEntryIds})})),disableHazmat=(0,react.useMemo)((function(){var _a,_b;if(1===batchEntries.length)return!1;for(var i=1;i<batchEntries.length;i++)if(!(0,lodash.isEqual)(null===(_a=batchEntries[i].extras)||void 0===_a?void 0:_a.hazmat,null===(_b=batchEntries[i-1].extras)||void 0===_b?void 0:_b.hazmat))return!0;return!1}),[batchEntries]);return(0,emotion_react_jsx_runtime_browser_esm.FD)(emotion_react_jsx_runtime_browser_esm.FK,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Divider.A,{style:{padding:"0.5rem"}}),(0,emotion_react_jsx_runtime_browser_esm.FD)(ExtrasBox,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(ExtraContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(FormSection.A,(0,tslib_es6.Cl)({name:"alcohol"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Fields.A,{names:["containsAlcohol","recipientType"],component:AlcoholFields})}))}),(0,emotion_react_jsx_runtime_browser_esm.Y)(ExtraContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(FormSection.A,(0,tslib_es6.Cl)({name:"dryIce"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Fields.A,{names:["containsDryIce","weight"],component:DryIceFields})}))}),(0,emotion_react_jsx_runtime_browser_esm.Y)(ExtraContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(IsReturnRequested,{orderObjectIds,crossBorderOrderObjectIds})}),(0,emotion_react_jsx_runtime_browser_esm.Y)(ExtraContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(HazmatFieldWrapper,{orderObjectIds,disableHazmat,crossBorderOrderObjectIds})})]})]})},reduxForm=__webpack_require__("./node_modules/redux-form/es/reduxForm.js"),ParcelBox=(0,emotion_styled_browser_esm.A)(Modal.A.Body)(ParcelForm_templateObject_1||(ParcelForm_templateObject_1=(0,tslib_es6.ue)(["\n  ",";\n"],["\n  ",";\n"])),(function(props){return props.insideCard&&"padding: 0"})),formTabIndex_parcelSelector=1,ParcelForm=function(_super){function ParcelForm(){return null!==_super&&_super.apply(this,arguments)||this}return(0,tslib_es6.C6)(ParcelForm,_super),ParcelForm.prototype.componentDidUpdate=function(prevProps){this.props.onSuccess&&prevProps.submitting&&!this.props.submitting&&this.props.submitSucceeded&&this.props.onSuccess(),this.props.onSuccess&&prevProps.submitting&&!this.props.submitting&&this.props.submitFailed&&this.props.onSuccess(),!prevProps.initialized&&this.props.initialized&&this.props.hasExceededPackageWeightError&&this.props.touch("weight"),prevProps.hasExceededPackageWeightError&&!this.props.hasExceededPackageWeightError&&this.props.change("hasExceededPackageWeightError",!1)},ParcelForm.prototype.render=function(){return(0,emotion_react_jsx_runtime_browser_esm.FD)(ParcelBox,(0,tslib_es6.Cl)({insideCard:this.props.insideCard},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(PackageTemplateChooser_PackageTemplateChooser,{formName:constants_form.n6,disableDropdown:!1,isWeightRequired:!0,startingTabIndex:formTabIndex_parcelSelector,someOrderHasImportedWeight:this.props.someOrderHasImportedWeight,importedWeight:this.props.importedWeight,importedWeightOption:this.props.importedWeightOption,showZeroState:this.props.showZeroState,dataAnalyticsContext:this.props.dataAnalyticsContext,shouldShowPolymailer:!1,appLocation:this.props.appLocation}),this.props.shouldShowParcelExtras&&this.props.orderSelection&&(0,emotion_react_jsx_runtime_browser_esm.Y)(PackageExtrasForm,{orderSelection:this.props.orderSelection})]}))},ParcelForm}(react.Component);const ParcelForm_ParcelForm=(0,redux.Zz)((0,utils_translate.Tl)("orders"),(0,es.Ng)((function(state,ownProps){var batchEntryId=ownProps.batchEntryId,shouldShowParcelExtras=ownProps.shouldShowParcelExtras,batchEntry=(0,batch_entry_selectors.fu)(state,{batchEntryId:Number(batchEntryId)}),userConfigDefaults=(0,user_selectors.Og)(state),initialFormValues=getInitialFormValues(ownProps.existingParcel?(0,Parcel.lL)(ownProps.existingParcel):userConfigDefaults.defaultParcel,userConfigDefaults,batchEntry,ownProps.initialExtrasValues,ownProps.useImportedWeight,ownProps.importedWeight);return initialFormValues.extras.isWeightRequired=!0,{shouldShowParcelExtras,userConfigDefaults,initialValues:(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},initialFormValues),{customItemsTotalWeight:(0,OrderBatchEntry.Ag)(batchEntry),hasExceededPackageWeightError:!!ownProps.hasExceededPackageWeightError})}})),(0,reduxForm.A)({validate:function(values,props){var _a,t=props.t,parcelErrors=PackageTemplateChooser_validate(values),extrasErrors=validateExtras(values),errors=(0,tslib_es6.Cl)((0,tslib_es6.Cl)((0,tslib_es6.Cl)({},parcelErrors),extrasErrors),{alcohol:""});return values.hasExceededPackageWeightError&&!props.anyTouched&&values.weight===props.initialValues.weight&&(errors.weight=t("orders:calculateRates:tabs:shipmentInfo:errors:orderWeightExceeded",{weight:values.customItemsTotalWeight,weightUnit:null===(_a=props.initialValues.weightUnit)||void 0===_a?void 0:_a.value})),errors},form:constants_form.n6,destroyOnUnmount:!0,touchOnChange:!0,onSubmit:function(data,_dispatch,props){return props.handleSubmit(data)}}))(ParcelForm);var ParcelForm_templateObject_1;const All_ParcelForm=ParcelForm_ParcelForm;var segment=__webpack_require__("./app/utils/segment/index.ts"),trackPackageUpdateEvent=function(data,orderSelection,origin,appLocation){var customDimensions=data.customDimensions,parcelTemplate=data.parcelTemplate,is_default=!(!parcelTemplate||!(0,ParcelTemplate.MS)(parcelTemplate))&&parcelTemplate.isDefault,is_saved_package_template=!!parcelTemplate&&(0,ParcelTemplate.MS)(parcelTemplate),is_carrier_package_template=!!parcelTemplate&&!(0,ParcelTemplate.MS)(parcelTemplate),height=(null==parcelTemplate?void 0:parcelTemplate.height)||(null==customDimensions?void 0:customDimensions.height)||0,width=(null==parcelTemplate?void 0:parcelTemplate.width)||(null==customDimensions?void 0:customDimensions.width)||0,length=(null==parcelTemplate?void 0:parcelTemplate.length)||(null==customDimensions?void 0:customDimensions.length)||0,weight=parcelTemplate&&(0,ParcelTemplate.MS)(parcelTemplate)?null==parcelTemplate?void 0:parcelTemplate.weight:data.weight,saved_package_name=!!parcelTemplate&&(null==parcelTemplate?void 0:parcelTemplate.name)||"",type=height&&.25===height?"polymailer":"box",weight_units=parcelTemplate&&(0,ParcelTemplate.MS)(parcelTemplate)?null==parcelTemplate?void 0:parcelTemplate.weightUnit:data.weightUnit.value.toString(),use_item_weight=data.useImportedOrderWeight;(0,utils.f0)(appLocation,segment.sV.package_info_edited,{origin,is_most_recent:!1,is_default,is_saved_package_template,is_carrier_package_template,orders_selected:Object.keys(orderSelection),width,length,weight,saved_package_name,type,weight_units,save_as_template:!1,use_item_weight,is_auto_save:!1})},utils_handleTrackPackageUpdatedOrAdded=function(trackingReference,selectedOrders,batchEntryData,additionalProps){void 0===selectedOrders&&(selectedOrders={});var hasExistingParcel=Object.values(selectedOrders).every((function(batchEntries){var _a;return null===(_a=batchEntryData[batchEntries[0]])||void 0===_a?void 0:_a.parcel}));trackingReference=TrackingHelper.U.amendTrackingReferenceOrders(trackingReference,Object.keys(selectedOrders)),(0,utils.bT)(trackingReference,types.wK.operations.SAVE_ATTEMPTED,additionalProps),hasExistingParcel?(0,utils.bT)(trackingReference,types.wK.operations.UPDATED,additionalProps):(0,utils.bT)(trackingReference,types.wK.operations.ADDED,additionalProps)},ParcelWrapper=(0,emotion_styled_browser_esm.A)("div")(EditParcelOverlayPanel_templateObject_1||(EditParcelOverlayPanel_templateObject_1=(0,tslib_es6.ue)(["\n  width: 405px;\n"],["\n  width: 405px;\n"]))),WeightDimensionsWarningWrapper=(0,emotion_styled_browser_esm.A)("div")(EditParcelOverlayPanel_templateObject_2||(EditParcelOverlayPanel_templateObject_2=(0,tslib_es6.ue)(["\n  display: flex;\n  max-width: 85%;\n  color: ",";\n  font-size: 0.875rem;\n"],["\n  display: flex;\n  max-width: 85%;\n  color: ",";\n  font-size: 0.875rem;\n"])),styles_constants.Tj.gray400),EditParcelOverlayPanel=function(_super){function EditParcelOverlayPanel(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.handleSubmit=function(data){var _a,_b,_c,parcel=(0,Parcel.On)(data),_d=_this.props,order=_d.order,batchEntry=_d.batchEntry,onSubmitForm=_d.onSubmitForm,saveParcel=_d.saveParcel,orderSelection=((_a={})[order.objectId]=batchEntry?[batchEntry.id]:[],_a),trackingReference=TrackingHelper.U.getTrackingReference(types.wK.name,"order_table",{parcelId:null===(_b=null==parcel?void 0:parcel.userParcelTemplate)||void 0===_b?void 0:_b.objectId,isAutoSave:!1,isQuickSelect:!1});return utils_handleTrackPackageUpdatedOrAdded(trackingReference,orderSelection,_this.props.batchEntryData,{parcelId:null===(_c=null==parcel?void 0:parcel.userParcelTemplate)||void 0===_c?void 0:_c.objectId,isAutoSave:!1,isQuickSelect:!1}),onSubmitForm&&(trackPackageUpdateEvent(data,orderSelection,schema.hX,"order_table"),onSubmitForm()),saveParcel(orderSelection,parcel,trackingReference)},_this}return(0,tslib_es6.C6)(EditParcelOverlayPanel,_super),EditParcelOverlayPanel.prototype.render=function(){var _a,_b=this.props,t=_b.t,batchEntry=_b.batchEntry,order=_b.order,dataAnalyticsContext=_b.dataAnalyticsContext,batchEntryLineItems=(null==batchEntry?void 0:batchEntry.lineItems)||[],hasExceededPackageWeightError=!!(null==batchEntry?void 0:batchEntry.errors.find((function(error){return"order_weight_exceeded"===error.code}))),importedWeightOption=order.weightUnit?options.Ay.commonWeightOptions[order.weightUnit]:options.Ay.commonWeightOptions[this.props.defaultMassUnit],partialFulfillmentRequestImportedWeight="";batchEntry&&(partialFulfillmentRequestImportedWeight=(0,OrderBatchEntry.f2)(batchEntryLineItems,order.lineItems).toString());var importedWeight=batchEntry&&batchEntry.partialFulfillmentRank>0?partialFulfillmentRequestImportedWeight:(null===(_a=(0,Order.J_)(order))||void 0===_a?void 0:_a.toString())||"";return(0,emotion_react_jsx_runtime_browser_esm.FD)(ParcelWrapper,(0,tslib_es6.Cl)({className:"space-y-4 p-4"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(components_OrderInfoHeader,{title:t("orders:packageInfo:popupTitle"),required:!((null==batchEntry?void 0:batchEntry.parcel)||order.parcel)}),(0,emotion_react_jsx_runtime_browser_esm.Y)(WeightDimensionsWarningWrapper,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Tabs_PackageWeightDimensionsWarning,{})}),(0,emotion_react_jsx_runtime_browser_esm.Y)(All_ParcelForm,{onSubmit:this.handleSubmit,existingParcel:(null==batchEntry?void 0:batchEntry.parcel)||order.parcel,onCancel:this.props.onCancel,onSuccess:this.props.onSave,useDefault:!0,importedWeight,importedWeightOption,someOrderHasImportedWeight:(0,Order.vz)(order),hasExceededPackageWeightError,useImportedWeight:!!batchEntry&&batchEntry.useImportedWeight,batchEntryId:null==batchEntry?void 0:batchEntry.id,showZeroState:!0,dataAnalyticsContext,insideCard:!0,appLocation:"order_table"}),(0,emotion_react_jsx_runtime_browser_esm.FD)(Modal.A.Footer,(0,tslib_es6.Cl)({noPadding:!0,hideBorder:!0},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Button.vM,(0,tslib_es6.Cl)({onClick:this.props.onCancel,dataPendo:"package-cancel",dataAnalytics:"".concat(dataAnalyticsContext,"PackageInfo-click-cancelButton")},{children:t("phrases.cancel")})),(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Button.jn,(0,tslib_es6.Cl)({onClick:this.props.submitParcelForm,isLoading:this.props.isSubmittingParcelForm,disabled:this.props.isSubmittingParcelForm||this.props.isInvalidParcelForm,dataPendo:"package-save",dataAnalytics:"".concat(dataAnalyticsContext,"PackageInfo-click-saveButton")},{children:t("phrases.save")}))]}))]}))},EditParcelOverlayPanel}(react.Component);const EditParcelOverlayPanel_EditParcelOverlayPanel=(0,redux.Zz)((0,es.Ng)((function(state,ownProps){var order=ownProps.order;return{batchEntry:ownProps.batchEntry||(0,batch_entry_selectors.Dz)(state,{orderObjectId:order.objectId}),isSubmittingParcelForm:(0,isSubmitting.A)(constants_form.n6)(state),isInvalidParcelForm:(0,isInvalid.A)(constants_form.n6)(state),defaultMassUnit:(0,user_selectors.cm)(state),batchEntryData:(0,batch_entry_selectors.zo)(state)}}),(function(dispatch){return{saveParcel:function(orderSelection,parcel,trackingReference){return dispatch((0,orders_actions.$h)(orderSelection,parcel,trackingReference))},submitParcelForm:function(){return dispatch((0,redux_form_es.tA)(constants_form.n6))}}})),(0,utils_translate.Tl)("orders"))(EditParcelOverlayPanel);var EditParcelOverlayPanel_templateObject_1,EditParcelOverlayPanel_templateObject_2;const All_EditParcelOverlayPanel=EditParcelOverlayPanel_EditParcelOverlayPanel;var ParcelName=(0,emotion_styled_browser_esm.A)("div")(OrderParcelInfo_templateObject_1||(OrderParcelInfo_templateObject_1=(0,tslib_es6.ue)(["\n  color: ",";\n  font-size: 0.875rem;\n  font-weight: ",";\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  -webkit-box-orient: vertical;\n  text-overflow: ellipsis;\n  overflow: hidden;\n"],["\n  color: ",";\n  font-size: 0.875rem;\n  font-weight: ",";\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  -webkit-box-orient: vertical;\n  text-overflow: ellipsis;\n  overflow: hidden;\n"])),styles_constants.Tj.gray1000,styles_constants.Wy.medium),DimensionWrapper=(0,emotion_styled_browser_esm.A)("div")(OrderParcelInfo_templateObject_2||(OrderParcelInfo_templateObject_2=(0,tslib_es6.ue)(["\n  color: ",";\n  font-weight: ",";\n  font-size: 0.8125rem;\n"],["\n  color: ",";\n  font-weight: ",";\n  font-size: 0.8125rem;\n"])),styles_constants.Tj.gray700,styles_constants.Wy.normal),OrderParcelInfo_Container=(0,emotion_styled_browser_esm.A)("div")(OrderParcelInfo_templateObject_3||(OrderParcelInfo_templateObject_3=(0,tslib_es6.ue)(["\n  min-height: ",";\n"],["\n  min-height: ",";\n"])),styles_constants.df),CaretIcon=(0,emotion_styled_browser_esm.A)("img")(OrderParcelInfo_templateObject_4||(OrderParcelInfo_templateObject_4=(0,tslib_es6.ue)(["\n  ","\n"],["\n  ","\n"])),(function(_a){return _a.isOpen?"transform: rotate(180deg)":"opacity: 0.2"})),ParcelButton=(0,emotion_styled_browser_esm.A)("button")(OrderParcelInfo_templateObject_5||(OrderParcelInfo_templateObject_5=(0,tslib_es6.ue)(["\n  padding: 0.5rem 0.5rem;\n  min-height: ",";\n\n  ",";\n"],["\n  padding: 0.5rem 0.5rem;\n  min-height: ",";\n\n  ",";\n"])),styles_constants.df,(function(_a){if(_a.isOpen)return"background-color: ".concat(styles_constants.Tj.sea50)})),ButtonContent=(0,emotion_styled_browser_esm.A)("span")(OrderParcelInfo_templateObject_6||(OrderParcelInfo_templateObject_6=(0,tslib_es6.ue)(["\n  ",";\n"],["\n  ",";\n"])),(function(_a){if(_a.hasParcel)return"grid-template-columns: 1fr 1.5rem;"})),OrderParcelInfo=function(_super){function OrderParcelInfo(props){var _this=_super.call(this,props)||this;return _this.renderParcelInfo=function(){var _a=_this.props,order=_a.order,batchEntry=_a.batchEntry,t=_a.t,isOpen=_this.state.isOpen,parcel=batchEntry?batchEntry.parcel:order.parcel;if(!parcel)return(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"-ml-2 flex items-center"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("img",{alt:"",className:"h-6",src:plus}),(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"leading-4 font-medium text-sm text-left"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Link.tp,{children:t("orders:packageInfo:addPackageInfo")})}))]}));var parcelDimension=(0,ParcelTemplate.$)((0,Parcel.lL)(parcel));return(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"flex flex-col leading-5"},{children:[_this.renderParcelName(),(0,emotion_react_jsx_runtime_browser_esm.FD)(DimensionWrapper,(0,tslib_es6.Cl)({className:"flex flex-wrap mt-1"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"mr-2"},{children:_this.getParcelWeightInfo()})),(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{children:parcelDimension})]}))]})),(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"flex justify-center"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(CaretIcon,{src:icons.jH,isOpen})}))]})},_this.getParcelWeightInfo=function(){var _a,_b=_this.props,order=_b.order,batchEntry=_b.batchEntry,batchEntryLineItems=(null==batchEntry?void 0:batchEntry.lineItems)||[],parcel=batchEntry?batchEntry.parcel:order.parcel;if(parcel&&parcel.weight&&parcel.weightUnit)return(0,ParcelTemplate.E_)(parcel);var weight=((batchEntry?(0,OrderBatchEntry.f2)(batchEntryLineItems,order.lineItems):null)||(0,Order.J_)(order)||(0,LineItem.X8)(order.lineItems)).toString(),weightUnit=order.weightUnit||(null===(_a=order.lineItems[0])||void 0===_a?void 0:_a.weightUnit);if(weight&&weightUnit){var weightProvider={weight,weightUnit};return(0,ParcelTemplate.E_)(weightProvider)}return null},_this.renderParcelName=function(){var _a=_this.props,order=_a.order,batchEntry=_a.batchEntry,t=_a.t,parcel=batchEntry?batchEntry.parcel:order.parcel;return parcel?(0,emotion_react_jsx_runtime_browser_esm.Y)(ParcelName,(0,tslib_es6.Cl)({className:styles_constants.xW.fulfilledOrderText},{children:(0,Parcel.gY)(parcel)||t("orders:calculateRates:tabs:shipmentInfo:customDimensions")})):null},_this.handleOpen=function(){var _a,_b=_this.props,order=_b.order,batchEntry=_b.batchEntry;(0,_b.openParcelSelect)(((_a={})[order.objectId]=batchEntry?[batchEntry.id]:[],_a)),_this.setState({isOpen:!0})},_this.handleClose=function(){_this.props.closeParcelSelect(),_this.setState({isOpen:!1})},_this.handleCellClick=function(evt){evt.stopPropagation()},_this.state={isOpen:!1},_this}return(0,tslib_es6.C6)(OrderParcelInfo,_super),OrderParcelInfo.prototype.render=function(){var _a=this.props,order=_a.order,batchEntry=_a.batchEntry,isOpen=this.state.isOpen,parcel=batchEntry?batchEntry.parcel:order.parcel,hasParcel=Boolean(parcel),buttonBackgroundReset=isOpen?"":"bg-transparent",gridClass=hasParcel?"grid":"";return(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderParcelInfo_Container,(0,tslib_es6.Cl)({onClick:this.handleCellClick,className:"h-full","data-pendo":hasParcel?"orders-parcel-edit":"orders-parcel-add"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Popup.A,(0,tslib_es6.Cl)({trigger:(0,emotion_react_jsx_runtime_browser_esm.Y)(ParcelButton,(0,tslib_es6.Cl)({className:"h-full w-full border-none cursor-pointer rounded-none items-center text-left ".concat(buttonBackgroundReset),"data-analytics":"".concat("orders_table","PackageInfo-click-button"),isOpen},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(ButtonContent,(0,tslib_es6.Cl)({className:"h-full w-full items-center text-left ".concat(gridClass),hasParcel},{children:this.renderParcelInfo()}))})),open:isOpen,onClose:this.handleClose,onOpen:this.handleOpen,on:"click",position:"bottom center",wrapperClassName:"w-full h-full",wrapperStyle:{minHeight:styles_constants.df},style:{padding:0,margin:0}},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(All_EditParcelOverlayPanel,{onCancel:this.handleClose,onSave:this.handleClose,order,batchEntry,dataAnalyticsContext:"orders_table"})}))}))},OrderParcelInfo}(react.PureComponent);const cells_OrderParcelInfo=(0,redux.Zz)((0,es.Ng)((function(state,ownProps){var order=ownProps.order;return{batchEntry:ownProps.batchEntry||(0,batch_entry_selectors.Dz)(state,{orderObjectId:order.objectId})}}),(function(dispatch){return{openParcelSelect:function(orderSelection){return dispatch((0,orders_actions._W)(orderSelection))},closeParcelSelect:function(){return dispatch((0,orders_actions.m6)())}}})),(0,utils_translate.Tl)("orders"))(OrderParcelInfo);var OrderParcelInfo_templateObject_1,OrderParcelInfo_templateObject_2,OrderParcelInfo_templateObject_3,OrderParcelInfo_templateObject_4,OrderParcelInfo_templateObject_5,OrderParcelInfo_templateObject_6,OrderPaymentStatus_a,paymentStatusIcons=((OrderPaymentStatus_a={})[Order.Re.AWAITPAY]="dollar",OrderPaymentStatus_a[Order.Re.PAID]="dollar",OrderPaymentStatus_a[Order.Re.PARTIALLY_FULFILLED]="dollar",OrderPaymentStatus_a[Order.Re.SHIPPED]="dollar",OrderPaymentStatus_a[Order.Re.REFUNDED]="reply",OrderPaymentStatus_a[Order.Re.CANCELLED]="times",OrderPaymentStatus_a[Order.Re.UNKNOWN]="",OrderPaymentStatus_a[Order.Re.GENERIC]="dollar",OrderPaymentStatus_a[Order.Re.VALID]="",OrderPaymentStatus_a[Order.Re.INVALID]="",OrderPaymentStatus_a);const cells_OrderPaymentStatus=(0,utils_translate.Tl)("orders")((function(props){var paymentStatusIcon=paymentStatusIcons[props.order.orderStatus]||"";return paymentStatusIcon?(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderIcon_OrderIcon,{className:"fa fa-".concat(paymentStatusIcon),tooltipText:props.t("orders:status:payment:".concat(props.order.orderStatus)),ok:(0,Order.tR)(props.order)}):null}));var ShippingMethodText=(0,emotion_styled_browser_esm.A)("div")(ShippingMethod_templateObject_1||(ShippingMethod_templateObject_1=(0,tslib_es6.ue)(["\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n"],["\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n"])));const cells_ShippingMethod=(0,utils_translate.Tl)()((function(props){var order=props.data,maxShipTime=(0,Order.CW)(order),maxShipTimeContent=maxShipTime?(0,emotion_react_jsx_runtime_browser_esm.FD)("span",{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("i",{className:"fa fa-arrow-circle-right"})," ",props.t("orders:all:shipBy"),maxShipTime.format("MM/DD/YY hA")]}):null,maxDeliveryTime=(0,Order.k4)(order),maxDeliveryTimeContent=maxDeliveryTime?(0,emotion_react_jsx_runtime_browser_esm.FD)("span",{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("i",{className:"fa fa-truck"})," ",props.t("orders:all:deliverBy"),maxDeliveryTime.format("MM/DD/YY hA")]}):null;return(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[order.shippingMethod&&(0,Order.PF)(order)?(0,emotion_react_jsx_runtime_browser_esm.FD)(ShippingMethodText,{children:[props.t("currency",{value:{value:order.shippingCost,currency_iso:order.shippingCostCurrency}})," ","- ",order.shippingMethod]}):null,(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Popup.A,(0,tslib_es6.Cl)({inverted:!0,size:"mini",position:"top center",trigger:maxShipTimeContent||maxDeliveryTimeContent},{children:props.t("orders:all:timeGuarantees")}))]})}));var ShippingMethod_templateObject_1,cellStyles=(0,emotion_react_browser_esm.AH)(TableCell_templateObject_1||(TableCell_templateObject_1=(0,tslib_es6.ue)(["\n  display: table-cell;\n  height: inherit;\n  padding: 15px 15px;\n  vertical-align: middle;\n  font-size: 13px;\n  line-height: 18px;\n  font-weight: ",";\n\n  :first-of-type {\n    padding-left: 10px;\n  }\n\n  :last-of-type {\n    padding-right: 10px;\n  }\n"],["\n  display: table-cell;\n  height: inherit;\n  padding: 15px 15px;\n  vertical-align: middle;\n  font-size: 13px;\n  line-height: 18px;\n  font-weight: ",";\n\n  :first-of-type {\n    padding-left: 10px;\n  }\n\n  :last-of-type {\n    padding-right: 10px;\n  }\n"])),styles_constants.Wy.normal),Cell=(0,emotion_styled_browser_esm.A)("td")(TableCell_templateObject_2||(TableCell_templateObject_2=(0,tslib_es6.ue)(["\n  ",";\n  ","\n\n  color: ",";\n\n  ","\n  ","\n  ","\n  ","\n  ",";\n"],["\n  ",";\n  ","\n\n  color: ",";\n\n  ","\n  ","\n  ","\n  ","\n  ",";\n"])),cellStyles,(function(props){return props.cursor?"cursor: ".concat(props.cursor,";"):props.onClick?"cursor: pointer;":""}),styles_constants.Tj.gray700,(function(props){return props.noLeftPadding?"padding-left: 0;":""}),(function(props){return props.noRightPadding?"padding-right: 0;":""}),(function(_a){return _a.noPadding?"padding: 0;":""}),(function(props){return props.verticalAlign?"vertical-align: ".concat(props.verticalAlign,";"):""}),(function(props){return props.customStyles})),Header=(0,emotion_styled_browser_esm.A)("th")(TableCell_templateObject_3||(TableCell_templateObject_3=(0,tslib_es6.ue)(["\n  ",";\n  color: ",";\n  font-size: 12px;\n  font-weight: 400;\n  width: ",";\n  ","\n  text-align: left;\n\n  ","\n  ","\n  ","\n"],["\n  ",";\n  color: ",";\n  font-size: 12px;\n  font-weight: 400;\n  width: ",";\n  ","\n  text-align: left;\n\n  ","\n  ","\n  ","\n"])),cellStyles,styles_constants.Tj.secondary,(function(props){return props.width||"inherit"}),(function(props){return props.minWidth?"min-width: ".concat(props.minWidth,";"):""}),(function(props){return props.noLeftPadding?"padding-left: 0;":""}),(function(props){return props.noRightPadding?"padding-right: 0;":""}),(function(props){return props.customStyles}));const Table_TableCell=react.memo((function(props){var children=props.children,cursor=props.cursor,customStyles=props.customStyles,colSpan=props.colSpan,noLeftPadding=props.noLeftPadding,noRightPadding=props.noRightPadding,noPadding=props.noPadding,onClick=props.onClick,rowIndex=props.rowIndex,isHeader=props.isHeader,verticalAlign=props.verticalAlign,width=props.width,asGrid=props.asGrid,onClickCallback=react.useCallback((function(evt){if(onClick&&void 0!==rowIndex)return evt.stopPropagation(),onClick(rowIndex)}),[onClick,rowIndex]),CellComponent=isHeader?Header:Cell;return(0,emotion_react_jsx_runtime_browser_esm.Y)(CellComponent,(0,tslib_es6.Cl)({colSpan,isHeader,width,noLeftPadding,noRightPadding,noPadding,verticalAlign,onClick:onClick?onClickCallback:void 0,cursor,customStyles,asGrid},{children}))}));var TableCell_templateObject_1,TableCell_templateObject_2,TableCell_templateObject_3,Row=(0,emotion_styled_browser_esm.A)("tr")(TableRow_templateObject_1||(TableRow_templateObject_1=(0,tslib_es6.ue)(["\n  ","\n\n  border-bottom: 1px solid ",";\n\n  :hover {\n    background-color: ",";\n  }\n\n  thead > &:hover {\n    background-color: white;\n  }\n\n  ","\n\n  ",";\n"],["\n  ","\n\n  border-bottom: 1px solid ",";\n\n  :hover {\n    background-color: ",";\n  }\n\n  thead > &:hover {\n    background-color: white;\n  }\n\n  ","\n\n  ",";\n"])),(function(props){return props.clickable?"cursor: pointer;":""}),styles_constants.Tj.gray50,styles_colors.T.accent.background.success,(function(_a){var asGrid=_a.asGrid,customStyles=_a.customStyles;return asGrid?"display: contents; :hover > td {\n        background-color: ".concat(styles_colors.T.accent.background.success,";\n        }\n        > td {\n          border-bottom: 1px solid ").concat(styles_constants.Tj.gray50,";\n          ").concat(null==customStyles?void 0:customStyles.styles,"\n        }\n        > th {\n          border-bottom: 1px solid ").concat(styles_constants.Tj.gray50,";\n        }\n        "):""}),(function(props){return props.customStyles})),selectedStyles=(0,emotion_react_browser_esm.AH)(TableRow_templateObject_2||(TableRow_templateObject_2=(0,tslib_es6.ue)(["\n  background-color: ",";\n"],["\n  background-color: ",";\n"])),styles_colors.T.accent.background.success),TableRow=react.memo((function(props){var children=props.children,customStyles=props.customStyles,dataPendo=props.dataPendo,forwardRef=props.forwardRef,isSelected=props.isSelected,onClick=props.onClick,rowIndex=props.rowIndex,asGrid=props.asGrid,classes=isSelected?selectedStyles:void 0,onClickCallback=react.useCallback((function(){if(onClick)return onClick(rowIndex||0)}),[onClick,rowIndex]);return(0,emotion_react_jsx_runtime_browser_esm.Y)(Row,(0,tslib_es6.Cl)({css:classes,onClick:onClickCallback,ref:forwardRef,"data-pendo":dataPendo,clickable:!!onClick,customStyles,asGrid},{children}))})),MessageRow=(0,emotion_styled_browser_esm.A)(Row)(TableRow_templateObject_3||(TableRow_templateObject_3=(0,tslib_es6.ue)(["\n  color: #95a3b7;\n  background-color: #f1f6fa;\n  text-align: center;\n"],["\n  color: #95a3b7;\n  background-color: #f1f6fa;\n  text-align: center;\n"])));const Table_TableRow=TableRow;var TableRow_templateObject_1,TableRow_templateObject_2,TableRow_templateObject_3,kebabCase=__webpack_require__("./node_modules/lodash-es/kebabCase.js"),Table_Container=(0,emotion_styled_browser_esm.A)("table")(Table_templateObject_1||(Table_templateObject_1=(0,tslib_es6.ue)(["\n  width: 100%;\n  border-collapse: collapse;\n  table-layout: ",";\n  ","\n"],["\n  width: 100%;\n  border-collapse: collapse;\n  table-layout: ",";\n  ","\n"])),(function(_a){return _a.autoLayout?"auto":"fixed"}),(function(_a){var grid=_a.grid;return grid?Object.entries(grid).reduce((function(css,_a){var _b=(0,tslib_es6.zs)(_a,2),key=_b[0],val=_b[1];return val?"".concat(css).concat((0,kebabCase.A)(key),":").concat(val,";"):css}),"display:grid;"):""})),TableHeader=(0,emotion_styled_browser_esm.A)("thead")(Table_templateObject_2||(Table_templateObject_2=(0,tslib_es6.ue)(["\n  ","\n"],["\n  ","\n"])),(function(_a){return _a.asGrid?"display: contents;":""})),TableBody=(0,emotion_styled_browser_esm.A)("tbody")(Table_templateObject_3||(Table_templateObject_3=(0,tslib_es6.ue)(["\n  ","\n"],["\n  ","\n"])),(function(_a){return _a.asGrid?"display: contents;":""})),MessageLink=(0,emotion_styled_browser_esm.A)("a")(Table_templateObject_4||(Table_templateObject_4=(0,tslib_es6.ue)(["\n  text-decoration: underline;\n  cursor: pointer;\n"],["\n  text-decoration: underline;\n  cursor: pointer;\n"])));const Table_Table=function Table(props){var columns=props.columns,customRowStyles=props.customRowStyles,data=props.data,message=props.message,messageTag=props.messageTag,fixedFirstRow=props.fixedFirstRow,rowClickTag=props.rowClickTag,onMessageClick=props.onMessageClick,onRowClick=props.onRowClick,selectedIndexes=props.selectedIndexes,grid=props.grid,autoLayout=props.autoLayout,children=props.children,hideHeader=react.useMemo((function(){return columns.every((function(col){return!col.header}))}),[columns]),renderCell=function(column,data,cellIndex,rowIndex){var cell=column.cell,noLeftPadding=column.noLeftPadding,noRightPadding=column.noRightPadding,noPadding=column.noPadding,width=column.width,verticalAlign=column.verticalAlign,onCellClick=column.onCellClick,cursor=column.cursor,customCellStyles=column.customCellStyles,CellComponent=cell,cellProps={rowIndex,noLeftPadding,noRightPadding,noPadding,cursor,verticalAlign:verticalAlign||props.columnVerticalAlignment||void 0,customStyles:"function"==typeof customCellStyles?customCellStyles({data,rowIndex}):customCellStyles};return hideHeader&&(cellProps.width=width),(0,emotion_react_browser_esm.n)(Table_TableCell,(0,tslib_es6.Cl)({},cellProps,{key:"cell-".concat(rowIndex,"-").concat(cellIndex),onClick:onCellClick,asGrid:!!grid}),(0,emotion_react_jsx_runtime_browser_esm.Y)(CellComponent,{rowIndex,data}))},header=react.useMemo((function(){return(0,emotion_react_jsx_runtime_browser_esm.Y)(TableHeader,(0,tslib_es6.Cl)({asGrid:!!grid},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Table_TableRow,(0,tslib_es6.Cl)({asGrid:!!grid},{children:columns.map((function(column,index){var isComponent="string"!=typeof column.header,HeaderComponent=column.header;return(0,emotion_react_jsx_runtime_browser_esm.Y)(Table_TableCell,(0,tslib_es6.Cl)({isHeader:!0,width:column.width,minWidth:column.minWidth,noLeftPadding:column.noLeftPadding,noRightPadding:column.noRightPadding,customStyles:"function"==typeof column.customHeaderStyles?column.customHeaderStyles():column.customHeaderStyles},{children:isComponent?(0,emotion_react_jsx_runtime_browser_esm.Y)(HeaderComponent,{}):column.header}),"heading-".concat(index))}))}))}))}),[columns]),rows=react.useMemo((function(){return data.map((function(d,rowIndex){return(0,emotion_react_jsx_runtime_browser_esm.Y)(Table_TableRow,(0,tslib_es6.Cl)({isSelected:!!selectedIndexes&&selectedIndexes.includes(rowIndex),rowIndex,onClick:onRowClick,dataPendo:rowClickTag||"",customStyles:"function"==typeof customRowStyles?customRowStyles({rowIndex,data:d}):customRowStyles,asGrid:!!grid},{children:columns.map((function(column,cellIndex){return renderCell(column,d,cellIndex,rowIndex)}))}),"row-".concat(rowIndex))}))}),[data,columns,selectedIndexes]);return(0,emotion_react_jsx_runtime_browser_esm.FD)(Table_Container,(0,tslib_es6.Cl)({className:props.className,grid,autoLayout},{children:[!hideHeader&&header,(0,emotion_react_jsx_runtime_browser_esm.FD)(TableBody,(0,tslib_es6.Cl)({asGrid:!!grid},{children:[message&&!grid&&(0,emotion_react_jsx_runtime_browser_esm.Y)(MessageRow,(0,tslib_es6.Cl)({onClick:onMessageClick,"data-pendo":messageTag||""},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Table_TableCell,(0,tslib_es6.Cl)({colSpan:columns.length},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(MessageLink,{children:message})}))})),fixedFirstRow&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Table_TableRow,{children:(props.fixedFirstRow||[]).map((function(column,cellIndex){return renderCell(column,null,cellIndex,0)}))},"custom-row"),rows]})),children]}))};var Table_templateObject_1,Table_templateObject_2,Table_templateObject_3,Table_templateObject_4;const components_withAddressBook=__webpack_require__("./app/components/withAddressBook/withAddressBook.tsx").A;const SelectAllOrders_container=function(props){var checked,dispatch=(0,es.wA)(),selectedOrders=(0,es.d4)(orders_selectors.Li),areAllOrdersSelected=(0,es.d4)(orders_selectors.MO),hasSelectedOrders=!!Object.keys(selectedOrders).length,allOrders=(0,es.d4)(batch_entry_composite_selectors.Vd);checked=hasSelectedOrders&&!areAllOrdersSelected?"partial":!!(areAllOrdersSelected&&Object.keys(allOrders).length>0);var handleChange=react.useCallback((function(){dispatch(areAllOrdersSelected?(0,orders_actions.uF)(!0):(0,orders_actions.B_)(allOrders,!0))}),[allOrders,areAllOrdersSelected]);return(0,emotion_react_jsx_runtime_browser_esm.Y)(Checkbox.Ay,(0,tslib_es6.Cl)({},props,{checked,onChange:handleChange}))};var noop=__webpack_require__("./node_modules/lodash-es/noop.js"),memoize_one_esm=__webpack_require__("./node_modules/memoize-one/dist/memoize-one.esm.js"),ManualErrorBoundary=__webpack_require__("./app/pages/Manual/ManualErrorBoundary/index.ts"),routing_actions=__webpack_require__("./app/actions/routing.actions.ts"),Dropdown_Dropdown=__webpack_require__("./app/components/Dropdown/Dropdown.tsx"),StyledDropdown=(0,emotion_styled_browser_esm.A)(Dropdown_Dropdown.A)(LabelHeader_templateObject_1||(LabelHeader_templateObject_1=(0,tslib_es6.ue)(["\n  top: 12px;\n  width: 225px;\n  left: -60px;\n"],["\n  top: 12px;\n  width: 225px;\n  left: -60px;\n"]))),LabelHeader_Container=(0,emotion_styled_browser_esm.A)("div")(LabelHeader_templateObject_2||(LabelHeader_templateObject_2=(0,tslib_es6.ue)(["\n  position: relative;\n"],["\n  position: relative;\n"]))),InnerContainer=(0,emotion_styled_browser_esm.A)("div")(LabelHeader_templateObject_3||(LabelHeader_templateObject_3=(0,tslib_es6.ue)(["\n  display: flex;\n"],["\n  display: flex;\n"]))),TextContainer=(0,emotion_styled_browser_esm.A)("div")(LabelHeader_templateObject_4||(LabelHeader_templateObject_4=(0,tslib_es6.ue)(["\n  flex-grow: 1;\n"],["\n  flex-grow: 1;\n"]))),DropdownButton=(0,emotion_styled_browser_esm.A)("button")(LabelHeader_templateObject_5||(LabelHeader_templateObject_5=(0,tslib_es6.ue)(["\n  border: none;\n  background: transparent;\n  color: ",";\n  cursor: pointer;\n  display: flex;\n"],["\n  border: none;\n  background: transparent;\n  color: ",";\n  cursor: pointer;\n  display: flex;\n"])),styles_constants.Tj.secondary),SmallIcon=(0,emotion_styled_browser_esm.A)("i")(LabelHeader_templateObject_6||(LabelHeader_templateObject_6=(0,tslib_es6.ue)(["\n  font-size: 10px;\n  margin-left: 4px;\n  vertical-align: middle;\n"],["\n  font-size: 10px;\n  margin-left: 4px;\n  vertical-align: middle;\n"]))),DropdownContainer=(0,emotion_styled_browser_esm.A)("div")(LabelHeader_templateObject_7||(LabelHeader_templateObject_7=(0,tslib_es6.ue)(["\n  width: 230px;\n  box-sizing: border-box;\n  padding: 20px;\n"],["\n  width: 230px;\n  box-sizing: border-box;\n  padding: 20px;\n"]))),CheckboxContainer=(0,emotion_styled_browser_esm.A)("div")(LabelHeader_templateObject_8||(LabelHeader_templateObject_8=(0,tslib_es6.ue)(["\n  margin-top: 16px;\n"],["\n  margin-top: 16px;\n"]))),LabelHeader=function(_super){function LabelHeader(props){var _this=_super.call(this,props)||this;return _this.toggleDropdown=function(){_this.setState((function(state){return(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},state),{isOpen:!state.isOpen})}))},_this.changeFetchCount=function(selected){if("string"==typeof selected.value)return _this.props.changeFetchCount(selected.value)},_this.toggleHidden=function(value){return _this.props.toggleHidden(value||void 0)},_this.state={isOpen:!1},_this}return(0,tslib_es6.C6)(LabelHeader,_super),LabelHeader.prototype.render=function(){var _this=this,options=[{value:"25",label:"25"},{value:"50",label:"50"},{value:"100",label:"100"}],_a=this.props,t=_a.t,label=_a.label,selectedOption=options.find((function(option){return option.value===_this.props.results}));return(0,emotion_react_jsx_runtime_browser_esm.FD)(LabelHeader_Container,{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(InnerContainer,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(TextContainer,{children:label}),(0,emotion_react_jsx_runtime_browser_esm.FD)(DropdownButton,(0,tslib_es6.Cl)({onClick:this.toggleDropdown,"data-pendo":"orders-layout-options"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("i",{className:"fa fa-bars"}),(0,emotion_react_jsx_runtime_browser_esm.Y)(SmallIcon,{className:"fa fa-chevron-down"})]}))]}),(0,emotion_react_jsx_runtime_browser_esm.Y)(StyledDropdown,(0,tslib_es6.Cl)({allowOverflow:!0,isOpen:this.state.isOpen,onClose:this.toggleDropdown},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(DropdownContainer,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Select,{label:t("orders:table:ordersPerPage"),options,size:constants_form.YI.xs,value:selectedOption,onChange:this.changeFetchCount,dataPendo:"orders-filters-results"}),(0,emotion_react_jsx_runtime_browser_esm.Y)(CheckboxContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Checkbox.Ay,{label:t("orders:table:showHidden"),onChange:this.toggleHidden,checked:this.props.hidden,dataPendo:"orders-layout-show-hidden"})})]})}))]})},LabelHeader}(react.PureComponent);const All_LabelHeader=(0,redux.Zz)((0,es.Ng)((function(state){return{results:getQSResults(state)||"25",hidden:getQSHidden(state)}}),(function(dispatch){return{changeFetchCount:function(fetchCount){return dispatch((0,routing_actions.bJ)("results",fetchCount))},toggleHidden:function(value){return dispatch((0,routing_actions.bJ)("hidden",value))}}})),(0,utils_translate.Tl)("orders"))(LabelHeader);var LabelHeader_templateObject_1,LabelHeader_templateObject_2,LabelHeader_templateObject_3,LabelHeader_templateObject_4,LabelHeader_templateObject_5,LabelHeader_templateObject_6,LabelHeader_templateObject_7,LabelHeader_templateObject_8;function sendGTMEvent(payload){return{payload,type:constants.t.SEND_GTM_EVENT}}function sendGTMEventSuccess(eventName){return{eventName,type:constants.t.SEND_GTM_EVENT_SUCCESS}}function sendGTMEventError(eventName,error){return{eventName,error,type:constants.t.SEND_GTM_EVENT_ERROR}}function pushToGTMDataLayer(payload){return{payload,type:constants.t.PUSH_TO_GTM_DATA_LAYER}}var dropdownPrimaryActionStyles=(0,emotion_react_browser_esm.AH)(DotTrigger_templateObject_1||(DotTrigger_templateObject_1=(0,tslib_es6.ue)(["\n  padding-left: 0.5rem;\n  padding-right: 0.5rem;\n  align-self: flex-end;\n  border: none;\n"],["\n  padding-left: 0.5rem;\n  padding-right: 0.5rem;\n  align-self: flex-end;\n  border: none;\n"]))),DotTrigger_SmallIcon=(0,emotion_styled_browser_esm.A)("i")(DotTrigger_templateObject_2||(DotTrigger_templateObject_2=(0,tslib_es6.ue)(["\n  display: flex;\n  font-size: 1.25rem;\n  vertical-align: middle;\n  margin-bottom: 2px;\n"],["\n  display: flex;\n  font-size: 1.25rem;\n  vertical-align: middle;\n  margin-bottom: 2px;\n"])));const DropdownList_DotTrigger=function(props){var buttonType=props.buttonType,buttonProps=(0,tslib_es6.Tt)(props,["buttonType"]),Button=components_Button.Uo[buttonType],icon=props.reversed?"v":"h";return(0,emotion_react_jsx_runtime_browser_esm.Y)(Button,(0,tslib_es6.Cl)({},buttonProps,{css:dropdownPrimaryActionStyles,ref:props.buttonRef},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(DotTrigger_SmallIcon,{className:"fa fa-ellipsis-".concat(icon)})}))};var DotTrigger_templateObject_1,DotTrigger_templateObject_2,Trigger_dropdownPrimaryActionStyles=(0,emotion_react_browser_esm.AH)(Trigger_templateObject_1||(Trigger_templateObject_1=(0,tslib_es6.ue)(["\n  border-bottom-left-radius: 0;\n  border-top-left-radius: 0;\n  padding-left: 0.5rem;\n  padding-right: 0.5rem;\n"],["\n  border-bottom-left-radius: 0;\n  border-top-left-radius: 0;\n  padding-left: 0.5rem;\n  padding-right: 0.5rem;\n"]))),Trigger_SmallIcon=(0,emotion_styled_browser_esm.A)("i")(Trigger_templateObject_2||(Trigger_templateObject_2=(0,tslib_es6.ue)(["\n  display: flex;\n  font-size: 0.625rem;\n  vertical-align: middle;\n  margin-bottom: 2px;\n"],["\n  display: flex;\n  font-size: 0.625rem;\n  vertical-align: middle;\n  margin-bottom: 2px;\n"])));const DropdownList_Trigger=function(props){var buttonType=props.buttonType,buttonProps=(0,tslib_es6.Tt)(props,["buttonType"]),Button=components_Button.Uo[buttonType],icon=props.reversed?"up":"down";return(0,emotion_react_jsx_runtime_browser_esm.Y)(Button,(0,tslib_es6.Cl)({},buttonProps,{css:Trigger_dropdownPrimaryActionStyles,ref:props.buttonRef},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Trigger_SmallIcon,{className:"fa fa-chevron-".concat(icon)})}))};var Trigger_templateObject_1,Trigger_templateObject_2,DropdownList_Container=(0,emotion_styled_browser_esm.A)("div")(DropdownList_templateObject_1||(DropdownList_templateObject_1=(0,tslib_es6.ue)(["\n  display: flex;\n  position: relative;\n  min-width: ",";\n  ",";\n"],["\n  display: flex;\n  position: relative;\n  min-width: ",";\n  ",";\n"])),(function(_a){return _a.minWidth||"180px"}),(function(props){return props.hamburger?"justify-content: flex-end;":""})),DropdownList_List=(0,emotion_styled_browser_esm.A)("ul")(DropdownList_templateObject_2||(DropdownList_templateObject_2=(0,tslib_es6.ue)(["\n  padding: 0;\n  margin: 0;\n\n  li:hover {\n    background-color: ",";\n  }\n"],["\n  padding: 0;\n  margin: 0;\n\n  li:hover {\n    background-color: ",";\n  }\n"])),(function(props){return props.hoverColor}));const DropdownList_DropdownList=function(_super){function DropdownList(props){var _this=_super.call(this,props)||this;return _this.trigger=null,_this.handleClick=function(evt){evt.stopPropagation(),_this.setState({isOpen:!_this.state.isOpen})},_this.onClickOutside=function(evt){-1===evt.propagationPath().indexOf(react_dom.findDOMNode(_this.trigger))&&_this.setState({isOpen:!1})},_this.setTriggerRef=function(node){return _this.trigger=node},_this.state={isOpen:!1},_this}return(0,tslib_es6.C6)(DropdownList,_super),DropdownList.prototype.render=function(){var _this=this;return(0,emotion_react_jsx_runtime_browser_esm.FD)(DropdownList_Container,(0,tslib_es6.Cl)({hamburger:this.props.hamburger||!1,minWidth:this.props.minWidth},{children:[this.props.primaryActionComponent?this.props.primaryActionComponent():void 0,(0,emotion_react_jsx_runtime_browser_esm.Y)(Dropdown.A,(0,tslib_es6.Cl)({triggerComponent:function(){return _this.props.hamburger?(0,emotion_react_jsx_runtime_browser_esm.Y)(DropdownList_DotTrigger,{buttonType:_this.props.triggerButtonType,dataE2E:_this.props.triggerDataE2E,onClick:_this.handleClick,buttonRef:_this.setTriggerRef,reversed:_this.props.reversed,disabled:_this.props.disabled}):(0,emotion_react_jsx_runtime_browser_esm.Y)(DropdownList_Trigger,{buttonType:_this.props.triggerButtonType,dataE2E:_this.props.triggerDataE2E,onClick:_this.handleClick,buttonRef:_this.setTriggerRef,reversed:_this.props.reversed,disabled:_this.props.disabled})},isOpen:this.state.isOpen,onClickOutside:this.onClickOutside,relativeToParent:!0,reversed:this.props.reversed,disabled:this.props.disabled},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(DropdownList_List,(0,tslib_es6.Cl)({hoverColor:this.props.hoverColor||styles_constants.Tj.gray25},{children:this.props.children}))}))]}))},DropdownList}(react.Component);var DropdownList_templateObject_1,DropdownList_templateObject_2,Li=(0,emotion_styled_browser_esm.A)("li")(DropdownOption_templateObject_1||(DropdownOption_templateObject_1=(0,tslib_es6.ue)(["\n  padding: ",";\n  line-height: 14px;\n  color: ",";\n  position: relative;\n  cursor: pointer;\n\n  :first-of-type {\n    margin-top: 8px;\n  }\n\n  :last-of-type {\n    margin-bottom: 8px;\n  }\n"],["\n  padding: ",";\n  line-height: 14px;\n  color: ",";\n  position: relative;\n  cursor: pointer;\n\n  :first-of-type {\n    margin-top: 8px;\n  }\n\n  :last-of-type {\n    margin-bottom: 8px;\n  }\n"])),(function(props){return props.noPadding?"0":"8px 0 8px 20px"}),styles_constants.Tj.fontColor),A=(0,emotion_styled_browser_esm.A)("a")(DropdownOption_templateObject_2||(DropdownOption_templateObject_2=(0,tslib_es6.ue)(["\n  display: block;\n  padding: 8px 0 8px 20px;\n  text-decoration: none;\n  color: inherit;\n"],["\n  display: block;\n  padding: 8px 0 8px 20px;\n  text-decoration: none;\n  color: inherit;\n"]))),handleClick=function(evt){return evt.stopPropagation()};const DropdownList_DropdownOption=function(props){var liProps=props.onClick?{onClick:props.onClick}:{},child=props.href?(0,emotion_react_jsx_runtime_browser_esm.Y)(A,(0,tslib_es6.Cl)({href:props.href,onClick:handleClick},{children:props.children})):props.children;return(0,emotion_react_jsx_runtime_browser_esm.Y)(Li,(0,tslib_es6.Cl)({},liProps,{className:props.className,noPadding:!!props.href,"data-pendo":props.dataPendo,"data-analytics":props.dataAnalytics},{children:child}))};var DropdownOption_templateObject_1,DropdownOption_templateObject_2,PrimaryAction_dropdownPrimaryActionStyles=(0,emotion_react_browser_esm.AH)(PrimaryAction_templateObject_1||(PrimaryAction_templateObject_1=(0,tslib_es6.ue)(["\n  border-bottom-right-radius: 0;\n  border-top-right-radius: 0;\n  text-align: center;\n"],["\n  border-bottom-right-radius: 0;\n  border-top-right-radius: 0;\n  text-align: center;\n"]))),PrimaryAction_handleClick=function(e){return e.stopPropagation()};const DropdownList_PrimaryAction=function(props){var buttonType=props.buttonType,children=props.children,dataPendo=props.dataPendo,dataAnalytics=props.dataAnalytics,buttonProps=(0,tslib_es6.Tt)(props,["buttonType","children","dataPendo","dataAnalytics"]),Button=components_Button.Uo[buttonType],isButtonSolid=[components_Button.EY.Primary,components_Button.EY.PrimaryBlue,components_Button.EY.SmallPrimary,components_Button.EY.SmallPrimaryExternalLink].includes(buttonType),propClass=(0,emotion_react_browser_esm.AH)(PrimaryAction_templateObject_2||(PrimaryAction_templateObject_2=(0,tslib_es6.ue)(["\n    width: ",";\n    ",";\n    border-right: "," !important;\n\n    &:hover,\n    &:focus {\n      border-right: "," !important;\n    }\n  "],["\n    width: ",";\n    ",";\n    border-right: "," !important;\n\n    &:hover,\n    &:focus {\n      border-right: "," !important;\n    }\n  "])),props.width?props.width:"125px",props.minWidth?"min-width: ".concat(props.minWidth):"",isButtonSolid?"1px solid #00000025":"none",isButtonSolid?"1px solid #00000025":"none"),primaryActionStyles=(0,emotion_react_browser_esm.AH)(PrimaryAction_templateObject_3||(PrimaryAction_templateObject_3=(0,tslib_es6.ue)(["\n    "," ",";\n  "],["\n    "," ",";\n  "])),PrimaryAction_dropdownPrimaryActionStyles,propClass),finalProps=(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},buttonProps),buttonProps.onClick?{onClick:function(evt){if(evt.stopPropagation(),buttonProps.onClick)return buttonProps.onClick(evt)}}:{onClick:PrimaryAction_handleClick});return(0,emotion_react_jsx_runtime_browser_esm.Y)(Button,(0,tslib_es6.Cl)({},finalProps,{css:primaryActionStyles,dataPendo,dataAnalytics},{children}))};var PrimaryAction_templateObject_1,PrimaryAction_templateObject_2,PrimaryAction_templateObject_3,svgSpinner='\n\x3c!-- By Sam Herbert (@sherb), for everyone. More @ http://goo.gl/7AJzbL --\x3e\n<svg width="64" height="64" viewBox="0 0 38 38" xmlns="http://www.w3.org/2000/svg">\n  <defs>\n    <linearGradient x1="8.042%" y1="0%" x2="65.682%" y2="23.865%" id="a">\n      <stop stop-color="'.concat(styles_constants.Tj.primary,'" stop-opacity="0" offset="0%"/>\n      <stop stop-color="').concat(styles_constants.Tj.primary,'" stop-opacity=".631" offset="63.146%"/>\n      <stop stop-color="').concat(styles_constants.Tj.primary,'" offset="100%"/>\n    </linearGradient>\n  </defs>\n  <g fill="none" fill-rule="evenodd">\n    <g transform="translate(1 1)">\n      <path d="M36 18c0-9.94-8.06-18-18-18" id="Oval-2" stroke="url(#a)" stroke-width="2">\n        <animateTransform\n          attributeName="transform"\n          type="rotate"\n          from="0 18 18"\n          to="360 18 18"\n          dur="0.9s"\n          repeatCount="indefinite" />\n      </path>\n      <circle fill="').concat(styles_constants.Tj.primary,'" cx="36" cy="18" r="1">\n        <animateTransform\n          attributeName="transform"\n          type="rotate"\n          from="0 18 18"\n          to="360 18 18"\n          dur="0.9s"\n          repeatCount="indefinite" />\n      </circle>\n    </g>\n  </g>\n</svg>\n'),contentSyle="\n  width: 100%;\n  margin-top: 8rem;\n  font-family: Roboto,pragmatica-web,'Helvetica Neue',Helvetica,Arial,sans-serif;\n  font-weight: ".concat(styles_constants.Wy.normal,";\n  font-size: 1rem;\n  line-height: 1.5rem;\n  display: flex;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  flex-direction: column;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n    -ms-flex-direction: column;\n      flex-direction: column;\n  align-items: center;\n  display: flex;\n  -webkit-box-align: center;\n    -ms-flex-align: center;\n      align-items: center;\n");const components_HTMLLoadingState='\n  <div style="'.concat(contentSyle,'">\n    ').concat(svgSpinner,'\n    <p style="').concat("\n  margin-top: 1.5rem;\n",'">Loading...</p>\n  </div>\n');var Transaction=__webpack_require__("./app/types/Transaction.ts"),GlobalComponentsProvider=__webpack_require__("./app/contexts/GlobalComponentsProvider.tsx"),ActionButton=(0,emotion_styled_browser_esm.A)(components_Button.AL)(TransactionActionButton_templateObject_1||(TransactionActionButton_templateObject_1=(0,tslib_es6.ue)(["\n  display: block;\n\n  & i {\n    margin-right: 5px;\n  }\n"],["\n  display: block;\n\n  & i {\n    margin-right: 5px;\n  }\n"]))),ComposedTransactionActionButton=(0,redux.Zz)((0,es.Ng)(null,(function(dispatch){return{sendEmailNotification:function(objectId){return dispatch(function sendEmailNotification(transactionId){return{type:constants.t.SEND_EMAIL_NOTIFICATION,payload:{transactionId}}}(objectId))}}})),(0,utils_translate.Tl)("orders"))((function(_a){var transaction=_a.transaction,sendEmailNotification=_a.sendEmailNotification,setTransaction=_a.setTransaction,action=_a.action,orderId=_a.orderId,t=_a.t,snackbar=(0,GlobalComponentsProvider.s)().snackbar,_b=(0,tslib_es6.zs)((0,react.useState)(!1),2),actionSent=_b[0],setActionSent=_b[1],returnLink="".concat("https://dev-qa.shippodev.com","/user/orders/fulfill/").concat(orderId,"/return_of/").concat(transaction.objectId),handleSendNotification=function(){sendEmailNotification(transaction.objectId),setActionSent(!0)};if(action===ModalAction.EMAIL)return actionSent?(0,emotion_react_jsx_runtime_browser_esm.FD)(ActionButton,(0,tslib_es6.Cl)({onClick:handleSendNotification,disabled:!0},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("i",{className:"fa fa-check"})," ",t("orders:shipments:emailSent")]})):(0,emotion_react_jsx_runtime_browser_esm.Y)(ActionButton,(0,tslib_es6.Cl)({onClick:handleSendNotification},{children:t("orders:shipments:sendEmail")}));if(action===ModalAction.RETURN)return(0,emotion_react_jsx_runtime_browser_esm.Y)(Link.ic,(0,tslib_es6.Cl)({href:returnLink,target:"_blank"},{children:t("orders:all:createReturn")}));if(action===ModalAction.REFUND){switch(transaction.objectStatus){case Transaction.x8.ERROR:return(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Button.vM,(0,tslib_es6.Cl)({disabled:!0},{children:t("orders:all:nonRefundable")}));case Transaction.x8.REFUNDED:return(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Button.vM,(0,tslib_es6.Cl)({disabled:!0},{children:t("orders:all:refunded")}));case Transaction.x8.REFUNDPENDING:return(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Button.vM,(0,tslib_es6.Cl)({disabled:!0},{children:t("orders:all:refundPending")}));case Transaction.x8.REFUNDREJECTED:return(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Button.vM,(0,tslib_es6.Cl)({disabled:!0},{children:t("orders:all:refundRejected")}))}return actionSent?(0,emotion_react_jsx_runtime_browser_esm.FD)(ActionButton,(0,tslib_es6.Cl)({disabled:!0},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("i",{className:"fa fa-check"}),t("orders:shipments:refundRequested")]})):(0,Transaction.PJ)(transaction)?(0,emotion_react_jsx_runtime_browser_esm.Y)(ActionButton,(0,tslib_es6.Cl)({onClick:function(){return snackbar.addSnackbarAlert(t("orders:refund:result:canadaPostIneligible"),"error")}},{children:t("orders:shipments:requestRefund")})):(0,emotion_react_jsx_runtime_browser_esm.Y)(ActionButton,(0,tslib_es6.Cl)({onClick:function(){return setTransaction(transaction)}},{children:t("orders:shipments:requestRefund")}))}}));const TransactionModal_TransactionActionButton=ComposedTransactionActionButton;var TransactionActionButton_templateObject_1;const components_Table=Table_Table;var styled=__webpack_require__("./node_modules/@mui/material/styles/styled.js"),FormControlLabel=__webpack_require__("./node_modules/@goshippo/components/esm/FormControlLabel/FormControlLabel.js"),Checkbox_Checkbox=__webpack_require__("./node_modules/@goshippo/components/esm/Checkbox/Checkbox.js"),Button_Button=__webpack_require__("./node_modules/@goshippo/components/esm/Button/Button.js"),CircularProgress=__webpack_require__("./node_modules/@goshippo/components/esm/CircularProgress/CircularProgress.js"),Dialog_Dialog=__webpack_require__("./node_modules/@goshippo/libraries/dist/esm/Dialog/Dialog.js"),node_modules_axios=__webpack_require__("./node_modules/axios/index.js"),axios_default=__webpack_require__.n(node_modules_axios),hooks_useRequest=__webpack_require__("./app/hooks/useRequest.ts"),services_api=__webpack_require__("./app/services/api.ts");function carrier_accounts_service_getCarrierAccounts(payload){return services_api.Ay.request({url:"/carrier_accounts",method:"GET",params:(0,tslib_es6.Cl)({results:999},payload)})}function getCarrierProviders(carriers){return services_api.YZ.request({url:"/setting/carriers",method:"GET",params:{carriers}})}function connectCarrierAccount(carrierAccount){return services_api.Ay.request({url:"/carrier_accounts",method:"POST",data:(0,tslib_es6.Cl)({},carrierAccount)})}function uploadCompanyLogo(accountObjectId,companyLogo){var formData=new FormData;return formData.append("file",companyLogo),formData.append("document_type","LETTERHEAD"),services_api.Ay.request({url:"/carrier_accounts/".concat(accountObjectId,"/documents"),method:"POST",data:formData})}function uploadDigitalSignature(accountObjectId,digitalSignature){var formData=new FormData;return formData.append("file",digitalSignature),formData.append("document_type","SIGNATURE"),services_api.Ay.request({url:"/carrier_accounts/".concat(accountObjectId,"/documents"),method:"POST",data:formData})}function editCarrierAccount(carrierAccount,id){return services_api.Ay.request({url:"/carrier_accounts/".concat(id),method:"PUT",data:(0,tslib_es6.Cl)({},carrierAccount)})}function editCarrierAccountServiceLevels(carrierServiceLevels,account_object_id){return services_api.Ay.request({url:"/carrier_accounts/".concat(account_object_id,"/service_levels"),method:"PATCH",data:carrierServiceLevels})}function carrier_accounts_service_createCarrierAccount(requestBody){return services_api.Ay.request({url:"/carrier_accounts/register/new",method:"POST",data:(0,tslib_es6.Cl)({},requestBody)})}function carrier_accounts_service_fetchCarrierAccountRegStatuses(){return services_api.YZ.request({url:"/carrier-accounts/reg-status/",method:"GET"})}var CarrierAccount=__webpack_require__("./app/types/CarrierAccount.ts");var moment_moment=__webpack_require__("./node_modules/moment/moment.js"),APIMessage=__webpack_require__("./app/types/APIMessage.ts"),Carrier=__webpack_require__("./app/types/Carrier.ts"),Rate=__webpack_require__("./app/types/Rate.ts"),Track=__webpack_require__("./app/types/Track.ts"),util=__webpack_require__("./app/pages/Shipments/ShipmentsPage/ShipmentsTable/util.ts");function getTransactionCreatedBy(createdBy){return(null==createdBy?void 0:createdBy.first_name)||(null==createdBy?void 0:createdBy.last_name)?[createdBy.first_name,createdBy.last_name].filter(Boolean).join(" "):null}var DATE_FORMAT_WITH_TIMEZONE="yyyy-MM-dd'T'HH:mm:ssxxx",format=__webpack_require__("./node_modules/date-fns/esm/format/index.js"),X_ORDERS_SEARCH_VERSION="ORDERS_SEARCH_ORDER_NUMBER";function getLegacy(orderId){return services_api.Ay.request({url:"/orders/".concat(orderId),method:"GET",headers:{Legacy:!0}})}function getAllLegacy(page,filters,fetchCount,showOnlyHidden,sort){return services_api.kC.request({url:"/orders",method:"GET",headers:{Legacy:!0},params:(0,tslib_es6.Cl)((0,tslib_es6.Cl)((0,tslib_es6.Cl)((0,tslib_es6.Cl)({},filters),{page,sort:""!==sort?sort:void 0}),""!==fetchCount?{results:fetchCount}:{}),{hidden:showOnlyHidden})})}function getAll(page,filters,fetchCount,showOnlyHidden,sort,sortBy,orderBy,object_id){return void 0===object_id&&(object_id=[]),services_api.YZ.request({url:"/orders",method:"GET",headers:{X_ORDERS_SEARCH_VERSION},params:(0,tslib_es6.Cl)((0,tslib_es6.Cl)((0,tslib_es6.Cl)((0,tslib_es6.Cl)((0,tslib_es6.Cl)((0,tslib_es6.Cl)((0,tslib_es6.Cl)((0,tslib_es6.Cl)((0,tslib_es6.Cl)({},filters),{page,sort:""!==sort?sort:void 0}),(null==sortBy?void 0:sortBy.length)?{sort_by:sortBy}:{}),(null==orderBy?void 0:orderBy.length)?{order_by:orderBy}:{}),(null==fetchCount?void 0:fetchCount.length)?{results:fetchCount}:{}),{hidden:showOnlyHidden}),filters.is_international?{destination:"true"===filters.is_international?"international":"domestic"}:{}),(null==object_id?void 0:object_id.length)?{object_id}:{}),{is_return_included:!0})})}function getWithReturns(orderId){return services_api.YZ.request({url:"/orders/".concat(orderId),method:"GET",params:{is_return_included:!0}})}function getOrderTransactions(orderObjectId){return services_api.kC.request({url:"/orders/".concat(orderObjectId,"/transactions"),method:"GET",params:{results:200}})}function createOrder(order){return services_api.kC.request({url:"orders/",method:"POST",data:order})}function countOrdersLegacy(){return services_api.kC.request({url:"/orders",method:"GET",headers:{Legacy:!0},params:{results:1,page:1}})}function countOrders(){return services_api.YZ.request({url:"/orders",method:"GET",params:{results:1,page:1}})}function getBatch(batchId){return services_api.YZ.request({url:"/batch/".concat(batchId),method:"GET"})}function createBatch(orderObjectIds,batchEntryIds){return services_api.YZ.request({url:"/batch/",method:"POST",data:{orders:orderObjectIds,batch_entries:batchEntryIds}})}function regenerateBatchEntry(batchId,batchEntryId,packageInformation){return services_api.YZ.request({url:"/batch/".concat(batchId,"/entries/").concat(batchEntryId,"/regenerate"),method:"POST",data:packageInformation})}function saveBatchPackageInformation(batchId,packageInformation){return services_api.YZ.request({url:"/batch/".concat(batchId,"/shipments"),method:"POST",data:packageInformation})}function createBatchTransactions(batchId,rates,excludedOrders){return services_api.YZ.request({url:"/batch/".concat(batchId,"/transactions"),method:"POST",data:{rates,excluded_orders:excludedOrders}})}function syncOrders(){return services_api.Ay.request({url:"orders/sync",method:"GET"})}function getOrderPackingSlip(orderObjectIds,batchEntryIds){return services_api.Ay.request({url:"orders/packingslip",method:"GET",params:{id:orderObjectIds,only_be_id:batchEntryIds}})}function getAllLabels(orderObjectIds,batchEntryIds){return services_api.kC.request({url:"orders/",method:"POST",data:{batch_entries:batchEntryIds,action:{list:orderObjectIds,type:"merge_labels"}}})}function orders_service_getLabel(transactionIds,fileFormat){return services_api.YZ.request({url:"label_regen/",method:"POST",data:{transactions:transactionIds,legacy_file_format:fileFormat}})}function hideOrder(orderObjectIds){return services_api.kC.request({url:"orders/",method:"POST",data:{action:{list:orderObjectIds,type:"hide"}}})}function createBatchEntriesForOrders(orderObjectIds,isRating){return services_api.YZ.request({url:"orders/batch_entry",method:"POST",data:{orders:orderObjectIds,is_rating:!!isRating}})}function getOrCloneBatchEntriesForOrders(orderObjectIDs,batchEntryIDs){return services_api.YZ.request({url:"orders/batch_entry",method:"POST",data:{orders:orderObjectIDs,batch_entries:batchEntryIDs,is_integrated:!0}})}var util_a,_b,_c,buildRequestParcel=function(parcel){var parcelData=parcel.use_imported_order_weight?{use_imported_order_weight:parcel.use_imported_order_weight}:{weight:parcel.weight,mass_unit:parcel.mass_unit},carrierTemplateVariableDimensions=parcel.carrier_parcel_template&&parcel.carrier_parcel_template.is_variable_dimensions;return parcel.user_parcel_template?(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},parcelData),{user_parcel_template_object_id:parcel.user_parcel_template&&parcel.user_parcel_template.object_id}):parcel.carrier_parcel_template&&!carrierTemplateVariableDimensions?(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},parcelData),{carrier_parcel_template_token:parcel.carrier_parcel_template&&parcel.carrier_parcel_template.token}):parcel.carrier_parcel_template&&carrierTemplateVariableDimensions?(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},parcelData),{carrier_parcel_template_token:parcel.carrier_parcel_template&&parcel.carrier_parcel_template.token,width:parcel.width,length:parcel.length,height:parcel.height,distance_unit:parcel.distance_unit}):(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},parcelData),{width:parcel.width,length:parcel.length,height:parcel.height,distance_unit:parcel.distance_unit})};function patchBatchEntries(batchEntryIds,parcel,extras){var requestParcel=parcel?buildRequestParcel((0,Parcel.U2)(parcel)):void 0,requestExtras=extras?(0,OrderBatchEntry.j3)(extras):void 0;return services_api.YZ.request({url:"batch_entry/",method:"PATCH",data:{batch_entries:batchEntryIds,parcel:requestParcel,extras:requestExtras}})}function updateParcel(batchEntryIds,parcel){var requestParcel=buildRequestParcel(parcel);return services_api.YZ.request({url:"orders/batch_entry/parcel",method:"PUT",data:{parcel:requestParcel,batch_entries:batchEntryIds}})}function updateBatchEntryExtras(batchEntryIds,extras){return services_api.YZ.request({url:"orders/batch_entry/extras",method:"PUT",data:{batch_entries:batchEntryIds,extras:(0,OrderBatchEntry.j3)(extras)}})}function patchUpdateBatchEntryExtras(batchEntryIds,extras){return services_api.YZ.request({url:"orders/batch_entry/extras",method:"PATCH",data:{batch_entries:batchEntryIds,extras:(0,OrderBatchEntry.j3)(extras)}})}function updateBatchEntryAddress(address,addressType,batchEntryIds){var _a,parsedAddress=address.id?address.id:(0,Address.U2)(address),convertedAddressType=addressType===addressBook.y9?"from":addressType,url="orders/batch_entry/address_".concat(convertedAddressType),data=((_a={batch_entries:batchEntryIds})["number"==typeof parsedAddress?"address_".concat(convertedAddressType,"_id"):"address_".concat(convertedAddressType)]=parsedAddress,_a);return services_api.YZ.request({url,data,method:"PUT"})}function updateBatchEntryServiceLevelToken(preferredServiceLevelToken,batchEntryIds,accountObjectId){return services_api.YZ.request({data:{batch_entries:batchEntryIds,preferred_service_level_token:preferredServiceLevelToken,preferred_account_object_id:accountObjectId},method:"PUT",url:"batch_entry/service_level"})}function updateBatchEntryShipmentDate(shipmentDate,batchEntryIds){return services_api.YZ.request({url:"/batch_entry/shipment_date",data:{batch_entries:batchEntryIds,shipment_date:moment_moment.isMoment(shipmentDate)?shipmentDate.format():(0,format.default)(shipmentDate,DATE_FORMAT_WITH_TIMEZONE)},method:"PUT"})}function refreshBatchEntry(batchEntryIds){return services_api.YZ.request({url:"/orders/batch_entry/refresh",method:"PUT",data:{batch_entries:batchEntryIds}})}function updateOrder(order){return services_api.kC.request({url:"orders/".concat(order.object_id),method:"PUT",data:order})}function getUserBatchInput(batchId,batchEntryId){return services_api.YZ.request({url:"/batch/".concat(batchId,"/entries/").concat(batchEntryId,"/input"),method:"GET"})}function getOrderBatchEntry(orderObjectId,includeReturns){return void 0===includeReturns&&(includeReturns=!1),services_api.YZ.request({url:"/orders/".concat(orderObjectId,"/batch_entry"),method:"GET",params:{is_return_included:includeReturns}})}function getOrderBatchEntries(orderObjectIds,includeReturns){return void 0===includeReturns&&(includeReturns=!1),services_api.YZ.request({url:"/batch_entry",method:"GET",params:{orders:orderObjectIds,is_return_included:includeReturns}})}function fetchBatchEntryRules(batchEntryId){return services_api.YZ.request({url:"/batch_entry/".concat(batchEntryId,"/rule"),method:"GET"})}function createPartialFulfillmentRequests(orderObjectId,partialFulfillmentRequests){return services_api.YZ.request({url:"orders/".concat(orderObjectId,"/split"),method:"POST",data:{shipments:partialFulfillmentRequests}})}function transactions_service_get(transactionObjectId){return services_api.Ay.request({url:"/transactions/".concat(transactionObjectId),method:"GET"})}function transactions_service_emailNotify(transactionObjectIds){return services_api.YZ.request({url:"/email",method:"POST",data:{transactions:transactionObjectIds}})}function refund(transactionObjectId){return services_api.Ay.request({url:"refunds/",method:"POST",data:{transaction:transactionObjectId}})}function useRefundTransaction(updateRows){var _this=this,_a=(0,tslib_es6.zs)((0,react.useState)(null),2),refundTransactionId=_a[0],setRefundTransactionId=_a[1],_b=(0,hooks_useRequest.A)(),request=_b.request,data=_b.data;(0,react.useEffect)((function(){data&&(updateRows&&updateRows([data]),setRefundTransactionId(null))}),[data,updateRows]);var onCancelRefund=(0,react.useCallback)((function(){setRefundTransactionId(null)}),[]);return{refundTransactionId,setRefundTransactionId,onRefundTransaction:function(id){return new Promise((function(resolve,reject){request((function(){return(0,tslib_es6.sH)(_this,void 0,void 0,(function(){var response,updatedRow,transactionSearch,output,e_1;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,4]),[4,refund(id)];case 1:return 201!==(response=_a.sent()).status?(reject(new Error(response.statusText)),[2,null]):[4,(transactionObjectID=id,services_api.YZ.get("transactions_search",{params:{transactionObjectID}}))];case 2:return updatedRow=_a.sent().data,transactionSearch=function transactionSearchFromJSON(jsonTransaction){var _a,_b,_c,_d;return{addressTo:Address.rS(jsonTransaction.address_to),addressReturn:Address.rS(jsonTransaction.address_return),commercialInvoiceUrl:jsonTransaction.commercial_invoice_url,customsNote:jsonTransaction.customs_note,eta:jsonTransaction.eta,isReturn:jsonTransaction.is_return,messages:(jsonTransaction.messages||[]).map(APIMessage.rS),metadata:jsonTransaction.metadata,notificationEmailFrom:jsonTransaction.notification_email_from,notificationEmailOther:jsonTransaction.notification_email_other,notificationEmailTo:jsonTransaction.notification_email_to,objectCreated:moment_moment(jsonTransaction.object_created),objectId:jsonTransaction.object_id,order:{id:null===(_a=jsonTransaction.order)||void 0===_a?void 0:_a.id,object_id:null===(_b=jsonTransaction.order)||void 0===_b?void 0:_b.object_id,status:null===(_c=jsonTransaction.order)||void 0===_c?void 0:_c.status,orderNumber:null===(_d=jsonTransaction.order)||void 0===_d?void 0:_d.order_number},objectState:jsonTransaction.object_state,objectStatus:jsonTransaction.object_status,objectUpdated:moment_moment(jsonTransaction.object_updated),parcel:jsonTransaction.parcel,pickupDate:jsonTransaction.pickup_date?moment_moment(jsonTransaction.pickup_date):void 0,rate:Rate.Nf(jsonTransaction.rate),refundRequestDate:jsonTransaction.refund_request_date?moment_moment(jsonTransaction.refund_request_date):void 0,submissionDate:jsonTransaction.submission_date,submissionNote:jsonTransaction.submission_note,trackingNumber:jsonTransaction.tracking_number,trackingStatus:jsonTransaction.tracking_status?(0,Track.O)(jsonTransaction.tracking_status):void 0,trackingUrlProvider:jsonTransaction.tracking_url_provider,wasTest:jsonTransaction.was_test,insuranceAmount:jsonTransaction.insurance_amount,insuranceCurrency:jsonTransaction.insurance_currency,insuranceClaimId:jsonTransaction.insurance_claim_id,insuranceProvider:jsonTransaction.insurance_provider,createdBy:getTransactionCreatedBy(jsonTransaction.created_by)}}(updatedRow),output=function types_shipmentTableRow(transactionSearch,isLastRows,isNewReturnExperience){var _a,_b,_c,_d,_e,_f,_g,_h,_j;return{id:transactionSearch.objectId,order:{objectId:transactionSearch.order.object_id,orderNumber:transactionSearch.order.orderNumber,createdAt:transactionSearch.objectCreated,status:transactionSearch.order.status,isReturn:transactionSearch.isReturn,isNewReturnExperience},customer:{name:null===(_a=transactionSearch.addressTo)||void 0===_a?void 0:_a.name,address:transactionSearch.addressTo,isLastRows:!!isLastRows},rate:{amount:Number(transactionSearch.rate.amount),amountInsuranceFee:Number(transactionSearch.rate.amountInsuranceFee),currency:constants_currency.q[transactionSearch.rate.currency],isReturn:transactionSearch.isReturn,wasTest:transactionSearch.wasTest,isNewReturnExperience},carrierService:{isMobile:!1,name:transactionSearch.rate.provider,serviceLevel:transactionSearch.rate.servicelevelName,trackingNumber:transactionSearch.trackingNumber,providerImage:transactionSearch.rate.provider&&(null===(_b=carriers.Ps[(0,Carrier.Z)(transactionSearch.rate.provider)])||void 0===_b?void 0:_b.icon),trackingUrlProvider:transactionSearch.trackingUrlProvider},status:{isMobile:!1,status:null===(_c=transactionSearch.trackingStatus)||void 0===_c?void 0:_c.status,statusDetails:(0,util.iM)(null===(_d=transactionSearch.trackingStatus)||void 0===_d?void 0:_d.statusDetails,transactionSearch.isReturn,isNewReturnExperience),transactionStatus:transactionSearch.objectStatus,messages:transactionSearch.messages,isLastRows:!!isLastRows},action:{refundRequestDate:transactionSearch.refundRequestDate,downloadLink:transactionSearch.trackingUrlProvider,trackStatus:null===(_e=transactionSearch.trackingStatus)||void 0===_e?void 0:_e.status,transactionStatus:transactionSearch.objectStatus},shipDate:{date:null===(_f=transactionSearch.trackingStatus)||void 0===_f?void 0:_f.statusDate,location:"".concat(null===(_g=transactionSearch.addressTo)||void 0===_g?void 0:_g.city," ").concat(null===(_h=transactionSearch.addressTo)||void 0===_h?void 0:_h.zip),submissionDate:transactionSearch.submissionDate},menu:{orderId:transactionSearch.order.id,trackStatus:null===(_j=transactionSearch.trackingStatus)||void 0===_j?void 0:_j.status,transactionStatus:transactionSearch.objectStatus,commercialInvoiceUrl:transactionSearch.commercialInvoiceUrl,isReturn:transactionSearch.isReturn,addressReturn:transactionSearch.addressReturn,addressTo:transactionSearch.addressTo},insurance:{insuranceCurrency:transactionSearch.insuranceCurrency,bookingId:transactionSearch.insuranceClaimId,insuranceProvider:transactionSearch.insuranceProvider,insuranceAmount:transactionSearch.insuranceAmount},createdBy:transactionSearch.createdBy}}(transactionSearch),resolve(output),[2,output];case 3:return e_1=_a.sent(),reject(e_1),[2,null];case 4:return[2]}var transactionObjectID}))}))}))}))},onCancelRefund}}(util_a={})[Transaction.x8.ERROR]=!0,util_a[Transaction.x8.REFUNDED]=!0,(_b={})[Track.S.UNKNOWN]=!0,_b[Track.S.PRE_TRANSIT]=!0,(_c={})[Track.S.RETURNED]=!0;var Content=(0,styled.Ay)("div")(RefundModal_templateObject_1||(RefundModal_templateObject_1=(0,tslib_es6.ue)(["\n  font-size: 1rem;\n\n  & > ul {\n    list-style: initial;\n  }\n"],["\n  font-size: 1rem;\n\n  & > ul {\n    list-style: initial;\n  }\n"]))),ComposedRefundModal=(0,utils_translate.Tl)("orders")((function(_a){var t=_a.t,hasInsurance=_a.hasInsurance,transactionId=_a.transactionId,isOpen=_a.isOpen,onClose=_a.onClose,onCancel=_a.onCancel,snackbar=(0,GlobalComponentsProvider.s)().snackbar,onRefundTransaction=useRefundTransaction().onRefundTransaction,_b=(0,tslib_es6.zs)((0,react.useState)(!1),2),isInsuranceAcknowledged=_b[0],setIsInsuranceAcknowledged=_b[1],_c=(0,tslib_es6.zs)((0,react.useState)(!1),2),isSubmitting=_c[0],setIsSubmitting=_c[1],handleClose=onClose,handleCancel=function(){onCancel?onCancel():onClose()};return(0,emotion_react_jsx_runtime_browser_esm.Y)(Dialog_Dialog.l,{open:!!isOpen,title:t("refund.title"),content:(0,emotion_react_jsx_runtime_browser_esm.FD)(Content,{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)("ul",{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("li",{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(utils_translate.x6,{i18nKey:"refund.bullets.0",components:[(0,emotion_react_jsx_runtime_browser_esm.Y)("a",(0,tslib_es6.Cl)({href:"https://support.goshippo.com/hc/en-us/articles/201772785",rel:"noreferrer noopener",target:"_blank"},{children:"0"}),0)]})}),(0,emotion_react_jsx_runtime_browser_esm.Y)("li",{children:t("refund.bullets.1")}),(0,emotion_react_jsx_runtime_browser_esm.Y)("li",{children:t("refund.bullets.2")}),(0,emotion_react_jsx_runtime_browser_esm.Y)("li",{children:t("refund.bullets.3")})]}),hasInsurance&&(0,emotion_react_jsx_runtime_browser_esm.Y)(FormControlLabel.A,{control:(0,emotion_react_jsx_runtime_browser_esm.Y)(Checkbox_Checkbox.A,{checked:isInsuranceAcknowledged,onChange:function(){return setIsInsuranceAcknowledged((function(v){return!v}))}}),label:t("refund.insuranceAcknowledge")})]}),actions:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Button_Button.A,(0,tslib_es6.Cl)({onClick:handleCancel,variant:"text",color:"secondary"},{children:t("refund.cancel")}),0),(0,emotion_react_jsx_runtime_browser_esm.FD)(Button_Button.A,(0,tslib_es6.Cl)({onClick:function(){return(0,tslib_es6.sH)(void 0,void 0,void 0,(function(){var error_1,errorCause,errorMessage,_a,_b,_c;return(0,tslib_es6.YH)(this,(function(_d){switch(_d.label){case 0:if(_d.trys.push([0,2,3,4]),utils_observability.O.startEvent("REFUND_REQUEST"),!transactionId)throw new Error("Transaction ID is missing");return setIsSubmitting(!0),[4,onRefundTransaction(transactionId)];case 1:return _d.sent(),snackbar.addSnackbarAlert(t("refund.result.success"),"success"),handleCancel(),setIsInsuranceAcknowledged(!1),utils_observability.O.successEvent("REFUND_REQUEST"),[3,4];case 2:return error_1=_d.sent(),errorCause="",errorCause=axios_default().isAxiosError(error_1)?null===(_c=null===(_b=null===(_a=error_1.response)||void 0===_a?void 0:_a.data)||void 0===_b?void 0:_b.transaction)||void 0===_c?void 0:_c.join(", "):error_1.message,errorMessage=t("refund.result.error"),snackbar.addSnackbarAlert(errorMessage,"error"),utils_observability.O.errorEvent("REFUND_REQUEST",{errorMessage,errorCause}),[3,4];case 3:return setIsSubmitting(!1),[7];case 4:return[2]}}))}))},color:"error",disabled:hasInsurance&&!isInsuranceAcknowledged||isSubmitting,sx:{gap:shippoTheme.A.spacing(2)}},{children:[isSubmitting&&(0,emotion_react_jsx_runtime_browser_esm.Y)(CircularProgress.A,{sx:{color:"inherit"},size:"small"}),(0,emotion_react_jsx_runtime_browser_esm.Y)("span",{children:t("refund.request")})]}),1)],onClose:handleClose})}));var RefundModal_templateObject_1;const All_RefundModal=ComposedRefundModal;var ModalAction;!function(ModalAction){ModalAction.EMAIL="EMAIL",ModalAction.REFUND="REFUND",ModalAction.RETURN="RETURN"}(ModalAction||(ModalAction={}));var ModalContainer=(0,emotion_styled_browser_esm.A)(Modal.A.Container)(TransactionModal_templateObject_1||(TransactionModal_templateObject_1=(0,tslib_es6.ue)(["\n  border-radius: 4px;\n"],["\n  border-radius: 4px;\n"]))),ModalHeader=(0,emotion_styled_browser_esm.A)("header")(TransactionModal_templateObject_2||(TransactionModal_templateObject_2=(0,tslib_es6.ue)(["\n  font-size: 24px;\n  border-bottom: 1px solid ",";\n  padding: 15px 20px;\n"],["\n  font-size: 24px;\n  border-bottom: 1px solid ",";\n  padding: 15px 20px;\n"])),styles_colors.T.gray50),ModalBody=(0,emotion_styled_browser_esm.A)(Modal.A.Body)(TransactionModal_templateObject_3||(TransactionModal_templateObject_3=(0,tslib_es6.ue)(["\n  padding: 20px 25px;\n"],["\n  padding: 20px 25px;\n"]))),ModalFooter=(0,emotion_styled_browser_esm.A)(Modal.A.Footer)(TransactionModal_templateObject_4||(TransactionModal_templateObject_4=(0,tslib_es6.ue)(["\n  display: flex;\n  justify-content: flex-end;\n  position: absolute;\n  bottom: 0px;\n  left: 0px;\n  right: 0px;\n  overflow: hidden;\n"],["\n  display: flex;\n  justify-content: flex-end;\n  position: absolute;\n  bottom: 0px;\n  left: 0px;\n  right: 0px;\n  overflow: hidden;\n"]))),TransactionProperty=(0,emotion_styled_browser_esm.A)("span")(TransactionModal_templateObject_5||(TransactionModal_templateObject_5=(0,tslib_es6.ue)(["\n  margin-right: 5px;\n  font-size: 12px;\n  width: auto;\n"],["\n  margin-right: 5px;\n  font-size: 12px;\n  width: auto;\n"]))),ServiceLevel=(0,emotion_styled_browser_esm.A)(TransactionProperty)(TransactionModal_templateObject_6||(TransactionModal_templateObject_6=(0,tslib_es6.ue)(["\n  font-weight: ",";\n"],["\n  font-weight: ",";\n"])),styles_constants.Wy.medium),TransactionTable=(0,emotion_styled_browser_esm.A)(components_Table)(TransactionModal_templateObject_7||(TransactionModal_templateObject_7=(0,tslib_es6.ue)(["\n  table-layout: auto;\n"],["\n  table-layout: auto;\n"]))),TransactionModal_TransactionModal=function(_super){function TransactionModal(props){var _this=_super.call(this,props)||this;return _this.transactionTableColumns=[{header:"",cell:function(_a){var data=_a.data;return(0,emotion_react_jsx_runtime_browser_esm.Y)("img",{src:data.rate.providerImage75,alt:data.rate.provider})}},{header:"",cell:function(_a){var data=_a.data;return(0,emotion_react_jsx_runtime_browser_esm.Y)(ServiceLevel,{children:data.rate.servicelevelName})}},{header:"",cell:function(_a){var data=_a.data;return(0,emotion_react_jsx_runtime_browser_esm.FD)(TransactionProperty,{children:["$",data.rate.amount]})}},{header:"",cell:function(_a){var data=_a.data;return data.addressTo?(0,emotion_react_jsx_runtime_browser_esm.FD)(TransactionProperty,{children:[data.addressTo.name,", ",data.addressTo.city]}):null}},{header:"",cell:function(_a){var data=_a.data;return(0,emotion_react_jsx_runtime_browser_esm.Y)(TransactionProperty,{children:data.objectCreated.format("L")})}},{header:"",cell:function(_a){var data=_a.data;return(0,emotion_react_jsx_runtime_browser_esm.Y)(TransactionProperty,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Link.ic,(0,tslib_es6.Cl)({href:data.trackingUrlProvider,target:"_blank"},{children:data.trackingNumber}))})}},{header:"",cell:function(_a){var data=_a.data;return(0,emotion_react_jsx_runtime_browser_esm.Y)(TransactionModal_TransactionActionButton,{transaction:data,action:_this.props.action,orderId:_this.props.orderId,setTransaction:_this.setTransaction})}}],_this.renderRows=function(){var tableMessage=0===_this.props.transactions.length?_this.props.t("orders:shipments:noneFound"):void 0;return(0,emotion_react_jsx_runtime_browser_esm.Y)(TransactionTable,{message:tableMessage,data:_this.props.transactions,columns:_this.transactionTableColumns})},_this.setTransaction=function(transaction){_this.setState({selectedTransaction:transaction})},_this.state={selectedTransaction:null},_this}return(0,tslib_es6.C6)(TransactionModal,_super),TransactionModal.prototype.render=function(){var _this=this,_a=this.props,t=_a.t,isOpen=_a.isOpen,closeTransactionModal=_a.closeTransactionModal,selectedTransaction=this.state.selectedTransaction;return selectedTransaction?(0,emotion_react_jsx_runtime_browser_esm.Y)(All_RefundModal,{isOpen:!0,onClose:function(){return _this.setTransaction(null)},onCancel:closeTransactionModal,transactionId:selectedTransaction.objectId,hasInsurance:selectedTransaction.rate.insurance}):(0,emotion_react_jsx_runtime_browser_esm.FD)(ModalContainer,(0,tslib_es6.Cl)({isOpen,size:"xl",onClose:closeTransactionModal,closeOnClickOutside:!0,scrollContent:!0},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(ModalHeader,{children:t("orders:shipments:title")}),(0,emotion_react_jsx_runtime_browser_esm.Y)(ModalBody,{children:this.renderRows()}),(0,emotion_react_jsx_runtime_browser_esm.Y)(ModalFooter,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Button.vM,(0,tslib_es6.Cl)({onClick:closeTransactionModal},{children:t("orders:phrases:cancel")}))})]}))},TransactionModal}(react.PureComponent);(0,utils_translate.Tl)("orders")(TransactionModal_TransactionModal);var TransactionModal_templateObject_1,TransactionModal_templateObject_2,TransactionModal_templateObject_3,TransactionModal_templateObject_4,TransactionModal_templateObject_5,TransactionModal_templateObject_6,TransactionModal_templateObject_7;var react_router=__webpack_require__("./node_modules/react-router/esm/react-router.js");function openLinkInNewTab(link){var win=window.open(link,"_blank");win&&win.focus()}function navigation_createWindowRef(loadingState){try{var windowRef=window.open("","_blank");if(!windowRef)return null;var metaTag=windowRef.document.createElement("meta");return metaTag.name="viewport",metaTag.content="width=device-width, initial-scale=1",windowRef.document.getElementsByTagName("head")[0].appendChild(metaTag),windowRef.document.body.innerHTML=loadingState,windowRef}catch(_){return null}}var DropdownListCell=(0,emotion_styled_browser_esm.A)(DropdownList_DropdownList)(OrderActionMenu_templateObject_1||(OrderActionMenu_templateObject_1=(0,tslib_es6.ue)(["\n  justify-content: flex-end;\n"],["\n  justify-content: flex-end;\n"]))),OrderActionMenuComponent=function(_super){function OrderActionMenuComponent(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.getOrderState=function(ordersRenderData){var order=ordersRenderData.order;if("partial-child"===ordersRenderData.kind){var batchEntry_1=ordersRenderData.batchEntry;if(!batchEntry_1.transactionObjectId)return Order.cH.NOT_FULFILLED;var transaction=order.transactions.find((function(t){return t.objectId===batchEntry_1.transactionObjectId}));return(null==transaction?void 0:transaction.status)===Transaction.x8.REFUNDPENDING?Order.cH.REFUND_PENDING:transaction&&(null==transaction?void 0:transaction.status)===Transaction.x8.SUCCESS?Order.cH.FULFILLED_SINGLE_LABEL:Order.cH.NOT_FULFILLED}return(0,Order.AU)(order)},_this.getPrimaryButtonType=function(){switch(_this.getOrderState(_this.props.ordersRenderData)){case Order.cH.REFUNDED:case Order.cH.REFUND_REJECTED:case Order.cH.REFUND_PENDING:case Order.cH.FULFILLED_OUTSIDE_SHIPPO:case Order.cH.CANCELLED:case Order.cH.FULFILLED_SINGLE_LABEL:case Order.cH.FULFILLED_MULTIPLE_LABELS:return components_Button.EY.GreyPrimaryAlternative;case Order.cH.NOT_FULFILLED:case Order.cH.PARTIALLY_FULFILLED_SINGLE_LABEL:case Order.cH.PARTIALLY_FULFILLED_SINGLE_REFUND:case Order.cH.PARTIALLY_FULFILLED_MULTIPLE_LABELS:return components_Button.EY.Primary}},_this.getSecondaryButtonType=function(){switch(_this.getOrderState(_this.props.ordersRenderData)){case Order.cH.REFUNDED:case Order.cH.REFUND_REJECTED:case Order.cH.REFUND_PENDING:case Order.cH.FULFILLED_OUTSIDE_SHIPPO:case Order.cH.CANCELLED:case Order.cH.FULFILLED_SINGLE_LABEL:case Order.cH.FULFILLED_MULTIPLE_LABELS:return components_Button.EY.GreyPrimaryAlternative;case Order.cH.NOT_FULFILLED:case Order.cH.PARTIALLY_FULFILLED_SINGLE_LABEL:case Order.cH.PARTIALLY_FULFILLED_SINGLE_REFUND:case Order.cH.PARTIALLY_FULFILLED_MULTIPLE_LABELS:return components_Button.EY.Primary}},_this.getSelection=function(){var _a,batchEntry=_this.props.ordersRenderData.batchEntry;return(_a={})[_this.props.ordersRenderData.order.objectId]=batchEntry?[batchEntry.id]:[],_a},_this.createLabel=function(){var _a=_this.props,_b=_a.ordersRenderData,order=_b.order,batchEntry=_b.batchEntry,isReadyToCheckout=_a.isReadyToCheckout;return _a.isSenderAddressValid?isReadyToCheckout?_this.props.startCheckout(order.objectId,batchEntry.id):_this.openOrderScreen():_this.props.toggleInvalidAddressModal()},_this.openOrderScreen=function(){var _a=_this.props.ordersRenderData,batchEntry=_a.batchEntry,order=_a.order,url="/orders/".concat(order.objectId);batchEntry&&(url="".concat(url,"/shipments/").concat(batchEntry.id)),_this.props.history.push(url)},_this.createAnotherLabel=function(){var _a=_this.props,ordersRenderData=_a.ordersRenderData,createAnotherLabel=_a.createAnotherLabel;_this.getOrderState(ordersRenderData)!==Order.cH.FULFILLED_OUTSIDE_SHIPPO?createAnotherLabel(_this.getSelection()):_this.openOrderScreen()},_this.printLabel=function(){var _a=_this.props,getLabel=_a.getLabel,defaultLabelFormat=_a.defaultLabelFormat,_b=_a.ordersRenderData,order=_b.order,batchEntry=_b.batchEntry,orderSelection=_this.getSelection();if((0,Order.cs)(order))return getLabel([order.transactions[order.transactions.length-1].objectId],defaultLabelFormat,navigation_createWindowRef(components_HTMLLoadingState)),void(0,utils.MH)("order_table","shipping_label",orderSelection);if(batchEntry&&(0,OrderBatchEntry.xW)(batchEntry)){var partialFulfillmentTransaction=order.transactions.find((function(transaction){return transaction.objectId===batchEntry.transactionObjectId}));if(partialFulfillmentTransaction)return openLinkInNewTab(partialFulfillmentTransaction.labelUrl),void(0,utils.MH)("order_table","shipping_label",orderSelection)}openLinkInNewTab(order.transactions[order.transactions.length-1].labelUrl),(0,utils.MH)("order_table","shipping_label",orderSelection)},_this.createReturnLabel=function(){var _a=_this.props.ordersRenderData,order=_a.order,batchEntry=_a.batchEntry;if(order.transactions.length>0){var transactionId=(null==batchEntry?void 0:batchEntry.transactionObjectId)||order.transactions[order.transactions.length-1].objectId;return"".concat("https://dev-qa.shippodev.com","/user/orders/fulfill/").concat(order.objectId,"/return_of/").concat(transactionId)}return"".concat("https://dev-qa.shippodev.com","/user/orders/fulfill/").concat(order.objectId,"/return/")},_this.downloadPackingSlip=function(){var orderSelection=_this.getSelection(),windowRef=navigation_createWindowRef(components_HTMLLoadingState);_this.props.getOrderPackingSlip(orderSelection,windowRef),(0,utils.MH)("order_table","packing_slip",orderSelection)},_this.findCommercialInvoiceUrl=function(){var _a,txns=_this.props.ordersRenderData.order.transactions,txnId=null===(_a=_this.props.ordersRenderData.batchEntry)||void 0===_a?void 0:_a.transactionObjectId,thisTransaction=txns.find((function(txn){return txn.objectId===txnId}));return null==thisTransaction?void 0:thisTransaction.commercialInvoiceUrl},_this.downloadCommercialInvoice=function(){var commercialInvoiceUrl=_this.findCommercialInvoiceUrl();commercialInvoiceUrl&&openLinkInNewTab(commercialInvoiceUrl)},_this.getAllLabels=function(){var orderSelection=_this.getSelection();_this.props.getAllLabels(orderSelection)},_this.addNote=function(){var orderSelection=_this.getSelection();_this.props.openOrderNoteModal(orderSelection)},_this.fetchOrderTxns=function(modalAction){modalAction===ModalAction.REFUND&&_this.props.sendGTMEvent("SET_REFUND_STARTED_EVENT");var orderObjectId=_this.props.ordersRenderData.order.objectId;_this.props.openTransactionModal(modalAction,orderObjectId),_this.props.fetchOrderTxns(orderObjectId)},_this.hideOrder=function(){_this.props.hideOrder(_this.props.ordersRenderData.order.objectId)},_this.retryShipment=function(){var orderSelection=_this.getSelection();_this.props.retryShipment(orderSelection)},_this.openLabelDownloadBlockedErrorDialog=function(){return _this.props.showErrorDialog({messages:[_this.props.t("orders:downloadLabel:error:fraud")],closeButtonText:"Close"})},_this.stopPropagationAction=function(func){return function(evt){evt.stopPropagation(),func()}},_this.splitOrder=function(){_this.props.openOrderSplitModal(_this.props.ordersRenderData.order.objectId)},_this.getOrderActions=function(){var actions=[],_a=_this.props,ordersRenderData=_a.ordersRenderData,t=_a.t,isReadyToCheckout=_a.isReadyToCheckout,orderState=_this.getOrderState(ordersRenderData),order=ordersRenderData.order,kind=ordersRenderData.kind,isEligibleForPartialFulfillment=(0,Order.FC)(order),isPartialChildKind="partial-child"===kind,returnAction=_this.props.isSenderAddressValid?{href:_this.createReturnLabel()}:{onClick:_this.stopPropagationAction(_this.props.toggleInvalidAddressModal)},createLabel={text:t(isReadyToCheckout?"orders:actions:single:buy":"orders:actions:single:createLabel"),onClick:_this.stopPropagationAction(_this.createLabel),tagName:"orders-create-label"},printLabel={text:t("orders:actions:single:download"),onClick:_this.stopPropagationAction(_this.printLabel),tagName:"orders-download-label"},printLabels={text:t("orders:actions:single:download"),onClick:_this.stopPropagationAction(_this.getAllLabels),tagName:"orders-download-label"},addPackingSlipNote={text:t("orders:actions:single:addNote"),onClick:_this.stopPropagationAction(_this.addNote),tagName:"orders-add-note"},createAnotherLabel={text:t("orders:actions:single:createAnother"),onClick:_this.stopPropagationAction(_this.createAnotherLabel),tagName:"orders-create-another-label"},createReturnLabel=(0,tslib_es6.Cl)({text:t("orders:actions:single:createReturn"),tagName:"orders-create-standalone-return"},returnAction),downloadPackingSlip={text:t("orders:actions:single:downloadSlip"),onClick:_this.stopPropagationAction(_this.downloadPackingSlip),tagName:""},downloadCommercialInvoice={text:t("orders:actions:single:downloadCommercialInvoice"),onClick:_this.stopPropagationAction(_this.downloadCommercialInvoice),tagName:"orders-download-commercial-invoice"},sendNotificationEmail={text:t("orders:actions:single:sendEmail"),onClick:_this.stopPropagationAction(_this.fetchOrderTxns.bind(_this,ModalAction.EMAIL)),tagName:"orders-send-notification"},refundLabel={text:t("orders:actions:single:refundLabel"),onClick:_this.stopPropagationAction(_this.fetchOrderTxns.bind(_this,ModalAction.REFUND)),tagName:"orders-refund-label"},refundLabels={text:t("orders:actions:single:refundLabels"),onClick:_this.stopPropagationAction(_this.fetchOrderTxns.bind(_this,ModalAction.REFUND)),tagName:"orders-refund-label"},returnLabels={text:t("orders:actions:single:createReturn"),onClick:_this.stopPropagationAction(_this.fetchOrderTxns.bind(_this,ModalAction.RETURN)),tagName:"orders-create-standalone-return"},hideOrderOption={text:order.hidden?t("orders:actions:single:unhide"):t("orders:actions:single:hide"),onClick:_this.stopPropagationAction(_this.hideOrder),tagName:order.hidden?"orders-unhide-order":"orders-hide-order"},splitOrder={text:t("orders:actions:single:splitOrder"),onClick:_this.stopPropagationAction(_this.splitOrder),tagName:"order-split"},shouldShowDownloadCommercialInvoice=_this.findCommercialInvoiceUrl();switch(orderState){case Order.cH.REFUNDED:actions=(0,tslib_es6.fX)([createAnotherLabel],(0,tslib_es6.zs)(isPartialChildKind?[]:[hideOrderOption]),!1);break;case Order.cH.REFUND_REJECTED:case Order.cH.REFUND_PENDING:actions=(0,tslib_es6.fX)((0,tslib_es6.fX)((0,tslib_es6.fX)((0,tslib_es6.fX)([sendNotificationEmail],(0,tslib_es6.zs)(isPartialChildKind?[]:[createReturnLabel]),!1),[createAnotherLabel],!1),(0,tslib_es6.zs)(shouldShowDownloadCommercialInvoice?[downloadCommercialInvoice]:[]),!1),(0,tslib_es6.zs)(isPartialChildKind?[]:[hideOrderOption]),!1);break;case Order.cH.FULFILLED_OUTSIDE_SHIPPO:actions=(0,tslib_es6.fX)((0,tslib_es6.fX)([createAnotherLabel],(0,tslib_es6.zs)(isPartialChildKind?[]:[createReturnLabel]),!1),(0,tslib_es6.zs)(isPartialChildKind?[]:[hideOrderOption]),!1);break;case Order.cH.FULFILLED_SINGLE_LABEL:actions=(0,tslib_es6.fX)((0,tslib_es6.fX)((0,tslib_es6.fX)((0,tslib_es6.fX)([sendNotificationEmail,refundLabel,downloadPackingSlip,addPackingSlipNote],(0,tslib_es6.zs)(isPartialChildKind?[]:[createReturnLabel]),!1),[createAnotherLabel],!1),(0,tslib_es6.zs)(shouldShowDownloadCommercialInvoice?[downloadCommercialInvoice]:[]),!1),(0,tslib_es6.zs)(isPartialChildKind?[]:[hideOrderOption]),!1);break;case Order.cH.FULFILLED_MULTIPLE_LABELS:actions=(0,tslib_es6.fX)((0,tslib_es6.fX)((0,tslib_es6.fX)((0,tslib_es6.fX)([sendNotificationEmail,refundLabels,downloadPackingSlip,addPackingSlipNote],(0,tslib_es6.zs)(isPartialChildKind?[]:[returnLabels]),!1),[createAnotherLabel],!1),(0,tslib_es6.zs)(shouldShowDownloadCommercialInvoice?[downloadCommercialInvoice]:[]),!1),(0,tslib_es6.zs)(isPartialChildKind?[]:[hideOrderOption]),!1);break;case Order.cH.PARTIALLY_FULFILLED_SINGLE_LABEL:actions=(0,tslib_es6.fX)((0,tslib_es6.fX)((0,tslib_es6.fX)((0,tslib_es6.fX)([createLabel,printLabel,sendNotificationEmail,refundLabel,downloadPackingSlip,addPackingSlipNote],(0,tslib_es6.zs)(isPartialChildKind?[]:[createReturnLabel]),!1),[createAnotherLabel],!1),(0,tslib_es6.zs)(shouldShowDownloadCommercialInvoice?[downloadCommercialInvoice]:[]),!1),(0,tslib_es6.zs)(isPartialChildKind?[]:[hideOrderOption]),!1);break;case Order.cH.PARTIALLY_FULFILLED_SINGLE_REFUND:actions=(0,tslib_es6.fX)((0,tslib_es6.fX)((0,tslib_es6.fX)((0,tslib_es6.fX)([createLabel,printLabel,sendNotificationEmail,downloadPackingSlip,addPackingSlipNote],(0,tslib_es6.zs)(isPartialChildKind?[]:[createReturnLabel]),!1),[createAnotherLabel],!1),(0,tslib_es6.zs)(shouldShowDownloadCommercialInvoice?[downloadCommercialInvoice]:[]),!1),(0,tslib_es6.zs)(isPartialChildKind?[]:[hideOrderOption]),!1);break;case Order.cH.PARTIALLY_FULFILLED_MULTIPLE_LABELS:actions=(0,tslib_es6.fX)((0,tslib_es6.fX)((0,tslib_es6.fX)((0,tslib_es6.fX)([createLabel,printLabels,sendNotificationEmail,refundLabels,downloadPackingSlip,addPackingSlipNote],(0,tslib_es6.zs)(isPartialChildKind?[]:[returnLabels]),!1),[createAnotherLabel],!1),(0,tslib_es6.zs)(shouldShowDownloadCommercialInvoice?[downloadCommercialInvoice]:[]),!1),(0,tslib_es6.zs)(isPartialChildKind?[]:[hideOrderOption]),!1);break;case Order.cH.CANCELLED:actions=(0,tslib_es6.fX)([],(0,tslib_es6.zs)(isPartialChildKind?[]:[hideOrderOption]),!1);break;case Order.cH.NOT_FULFILLED:actions=(0,tslib_es6.fX)((0,tslib_es6.fX)([downloadPackingSlip,addPackingSlipNote],(0,tslib_es6.zs)(isPartialChildKind?[]:[hideOrderOption]),!1),(0,tslib_es6.zs)(isEligibleForPartialFulfillment?[splitOrder]:[]),!1)}return actions},_this.getPrimaryActionMetadata=function(){var onPrimaryActionClick,primaryActionText,primaryActionPendoTag,_a=_this.props,t=_a.t,order=_a.ordersRenderData.order,needNewRates=_a.needNewRates,isSenderAddressValid=_a.isSenderAddressValid,isReadyToCheckout=_a.isReadyToCheckout;return onPrimaryActionClick=needNewRates?_this.stopPropagationAction(_this.openOrderScreen):isSenderAddressValid||(0,Order.Dd)(order)?_this.stopPropagationAction(_this.createLabel):_this.stopPropagationAction(_this.openOrderScreen),needNewRates?(primaryActionText=t("orders:actions:single:viewOrder"),primaryActionPendoTag="orders-edit-label"):isReadyToCheckout?(primaryActionText=t("orders:actions:single:buy"),primaryActionPendoTag="orders-buy-label"):(primaryActionText=t("orders:actions:single:viewOrder"),primaryActionPendoTag="orders-edit-label"),[onPrimaryActionClick,primaryActionText,primaryActionPendoTag]},_this.renderPrimaryActionComponent=function(){var _a,onPrimaryActionClick,primaryActionText,primaryActionPendoTag,_b=_this.props,ordersRenderData=_b.ordersRenderData,batchMode=_b.batchMode,primaryButtonType=_this.getPrimaryButtonType(),orderState=_this.getOrderState(ordersRenderData),active=[Order.cH.NOT_FULFILLED,Order.cH.FULFILLED_SINGLE_LABEL,Order.cH.FULFILLED_MULTIPLE_LABELS].includes(orderState);switch(orderState){case Order.cH.CANCELLED:primaryActionText=_this.props.t("orders:actions:single:cancelled");break;case Order.cH.REFUNDED:primaryActionText=_this.props.t("orders:actions:single:refunded");break;case Order.cH.REFUND_REJECTED:primaryActionText=_this.props.t("orders:actions:single:refundRejected");break;case Order.cH.REFUND_PENDING:primaryActionText=_this.props.t("orders:actions:single:refundPending");break;case Order.cH.FULFILLED_OUTSIDE_SHIPPO:primaryActionText=_this.props.t("orders:actions:single:fulfilled");break;case Order.cH.FULFILLED_SINGLE_LABEL:_this.props.isUserLabelDownloadBlocked?(onPrimaryActionClick=_this.stopPropagationAction(_this.openLabelDownloadBlockedErrorDialog),primaryActionText="Error",primaryActionPendoTag="orders-download-label-blocked"):(onPrimaryActionClick=_this.stopPropagationAction(_this.printLabel),primaryActionText=_this.props.t("orders:actions:single:download"),primaryActionPendoTag="orders-download-label");break;case Order.cH.FULFILLED_MULTIPLE_LABELS:_this.props.isUserLabelDownloadBlocked?(onPrimaryActionClick=_this.stopPropagationAction(_this.openLabelDownloadBlockedErrorDialog),primaryActionText="Error",primaryActionPendoTag="orders-download-label-blocked"):(onPrimaryActionClick=_this.stopPropagationAction(_this.getAllLabels),primaryActionText=_this.props.t("orders:actions:single:download"),primaryActionPendoTag="orders-download-label");break;case Order.cH.NOT_FULFILLED:case Order.cH.PARTIALLY_FULFILLED_SINGLE_LABEL:case Order.cH.PARTIALLY_FULFILLED_SINGLE_REFUND:case Order.cH.PARTIALLY_FULFILLED_MULTIPLE_LABELS:onPrimaryActionClick=(_a=(0,tslib_es6.zs)(_this.getPrimaryActionMetadata(),3))[0],primaryActionText=_a[1],primaryActionPendoTag=_a[2]}return(0,emotion_react_jsx_runtime_browser_esm.Y)(DropdownList_PrimaryAction,(0,tslib_es6.Cl)({buttonType:primaryButtonType,disabled:batchMode||!active,dataPendo:primaryActionPendoTag,onClick:onPrimaryActionClick},{children:primaryActionText}))},_this}return(0,tslib_es6.C6)(OrderActionMenuComponent,_super),OrderActionMenuComponent.prototype.render=function(){var actions=this.getOrderActions();return(0,emotion_react_jsx_runtime_browser_esm.Y)(DropdownListCell,(0,tslib_es6.Cl)({triggerButtonType:this.getSecondaryButtonType(),primaryActionComponent:this.renderPrimaryActionComponent,disabled:this.props.batchMode,triggerDataE2E:"open-order-action-dropdown"},{children:actions.map((function(option){var text=option.text,tagName=option.tagName,props=(0,tslib_es6.Tt)(option,["text","tagName"]);return(0,emotion_react_browser_esm.n)(DropdownList_DropdownOption,(0,tslib_es6.Cl)({},props,{key:text,dataPendo:tagName||void 0}),text)}))}))},OrderActionMenuComponent}(react.Component),ComposedOrderActionMenu=(0,redux.Zz)((0,es.Ng)((function(){var getDoesBatchEntryNeedNewRates=(0,batch_entry_selectors.Vw)();return function(state,ownProps){var batchEntry=ownProps.ordersRenderData.batchEntry;return{packingSlipUrl:(0,orders_selectors.Bq)(state),singleLabelFlowTest:state.featureTests.testVariantByFeature["Single Label Flow Test"],isSenderAddressValid:(0,user_selectors.Oz)(state),isReadyToCheckout:batchEntry&&(0,batch_entry_composite_selectors.P5)(state,{batchEntryId:batchEntry.id}),needNewRates:batchEntry&&getDoesBatchEntryNeedNewRates(state,{batchEntryId:batchEntry.id}),defaultLabelFormat:(0,user_selectors.Hz)(state),isUserLabelDownloadBlocked:(0,user_selectors.ch)(state),batchMode:!!(0,orders_selectors.Li)(state).length}}}),(function(dispatch){return{getOrderPackingSlip:function(orderSelection,windowRef){return dispatch((0,orders_actions.JO)(orderSelection,windowRef,"other"))},getLabel:function(transactionIds,labelFormat,windowRef){return dispatch((0,orders_actions.p9)(transactionIds,labelFormat,windowRef))},getAllLabels:function(orderSelection){return dispatch((0,orders_actions.fn)(orderSelection))},fetchOrderTxns:function(objectId){return dispatch((0,orders_actions.cn)(objectId))},startCheckout:function(orderObjectId,batchEntryId){var _a;return dispatch((0,orders_actions.dT)(((_a={})[orderObjectId]=[batchEntryId],_a)))},createAnotherLabel:function(orderSelection){return dispatch((0,orders_actions.GT)(orderSelection))},retryShipment:function(orderSelection){return dispatch((0,orders_actions.lN)(orderSelection))},openOrderSplitModal:function(orderObjectId){return dispatch((0,orders_actions.gW)(orderObjectId))},showErrorDialog:function(errorDialogProps){return dispatch(showDialog(errorDialogProps,"error"))},sendGTMEvent:function(gtmEventString){return dispatch(sendGTMEvent({eventName:gtmEventString}))}}})),(0,utils_translate.Tl)(),react_router.y)(OrderActionMenuComponent);var OrderActionMenu_templateObject_1;const All_OrderActionMenu=ComposedOrderActionMenu;var ParentOrderActionMenu_DropdownListCell=(0,emotion_styled_browser_esm.A)(DropdownList_DropdownList)(ParentOrderActionMenu_templateObject_1||(ParentOrderActionMenu_templateObject_1=(0,tslib_es6.ue)(["\n  justify-content: flex-end;\n"],["\n  justify-content: flex-end;\n"]))),ParentOrderActionMenu=function(_super){function ParentOrderActionMenu(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.openOrderScreen=function(){var _a=_this.props,push=_a.history.push,order=_a.order,batchEntry=order.partialFulfillmentRequests[0];push("/orders/".concat(order.objectId,"/shipments/").concat(batchEntry.id))},_this.fetchOrderTxns=function(modalAction){var orderObjectId=_this.props.order.objectId;_this.props.openTransactionModal(modalAction,orderObjectId),_this.props.fetchOrderTxns(orderObjectId)},_this.createReturnLabel=function(){var order=_this.props.order;return order.transactions.length>0?"".concat("https://dev-qa.shippodev.com","/user/orders/fulfill/").concat(order.objectId,"/return_of/").concat(order.transactions[order.transactions.length-1].objectId):"".concat("https://dev-qa.shippodev.com","/user/orders/fulfill/").concat(order.objectId,"/return/")},_this.hideOrder=function(){_this.props.hideOrder(_this.props.order.objectId)},_this.stopPropagationAction=function(func){return function(evt){evt.stopPropagation(),func()}},_this.renderOrderActionMenu=function(){var _a=_this.props,t=_a.t,order=_a.order,orderState=(0,Order.AU)(order),returnAction=_this.props.isSenderAddressValid?{href:_this.createReturnLabel()}:{onClick:_this.stopPropagationAction(_this.props.toggleInvalidAddressModal)},createReturnLabel=(0,tslib_es6.Cl)({text:t("orders:actions:single:createReturn"),tagName:"orders-create-standalone-return"},returnAction),returnLabels={text:t("orders:actions:single:createReturn"),onClick:_this.stopPropagationAction(_this.fetchOrderTxns.bind(_this,ModalAction.RETURN)),tagName:"orders-create-standalone-return"},actions=[{text:order.hidden?t("orders:actions:single:unhide"):t("orders:actions:single:hide"),onClick:_this.stopPropagationAction(_this.hideOrder),tagName:_this.props.order.hidden?"orders-unhide-order":"orders-hide-order"}];switch(orderState){case Order.cH.REFUND_REJECTED:case Order.cH.REFUND_PENDING:case Order.cH.FULFILLED_SINGLE_LABEL:case Order.cH.FULFILLED_OUTSIDE_SHIPPO:case Order.cH.PARTIALLY_FULFILLED_SINGLE_LABEL:case Order.cH.PARTIALLY_FULFILLED_SINGLE_REFUND:actions.push(createReturnLabel);break;case Order.cH.FULFILLED_MULTIPLE_LABELS:case Order.cH.PARTIALLY_FULFILLED_MULTIPLE_LABELS:actions.push(returnLabels)}return actions.map(_this.renderDropdownOption)},_this.renderDropdownOption=function(option){var text=option.text,tagName=option.tagName,props=(0,tslib_es6.Tt)(option,["text","tagName"]);return(0,emotion_react_browser_esm.n)(DropdownList_DropdownOption,(0,tslib_es6.Cl)({},props,{key:text,dataPendo:tagName}),text)},_this.renderPrimaryActionComponent=function(){var t=_this.props.t;return(0,emotion_react_jsx_runtime_browser_esm.Y)(DropdownList_PrimaryAction,(0,tslib_es6.Cl)({buttonType:components_Button.EY.GreyPrimaryAlternative,onClick:_this.stopPropagationAction(_this.openOrderScreen)},{children:t("orders:actions:single:viewOrder")}))},_this}return(0,tslib_es6.C6)(ParentOrderActionMenu,_super),ParentOrderActionMenu.prototype.render=function(){return(0,emotion_react_jsx_runtime_browser_esm.Y)(ParentOrderActionMenu_DropdownListCell,(0,tslib_es6.Cl)({triggerButtonType:components_Button.EY.GreyPrimaryAlternative,primaryActionComponent:this.renderPrimaryActionComponent,disabled:this.props.batchMode},{children:this.renderOrderActionMenu()}))},ParentOrderActionMenu}(react.Component);var ParentOrderActionMenu_templateObject_1;const All_ParentOrderActionMenu=(0,redux.Zz)((0,es.Ng)((function(state){return{isSenderAddressValid:(0,user_selectors.Oz)(state),batchMode:!!(0,orders_selectors.Li)(state).length}}),(function(dispatch){return{fetchOrderTxns:function(objectId){return dispatch((0,orders_actions.cn)(objectId))}}})),(0,utils_translate.Tl)(),react_router.y)(ParentOrderActionMenu);var SingleOrderActions=function(_super){function SingleOrderActions(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.getPrimaryButtonType=function(){switch((0,Order.AU)(_this.props.order)){case Order.cH.REFUNDED:case Order.cH.REFUND_REJECTED:case Order.cH.REFUND_PENDING:case Order.cH.FULFILLED_OUTSIDE_SHIPPO:case Order.cH.FULFILLED_SINGLE_LABEL:case Order.cH.FULFILLED_MULTIPLE_LABELS:case Order.cH.CANCELLED:return components_Button.EY.GreyPrimaryAlternative;case Order.cH.NOT_FULFILLED:case Order.cH.PARTIALLY_FULFILLED_SINGLE_LABEL:case Order.cH.PARTIALLY_FULFILLED_SINGLE_REFUND:case Order.cH.PARTIALLY_FULFILLED_MULTIPLE_LABELS:return components_Button.EY.SmallPrimaryExternalLink}},_this.getSecondaryButtonType=function(){switch((0,Order.AU)(_this.props.order)){case Order.cH.REFUNDED:case Order.cH.REFUND_REJECTED:case Order.cH.REFUND_PENDING:case Order.cH.FULFILLED_OUTSIDE_SHIPPO:case Order.cH.FULFILLED_SINGLE_LABEL:case Order.cH.FULFILLED_MULTIPLE_LABELS:case Order.cH.CANCELLED:return components_Button.EY.GreyPrimaryAlternative;case Order.cH.NOT_FULFILLED:case Order.cH.PARTIALLY_FULFILLED_SINGLE_LABEL:case Order.cH.PARTIALLY_FULFILLED_SINGLE_REFUND:case Order.cH.PARTIALLY_FULFILLED_MULTIPLE_LABELS:return components_Button.EY.SmallPrimary}},_this.createLabelLink=function(){var testVariant=_this.props.singleLabelFlowTest,orderObjectId=_this.props.order.objectId;return testVariant?"Single Label Express"===testVariant.name?"".concat("#","/fulfill/").concat(orderObjectId,"/shipment/new"):"".concat("#","/orders/").concat(orderObjectId,"/label"):"".concat("#","/fulfillment/interstitial/").concat(orderObjectId)},_this.printLabel=function(){var _a,_b,_c=_this.props,getLabel=_c.getLabel,defaultLabelFormat=_c.defaultLabelFormat,order=_c.order;if((0,Order.cs)(order))return getLabel([order.transactions[0].objectId],defaultLabelFormat,navigation_createWindowRef(components_HTMLLoadingState)),void(0,utils.MH)("order_table","shipping_label",(_a={},_a[order.objectId]=[],_a));openLinkInNewTab(order.transactions[0].labelUrl),(0,utils.MH)("order_table","shipping_label",((_b={})[order.objectId]=[],_b))},_this.createReturnLabel=function(){return _this.props.order.transactions.length>0?"".concat("https://dev-qa.shippodev.com","/user/orders/fulfill/").concat(_this.props.order.objectId,"/return_of/").concat(_this.props.order.transactions[0].objectId):"".concat("https://dev-qa.shippodev.com","/user/orders/fulfill/").concat(_this.props.order.objectId,"/return/")},_this.downloadPackingSlip=function(){var windowRef=navigation_createWindowRef(components_HTMLLoadingState);_this.props.getOrderPackingSlip(_this.props.order.objectId,windowRef)},_this.getAllLabels=function(){_this.props.getAllLabels(_this.props.order.objectId)},_this.fetchOrderTxns=function(modalAction){var orderObjectId=_this.props.order.objectId;_this.props.openTransactionModal(modalAction,orderObjectId),_this.props.fetchOrderTxns(orderObjectId)},_this.hideOrder=function(){_this.props.hideOrder(_this.props.order.objectId)},_this.stopPropagationAction=function(func){return function(evt){evt.stopPropagation(),func()}},_this.renderSingleOrderActionsList=function(){var actions=[],_a=_this.props,t=_a.t,order=_a.order,orderState=(0,Order.AU)(order),conditionalProps=_this.props.isSenderAddressValid?{createAnother:{href:_this.createLabelLink()},createReturn:{href:_this.createReturnLabel()}}:{createAnother:{onClick:_this.stopPropagationAction(_this.props.toggleInvalidAddressModal)},createReturn:{onClick:_this.stopPropagationAction(_this.props.toggleInvalidAddressModal)}},printLabel={text:t("orders:actions:single:printLabel"),onClick:_this.stopPropagationAction(_this.printLabel),tagName:"orders-download-label"},printLabels={text:t("orders:actions:single:printLabels"),onClick:_this.stopPropagationAction(_this.getAllLabels),tagName:"orders-download-label"},createAnotherLabel=(0,tslib_es6.Cl)({text:t("orders:actions:single:createAnother"),tagName:"orders-create-another-label"},conditionalProps.createAnother),createReturnLabel=(0,tslib_es6.Cl)({text:t("orders:actions:single:createReturn"),tagName:"orders-create-standalone-return"},conditionalProps.createReturn),downloadPackingSlip={text:t("orders:actions:single:downloadSlip"),onClick:_this.stopPropagationAction(_this.downloadPackingSlip),tagName:"orders-download-packing-slip"},sendNotificationEmail={text:t("orders:actions:single:sendEmail"),onClick:_this.stopPropagationAction(_this.fetchOrderTxns.bind(_this,ModalAction.EMAIL)),tagName:"orders-send-notification"},refundLabel={text:t("orders:actions:single:refundLabel"),onClick:_this.stopPropagationAction(_this.fetchOrderTxns.bind(_this,ModalAction.REFUND)),tagName:"orders-refund-label"},refundLabels={text:t("orders:actions:single:refundLabels"),onClick:_this.stopPropagationAction(_this.fetchOrderTxns.bind(_this,ModalAction.REFUND)),tagName:"orders-refund-label"},returnLabels={text:t("orders:actions:single:createReturn"),onClick:_this.stopPropagationAction(_this.fetchOrderTxns.bind(_this,ModalAction.RETURN)),tagName:"orders-create-standalone-return"},hideOrderOption={text:order.hidden?t("orders:actions:single:unhide"):t("orders:actions:single:hide"),onClick:_this.stopPropagationAction(_this.hideOrder),tagName:_this.props.order.hidden?"orders-unhide-order":"orders-hide-order"};switch(orderState){case Order.cH.REFUNDED:actions=[createAnotherLabel,hideOrderOption];break;case Order.cH.REFUND_REJECTED:case Order.cH.REFUND_PENDING:actions=[sendNotificationEmail,downloadPackingSlip,createReturnLabel,createAnotherLabel,hideOrderOption];break;case Order.cH.FULFILLED_OUTSIDE_SHIPPO:actions=[downloadPackingSlip,createAnotherLabel,createReturnLabel,hideOrderOption];break;case Order.cH.FULFILLED_SINGLE_LABEL:actions=[printLabel,sendNotificationEmail,refundLabel,downloadPackingSlip,createReturnLabel,createAnotherLabel,hideOrderOption];break;case Order.cH.FULFILLED_MULTIPLE_LABELS:actions=[printLabels,sendNotificationEmail,refundLabels,downloadPackingSlip,returnLabels,createAnotherLabel,hideOrderOption];break;case Order.cH.PARTIALLY_FULFILLED_SINGLE_LABEL:actions=[printLabel,sendNotificationEmail,refundLabel,downloadPackingSlip,createReturnLabel,createAnotherLabel,hideOrderOption];break;case Order.cH.PARTIALLY_FULFILLED_SINGLE_REFUND:actions=[printLabel,sendNotificationEmail,downloadPackingSlip,createReturnLabel,createAnotherLabel,hideOrderOption];break;case Order.cH.PARTIALLY_FULFILLED_MULTIPLE_LABELS:actions=[printLabels,sendNotificationEmail,refundLabels,downloadPackingSlip,returnLabels,createAnotherLabel,hideOrderOption];break;case Order.cH.CANCELLED:case Order.cH.NOT_FULFILLED:actions=[downloadPackingSlip,hideOrderOption]}return actions.map(_this.renderDropdownOption)},_this.renderDropdownOption=function(option){var text=option.text,tagName=option.tagName,props=(0,tslib_es6.Tt)(option,["text","tagName"]);return(0,emotion_react_browser_esm.n)(DropdownList_DropdownOption,(0,tslib_es6.Cl)({},props,{key:text,dataPendo:tagName}),text)},_this.renderPrimaryActionComponent=function(){var onPrimaryActionClick,primaryActionText,order=_this.props.order,primaryButtonType=_this.getPrimaryButtonType(),orderState=(0,Order.AU)(order),active=orderState===Order.cH.NOT_FULFILLED;switch(orderState){case Order.cH.CANCELLED:primaryActionText=_this.props.t("orders:actions:single:cancelled");break;case Order.cH.REFUNDED:primaryActionText=_this.props.t("orders:actions:single:refunded");break;case Order.cH.REFUND_REJECTED:primaryActionText=_this.props.t("orders:actions:single:refundRejected");break;case Order.cH.REFUND_PENDING:primaryActionText=_this.props.t("orders:actions:single:refundPending");break;case Order.cH.FULFILLED_OUTSIDE_SHIPPO:case Order.cH.FULFILLED_SINGLE_LABEL:case Order.cH.FULFILLED_MULTIPLE_LABELS:primaryActionText=_this.props.t("orders:actions:single:fulfilled");break;case Order.cH.NOT_FULFILLED:case Order.cH.PARTIALLY_FULFILLED_SINGLE_LABEL:case Order.cH.PARTIALLY_FULFILLED_SINGLE_REFUND:case Order.cH.PARTIALLY_FULFILLED_MULTIPLE_LABELS:onPrimaryActionClick=_this.props.isSenderAddressValid||(0,Order.Dd)(order)?_this.createLabelLink():_this.stopPropagationAction(_this.props.toggleInvalidAddressModal),primaryActionText=_this.props.t("orders:actions:single:createLabel")}var props="string"==typeof onPrimaryActionClick?{href:onPrimaryActionClick}:{onClick:onPrimaryActionClick};return(0,emotion_react_jsx_runtime_browser_esm.Y)(DropdownList_PrimaryAction,(0,tslib_es6.Cl)({buttonType:primaryButtonType},props,{disabled:!active,dataPendo:active?"orders-create-label":""},{children:primaryActionText}))},_this}return(0,tslib_es6.C6)(SingleOrderActions,_super),SingleOrderActions.prototype.render=function(){var triggerButtonType=this.getSecondaryButtonType();return(0,emotion_react_jsx_runtime_browser_esm.Y)(DropdownList_DropdownList,(0,tslib_es6.Cl)({triggerButtonType,primaryActionComponent:this.renderPrimaryActionComponent},{children:this.renderSingleOrderActionsList()}))},SingleOrderActions}(react.Component),ComposedSingleOrderActions=(0,redux.Zz)((0,es.Ng)((function(state){return{defaultLabelFormat:(0,user_selectors.Hz)(state),packingSlipUrl:(0,orders_selectors.Bq)(state),singleLabelFlowTest:state.featureTests.testVariantByFeature["Single Label Flow Test"],isSenderAddressValid:(0,user_selectors.Oz)(state)}}),(function(dispatch){return{getLabel:function(transactionIds,labelFormat,windowRef){return dispatch((0,orders_actions.p9)(transactionIds,labelFormat,windowRef))},getOrderPackingSlip:function(objectId,windowRef){var _a;return dispatch((0,orders_actions.JO)(((_a={})[objectId]=[],_a),windowRef,"other"))},getAllLabels:function(objectId){var _a;return dispatch((0,orders_actions.fn)(((_a={})[objectId]=[],_a)))},fetchOrderTxns:function(objectId){return dispatch((0,orders_actions.cn)(objectId))}}})),(0,utils_translate.Tl)())(SingleOrderActions);const All_SingleOrderActions=ComposedSingleOrderActions;var providers_selectors=__webpack_require__("./app/selectors/providers.selectors.ts"),batchEntryRendering=__webpack_require__("./app/utils/batchEntryRendering.ts"),icon_check_gray=__webpack_require__("./app/assets/icons/icon_check_gray.svg"),CustomerShippingMethod=__webpack_require__("./app/pages/Orders/All/CustomerShippingMethod/index.ts"),shipments_selectors=__webpack_require__("./app/selectors/shipments.selectors.ts"),CustomsDeclaration=__webpack_require__("./app/types/CustomsDeclaration.ts"),types_ServiceLevel=__webpack_require__("./app/types/ServiceLevel.ts"),orderValidation=__webpack_require__("./app/utils/orderValidation.ts"),refresh_gray=__webpack_require__("./app/assets/icons/refresh/refresh_gray.svg"),refresh_green=__webpack_require__("./app/assets/icons/refresh/refresh_green.svg");const components_RefreshButton=function(props){var isRefreshing=props.isRefreshing,onClick=props.onClick,disabled=props.disabled,dataAnalytics=props.dataAnalytics,children=props.children,disabledOrRefreshing=disabled||isRefreshing,imgSource=disabledOrRefreshing?refresh_gray:refresh_green,iconStyling="h-5 mr-1".concat(isRefreshing?" animate-spin":""),containerStyling="flex items-center border-none bg-transparent p-0 focus:outline-none h-full ".concat(disabledOrRefreshing?"cursor-not-allowed":"cursor-pointer");return(0,emotion_react_jsx_runtime_browser_esm.FD)("button",(0,tslib_es6.Cl)({disabled,onClick,className:containerStyling,"data-analytics":dataAnalytics},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("img",{className:iconStyling,src:imgSource,alt:""}),children]}))};var hooks_useRefreshRates=__webpack_require__("./app/pages/Orders/Blackbeard/hooks/hooks/useRefreshRates.ts"),ComposedRefreshRatesButton=(0,utils_translate.Tl)("orders")((function(_a){var orderSelection=_a.orderSelection,dataAnalytics=_a.dataAnalytics,t=_a.t,children=_a.children,_b=(0,hooks_useRefreshRates.A)(orderSelection),batchEntries=_b.batchEntries,handleRefresh=_b.handleRefresh,isRefreshing=_b.isRefreshing;return(0,emotion_react_jsx_runtime_browser_esm.Y)(emotion_react_jsx_runtime_browser_esm.FK,{children:batchEntries.length>0?(0,emotion_react_jsx_runtime_browser_esm.Y)(components_RefreshButton,(0,tslib_es6.Cl)({onClick:handleRefresh,disabled:isRefreshing,isRefreshing,dataAnalytics},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"flex flex-col items-start"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Link.Oc,(0,tslib_es6.Cl)({disabled:isRefreshing},{children:t(isRefreshing?"orders:calculateRates:rates:refreshing":"orders:calculateRates:rates:refresh")})),children]}))})):null})}));const Addons_RefreshRatesButton=ComposedRefreshRatesButton;var common_templateObject_1,ImageContainer=(0,emotion_styled_browser_esm.A)("div")(common_templateObject_1||(common_templateObject_1=(0,tslib_es6.ue)(["\n  width: 2rem;\n"],["\n  width: 2rem;\n"]))),question_circle_gray=__webpack_require__("./app/assets/icons/question_circle_gray.svg"),question_circle_yellow=__webpack_require__("./app/assets/icons/question_circle_yellow.svg"),FlexContainer=__webpack_require__("./app/components/Layout/FlexContainer.tsx"),Message=__webpack_require__("./app/components/MessageBox/Message.tsx");function fetchShipment(shipmentId,trackingReference){return{shipmentId,trackingReference,type:constants.t.SHIPMENT_FETCH}}function fetchShipmentRatesSuccess(shipmentId,payload,trackingReference){return{payload,shipmentId,trackingReference,type:constants.t.SHIPMENT_FETCH_SUCCESS}}function selectRate(shipmentObjectId,rateObjectId,userTriggered,trackingReference,orderSelection,serviceLevelToken,accountObjectId){return void 0===userTriggered&&(userTriggered=!0),{type:constants.t.RATE_SELECT,payload:{orderSelection,rateObjectId,serviceLevelToken,shipmentObjectId,userTriggered,accountObjectId,trackingReference}}}function clearRates(shipmentIds){return{type:constants.t.RATE_CLEAR,payload:{shipmentIds}}}var react_intersection_observer_esm=__webpack_require__("./node_modules/react-intersection-observer/react-intersection-observer.esm.js"),Gradient=(0,emotion_styled_browser_esm.A)("div")(GradientWrapper_templateObject_1||(GradientWrapper_templateObject_1=(0,tslib_es6.ue)(["\n  position: absolute;\n  height: 50px;\n  width: 100%;\n  pointer-events: none;\n  left: 0;\n  background: linear-gradient(180deg, "," 0%, rgba(255, 255, 255, 0) 100%);\n  border-radius: 6px;\n\n  ","\n"],["\n  position: absolute;\n  height: 50px;\n  width: 100%;\n  pointer-events: none;\n  left: 0;\n  background: linear-gradient(180deg, "," 0%, rgba(255, 255, 255, 0) 100%);\n  border-radius: 6px;\n\n  ","\n"])),styles_constants.Tj.white,(function(props){return props.bottom?"\n        bottom: 0;\n        transform: matrix(1, 0, 0, -1, 0, 0);\n      ":props.top?"\n        top: 0;\n        transform: matrix(-1, 0, 0, 1, 0, 0);\n      ":void 0}));const GradientWrapper_GradientWrapper=function(_a){var children=_a.children,_b=(0,tslib_es6.zs)((0,react_intersection_observer_esm.Wx)(),2),bottomObservableRef=_b[0],isAtBottom=_b[1],_c=(0,tslib_es6.zs)((0,react_intersection_observer_esm.Wx)(),2),topObservableRef=_c[0],isAtTop=_c[1];return(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{ref:topObservableRef}),!isAtTop&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Gradient,{top:!0}),children,(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{ref:bottomObservableRef}),!isAtBottom&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Gradient,{bottom:!0})]})};var GradientWrapper_templateObject_1;const components_GradientWrapper=GradientWrapper_GradientWrapper;var components_Icon=__webpack_require__("./app/components/Icon/index.ts"),SelectableCard=(0,emotion_styled_browser_esm.A)("div")(SelectableCard_templateObject_1||(SelectableCard_templateObject_1=(0,tslib_es6.ue)(["\n  cursor: pointer;\n  background-color: ",";\n  /* the 1px right/left margin is a bit of a hack to\n     prevent the outset box-shadow from being cut off if\n     our designs change to have selected and unselected\n     borders have the same thickness we should revert this change */\n  margin: 8px ",";\n  ",";\n  min-width: 20.25rem;\n  ","\n  border-radius: 4px;\n\n  @media screen and (min-width: ","px) {\n    :hover {\n      box-shadow:\n        0px 2px 4px rgba(0, 0, 0, 0.16),\n        0px 4px 6px rgba(0, 0, 0, 0.16);\n      ","\n    }\n  }\n"],["\n  cursor: pointer;\n  background-color: ",";\n  /* the 1px right/left margin is a bit of a hack to\n     prevent the outset box-shadow from being cut off if\n     our designs change to have selected and unselected\n     borders have the same thickness we should revert this change */\n  margin: 8px ",";\n  ",";\n  min-width: 20.25rem;\n  ","\n  border-radius: 4px;\n\n  @media screen and (min-width: ","px) {\n    :hover {\n      box-shadow:\n        0px 2px 4px rgba(0, 0, 0, 0.16),\n        0px 4px 6px rgba(0, 0, 0, 0.16);\n      ","\n    }\n  }\n"])),(function(_a){return _a.isSelected?styles_constants.zC.accent.background.success:styles_constants.Tj.white}),(function(_a){return _a.isSelected?"0px":"1px"}),(function(_a){return _a.responsiveWidth?"width: 100%":"width: auto"}),(function(_a){var isSelected=_a.isSelected,light=_a.light;return isSelected?"border: 2px solid ".concat(light?styles_constants.Tj.forest600:styles_constants.zC.accent.foreground.success,";"):"box-shadow: 0 0 0 1px ".concat(styles_constants.zC.borders,"; border: 1px solid transparent;")}),responsive.P.Mobile,(function(_a){return _a.isSelected?"":"border-color: ".concat(styles_constants.zC.borders,";")}));const ServiceLevel_SelectableCard=SelectableCard;var SelectableCard_templateObject_1,ServiceLevelNameContainer=(0,emotion_styled_browser_esm.A)("div")(ServiceLevelName_templateObject_1||(ServiceLevelName_templateObject_1=(0,tslib_es6.ue)(["\n  font-size: 1rem;\n  line-height: 1.5rem;\n  display: flex;\n  align-items: center;\n  flex-wrap: wrap;\n\n  > :not(:last-child) {\n    margin-right: 8px;\n  }\n"],["\n  font-size: 1rem;\n  line-height: 1.5rem;\n  display: flex;\n  align-items: center;\n  flex-wrap: wrap;\n\n  > :not(:last-child) {\n    margin-right: 8px;\n  }\n"]))),ServiceLevelText=(0,emotion_styled_browser_esm.A)("span")(ServiceLevelName_templateObject_2||(ServiceLevelName_templateObject_2=(0,tslib_es6.ue)(["\n  -webkit-line-clamp: 2;\n  overflow: hidden;\n  display: -webkit-inline-box;\n  -webkit-box-orient: vertical;\n"],["\n  -webkit-line-clamp: 2;\n  overflow: hidden;\n  display: -webkit-inline-box;\n  -webkit-box-orient: vertical;\n"])));const ServiceLevel_ServiceLevelName=function(_a){var name=_a.name,isSelected=_a.isSelected;return(0,emotion_react_jsx_runtime_browser_esm.Y)(ServiceLevelText,(0,tslib_es6.Cl)({className:"align-middle leading-5 ".concat(isSelected?"font-bold":""),title:name},{children:name}))};var ServiceLevelName_templateObject_1,ServiceLevelName_templateObject_2,ServiceLevelRateWrapper_Wrapper=emotion_styled_browser_esm.A.div(ServiceLevelRateWrapper_templateObject_1||(ServiceLevelRateWrapper_templateObject_1=(0,tslib_es6.ue)(["\n  min-height: 72px;\n  color: ",";\n  font-size: 14px;\n  font-weight: ",";\n  cursor: pointer;\n  padding: 0 16px;\n"],["\n  min-height: 72px;\n  color: ",";\n  font-size: 14px;\n  font-weight: ",";\n  cursor: pointer;\n  padding: 0 16px;\n"])),styles_constants.Tj.fontColor,styles_constants.Wy.normal);const ServiceLevel_ServiceLevelRateWrapper=function(_a){var onClick=_a.onClick,children=_a.children,dataE2E=_a.dataE2E,dataCarrier=_a.dataCarrier,isTest=_a.isTest,dataAnalytics=_a.dataAnalytics,className=_a.className;return(0,emotion_react_jsx_runtime_browser_esm.Y)(ServiceLevelRateWrapper_Wrapper,(0,tslib_es6.Cl)({onClick,"data-e2e":dataE2E,"data-carrier":dataCarrier,"data-type":isTest?"test-rate":"live-rate","data-analytics":dataAnalytics,className,role:"button"},{children}))};var ServiceLevelRateWrapper_templateObject_1,TagContainer=(0,emotion_styled_browser_esm.A)("span")(AccountNicknameTag_templateObject_1||(AccountNicknameTag_templateObject_1=(0,tslib_es6.ue)(["\n  display: inline-flex;\n  color: ",";\n  background-color: ",";\n  padding: 3px 4px;\n  border-radius: 4px;\n  font-size: 10px;\n  line-height: 10px;\n"],["\n  display: inline-flex;\n  color: ",";\n  background-color: ",";\n  padding: 3px 4px;\n  border-radius: 4px;\n  font-size: 10px;\n  line-height: 10px;\n"])),styles_constants.Tj.white,styles_constants.Tj.gray400),AccountNicknameTag_TextContainer=(0,emotion_styled_browser_esm.A)("span")(AccountNicknameTag_templateObject_2||(AccountNicknameTag_templateObject_2=(0,tslib_es6.ue)(["\n  max-width: 56px;\n  display: inline-block;\n  vertical-align: middle;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n"],["\n  max-width: 56px;\n  display: inline-block;\n  vertical-align: middle;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n"]))),AccountNicknameTag=function(props){var nickname=props.nickname,t=props.t,_a=(0,tslib_es6.zs)(react.useState(null),2),element=_a[0],setElement=_a[1],_b=(0,tslib_es6.zs)(react.useState(!1),2),isTruncated=_b[0],setIsTruncated=_b[1];react.useEffect((function(){element&&element.offsetWidth<element.scrollWidth&&setIsTruncated(!0)}));var tag=(0,emotion_react_jsx_runtime_browser_esm.Y)(AccountNicknameTag_TextContainer,(0,tslib_es6.Cl)({ref:function(el){setElement(el)}},{children:nickname||t("orders:calculateRates:rates:serviceLevels:accountType.personal")}));return isTruncated?(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Popup.A,(0,tslib_es6.Cl)({trigger:tag,on:"hover",position:"top center",inverted:!0,style:{fontSize:".8125rem"}},{children:nickname||t("orders:calculateRates:rates:serviceLevels:accountType.personal")})):tag};const AccountNicknameTag_AccountNicknameTag=(0,utils_translate.Tl)("orders")((function(props){return(0,emotion_react_jsx_runtime_browser_esm.Y)(TagContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(AccountNicknameTag,(0,tslib_es6.Cl)({},props))})}));var AccountNicknameTag_templateObject_1,AccountNicknameTag_templateObject_2,TestTag=__webpack_require__("./app/components/Tag/TestTag/TestTag.tsx"),ServiceLevelContainer=(0,emotion_styled_browser_esm.A)("div")(NoRateCard_templateObject_1||(NoRateCard_templateObject_1=(0,tslib_es6.ue)(["\n  display: grid;\n  grid-template-columns: 2.5rem 1fr 2rem;\n  grid-gap: 0.5rem;\n  align-items: center;\n  width: 100%;\n"],["\n  display: grid;\n  grid-template-columns: 2.5rem 1fr 2rem;\n  grid-gap: 0.5rem;\n  align-items: center;\n  width: 100%;\n"]))),NoRateCard_IconContainer=(0,emotion_styled_browser_esm.A)("img")(NoRateCard_templateObject_2||(NoRateCard_templateObject_2=(0,tslib_es6.ue)(["\n  width: 1.5rem;\n  height: 1rem;\n"],["\n  width: 1.5rem;\n  height: 1rem;\n"])));const ServiceLevel_NoRateCard=(0,redux.Zz)(react.memo,(0,utils_translate.Tl)("orders"))((function(props){var responsiveWidth=props.responsiveWidth,providerDataset=props.providerDataset,isSelected=props.isSelected,onServiceLevelSelect=props.onServiceLevelSelect,accountObjectId=providerDataset.accountObjectId,provider=providerDataset.provider,isShippoAccount=providerDataset.isShippoAccount,_a=providerDataset.servicelevel,token=_a.token,name=_a.name,handleRateSelect=react.useCallback((function(){onServiceLevelSelect({accountObjectId,token})}),[providerDataset,onServiceLevelSelect]);return(0,emotion_react_jsx_runtime_browser_esm.Y)(ServiceLevel_SelectableCard,(0,tslib_es6.Cl)({onClick:function(){return handleRateSelect()},isSelected,responsiveWidth},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(ServiceLevel_ServiceLevelRateWrapper,(0,tslib_es6.Cl)({className:"flex flex-1 items-center","data-e2e":"no-rate"},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(ServiceLevelContainer,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Icon.kC,{provider}),(0,emotion_react_jsx_runtime_browser_esm.FD)(ServiceLevelNameContainer,(0,tslib_es6.Cl)({className:"w-2/3 p-2"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(ServiceLevel_ServiceLevelName,{name}),!isShippoAccount&&(0,emotion_react_jsx_runtime_browser_esm.Y)("span",(0,tslib_es6.Cl)({className:"leading-4"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(AccountNicknameTag_AccountNicknameTag,{nickname:""})}))]})),(0,emotion_react_jsx_runtime_browser_esm.Y)(NoRateCard_IconContainer,{src:question_circle_gray,alt:"error"})]})}))}))}));var NoRateCard_templateObject_1,NoRateCard_templateObject_2,fetchable=__webpack_require__("./app/utils/fetchable.ts"),AttributeHeader=(0,emotion_styled_browser_esm.A)("span")(ServiceLevelNoRate_templateObject_1||(ServiceLevelNoRate_templateObject_1=(0,tslib_es6.ue)(["\n  font-size: 0.75rem;\n  line-height: 1.25rem;\n  font-weight: ",";\n  color: ",";\n  margin: 8px 0;\n"],["\n  font-size: 0.75rem;\n  line-height: 1.25rem;\n  font-weight: ",";\n  color: ",";\n  margin: 8px 0;\n"])),styles_constants.Wy.normal,styles_constants.Tj.secondary),getSelectedProviderDataset=function(_a){var serviceLevel=_a.serviceLevel,accountObject=_a.accountObject;if(serviceLevel&&accountObject)return{provider:accountObject.providerName,providerImage75:accountObject.providerImage75,providerImage200:accountObject.providerImage200,isShippoAccount:accountObject.isShippoAccount,accountObjectId:accountObject.objectId,servicelevel:{name:serviceLevel.name,token:serviceLevel.token,terms:""}}};const ServiceLevel_ServiceLevelNoRate=(0,redux.Zz)((0,utils_translate.Tl)("orders"),react_router.y)((function(props){var dispatch=(0,es.wA)(),t=props.t,responsiveWidth=props.responsiveWidth,batchEntry=props.batchEntry,order=props.order,closePopover=props.closePopover,serviceLevelsByAccountRequest=(0,es.d4)(providers_selectors.eA),isServiceLevelsRequestComplete=(0,es.d4)(providers_selectors.X7),activeServiceLevelsMapByAccount=(0,es.d4)(providers_selectors.ig),userDefaultServiceLevel=(0,es.d4)(user_selectors.Fh),handleServiceLevelSelect=react.useCallback((function(_a){var _b,token=_a.token,accountObjectId=_a.accountObjectId,objectID=null==order?void 0:order.objectId,trackingReference=TrackingHelper.U.getTrackingReference(types.Fd.name,"order_details",{rateIds:void 0});if(batchEntry){var orderSelection=((_b={})[null==batchEntry?void 0:batchEntry.orderObjectId]=[null==batchEntry?void 0:batchEntry.id],_b);closePopover&&closePopover(),dispatch(selectRate(objectID,"",!0,trackingReference,orderSelection,token,accountObjectId))}else dispatch((0,orders_actions.YT)(token,objectID,accountObjectId,closePopover))}),[order,batchEntry,closePopover]),getFirstMatchedAccountIdFromToken=function(token){if("success"===(null==serviceLevelsByAccountRequest?void 0:serviceLevelsByAccountRequest.kind)){var accountObject=null==serviceLevelsByAccountRequest?void 0:serviceLevelsByAccountRequest.data.find((function(carrier){return carrier.visibleServiceLevels.find((function(el){return(0,types_ServiceLevel.M7)(el,token)}))}));return null==accountObject?void 0:accountObject.objectId}},getSelectedServiceLevel=function(){var preferredServiceLevelToken=null==batchEntry?void 0:batchEntry.preferredServiceLevelToken;return preferredServiceLevelToken?{token:preferredServiceLevelToken||"",accountObjectID:(null==batchEntry?void 0:batchEntry.preferredAccountObjectID)||getFirstMatchedAccountIdFromToken(preferredServiceLevelToken)||""}:{token:(null==userDefaultServiceLevel?void 0:userDefaultServiceLevel.token)||"",accountObjectID:(null==userDefaultServiceLevel?void 0:userDefaultServiceLevel.accountId)||getFirstMatchedAccountIdFromToken((null==userDefaultServiceLevel?void 0:userDefaultServiceLevel.token)||"")||""}};return(0,emotion_react_jsx_runtime_browser_esm.Y)(react.Fragment,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(components_GradientWrapper,{children:[function(){var _a=getSelectedServiceLevel(),accountObjectID=_a.accountObjectID,token=_a.token;if(accountObjectID&&token&&activeServiceLevelsMapByAccount){var accountObject=activeServiceLevelsMapByAccount[accountObjectID],serviceLevel=null==accountObject?void 0:accountObject.serviceLevels.find((function(service){return token===service.token})),providerDataset=getSelectedProviderDataset({serviceLevel,accountObject});return providerDataset?(0,emotion_react_jsx_runtime_browser_esm.FD)("div",{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(AttributeHeader,{children:t("orders:calculateRates:rates:serviceLevels:selected")}),(0,emotion_react_jsx_runtime_browser_esm.Y)(ServiceLevel_NoRateCard,{providerDataset,isSelected:!0,onServiceLevelSelect:handleServiceLevelSelect,responsiveWidth})]}):""}}(),function(){var _a;if(isServiceLevelsRequestComplete){var serviceLevelsByAccount=null!==(_a=(0,fetchable.Vn)(serviceLevelsByAccountRequest))&&void 0!==_a?_a:[],_b=getSelectedServiceLevel(),accountObjectID_1=_b.accountObjectID,token_1=_b.token;return(0,emotion_react_jsx_runtime_browser_esm.FD)("div",{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(AttributeHeader,{children:t("orders:calculateRates:rates:serviceLevels:allServices")}),serviceLevelsByAccount.map((function(account){return account.visibleServiceLevels.map((function(serviceLevel){var providerDataset=getSelectedProviderDataset({serviceLevel,accountObject:account}),isSelected=accountObjectID_1===account.objectId&&token_1===serviceLevel.token;return providerDataset?(0,emotion_react_jsx_runtime_browser_esm.Y)(ServiceLevel_NoRateCard,{providerDataset,isSelected,onServiceLevelSelect:handleServiceLevelSelect,responsiveWidth},serviceLevel.token):""}))}))]})}}()]})})}));var ServiceLevelNoRate_templateObject_1,Card=(0,emotion_styled_browser_esm.A)("section")(Card_templateObject_1||(Card_templateObject_1=(0,tslib_es6.ue)(["\n  border: 1px solid ",";\n  border-radius: ",";\n  @media screen and (min-width: ","px) {\n    border-radius: 6px;\n  }\n  padding: 24px;\n\n  ","\n"],["\n  border: 1px solid ",";\n  border-radius: ",";\n  @media screen and (min-width: ","px) {\n    border-radius: 6px;\n  }\n  padding: 24px;\n\n  ","\n"])),styles_constants.Tj.greyBorder,(function(props){return props.isAlwaysRounded?"6px":"0px"}),responsive.P.Tablet,(function(props){return props.hasShadow?"box-shadow: 0px 2px 8px rgba(0, 0, 0, 0.15);":""}));const Card_Card=Card;var Card_templateObject_1,Card_templateObject_2,Card_templateObject_3,Card_templateObject_4,Card_templateObject_5,InfoCard=(0,emotion_styled_browser_esm.A)(Card)(Card_templateObject_2||(Card_templateObject_2=(0,tslib_es6.ue)(["\n  margin-bottom: 17px;\n  padding: 18px 21px;\n  font-size: 13px;\n  color: ",";\n  border: 1px solid #e8e395;\n  background-color: #fffced;\n  line-height: 18px;\n"],["\n  margin-bottom: 17px;\n  padding: 18px 21px;\n  font-size: 13px;\n  color: ",";\n  border: 1px solid #e8e395;\n  background-color: #fffced;\n  line-height: 18px;\n"])),styles_constants.Tj.fontColor),InfoCardTitle=(0,emotion_styled_browser_esm.A)("h2")(Card_templateObject_3||(Card_templateObject_3=(0,tslib_es6.ue)(["\n  color: #e8d576;\n  font-size: 13px;\n  font-weight: ",";\n  margin: 0 0 5px 0;\n"],["\n  color: #e8d576;\n  font-size: 13px;\n  font-weight: ",";\n  margin: 0 0 5px 0;\n"])),styles_constants.Wy.medium),GrayInfoCard=((0,emotion_styled_browser_esm.A)(Card)(Card_templateObject_4||(Card_templateObject_4=(0,tslib_es6.ue)(["\n  margin-top: 0px !important;\n  margin-bottom: 2rem;\n  background-color: ",";\n  font-size: 0.875rem;\n  line-height: 1.5rem;\n  font-weight: ",";\n  color: ",";\n  padding: 0.75rem 0.5rem;\n"],["\n  margin-top: 0px !important;\n  margin-bottom: 2rem;\n  background-color: ",";\n  font-size: 0.875rem;\n  line-height: 1.5rem;\n  font-weight: ",";\n  color: ",";\n  padding: 0.75rem 0.5rem;\n"])),styles_constants.Tj.sea25,styles_constants.Wy.normal,styles_constants.Tj.black),(0,emotion_styled_browser_esm.A)(Card)(Card_templateObject_5||(Card_templateObject_5=(0,tslib_es6.ue)(["\n  background-color: ",";\n  border: 1px solid ",";\n  border-radius: 3px;\n  color: ",";\n  padding: 1rem;\n"],["\n  background-color: ",";\n  border: 1px solid ",";\n  border-radius: 3px;\n  color: ",";\n  padding: 1rem;\n"])),styles_constants.Tj.gray25,styles_constants.Tj.gray400,styles_constants.Tj.gray900));const components_Card=Card_Card;var CardSection=(0,emotion_styled_browser_esm.A)("div")(OrderDetails_templateObject_1||(OrderDetails_templateObject_1=(0,tslib_es6.ue)(["\n  color: ",";\n  padding: 0.75rem;\n  margin-bottom: 0.75rem;\n  background-color: ",";\n  border: 1px solid ",";\n  border-radius: 4px;\n  font-size: 0.8125rem;\n  line-height: 1.25rem;\n  font-weight: ",";\n"],["\n  color: ",";\n  padding: 0.75rem;\n  margin-bottom: 0.75rem;\n  background-color: ",";\n  border: 1px solid ",";\n  border-radius: 4px;\n  font-size: 0.8125rem;\n  line-height: 1.25rem;\n  font-weight: ",";\n"])),styles_constants.Tj.gray1000,styles_constants.Tj.gray25,styles_constants.Tj.containerBorderColor,styles_constants.Wy.medium),ShippingMethodTitle=(0,emotion_styled_browser_esm.A)("div")(OrderDetails_templateObject_2||(OrderDetails_templateObject_2=(0,tslib_es6.ue)(["\n  font-size: 0.75rem;\n  line-height: 1.25rem;\n  font-weight: ",";\n  margin-bottom: 0.675rem;\n"],["\n  font-size: 0.75rem;\n  line-height: 1.25rem;\n  font-weight: ",";\n  margin-bottom: 0.675rem;\n"])),styles_constants.Wy.normal),ShippingMethodIcon=(0,emotion_styled_browser_esm.A)("img")(OrderDetails_templateObject_3||(OrderDetails_templateObject_3=(0,tslib_es6.ue)(["\n  width: 0.875rem;\n"],["\n  width: 0.875rem;\n"])));const Tabs_OrderDetails=(0,redux.Zz)((0,es.Ng)((function(){var getOrderById=(0,orders_selectors.H4)();return function(state,ownProps){return{order:getOrderById(state,{orderId:ownProps.orderId})}}})),(0,utils_translate.Tl)("orders"))((function(props){var t=props.t,order=props.order,showOrderNotes=props.showOrderNotes;return(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[function(){var shippingMethod=order.shippingMethod,shippingCost=order.shippingCost,shippingCostCurrency=order.shippingCostCurrency;if(!shippingCostCurrency||!shippingCost)return null;var isCostValid=!!shippingCost&&"0"!==shippingCost,amountTextWithCurrency=t("translations:currency",{value:{value:shippingCost,currency_iso:shippingCostCurrency}});return(shippingMethod||isCostValid)&&(0,emotion_react_jsx_runtime_browser_esm.FD)(CardSection,{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(ShippingMethodTitle,(0,tslib_es6.Cl)({className:"flex items-center"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(ShippingMethodIcon,{className:"mr-3",src:icons.G,alt:"info icon"}),t("orders:calculateRates:tabs:shipmentInfo:shippingMethodUppercase")]})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Typography.A,(0,tslib_es6.Cl)({component:"div",variant:"bodyEmphasized"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(CustomerShippingMethod.x,{shippingMethod,isCostValid,amountTextWithCurrency})}))]})}(),!!showOrderNotes&&order.notes&&(0,emotion_react_jsx_runtime_browser_esm.FD)(InfoCard,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(InfoCardTitle,{children:t("orders:all:orderNotes")}),order.notes]})]})}));var OrderDetails_templateObject_1,OrderDetails_templateObject_2,OrderDetails_templateObject_3;const Tabs_Context=react.createContext({});const Tabs_Container=function(props){var value={selectedTab:props.selectedTab||props.defaultTab,onTabClick:props.onTabClick,activeBorderBottom:props.activeBorderBottom};return(0,emotion_react_jsx_runtime_browser_esm.Y)(Tabs_Context.Provider,(0,tslib_es6.Cl)({value},{children:props.children}))};const Tabs_Content=function(props){return(0,emotion_react_jsx_runtime_browser_esm.Y)(Tabs_Context.Consumer,{children:function(consumerProps){return react.Children.toArray(props.children).filter((function(child){return child.props.for===consumerProps.selectedTab}))}})};var arrow_left=__webpack_require__("./app/assets/icons/arrow-left.svg"),arrow_right=__webpack_require__("./app/assets/icons/arrow-right.svg"),TabsList_List=(0,emotion_styled_browser_esm.A)("div")(TabsList_templateObject_1||(TabsList_templateObject_1=(0,tslib_es6.ue)(["\n  display: flex;\n  padding: 0;\n  margin: 0;\n  ",";\n  ","\n"],["\n  display: flex;\n  padding: 0;\n  margin: 0;\n  ",";\n  ","\n"])),(function(props){return props.hideBorder?"":"border-".concat(props.activeBorderBottom?"bottom":"top",": 1px solid ").concat(styles_constants.Tj.gray50)}),(function(_a){return _a.fullWidth?"width: 100%;":""})),AddOnContainer=emotion_styled_browser_esm.A.div(TabsList_templateObject_2||(TabsList_templateObject_2=(0,tslib_es6.ue)(["\n  padding-top: 0.875rem;\n  padding-bottom: 1rem;\n  margin-left: auto;\n"],["\n  padding-top: 0.875rem;\n  padding-bottom: 1rem;\n  margin-left: auto;\n"])));var TabsList_templateObject_1,TabsList_templateObject_2;const Tabs_TabsList=function(props){var addOn=props.addOn;return(0,emotion_react_jsx_runtime_browser_esm.FD)(TabsList_List,(0,tslib_es6.Cl)({ref:props.tabsListRef},props,{children:[props.children,addOn&&(0,emotion_react_jsx_runtime_browser_esm.Y)(AddOnContainer,{children:addOn})]}))};var ScrollableListContainer=(0,emotion_styled_browser_esm.A)("section")(ScrollableTabsList_templateObject_1||(ScrollableTabsList_templateObject_1=(0,tslib_es6.ue)(["\n  position: relative;\n"],["\n  position: relative;\n"]))),ScrollableList=(0,emotion_styled_browser_esm.A)(Tabs_TabsList)(ScrollableTabsList_templateObject_2||(ScrollableTabsList_templateObject_2=(0,tslib_es6.ue)(["\n  width: 100%;\n  overflow-x: auto;\n  /* hide scrollbar for different browsers */\n  scrollbar-width: none;\n  -ms-overflow-style: none;\n  &::-webkit-scrollbar {\n    display: none;\n  }\n"],["\n  width: 100%;\n  overflow-x: auto;\n  /* hide scrollbar for different browsers */\n  scrollbar-width: none;\n  -ms-overflow-style: none;\n  &::-webkit-scrollbar {\n    display: none;\n  }\n"]))),TabButton=(0,emotion_styled_browser_esm.A)("button")(ScrollableTabsList_templateObject_3||(ScrollableTabsList_templateObject_3=(0,tslib_es6.ue)(["\n  position: absolute;\n  top: 0;\n  height: 100%;\n  background-color: transparent;\n  border: none;\n  cursor: pointer;\n  width: 24px;\n"],["\n  position: absolute;\n  top: 0;\n  height: 100%;\n  background-color: transparent;\n  border: none;\n  cursor: pointer;\n  width: 24px;\n"]))),LeftTabButton=(0,emotion_styled_browser_esm.A)(TabButton)(ScrollableTabsList_templateObject_4||(ScrollableTabsList_templateObject_4=(0,tslib_es6.ue)(["\n  left: 0;\n"],["\n  left: 0;\n"]))),RightTabButton=(0,emotion_styled_browser_esm.A)(TabButton)(ScrollableTabsList_templateObject_5||(ScrollableTabsList_templateObject_5=(0,tslib_es6.ue)(["\n  right: 0;\n"],["\n  right: 0;\n"]))),ScrollableTabsList_Gradient=(0,emotion_styled_browser_esm.A)("div")(ScrollableTabsList_templateObject_6||(ScrollableTabsList_templateObject_6=(0,tslib_es6.ue)(["\n  position: absolute;\n  height: 100%;\n  width: 56px;\n  top: 0;\n  pointer-events: none;\n"],["\n  position: absolute;\n  height: 100%;\n  width: 56px;\n  top: 0;\n  pointer-events: none;\n"]))),RightGradient=(0,emotion_styled_browser_esm.A)(ScrollableTabsList_Gradient)(ScrollableTabsList_templateObject_7||(ScrollableTabsList_templateObject_7=(0,tslib_es6.ue)(["\n  right: 0;\n  background: linear-gradient(\n    90deg,\n    rgba(255, 255, 255, 0.0001) 0%,\n    "," 100%\n  );\n"],["\n  right: 0;\n  background: linear-gradient(\n    90deg,\n    rgba(255, 255, 255, 0.0001) 0%,\n    "," 100%\n  );\n"])),(function(_a){return _a.gradientColor||styles_constants.Tj.white})),LeftGradient=(0,emotion_styled_browser_esm.A)(ScrollableTabsList_Gradient)(ScrollableTabsList_templateObject_8||(ScrollableTabsList_templateObject_8=(0,tslib_es6.ue)(["\n  left: 0;\n  background: linear-gradient(\n    90deg,\n    rgba(255, 255, 255, 0.0001) 0%,\n    "," 100%\n  );\n  transform: matrix(-1, 0, 0, 1, 0, 0);\n"],["\n  left: 0;\n  background: linear-gradient(\n    90deg,\n    rgba(255, 255, 255, 0.0001) 0%,\n    "," 100%\n  );\n  transform: matrix(-1, 0, 0, 1, 0, 0);\n"])),(function(_a){return _a.gradientColor||styles_constants.Tj.white})),ObserverRight=(0,emotion_styled_browser_esm.A)("div")(ScrollableTabsList_templateObject_9||(ScrollableTabsList_templateObject_9=(0,tslib_es6.ue)(["\n  /* \n    the right observer needs a border\n    in order for iOS safari to see the\n    element being observed, width does\n    not seem to work for some reason\n  */\n  border: 1px solid transparent;\n"],["\n  /* \n    the right observer needs a border\n    in order for iOS safari to see the\n    element being observed, width does\n    not seem to work for some reason\n  */\n  border: 1px solid transparent;\n"])));const ScrollableTabsList_ScrollableTabsList=function(props){var children=props.children,gradientColor=props.gradientColor,scrollingContainerRef=react.useRef(null),_a=(0,tslib_es6.zs)((0,react_intersection_observer_esm.Wx)(),2),leftObservableRef=_a[0],isAtBeginning=_a[1],_b=(0,tslib_es6.zs)((0,react_intersection_observer_esm.Wx)(),2),rightObservableRef=_b[0],isAtEnd=_b[1];react.useEffect((function(){if(null!==scrollingContainerRef.current){var activeElement=scrollingContainerRef.current.querySelector(".active");null==activeElement||activeElement.scrollIntoView({inline:"center"})}}),[]);var handleClick=react.useCallback((function(direction){return function(){if(scrollingContainerRef.current){var current=scrollingContainerRef.current;current.scrollLeft+=direction*current.clientWidth}}}),[]);return(0,emotion_react_jsx_runtime_browser_esm.FD)(ScrollableListContainer,{children:[!isAtBeginning&&(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(LeftGradient,{gradientColor}),(0,emotion_react_jsx_runtime_browser_esm.Y)(LeftTabButton,(0,tslib_es6.Cl)({onClick:handleClick(-1)},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)("img",{src:arrow_left,alt:"Scroll left"})}))]}),(0,emotion_react_jsx_runtime_browser_esm.FD)(ScrollableList,(0,tslib_es6.Cl)({tabsListRef:scrollingContainerRef},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{ref:leftObservableRef}),children,(0,emotion_react_jsx_runtime_browser_esm.Y)(ObserverRight,{ref:rightObservableRef})]})),!isAtEnd&&(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(RightGradient,{gradientColor}),(0,emotion_react_jsx_runtime_browser_esm.Y)(RightTabButton,(0,tslib_es6.Cl)({onClick:handleClick(1)},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)("img",{src:arrow_right,alt:"Scroll right"})}))]})]})};var ScrollableTabsList_templateObject_1,ScrollableTabsList_templateObject_2,ScrollableTabsList_templateObject_3,ScrollableTabsList_templateObject_4,ScrollableTabsList_templateObject_5,ScrollableTabsList_templateObject_6,ScrollableTabsList_templateObject_7,ScrollableTabsList_templateObject_8,ScrollableTabsList_templateObject_9,baseTabStyle=(0,emotion_react_browser_esm.AH)(Tab_templateObject_1||(Tab_templateObject_1=(0,tslib_es6.ue)(["\n  min-width: 36px;\n  text-align: center;\n\n  padding-top: 0.875rem;\n  padding-bottom: 1rem;\n  display: inline-block;\n  font-size: 0.875rem;\n  line-height: 1.5rem;\n  cursor: pointer;\n  transition: border 0.2s;\n  font-weight: ",";\n\n  :hover {\n    border-color: ",";\n    color: ",";\n  }\n\n  :focus {\n    border-color: ",";\n    color: ",";\n    outline: 0;\n  }\n"],["\n  min-width: 36px;\n  text-align: center;\n\n  padding-top: 0.875rem;\n  padding-bottom: 1rem;\n  display: inline-block;\n  font-size: 0.875rem;\n  line-height: 1.5rem;\n  cursor: pointer;\n  transition: border 0.2s;\n  font-weight: ",";\n\n  :hover {\n    border-color: ",";\n    color: ",";\n  }\n\n  :focus {\n    border-color: ",";\n    color: ",";\n    outline: 0;\n  }\n"])),styles_constants.Wy.normal,styles_constants.Tj.fontColor,styles_constants.Tj.fontColor,styles_constants.Tj.fontColor,styles_constants.Tj.fontColor),Tab=(0,emotion_styled_browser_esm.A)("div")(Tab_templateObject_2||(Tab_templateObject_2=(0,tslib_es6.ue)(["\n  ",";\n  ",";\n  ",";\n  color: ",";\n  border-color: ",";\n"],["\n  ",";\n  ",";\n  ",";\n  color: ",";\n  border-color: ",";\n"])),baseTabStyle,(function(_a){return _a.stretch?"flex: 1":"margin-right: 28px"}),(function(props){return props.activeBorderBottom?"border-bottom: 2px solid":"border-top: 2px solid"}),(function(props){return props.isActive?styles_constants.Tj.fontColor:styles_constants.Tj.secondary}),(function(props){return props.isActive?styles_constants.Tj.fontColor:"transparent"}));const Tab_Tab=function(props){var createOnKeyDown=function(consumerProps){return function(event){event.key===keys.D.Enter&&consumerProps.onTabClick(props.tabKey)}};return(0,emotion_react_jsx_runtime_browser_esm.Y)(Tabs_Context.Consumer,{children:function(consumerProps){var handleClick=consumerProps.onTabClick?consumerProps.onTabClick.bind(null,props.tabKey):void 0;return(0,emotion_react_jsx_runtime_browser_esm.Y)(Tab,(0,tslib_es6.Cl)({tabIndex:0},props,{ref:props.tabRef,isActive:props.tabKey===consumerProps.selectedTab,onClick:handleClick,onKeyDown:createOnKeyDown(consumerProps),activeBorderBottom:consumerProps.activeBorderBottom||props.activeBorderBottom,"data-pendo":props.dataPendo}))}})};var Tab_templateObject_1,Tab_templateObject_2;const Tabs_Tab=Tab_Tab;const Tabs_TabContent=function(props){return(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({},props.containerProps,{children:props.children}))};var TabLink_templateObject_1,react_router_dom=__webpack_require__("./node_modules/react-router-dom/esm/react-router-dom.js"),StyledNavLink=(0,emotion_styled_browser_esm.A)(react_router_dom.k2)(TabLink_templateObject_1||(TabLink_templateObject_1=(0,tslib_es6.ue)(["\n  ",";\n\n  color: ",";\n  ",";\n  ",";\n  border-color: transparent;\n\n  /* baseTabStyle overrides */\n  min-width: initial;\n  white-space: nowrap;\n  text-decoration: none;\n  margin: 0;\n  display: flex;\n  align-items: center;\n  padding: 16px 12px;\n  ",";\n\n  &.active {\n    ",";\n    color: ",";\n    font-weight: ",";\n  }\n"],["\n  ",";\n\n  color: ",";\n  ",";\n  ",";\n  border-color: transparent;\n\n  /* baseTabStyle overrides */\n  min-width: initial;\n  white-space: nowrap;\n  text-decoration: none;\n  margin: 0;\n  display: flex;\n  align-items: center;\n  padding: 16px 12px;\n  ",";\n\n  &.active {\n    ",";\n    color: ",";\n    font-weight: ",";\n  }\n"])),baseTabStyle,styles_constants.Tj.secondary,(function(props){return props.activeBorderBottom?"border-bottom: 2px solid":"border-top: 2px solid"}),(function(_a){return _a.isActive&&"border-top: 2px solid"}),(function(_a){return _a.hasAddons&&"padding: 16px 8px 16px 16px;"}),(function(props){return props.activeBorderBottom?"border-bottom: 2px solid":"border-top: 2px solid"}),styles_constants.Tj.gray1000,styles_constants.Wy.semiBold);const components_Tabs={Container:Tabs_Container,TabsList:Tabs_TabsList,Tab:Tabs_Tab,TabLink:function TabLink(props){var children=props.children,addons=props.addons,AddonComponents=addons,hasAddons=Boolean(addons);return(0,emotion_react_jsx_runtime_browser_esm.FD)(StyledNavLink,(0,tslib_es6.Cl)({},props,{hasAddons},{children:[children,AddonComponents&&(0,emotion_react_jsx_runtime_browser_esm.Y)(AddonComponents,{})]}))},Content:Tabs_Content,TabContent:Tabs_TabContent,ScrollableTabsList:ScrollableTabsList_ScrollableTabsList};var signatureConfirmation=__webpack_require__("./app/constants/signatureConfirmation.ts"),businessRules=__webpack_require__("./app/utils/businessRules.ts");var Anchor_templateObject_1;const components_Anchor=(0,emotion_styled_browser_esm.A)("div")(Anchor_templateObject_1||(Anchor_templateObject_1=(0,tslib_es6.ue)(["\n  display: block;\n  position: relative;\n  top: -75px;\n  visibility: hidden;\n"],["\n  display: block;\n  position: relative;\n  top: -75px;\n  visibility: hidden;\n"])));var ShipmentInfoCard_CardSection=(0,emotion_styled_browser_esm.A)(components_Card)(ShipmentInfoCard_templateObject_1||(ShipmentInfoCard_templateObject_1=(0,tslib_es6.ue)(["\n  margin: 16px 0;\n  padding: 12px 16px;\n  background-color: ",";\n\n  @media screen and (min-width: ","px) {\n    border-radius: 6px;\n  }\n\n  @media (max-width: ","px) {\n    border-left: none;\n    border-right: none;\n  }\n"],["\n  margin: 16px 0;\n  padding: 12px 16px;\n  background-color: ",";\n\n  @media screen and (min-width: ","px) {\n    border-radius: 6px;\n  }\n\n  @media (max-width: ","px) {\n    border-left: none;\n    border-right: none;\n  }\n"])),styles_constants.Tj.white,responsive.P.Mobile,responsive.P.Tablet),BodyContainer=(0,emotion_styled_browser_esm.A)("div")(ShipmentInfoCard_templateObject_2||(ShipmentInfoCard_templateObject_2=(0,tslib_es6.ue)([""],[""]))),ShipmentInfoCard=function(props){return(0,emotion_react_jsx_runtime_browser_esm.Y)(ShipmentInfoCard_CardSection,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(BodyContainer,{children:props.children})})};const Tabs_ShipmentInfoCard=ShipmentInfoCard;var ShipmentInfoCard_templateObject_1,ShipmentInfoCard_templateObject_2,ShipmentInfoCardTitle_Title=(0,emotion_styled_browser_esm.A)("div")(ShipmentInfoCardTitle_templateObject_1||(ShipmentInfoCardTitle_templateObject_1=(0,tslib_es6.ue)(["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  line-height: 1.5rem;\n  font-size: ",";\n  font-weight: ",";\n  margin-bottom: 0.5rem;\n  color: ",";\n  flex-grow: 1;\n"],["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  line-height: 1.5rem;\n  font-size: ",";\n  font-weight: ",";\n  margin-bottom: 0.5rem;\n  color: ",";\n  flex-grow: 1;\n"])),(function(_a){return _a.insideTable?"1rem":"0.875rem"}),styles_constants.Wy.medium,(function(_a){return _a.invalid?styles_constants.Tj.dangerRed:styles_constants.Tj.black}));const Tabs_ShipmentInfoCardTitle=function(props){return(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"w-full"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(ShipmentInfoCardTitle_Title,(0,tslib_es6.Cl)({insideTable:props.insideTable,invalid:props.invalid},{children:props.children}))}))};var ShipmentInfoCardTitle_templateObject_1,NameText=(0,emotion_styled_browser_esm.A)("div")(AddressText_templateObject_1||(AddressText_templateObject_1=(0,tslib_es6.ue)(["\n  color: ",";\n  font-size: 0.875rem;\n  line-height: 1.5;\n"],["\n  color: ",";\n  font-size: 0.875rem;\n  line-height: 1.5;\n"])),styles_constants.Tj.black),Text=(0,emotion_styled_browser_esm.A)("div")(AddressText_templateObject_2||(AddressText_templateObject_2=(0,tslib_es6.ue)(["\n  color: ",";\n  font-size: 0.75rem;\n  line-height: 1.25;\n"],["\n  color: ",";\n  font-size: 0.75rem;\n  line-height: 1.25;\n"])),styles_constants.Tj.gray700),ContactContainer=(0,emotion_styled_browser_esm.A)("div")(AddressText_templateObject_3||(AddressText_templateObject_3=(0,tslib_es6.ue)(["\n  display: flex;\n  flex-direction: row;\n  overflow-wrap: break-word;\n  word-wrap: break-word;\n  font-size: 0.75rem;\n  line-height: 1.25rem;\n  color: ",";\n"],["\n  display: flex;\n  flex-direction: row;\n  overflow-wrap: break-word;\n  word-wrap: break-word;\n  font-size: 0.75rem;\n  line-height: 1.25rem;\n  color: ",";\n"])),styles_constants.Tj.rollingStone),ContactLink=(0,emotion_styled_browser_esm.A)(Link.Ot)(AddressText_templateObject_4||(AddressText_templateObject_4=(0,tslib_es6.ue)(["\n  text-decoration: none;\n  font-size: inherit;\n\n  :hover {\n    text-decoration: underline;\n  }\n"],["\n  text-decoration: none;\n  font-size: inherit;\n\n  :hover {\n    text-decoration: underline;\n  }\n"]))),ComposedAddressText=react.memo((function(props){var _a=props.address,company=_a.company,name=_a.name,email=_a.email,phone=_a.phone,city=_a.city,state=_a.state,zip=_a.zip,country=_a.country,stateText=state?"".concat(state," "):"",zipText=country&&"US"===country.iso2?(0,Address.dY)(zip):zip;return(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(NameText,(0,tslib_es6.Cl)({"data-e2e":"order-details-".concat(props.addressType,"-address-name"),"data-testid":"order-details-".concat(props.addressType,"-address-name")},{children:company||name})),(0,emotion_react_jsx_runtime_browser_esm.FD)(Text,(0,tslib_es6.Cl)({"data-testid":"order-details-".concat(props.addressType,"-address-text")},{children:[(0,Address.mp)(props.address),props.address&&props.address.street2&&", ".concat(props.address.street2),city?", ".concat(city):"",city&&(stateText||zipText)?", ":"",stateText,stateText&&zipText?" ":"",zipText,(city||stateText||zipText)&&", ",country&&"".concat(country.name)]})),(email||phone)&&(0,emotion_react_jsx_runtime_browser_esm.FD)(ContactContainer,{children:[email&&(0,emotion_react_jsx_runtime_browser_esm.Y)(ContactLink,(0,tslib_es6.Cl)({className:"mr-2",href:"mailto:".concat(email)},{children:email})),phone&&(0,emotion_react_jsx_runtime_browser_esm.Y)(ContactLink,(0,tslib_es6.Cl)({href:"tel:".concat(phone)},{children:phone}))]})]})}));const AddressCard_AddressText=ComposedAddressText;var AddressText_templateObject_1,AddressText_templateObject_2,AddressText_templateObject_3,AddressText_templateObject_4,SecondaryActionLink=(0,emotion_styled_browser_esm.A)(Link.Ay)(AddressCell_templateObject_1||(AddressCell_templateObject_1=(0,tslib_es6.ue)(["\n  color: ",";\n  font-size: 0.875rem;\n  font-weight: ",";\n\n  &:hover {\n    text-decoration: underline;\n  }\n"],["\n  color: ",";\n  font-size: 0.875rem;\n  font-weight: ",";\n\n  &:hover {\n    text-decoration: underline;\n  }\n"])),styles_constants.Tj.gray700,styles_constants.Wy.normal),MultipleAddressesText=emotion_styled_browser_esm.A.div(AddressCell_templateObject_2||(AddressCell_templateObject_2=(0,tslib_es6.ue)(["\n  color: ",";\n  font-size: 0.8125rem;\n  font-weight: ",";\n  margin: 1rem 0 0.5rem;\n"],["\n  color: ",";\n  font-size: 0.8125rem;\n  font-weight: ",";\n  margin: 1rem 0 0.5rem;\n"])),styles_constants.Tj.gray700,styles_constants.Wy.normal),ComposedAddressCell=react.memo((0,utils_translate.Tl)()((function(_a){var t=_a.t,kind=_a.kind,isMultipleAddresses=_a.isMultipleAddresses,hideUseAsReturnCheckbox=_a.hideUseAsReturnCheckbox,orderSelection=_a.orderSelection,_b=_a.dataAnalyticsBase,dataAnalyticsBase=void 0===_b?"":_b,addressBookContext=react.useContext(context.o),address=addressBookContext.selectedAddresses[kind],dispatch=(0,es.wA)(),addressBookName=addressBookContext.addressBookName,combineSenderReturnAddresses=addressBookContext.combineSenderReturnAddresses,openAddressBook=addressBookContext.openAddressBook,openEditAddress=addressBookContext.openEditAddress,toggleCombineSenderReturnAddresses=addressBookContext.toggleCombineSenderReturnAddresses,openCreateAddress=addressBookContext.openCreateAddress,translation=kind===addressBook.y9?"shippingAddress":kind===addressBook.lj?"returnAddress":"recipientAddress",isAddressValid=!!address&&!(0,Address.X2)(address),handleOpenEditAddress=react.useCallback((function(){openEditAddress(kind,orderSelection,isMultipleAddresses)}),[kind,orderSelection,isMultipleAddresses]),handleOpenCreateAddress=react.useCallback((function(){openCreateAddress(kind,orderSelection)}),[kind,orderSelection]),handleOpenAddressBook=react.useCallback((function(){openAddressBook(kind,orderSelection)}),[kind]),addOns=(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"flex items-center"},{children:[kind!==addressBook.i1&&(0,emotion_react_jsx_runtime_browser_esm.Y)(SecondaryActionLink,(0,tslib_es6.Cl)({onClick:handleOpenAddressBook,dataPendo:dataAnalyticsBase+(kind===addressBook.y9?"address-sender-select":"address-return-select"),dataAnalytics:dataAnalyticsBase+(kind===addressBook.y9?"address-sender-select":"address-return-select"),className:"mr-4"},{children:t("orders:address:openAddressBook")})),(address||isMultipleAddresses)&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Link.Oc,(0,tslib_es6.Cl)({onClick:handleOpenEditAddress,dataPendo:"".concat(dataAnalyticsBase,"address-").concat(kind,"-edit"),dataAnalytics:"".concat(dataAnalyticsBase,"address-").concat(kind,"-edit")},{children:t("orders:calculateRates:tabs:shipmentInfo:".concat(translation,"Edit"))}))]})),addAddressActionContent="+ ".concat(t("orders:calculateRates:tabs:shipmentInfo:addAddress",{type:t("orders:all:addressType:".concat(kind))}));return(0,emotion_react_jsx_runtime_browser_esm.Y)(react.Fragment,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"pb-2 ".concat(kind!==addressBook.i1?"pt-1":"")},{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(Tabs_ShipmentInfoCardTitle,(0,tslib_es6.Cl)({invalid:!isAddressValid&&!isMultipleAddresses},{children:[t("orders:calculateRates:tabs:shipmentInfo:".concat(translation)),addOns]})),isMultipleAddresses?(0,emotion_react_jsx_runtime_browser_esm.Y)(MultipleAddressesText,{children:t("orders:actions:multi:multipleAddressesSelected")}):(0,emotion_react_jsx_runtime_browser_esm.FD)(emotion_react_jsx_runtime_browser_esm.FK,{children:[address?(0,emotion_react_jsx_runtime_browser_esm.Y)(AddressCard_AddressText,{address,addressType:kind}):(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"flex flex-col items-center my-4"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Link.Oc,(0,tslib_es6.Cl)({dataAnalytics:"".concat(dataAnalyticsBase,"address-").concat(kind,"-add"),onClick:handleOpenCreateAddress},{children:addAddressActionContent}))})),kind===addressBook.y9&&!hideUseAsReturnCheckbox&&(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"mt-2"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Checkbox.Ay,{checked:combineSenderReturnAddresses,label:t("orders:calculateRates:tabs:shipmentInfo:useAsReturnAddress"),onChange:function(){toggleCombineSenderReturnAddresses();var newCombineValue=!combineSenderReturnAddresses;if(address){address.id&&delete address.id;var trackingReference=TrackingHelper.U.amendTrackingReferenceOrders(TrackingHelper.U.getTrackingReference(types.eJ.name,"order_details",{addressId:void 0,addressType:kind}),Object.keys(orderSelection));(0,utils.Rk)(trackingReference,types.eJ.operations.SAVE_ATTEMPTED,{}),dispatch((0,orders_actions.kR)({orderSelection,addressType:addressBook.lj,address,combineSenderReturnAddresses:newCombineValue,createUserAddress:!1,source:addressBookName,trackingReference}))}},disabled:!address,dataPendo:"address-sender-as-return",dataAnalytics:"".concat(dataAnalyticsBase,"address-sender-as-return")})}))]})]}))})})));const AddressCard_AddressCell=ComposedAddressCell;var AddressCell_templateObject_1,AddressCell_templateObject_2,ComposedAddressCard=react.memo((function(_a){var combineSenderReturnAddresses=_a.combineSenderReturnAddresses,orderSelection=_a.orderSelection;return(0,emotion_react_jsx_runtime_browser_esm.FD)(ShipmentInfoCard,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Anchor,{id:"addressCard"}),(0,emotion_react_jsx_runtime_browser_esm.Y)(AddressCard_AddressCell,{kind:"to",orderSelection}),(0,emotion_react_jsx_runtime_browser_esm.Y)(BorderLine,{}),(0,emotion_react_jsx_runtime_browser_esm.Y)(AddressCard_AddressCell,{kind:"sender",orderSelection}),!combineSenderReturnAddresses&&(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(BorderLine,{}),(0,emotion_react_jsx_runtime_browser_esm.Y)(AddressCard_AddressCell,{kind:"return",orderSelection})]})]})}));const AddressCard_AddressCard=ComposedAddressCard;var AddressCardContainer=function(_super){function AddressCardContainer(props){var _this=_super.call(this,props)||this;return _this.getAddressFromAddressBookWithFallback=function(address,fallbackAddress){var matchingAddressBookEntry=address&&Object.values(_this.context.addresses).find((function(a){return(0,Address.fq)(a,address)}));return address?(null==matchingAddressBookEntry?void 0:matchingAddressBookEntry.id)||address:(null==fallbackAddress?void 0:fallbackAddress.id)?fallbackAddress.id:null},_this.getOrderSelection=function(){var _a,_b=_this.props,batchEntry=_b.batchEntry,order=_b.order,batchEntryIds=batchEntry?[batchEntry.id]:[];return(_a={})[order.objectId]=batchEntryIds,_a},_this}return(0,tslib_es6.C6)(AddressCardContainer,_super),AddressCardContainer.prototype.componentDidMount=function(){var _a=this.props,batchEntry=_a.batchEntry,order=_a.order,toAddress=(null==batchEntry?void 0:batchEntry.addressTo)||order.toAddress,addressFrom=(null==batchEntry?void 0:batchEntry.addressFrom)||order.addressFrom||null,addressReturn=(null==batchEntry?void 0:batchEntry.addressReturn)||order.addressReturn||null;this.context.initSelectedAddresses({to:toAddress,sender:this.getAddressFromAddressBookWithFallback(addressFrom,this.props.userSenderAddress),return:this.getAddressFromAddressBookWithFallback(addressReturn,this.props.userReturnAddress)})},AddressCardContainer.prototype.componentDidUpdate=function(prevProps){var _a,_b,_c,_d,_e,_f;(null===(_a=prevProps.batchEntry)||void 0===_a?void 0:_a.addressFrom)!==(null===(_b=this.props.batchEntry)||void 0===_b?void 0:_b.addressFrom)&&(null===(_c=this.props.batchEntry)||void 0===_c?void 0:_c.addressFrom)&&this.context.selectAddress("sender",this.props.batchEntry.addressFrom),(null===(_d=prevProps.batchEntry)||void 0===_d?void 0:_d.addressReturn)!==(null===(_e=this.props.batchEntry)||void 0===_e?void 0:_e.addressReturn)&&(null===(_f=this.props.batchEntry)||void 0===_f?void 0:_f.addressReturn)&&this.context.selectAddress("return",this.props.batchEntry.addressReturn)},AddressCardContainer.prototype.render=function(){return(0,emotion_react_jsx_runtime_browser_esm.Y)(react.Fragment,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(AddressCard_AddressCard,{combineSenderReturnAddresses:this.context.combineSenderReturnAddresses,orderSelection:this.getOrderSelection()})})},AddressCardContainer.contextType=context.o,AddressCardContainer}(react.Component);const AddressCard_container=(0,redux.Zz)((0,es.Ng)((function(){return function(state){return{userSenderAddress:(0,user_selectors.GA)(state),userReturnAddress:(0,user_selectors.kQ)(state)}}})),components_withAddressBook({name:"order-screen",appLocation:"order_details"}))(AddressCardContainer);var constants_customsDeclaration=__webpack_require__("./app/constants/customsDeclaration.ts"),utils_utils=__webpack_require__("./app/utils/utils.ts");function deleteCustomsItem(orderSelection,initialValues){return{type:constants.t.CUSTOMS_ITEM_DELETE,payload:{orderSelection,initialValues}}}function editCustomsDeclaration(appLocation,orderSelection,customsDeclarationPayload,initialValues,trackingData){return{type:constants.t.CUSTOMS_DECLARATION_UPDATE,payload:{appLocation,orderSelection,customsDeclarationPayload,initialValues,trackingData}}}var StyledComponents=__webpack_require__("./app/components/Modal/shared/StyledComponents.tsx"),getFormInitialValues=__webpack_require__("./node_modules/redux-form/es/getFormInitialValues.js"),Grid=__webpack_require__("./app/components/Layout/Grid.tsx"),TextArea=__webpack_require__("./app/components/TextArea/index.ts"),formValueSelector=__webpack_require__("./node_modules/redux-form/es/formValueSelector.js");const CustomsDeclarationModal_validate=function(values){var errors={id:"",contentsType:"",contentsExplanation:"",incoterm:"",exporterReference:"",importerReference:"",invoice:"",nonDeliveryOption:"",license:"",certificate:"",eelPfc:"",aesItn:"",certifySigner:"",notes:"",isCertify:"",b13aFilingOption:"",b13aNumber:"",eoriNumber:"",taxIdType:"",taxIdNumber:""};if(values.contentsType||(errors.contentsType=constants_customsDeclaration.Kk.contentsType.required),values.contentsType&&values.contentsType.value===constants_customsDeclaration.fI.OTHER&&(values.contentsExplanation?(0,validations.JT)(1,20,values.contentsExplanation)||(errors.contentsExplanation=constants_customsDeclaration.Kk.contentsExplanation.tooLong):errors.contentsExplanation=constants_customsDeclaration.Kk.contentsExplanation.required),values.exporterReference&&!(0,validations.JT)(0,50,values.exporterReference)&&(errors.exporterReference=constants_customsDeclaration.Kk.exporterReference.tooLong),values.importerReference&&!(0,validations.JT)(0,50,values.importerReference)&&(errors.importerReference=constants_customsDeclaration.Kk.importerReference.tooLong),values.license&&!(0,validations.JT)(0,15,values.license)&&(errors.license=constants_customsDeclaration.Kk.license.tooLong),values.certificate&&!(0,validations.JT)(0,12,values.certificate)&&(errors.certificate=constants_customsDeclaration.Kk.certificate.tooLong),values.certifySigner?(0,validations.JT)(1,100,values.certifySigner)||(errors.certifySigner=constants_customsDeclaration.Kk.certifySigner.tooLong):errors.certifySigner=constants_customsDeclaration.Kk.certifySigner.required,values.eelPfc&&values.eelPfc.value===constants_customsDeclaration.aU.AESITN&&(values.aesItn?(0,validations.JT)(0,15,values.aesItn)?15===values.aesItn.length&&/(x|X)\d{14}/.test(values.aesItn)||(errors.aesItn=constants_customsDeclaration.Kk.aesItn.invalid):errors.aesItn=constants_customsDeclaration.Kk.aesItn.tooLong:errors.aesItn=constants_customsDeclaration.Kk.aesItn.required),values.b13aFilingOption&&values.b13aFilingOption.value!==constants_customsDeclaration.i2.NONE_SELECTED)if(String(values.b13aFilingOption.value)in constants_customsDeclaration.Zq){var _a=constants_customsDeclaration.Zq[String(values.b13aFilingOption.value)],label=_a.label,regex=_a.regex,regexDisplay=_a.regexDisplay;values.b13aNumber?regex.test(values.b13aNumber)||(errors.b13aNumber=constants_customsDeclaration.Kk.b13aNumber.invalid(regexDisplay)):errors.b13aNumber=constants_customsDeclaration.Kk.b13aNumber.required(label)}else errors.b13aFilingOption=constants_customsDeclaration.Kk.b13aFilingOption.invalid;(values.notes&&!(0,validations.JT)(0,200,values.notes)&&(errors.notes=constants_customsDeclaration.Kk.notes.tooLong),values.isCertify||(errors.isCertify=constants_customsDeclaration.Kk.isCertify.required),values.eoriNumber)&&((0,validations.JT)(0,19,values.eoriNumber)||(errors.eoriNumber=constants_customsDeclaration.Kk.eoriNumber.tooLong),new RegExp("^[A-Za-z]{2}[A-Za-z0-9]{6,17}","i").test(values.eoriNumber)||"GBUNREG"===values.eoriNumber||(errors.eoriNumber=constants_customsDeclaration.Kk.eoriNumber.invalid));if(values.taxIdType&&""!==values.taxIdType.value)if(values.taxIdNumber)switch(values.taxIdType.value){case constants_customsDeclaration.Gs.VAT:case constants_customsDeclaration.Gs.IOSS:if((0,validations.JT)(0,constants_customsDeclaration.K4,values.taxIdNumber))new RegExp("^[A-Za-z]{2}[A-Za-z0-9]{2,13}$","i").test(values.taxIdNumber)||(errors.taxIdNumber=constants_customsDeclaration.Kk.taxIdNumber.invalid(values.taxIdType.value));else errors.taxIdNumber=constants_customsDeclaration.Kk.taxIdNumber.tooLong(constants_customsDeclaration.K4);break;case constants_customsDeclaration.Gs.EIN:if((0,validations.JT)(0,constants_customsDeclaration.l_,values.taxIdNumber))new RegExp("^([0-9]{9})$","i").test(values.taxIdNumber)||(errors.taxIdNumber=constants_customsDeclaration.Kk.taxIdNumber.invalid(values.taxIdType.value));else errors.taxIdNumber=constants_customsDeclaration.Kk.taxIdNumber.tooLong(constants_customsDeclaration.l_)}else errors.taxIdNumber=constants_customsDeclaration.Kk.taxIdNumber.required(values.taxIdType.value);return errors};var CustomsDeclarationForm_Row=(0,emotion_styled_browser_esm.A)(Grid.f)(CustomsDeclarationForm_templateObject_1||(CustomsDeclarationForm_templateObject_1=(0,tslib_es6.ue)(["\n  :last-of-type {\n    padding-bottom: 16px;\n  }\n"],["\n  :last-of-type {\n    padding-bottom: 16px;\n  }\n"]))),FormContainer=(0,emotion_styled_browser_esm.A)("div")(CustomsDeclarationForm_templateObject_2||(CustomsDeclarationForm_templateObject_2=(0,tslib_es6.ue)(["\n  overflow: auto;\n  padding: 16px 30px 66px 30px;\n  a {\n    color: ",";\n  }\n\n  @media screen and (min-width: ","px) {\n    padding: 16px 30px 0 30px;\n  }\n"],["\n  overflow: auto;\n  padding: 16px 30px 66px 30px;\n  a {\n    color: ",";\n  }\n\n  @media screen and (min-width: ","px) {\n    padding: 16px 30px 0 30px;\n  }\n"])),styles_constants.Tj.sea700,responsive.P.Mobile),requiredLabelProps={required:!0};const CustomsDeclarationModal_CustomsDeclarationForm=(0,redux.Zz)((0,es.Ng)((function(state,ownProps){var valuesSelector=(0,formValueSelector.A)(constants_form.ZP),customsDeclaration=ownProps.customsDeclaration;return{initialValues:customsDeclaration?(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},customsDeclaration),{b13aFilingOption:customsDeclaration.b13aFilingOption?options.Ay.customsDeclaration.b13aFilingOptionsMap[customsDeclaration.b13aFilingOption]:null,contentsType:customsDeclaration.contentsType?options.Ay.customsDeclaration.contentsTypeOptionsMap[customsDeclaration.contentsType]:options.Ay.customsDeclaration.contentsTypeOptionsMap[constants_customsDeclaration.fI.MERCHANDISE],incoterm:customsDeclaration.incoterm?options.Ay.customsDeclaration.incotermOptionsMap[customsDeclaration.incoterm]:options.Ay.customsDeclaration.incotermOptionsMap[constants_customsDeclaration.uF.DDU],eelPfc:customsDeclaration.eelPfc?options.Ay.customsDeclaration.eelPfcOptionsMap[customsDeclaration.eelPfc]:null,nonDeliveryOption:customsDeclaration.nonDeliveryOption?options.Ay.customsDeclaration.nonDeliveryOptionsMap[customsDeclaration.nonDeliveryOption]:options.Ay.customsDeclaration.nonDeliveryOptionsMap[constants_customsDeclaration.kV.RETURN],certifySigner:customsDeclaration.certifySigner?customsDeclaration.certifySigner:ownProps.senderAddressName,taxIdType:customsDeclaration.taxIdType?options.Ay.customsDeclaration.taxIdTypeOptionsMap[customsDeclaration.taxIdType]:options.Ay.customsDeclaration.taxIdTypeOptionsMap[""]}):{b13aFilingOption:null,contentsType:options.Ay.customsDeclaration.contentsTypeOptionsMap[constants_customsDeclaration.fI.MERCHANDISE],incoterm:options.Ay.customsDeclaration.incotermOptionsMap[constants_customsDeclaration.uF.DDU],eelPfc:null,nonDeliveryOption:options.Ay.customsDeclaration.nonDeliveryOptionsMap[constants_customsDeclaration.kV.RETURN],certifySigner:ownProps.senderAddressName,taxIdType:options.Ay.customsDeclaration.taxIdTypeOptionsMap[""]},formValues:{contentsType:valuesSelector(state,"contentsType"),b13aFilingOption:valuesSelector(state,"b13aFilingOption")||options.Ay.customsDeclaration.b13aFilingOptionsMap[constants_customsDeclaration.i2.NONE_SELECTED],eelPfc:valuesSelector(state,"eelPfc"),taxIDTypeSelected:valuesSelector(state,"taxIdType"),incotermSelected:valuesSelector(state,"incoterm")}}})),(0,reduxForm.A)({validate:CustomsDeclarationModal_validate,form:constants_form.ZP,submitAsSideEffect:!0}))((function(props){var _a=props.formValues,eelPfc=_a.eelPfc,b13aFilingOption=_a.b13aFilingOption,taxIDTypeSelected=_a.taxIDTypeSelected,showEELPFC=props.showEELPFC,showB13A=props.showB13A,isAesItnSelected=(null==eelPfc?void 0:eelPfc.value)===constants_customsDeclaration.aU.AESITN,isTaxIdSelected=""!==(null==taxIDTypeSelected?void 0:taxIDTypeSelected.value),isB13ANumberInputVisible=(null==b13aFilingOption?void 0:b13aFilingOption.value)!==constants_customsDeclaration.i2.NONE_SELECTED;(0,react.useEffect)((function(){props.submitSucceeded&&props.onClose()}),[props.submitSucceeded,props.onClose]);var taxIdNumberFieldToolTip=(0,react.useMemo)((function(){var _a;switch(null===(_a=props.formValues.taxIDTypeSelected)||void 0===_a?void 0:_a.value){case constants_customsDeclaration.Gs.VAT:return["A VAT (Value-Added Tax) number is a registered tax identification number in tax systems that have a Value-Added Tax."];case constants_customsDeclaration.Gs.IOSS:return["An IOSS VAT (Import One Stop Shop Value-Added Tax) number is a registered tax identification number in EU tax systems that have a Value-Added Tax for imports in EU countries."];case constants_customsDeclaration.Gs.EIN:return["An EIN is a unique nine-digit number that identifies your business for tax purposes in the United States. The EIN will be printed on the Commercial Invoice. Please",(0,emotion_react_jsx_runtime_browser_esm.FD)(emotion_react_jsx_runtime_browser_esm.FK,{children:[" ",(0,emotion_react_jsx_runtime_browser_esm.Y)("strong",{children:"do not"})," "]}),"submit a Social Security Number."];default:return[""]}}),[props.formValues.taxIDTypeSelected]);return(0,emotion_react_jsx_runtime_browser_esm.Y)("form",(0,tslib_es6.Cl)({onSubmit:props.handleSubmit(props.onSubmit)},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(FormContainer,{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(CustomsDeclarationForm_Row,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Grid.V,(0,tslib_es6.Cl)({width:"50%"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{required:!0,responsive:!0,name:"contentsType",component:SelectField,options:options.Ay.customsDeclaration.contentsTypeOptions,type:"text",label:"Purpose of shipment",labelProps:(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},requiredLabelProps),{tooltipText:"What is the reason for export? For example, is the shipment a sale, a gift, an item for repair, etc.",tooltipPosition:"right"})})})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Grid.V,(0,tslib_es6.Cl)({width:"50%"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{responsive:!0,name:"incoterm",component:SelectField,options:options.Ay.customsDeclaration.incotermOptions,type:"text",label:"Incoterm",labelProps:{tooltipText:"Selection indicates who pays for customs charges (duties & taxes). Default is DDU (Receiver)",tooltipPosition:"bottom"}})}))]}),props.formValues.contentsType&&props.formValues.contentsType.value===constants_customsDeclaration.fI.OTHER&&(0,emotion_react_jsx_runtime_browser_esm.FD)(CustomsDeclarationForm_Row,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Grid.V,(0,tslib_es6.Cl)({width:"50%"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{required:!0,responsive:!0,name:"contentsExplanation",component:Input.FO,type:"text",label:"Content Explanation",labelProps:(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},requiredLabelProps),{tooltipText:"Describe the type of content",tooltipPosition:"right"})})})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Grid.V,{width:"50%"})]}),(0,emotion_react_jsx_runtime_browser_esm.FD)(CustomsDeclarationForm_Row,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Grid.V,(0,tslib_es6.Cl)({width:"50%"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{responsive:!0,name:"exporterReference",component:Input.FO,type:"text",label:"Exporter reference",labelProps:{tooltipText:"Your reference if you are a certified exporter (optional)",tooltipPosition:"right"}})})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Grid.V,(0,tslib_es6.Cl)({width:"50%"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{responsive:!0,name:"importerReference",component:Input.FO,type:"text",label:"Importer reference",labelProps:{tooltipText:"Your reference if you are a certified importer (optional)"}})}))]}),(0,emotion_react_jsx_runtime_browser_esm.FD)(CustomsDeclarationForm_Row,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Grid.V,(0,tslib_es6.Cl)({width:"50%"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{responsive:!0,name:"invoice",component:Input.FO,type:"text",label:"Invoice number",labelProps:{tooltipText:"Your invoice number which will be printed on the declaration",tooltipPosition:"right"}})})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Grid.V,(0,tslib_es6.Cl)({width:"50%"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{responsive:!0,name:"nonDeliveryOption",component:SelectField,options:options.Ay.customsDeclaration.nonDeliveryOptions,type:"text",label:"Non-delivery handling",labelProps:{tooltipText:"What should be done when the delivery is not possible? Selecting return might cause additional charges later"}})}))]}),(0,emotion_react_jsx_runtime_browser_esm.FD)(CustomsDeclarationForm_Row,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Grid.V,(0,tslib_es6.Cl)({width:"50%"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{responsive:!0,name:"license",component:Input.FO,type:"text",label:"License",labelProps:{tooltipText:"The license identifier you need for some types of shipments. (optional)",tooltipPosition:"right"}})})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Grid.V,(0,tslib_es6.Cl)({width:"50%"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{responsive:!0,name:"certificate",component:Input.FO,type:"text",label:"Certificate",labelProps:{tooltipText:"The certificate identifier you need for some types of shipments. (optional)"}})}))]}),(0,emotion_react_jsx_runtime_browser_esm.FD)(CustomsDeclarationForm_Row,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Grid.V,(0,tslib_es6.Cl)({width:"50%"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{required:!0,responsive:!0,name:"eoriNumber",component:Input.FO,type:"text",label:"EORI Number",labelProps:{tooltipText:"An EORI (Economic Operators Registration Number) is required to move goods into or out of the European Union."}})})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Grid.V,(0,tslib_es6.Cl)({width:"50%"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{required:!0,responsive:!0,name:"certifySigner",component:Input.FO,type:"text",label:"Name of authorized person",labelProps:(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},requiredLabelProps),{tooltipText:"The responsible person signing this customs declaration. Must be the one filling it out (required). For USPS this field cannot be changed, it will automatically be set to the sender address' name"})})}))]}),(0,emotion_react_jsx_runtime_browser_esm.FD)("p",(0,tslib_es6.Cl)({className:"m-0"},{children:["Provide IOSS VAT ID if you are shipping to EU through FedEx, UPS, DHL Express, or USPS via PMI or PMEI."," ",(0,emotion_react_jsx_runtime_browser_esm.Y)("a",(0,tslib_es6.Cl)({href:"https://support.goshippo.com/hc/en-us/articles/1260805823509-EORI-TaxID-VAT-IOSS",target:"_blank",rel:"noreferrer"},{children:"Learn more"}))]})),(0,emotion_react_jsx_runtime_browser_esm.FD)(CustomsDeclarationForm_Row,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Grid.V,(0,tslib_es6.Cl)({width:isTaxIdSelected?"50%":"100%"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{responsive:!0,name:"taxIdType",component:SelectField,options:options.Ay.customsDeclaration.taxIdTypeOptions,type:"text",label:"Tax ID Type",labelProps:{tooltipText:"Tax IDs are unique identifiers assigned to a business entity for tax purposes. Examples include EIN (Employer Identification Number), IOSS (Import One Stop Shop) and VAT (Value Added Tax) numbers. Shippo does not accept personally identifying Tax IDs, such as Social Security Numbers."}})})),isTaxIdSelected&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Grid.V,(0,tslib_es6.Cl)({width:"50%"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{required:!0,responsive:!0,name:"taxIdNumber",component:Input.FO,type:"text",label:null==taxIDTypeSelected?void 0:taxIDTypeSelected.value,labelProps:(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},requiredLabelProps),{tooltipText:taxIdNumberFieldToolTip,isAutoWidth:!0})})}))]}),showEELPFC&&(0,emotion_react_jsx_runtime_browser_esm.FD)(CustomsDeclarationForm_Row,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Grid.V,(0,tslib_es6.Cl)({width:isAesItnSelected?"50%":"100%"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{responsive:!0,name:"eelPfc",component:SelectField,options:options.Ay.customsDeclaration.eelPfcOptions,type:"text",label:"EEL / PFC",labelProps:{tooltipText:"Exemption or Exclusion Legend (EEL) or a Proof of Filing Citation (PFC). Only required in specific cases (optional). For most merchants, choose NOEEI 30 36 for shipments from the US or CA or NOEEI 30 37(a) for any other shipments from the US",tooltipPosition:"right"}})})),isAesItnSelected&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Grid.V,(0,tslib_es6.Cl)({width:"50%"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{required:!0,responsive:!0,name:"aesItn",component:Input.FO,type:"text",label:"AES / ITN",labelProps:(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},requiredLabelProps),{tooltipText:"The applicable Automated Export System or Internal Transaction Number.",tooltipPosition:"right"})})}))]}),showB13A&&(0,emotion_react_jsx_runtime_browser_esm.FD)(CustomsDeclarationForm_Row,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Grid.V,(0,tslib_es6.Cl)({width:isB13ANumberInputVisible?"50%":"100%"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{responsive:!0,name:"b13aFilingOption",component:SelectField,label:"B13A Option",labelProps:{tooltipText:["B13A Option details are obtained by filing a B13A Canada Export Declaration via the Canadian Export Reporting System (CERS). Optional. ",(0,emotion_react_jsx_runtime_browser_esm.Y)(Link.zN,(0,tslib_es6.Cl)({href:"https://www.cbsa-asfc.gc.ca/export/reporting-declaration-eng.html",rel:"noreferrer noopener",target:"_blank"},{children:"More information on reporting commercial exports from Canada."}),"link")],tooltipPosition:"right"},options:options.Ay.customsDeclaration.b13aFilingOptions,type:"text",value:props.formValues.b13aFilingOption})})),isB13ANumberInputVisible&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Grid.V,(0,tslib_es6.Cl)({width:"50%"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{required:!0,responsive:!0,name:"b13aNumber",component:Input.FO,type:"text",label:constants_customsDeclaration.Zq[String(b13aFilingOption.value)].label,labelProps:requiredLabelProps})}))]}),(0,emotion_react_jsx_runtime_browser_esm.Y)(CustomsDeclarationForm_Row,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Grid.V,(0,tslib_es6.Cl)({width:"100%"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{responsive:!0,name:"notes",component:TextArea.l2,type:"textarea",label:"Notes",rows:4,labelProps:{tooltipText:"Any notes that might be relevant for customs processing (optional).",tooltipPosition:"right"}})}))}),(0,emotion_react_jsx_runtime_browser_esm.Y)(CustomsDeclarationForm_Row,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Grid.V,(0,tslib_es6.Cl)({width:"100%"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{required:!0,responsive:!0,name:"isCertify",label:"I certify the validity of the information provided",component:components_Checkbox.Y,labelProps:requiredLabelProps})}))})]})}))}));var CustomsDeclarationForm_templateObject_1,CustomsDeclarationForm_templateObject_2;const CustomsDeclarationModal_CustomsDeclarationModal=function(props){var dispatch=(0,es.wA)(),submitting=(0,es.d4)((0,isSubmitting.A)(constants_form.ZP)),initialValues=(0,es.d4)((0,getFormInitialValues.A)(constants_form.ZP)),handleSubmit=react.useCallback((function(){dispatch((0,redux_form_es.tA)(constants_form.ZP))}),[dispatch,redux_form_es.tA]),handleEditCustomsDeclaration=react.useCallback((function(formValues){var _a,_b,orderSelection=((_a={})[props.orderObjectId]=props.batchEntryId?[props.batchEntryId]:[],_a),b13aFilingOption=formValues.b13aFilingOption&&formValues.b13aFilingOption.value!==constants_customsDeclaration.i2.NONE_SELECTED?formValues.b13aFilingOption:"",contentsExplanation=formValues.contentsType&&formValues.contentsType.value===constants_customsDeclaration.fI.OTHER?formValues.contentsExplanation:"",taxIdType=(null===(_b=null==formValues?void 0:formValues.taxIdType)||void 0===_b?void 0:_b.value)?formValues.taxIdType.value:"",valuesPayload=(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},formValues),{contentsExplanation,b13aFilingOption,b13aNumber:b13aFilingOption?formValues.b13aNumber:"",taxIdNumber:taxIdType?formValues.taxIdNumber:""});dispatch(editCustomsDeclaration(props.appLocation,orderSelection,valuesPayload,initialValues,{transactionId:null==props?void 0:props.transactionId,location:schema.ID}))}),[dispatch,editCustomsDeclaration]);return(0,emotion_react_jsx_runtime_browser_esm.FD)(Modal.A.Container,(0,tslib_es6.Cl)({isOpen:!0,hasNoPaddingHeader:!0,size:"sm",onClose:props.onClose,showCloseIcon:!0},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Modal.A.Header,(0,tslib_es6.Cl)({hidePadding:!0,hideBorder:!0},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(StyledComponents.a1,{children:"Commercial invoice"})})),(0,emotion_react_jsx_runtime_browser_esm.Y)(StyledComponents.hb,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(CustomsDeclarationModal_CustomsDeclarationForm,{orderObjectId:props.orderObjectId,onClose:props.onClose,onSubmit:handleEditCustomsDeclaration,customsDeclaration:props.customsDeclaration,senderAddressName:props.senderAddressName,showEELPFC:props.conditionalFieldsFlags.showEELPFC,showB13A:props.conditionalFieldsFlags.showB13A})}),(0,emotion_react_jsx_runtime_browser_esm.Y)(StyledComponents.al,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"w-full"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(StyledComponents.Zb,(0,tslib_es6.Cl)({onClick:props.onClose,dataPendo:"customs-declaration-edit-cancel",id:"customs-declaration-edit-cancel"},{children:"Cancel"})),(0,emotion_react_jsx_runtime_browser_esm.Y)(StyledComponents.Tk,(0,tslib_es6.Cl)({fullWidth:!0,onClick:handleSubmit,disabled:submitting,isLoading:submitting,dataPendo:"customs-declaration-edit-submit",id:"customs-declaration-edit-submit"},{children:"Save"}))]}))})]}))},Tabs_CustomsDeclarationModal=CustomsDeclarationModal_CustomsDeclarationModal;var CustomsOptOutForm_Footer=(0,emotion_styled_browser_esm.A)("div")(CustomsOptOutForm_templateObject_1||(CustomsOptOutForm_templateObject_1=(0,tslib_es6.ue)(["\n  text-align: right;\n"],["\n  text-align: right;\n"]))),CustomsOptOutForm_CancelButton=(0,emotion_styled_browser_esm.A)(components_Button.vM)(CustomsOptOutForm_templateObject_2||(CustomsOptOutForm_templateObject_2=(0,tslib_es6.ue)(["\n  margin-right: 10px;\n"],["\n  margin-right: 10px;\n"]))),WarningText=(0,emotion_styled_browser_esm.A)("div")(CustomsOptOutForm_templateObject_3||(CustomsOptOutForm_templateObject_3=(0,tslib_es6.ue)(["\n  line-height: 18px;\n  font-size: 13px;\n"],["\n  line-height: 18px;\n  font-size: 13px;\n"])));const CustomsDeclarationCard_CustomsOptOutForm=(0,redux.Zz)((0,utils_translate.Tl)("orders"),(0,es.Ng)((function(state,ownProps){var _a,valuesSelector=(0,formValueSelector.A)(constants_form.HB),defaultMassUnit=null!==(_a=(0,user_selectors.cm)(state))&&void 0!==_a?_a:weight.VV.LB;return{isBypassCustomsValue:valuesSelector(state,"isBypassCustoms"),initialValues:getInitialShipmentExtrasFormValues(ownProps.batchEntry,defaultMassUnit,!1)}})),(0,reduxForm.A)({form:constants_form.HB,enableReinitialize:!0}))((function(props){var t=props.t,reset=props.reset,submitting=props.submitting,pristine=props.pristine,submitFailed=props.submitFailed,batchEntry=props.batchEntry,order=props.order,isBypassCustomsValue=props.isBypassCustomsValue,dispatch=(0,es.wA)(),_a=(0,tslib_es6.zs)(react.useState(pristine),2),hideControls=_a[0],updateHideControls=_a[1];react.useEffect((function(){pristine||updateHideControls(!1),submitFailed&&updateHideControls(!0)}),[pristine,submitFailed]);var onSubmit=react.useCallback((function(data){var _a;utils_observability.O.startEvent("RATE_REFRESH_ORDER_DETAILS"),dispatch((0,orders_actions.xl)(((_a={})[order.objectId]=batchEntry?[batchEntry.id]:[],_a),(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},data),{insurance:(null==data?void 0:data.insurance)&&data.insurance.purchaseInsurance?(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},data.insurance),{currency:constants_currency.q[data.insurance.currency.value.toString()]}):null,alcohol:(null==data?void 0:data.alcohol.containsAlcohol)?{containsAlcohol:data.alcohol.containsAlcohol,recipientType:data.alcohol.recipientType.value}:null,signatureConfirmation:data.signatureConfirmation.hasSignatureConfirmation?{hasSignatureConfirmation:data.signatureConfirmation.hasSignatureConfirmation,signatureConfirmationType:data.signatureConfirmation.signatureConfirmationType.value}:null,dryIce:data.dryIce.containsDryIce?{containsDryIce:data.dryIce.containsDryIce,weight:data.dryIce.weight,weightUnitId:data.dryIce.weightUnitId}:null,isBypassCustoms:data.isBypassCustoms,packingSlipText:data.packingSlipText,hazmat:null}),constants_form.HB))}),[isBypassCustomsValue]),handleCancel=react.useCallback((function(){reset(),updateHideControls((function(prevState){return!prevState}))}),[reset]),renderWarning=react.useCallback((function(){var i18nKey="customsDeclarationOptOutWarning";return function(batchEntry){var _a,_b,_c,_d,countryTo=null===(_b=null===(_a=null==batchEntry?void 0:batchEntry.addressTo)||void 0===_a?void 0:_a.country)||void 0===_b?void 0:_b.iso2,countryFrom=null===(_d=null===(_c=null==batchEntry?void 0:batchEntry.addressFrom)||void 0===_c?void 0:_c.country)||void 0===_d?void 0:_d.iso2;return countryTo&&countryFrom&&countryTo!==countryFrom&&constants_countries.R$.includes(countryTo)&&constants_countries.R$.includes(countryFrom)}(batchEntry)&&(i18nKey=i18nKey.concat("Ics2")),(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"flex items-start py-2"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"flex items-start text-lg mr-2 -ml-px"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Icon,{warning:!0,className:"fa fa-exclamation-circle"})})),(0,emotion_react_jsx_runtime_browser_esm.Y)(WarningText,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(utils_translate.x6,(0,tslib_es6.Cl)({i18nKey:"calculateRates.tabs.shipmentInfo.".concat(i18nKey)},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Link.tp,(0,tslib_es6.Cl)({target:"_blank",href:"https://support.goshippo.com/hc/en-us/articles/203004889-Customs-Declarations-in-Shippo"},{children:t("calculateRates.tabs.shipmentInfo.customsDeclarationOptOutWarningLink")}))}))})]}))}),[batchEntry]);return(0,emotion_react_jsx_runtime_browser_esm.FD)("form",(0,tslib_es6.Cl)({onSubmit:props.handleSubmit(onSubmit)},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{name:"isBypassCustoms",component:components_Checkbox.Y,label:t("orders:calculateRates:tabs:shipmentInfo:customsDeclarationOptOut"),labelProps:{tooltipText:t("orders:calculateRates:tabs:shipmentInfo:customsDeclarationOptOutTooltip")}}),isBypassCustomsValue&&renderWarning(),!hideControls&&(0,emotion_react_jsx_runtime_browser_esm.FD)(CustomsOptOutForm_Footer,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(CustomsOptOutForm_CancelButton,(0,tslib_es6.Cl)({onClick:handleCancel,disabled:submitting},{children:t("orders:phrases:cancel")})),(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Button.jn,(0,tslib_es6.Cl)({type:"submit",isLoading:submitting,disabled:submitting||pristine,dataPendo:"service-apply"},{children:t("orders:phrases:save")}))]})]}))}));var CustomsOptOutForm_templateObject_1,CustomsOptOutForm_templateObject_2,CustomsOptOutForm_templateObject_3,styles_templateObject_1,styles_templateObject_2,styles_templateObject_3,styles_templateObject_4,styles_templateObject_5,styles_templateObject_6,InfoContainer=(0,emotion_styled_browser_esm.A)("div")(styles_templateObject_1||(styles_templateObject_1=(0,tslib_es6.ue)(["\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  padding-top: 1rem;\n"],["\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  padding-top: 1rem;\n"]))),InfoField=(0,emotion_styled_browser_esm.A)("div")(styles_templateObject_2||(styles_templateObject_2=(0,tslib_es6.ue)(["\n  ",";\n  padding-bottom: 1rem;\n"],["\n  ",";\n  padding-bottom: 1rem;\n"])),(function(props){return props.isSpan?"grid-column: auto / span 2":""})),styles_Title=(0,emotion_styled_browser_esm.A)("div")(styles_templateObject_3||(styles_templateObject_3=(0,tslib_es6.ue)(["\n  font-size: 0.75rem;\n  font-weight: ",";\n  line-height: 1.25rem;\n  height: 1.25rem;\n  color: ",";\n"],["\n  font-size: 0.75rem;\n  font-weight: ",";\n  line-height: 1.25rem;\n  height: 1.25rem;\n  color: ",";\n"])),styles_constants.Wy.normal,styles_constants.Tj.gray700),Subtitle=(0,emotion_styled_browser_esm.A)("div")(styles_templateObject_4||(styles_templateObject_4=(0,tslib_es6.ue)(["\n  font-size: 0.875rem;\n  font-weight: ",";\n  height: 1.5rem;\n  line-height: 1.5rem;\n  color: ",";\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n"],["\n  font-size: 0.875rem;\n  font-weight: ",";\n  height: 1.5rem;\n  line-height: 1.5rem;\n  color: ",";\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n"])),styles_constants.Wy.normal,(function(props){return props.isNone?styles_constants.Tj.gray400:styles_constants.Tj.gray1000})),NotesCell=(0,emotion_styled_browser_esm.A)(InfoField)(styles_templateObject_5||(styles_templateObject_5=(0,tslib_es6.ue)(["\n  max-width: 466px;\n"],["\n  max-width: 466px;\n"]))),NotesValue=(0,emotion_styled_browser_esm.A)(Subtitle)(styles_templateObject_6||(styles_templateObject_6=(0,tslib_es6.ue)(["\n  white-space: inherit;\n  height: auto;\n"],["\n  white-space: inherit;\n  height: auto;\n"]))),CustomsDeclarationCard_a=options.Ay.customsDeclaration,contentsTypeOptionsMap=CustomsDeclarationCard_a.contentsTypeOptionsMap,nonDeliveryOptionsMap=CustomsDeclarationCard_a.nonDeliveryOptionsMap,ComposedCustomsDeclarationCard=(0,utils_translate.Tl)()((function(props){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,t=props.t,order=props.order,senderAddress=props.senderAddress,customsDeclaration=props.customsDeclaration,batchEntry=props.batchEntry,conditionalFieldsFlags=getConditionalFieldsFlags({sender:{batchEntryAddress:batchEntry&&batchEntry.addressFrom?{country:(null===(_b=null===(_a=batchEntry.addressFrom)||void 0===_a?void 0:_a.country)||void 0===_b?void 0:_b.iso2)||"",state:batchEntry.addressFrom.state}:void 0,orderAddress:order&&order.addressFrom?{country:(null===(_d=null===(_c=order.addressFrom)||void 0===_c?void 0:_c.country)||void 0===_d?void 0:_d.iso2)||"",state:order.addressFrom.state}:void 0},recipient:{batchEntryAddress:batchEntry&&batchEntry.addressTo?{country:(null===(_f=null===(_e=batchEntry.addressTo)||void 0===_e?void 0:_e.country)||void 0===_f?void 0:_f.iso2)||"",state:batchEntry.addressTo.state}:void 0,orderAddress:order&&order.toAddress?{country:(null===(_h=null===(_g=order.toAddress)||void 0===_g?void 0:_g.country)||void 0===_h?void 0:_h.iso2)||"",state:order.toAddress.state}:void 0}}),_m=(0,tslib_es6.zs)(react.useState(!1),2),showDetails=_m[0],updateShowDetails=_m[1],_o=(0,tslib_es6.zs)(react.useState(!1),2),showModal=_o[0],updateShowModal=_o[1],handleEditClick=react.useCallback((function(){updateShowModal((function(prevState){return!prevState}))}),[]),handleShowDetailsClick=react.useCallback((function(){updateShowDetails((function(prevState){return!prevState}))}),[]),cdInfo=customsDeclaration||{contentsType:"MERCHANDISE",contentsExplanation:"",incoterm:"DDU",exporterReference:"",importerReference:"",invoice:"",license:"",certificate:"",certifySigner:senderAddress&&senderAddress.name||"",eelPfc:"",aesItn:"",notes:"",nonDeliveryOption:"RETURN",b13aFilingOption:"",b13aNumber:"",eoriNumber:"",taxIdType:"",taxIdNumber:""},senderAddressName=react.useMemo((function(){return(null==batchEntry?void 0:batchEntry.addressFrom)?batchEntry.addressFrom.name:order.addressFrom?order.addressFrom.name:senderAddress?senderAddress.name:void 0}),[batchEntry,order,senderAddress]),renderEditButton=react.useCallback((function(){var _a;return(0,emotion_react_jsx_runtime_browser_esm.Y)(Link.Oc,(0,tslib_es6.Cl)({onClick:handleEditClick,dataPendo:"customs-declaration-edit",dataAnalytics:"customs-declaration-edit",id:"customs-declaration-edit",disabled:!!(null===(_a=null==batchEntry?void 0:batchEntry.extras)||void 0===_a?void 0:_a.isBypassCustoms)},{children:t("orders:calculateRates:tabs:shipmentInfo:customsDeclarationEdit")}))}),[batchEntry,handleEditClick]),renderDetailsAccordion=react.useCallback((function(){return(0,emotion_react_jsx_runtime_browser_esm.Y)("button",(0,tslib_es6.Cl)({className:"cursor-pointer flex items-center justify-center bg-transparent border-none m-0 p-0 w-full",style:{color:"inherit",fontSize:"inherit",lineHeight:"inherit"},onClick:handleShowDetailsClick,"data-testid":"order-details-customs-accordion-show-details"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)("span",{children:showDetails?(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[t("orders:calculateRates:tabs:shipmentInfo:customsDeclarationHideDetails"),(0,emotion_react_jsx_runtime_browser_esm.Y)("i",{className:"fa fa-caret-up ml-2"})]}):(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[t("orders:calculateRates:tabs:shipmentInfo:customsDeclarationShowDetails"),(0,emotion_react_jsx_runtime_browser_esm.Y)("i",{className:"fa fa-caret-down ml-2"})]})})}))}),[handleShowDetailsClick,showDetails]),renderInfoField=react.useCallback((function(_a,span){var label=_a.label,value=_a.value;void 0===span&&(span=!1);var testId=(0,utils_utils.a2)(label);return(0,emotion_react_jsx_runtime_browser_esm.FD)(InfoField,(0,tslib_es6.Cl)({"data-testid":testId,isSpan:span},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(styles_Title,{children:label}),(0,emotion_react_jsx_runtime_browser_esm.Y)(Subtitle,(0,tslib_es6.Cl)({isNone:"None"===value},{children:value}))]}),(0,index_browser.Ak)())}),[]),renderNotes=react.useCallback((function(value){return(0,emotion_react_jsx_runtime_browser_esm.FD)(NotesCell,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(styles_Title,{children:"Notes"}),(0,emotion_react_jsx_runtime_browser_esm.Y)(NotesValue,(0,tslib_es6.Cl)({isNone:"None"===value},{children:value}))]})}),[]),isValid=react.useMemo((function(){var _a;return(null==batchEntry?void 0:batchEntry.customsDeclaration)||!!(null===(_a=null==batchEntry?void 0:batchEntry.extras)||void 0===_a?void 0:_a.isBypassCustoms)}),[batchEntry]);return(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(Tabs_ShipmentInfoCardTitle,(0,tslib_es6.Cl)({invalid:!isValid},{children:[t("orders:calculateRates:tabs:shipmentInfo:customsDeclaration"),(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"flex items-baseline"},{children:renderEditButton()}))]})),(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(CustomsDeclarationCard_CustomsOptOutForm,{order:props.order,batchEntry:props.batchEntry}),!(null===(_j=null==batchEntry?void 0:batchEntry.extras)||void 0===_j?void 0:_j.isBypassCustoms)&&(0,emotion_react_jsx_runtime_browser_esm.FD)("div",{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(InfoContainer,(0,tslib_es6.Cl)({"data-testid":"customs-declaration-info"},{children:[renderInfoField({label:"Type of Content",value:contentsTypeOptionsMap[cdInfo.contentsType].label}),renderInfoField({label:"Incoterm",value:cdInfo.incoterm}),cdInfo.contentsType===constants_customsDeclaration.Vv.OTHER?renderInfoField({label:"Content Explanation",value:cdInfo.contentsExplanation||"None"},!0):null,showDetails&&(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[renderInfoField({label:"Exporter Reference",value:cdInfo.exporterReference||"None"}),renderInfoField({label:"Importer Reference",value:cdInfo.importerReference||"None"}),renderInfoField({label:"Invoice",value:cdInfo.invoice||"None"}),renderInfoField({label:"Non-delivery handling",value:nonDeliveryOptionsMap[cdInfo.nonDeliveryOption].label}),renderInfoField({label:"License",value:cdInfo.license||"None"}),renderInfoField({label:"Certificate",value:cdInfo.certificate||"None"}),renderInfoField({label:"EORI Number",value:cdInfo.eoriNumber||"None"}),renderInfoField({label:"Signing Person",value:cdInfo.certifySigner}),renderInfoField({label:"Tax ID Type",value:cdInfo.taxIdType||"None"},!cdInfo.taxIdType),cdInfo.taxIdNumber&&cdInfo.taxIdType&&renderInfoField({label:cdInfo.taxIdType,value:cdInfo.taxIdNumber}),conditionalFieldsFlags.showEELPFC&&renderInfoField({label:"EEL / PFC",value:cdInfo.eelPfc||"None"},!0),conditionalFieldsFlags.showEELPFC&&cdInfo.eelPfc&&cdInfo.eelPfc===constants_customsDeclaration.aU.AESITN?renderInfoField({label:"AES / ITN",value:cdInfo.aesItn||"None"},!0):null,conditionalFieldsFlags.showB13A&&renderInfoField({label:"B13A Option",value:cdInfo.b13aFilingOption||"None"},!cdInfo.b13aFilingOption),conditionalFieldsFlags.showB13A&&cdInfo.b13aFilingOption&&cdInfo.b13aFilingOption!==constants_customsDeclaration.i2.NONE_SELECTED&&renderInfoField({label:constants_customsDeclaration.Zq[cdInfo.b13aFilingOption].label,value:cdInfo.b13aNumber||"None"})]})]})),showDetails&&renderNotes(cdInfo.notes||"None"),renderDetailsAccordion()]})]}),showModal&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Tabs_CustomsDeclarationModal,{appLocation:"order_details",orderObjectId:order.objectId,batchEntryId:null===(_k=props.batchEntry)||void 0===_k?void 0:_k.id,transactionId:(null===(_l=props.batchEntry)||void 0===_l?void 0:_l.transactionObjectId)||"",onClose:handleEditClick,customsDeclaration:props.customsDeclaration,senderAddressName,conditionalFieldsFlags})]})}));const Tabs_CustomsDeclarationCard=ComposedCustomsDeclarationCard;var OrderItemsCard_common_templateObject_1,common_templateObject_2,icon_customs_declaration=__webpack_require__("./app/assets/icons/icon_customs_declaration.svg"),Layout=__webpack_require__("./app/components/Layout/index.ts"),HalfSection=(0,emotion_styled_browser_esm.A)("div")(OrderItemsCard_common_templateObject_1||(OrderItemsCard_common_templateObject_1=(0,tslib_es6.ue)(["\n  width: 50%;\n  display: flex;\n"],["\n  width: 50%;\n  display: flex;\n"]))),common_Icon=(0,emotion_styled_browser_esm.A)("i")(common_templateObject_2||(common_templateObject_2=(0,tslib_es6.ue)(["\n  height: 8px;\n  color: ",";\n  font-size: inherit;\n  line-height: inherit;\n"],["\n  height: 8px;\n  color: ",";\n  font-size: inherit;\n  line-height: inherit;\n"])),styles_constants.Tj.ruby600),ErrorIcon=function(props){return(0,emotion_react_jsx_runtime_browser_esm.Y)(common_Icon,{className:"".concat(props.className," fa fa-exclamation-circle")})},ErrorDialog=(__webpack_require__("./app/components/Dialog/Dialog.tsx"),__webpack_require__("./app/components/Dialog/ErrorDialog/ErrorDialog.tsx"));const Dialog_ErrorDialog=ErrorDialog.A;var getLineItemsStore=function(state){return state.lineItem},getIsDeletingLineItem=(0,reselect_es.createSelector)(getLineItemsStore,(function(lineItemsStore){return lineItemsStore.isDeletingLineItem})),getIsDeletingCustomsItem=(0,reselect_es.createSelector)(getLineItemsStore,(function(lineItemsStore){return lineItemsStore.isDeletingCustomsItem})),SmartSelect=__webpack_require__("./app/components/SmartSelect/index.ts"),user_address_selectors=__webpack_require__("./app/selectors/user-address.selectors.ts"),field_formaters=__webpack_require__("./app/utils/field-formaters.ts"),field_normalizers=__webpack_require__("./app/utils/field-normalizers.ts"),numbers=__webpack_require__("./app/utils/numbers.ts"),EccnEar99ValidationRegex=/^(\d[A-Z]\d{3}[\da-z.]{0,15}|EAR99)$/,ValidationMessagesMap_description={required:"Please enter the item title",invalid:"This field cannot be longer than 150 characters"},ValidationMessagesMap_eccnEar99={invalid:"Please enter a valid ECCN/EAR99 code"},ValidationMessagesMap_massUnit={required:"Please select a mass unit"},ValidationMessagesMap_originCountry={required:"Please select a country of origin"},ValidationMessagesMap_quantity={required:"Please enter the item quantity",invalid:"Please enter a valid quantity"},ValidationMessagesMap_tariffNumber={invalid:"This field cannot be longer than 12 characters"},ValidationMessagesMap_unitValue={required:"Please enter unit value",invalid:"Please enter a valid unit value"},ValidationMessagesMap_unitWeight={required:"Please enter unit weight",invalid:"Please enter a valid unit weight"},ValidationMessagesMap_valueCurrency={required:"Please select a currency"};const CustomsItemForm_validate=function(values){var _a,errors={description:"",quantity:"",unitWeight:"",massUnit:"",unitValue:"",valueCurrency:"",originCountry:"",skuCode:"",tariffNumber:"",eccnEar99:"",originalMassUnit:"",originalNetWeight:"",originalUnitWeight:""};if(values.description?(0,validations.JT)(0,150,values.description)||(errors.description=ValidationMessagesMap_description.invalid):errors.description=ValidationMessagesMap_description.required,values.quantity){var trimmedQuantity=values.quantity.toString().trim();(0,validations.M3)(trimmedQuantity,0)&&0!==trimmedQuantity.length||(errors.quantity=ValidationMessagesMap_quantity.invalid)}else errors.quantity=ValidationMessagesMap_quantity.required;if(values.unitWeight){var trimmedUnitWeight=values.unitWeight.toString().trim();(0,validations.aM)(trimmedUnitWeight)&&0!==trimmedUnitWeight.length||(errors.unitWeight=ValidationMessagesMap_unitWeight.invalid)}else errors.unitWeight=ValidationMessagesMap_unitWeight.required;if(values.massUnit||(errors.massUnit=ValidationMessagesMap_massUnit.required),values.unitValue){var trimmedUnitValue=values.unitValue.toString().trim();(0,validations.aM)(trimmedUnitValue)&&0!==trimmedUnitValue.length||(errors.unitValue=ValidationMessagesMap_unitValue.invalid)}else errors.unitValue=ValidationMessagesMap_unitValue.required;return values.valueCurrency||(errors.valueCurrency=ValidationMessagesMap_valueCurrency.required),values.originCountry||(errors.originCountry=ValidationMessagesMap_originCountry.required),values.tariffNumber&&!(0,validations.JT)(1,12,values.tariffNumber)&&(errors.tariffNumber=ValidationMessagesMap_tariffNumber.invalid),(null===(_a=values.eccnEar99)||void 0===_a?void 0:_a.length)&&!EccnEar99ValidationRegex.test(values.eccnEar99)&&(errors.eccnEar99=ValidationMessagesMap_eccnEar99.invalid),errors};var labelProps={required:!0},CustomsItemForm=function(_super){function CustomsItemForm(props){var _this=_super.call(this,props)||this;return _this.memoizedCountryOptions=(0,memoize_one_esm.A)((function(iso2){return(0,Address.b8)(iso2)})),_this.displayCalculatedWeight=function(){var _a=_this.props.formValues,originalMassUnit=_a.originalMassUnit,originalUnitWeight=_a.originalUnitWeight,quantity=_a.quantity,total=(0,numbers.T1)(originalUnitWeight,quantity);if(total&&originalMassUnit)return"Total: ".concat(total.toFixed(2)," ").concat(originalMassUnit.value)},_this.displayCalculatedAmount=function(){var _a=_this.props,t=_a.t,formValues=_a.formValues,unitValue=formValues.unitValue,quantity=formValues.quantity,valueCurrency=formValues.valueCurrency,total=(0,numbers.T1)(unitValue,quantity);if(total&&valueCurrency)return"Total: ".concat(t("currency",{value:{value:total,currency_iso:valueCurrency.value}}))},_this}return(0,tslib_es6.C6)(CustomsItemForm,_super),CustomsItemForm.prototype.componentDidUpdate=function(prevProps){this.props.submitSucceeded&&this.props.onClose(),prevProps.submitting&&!this.props.submitting&&this.props.submitFailed&&this.props.onClose()},CustomsItemForm.prototype.render=function(){var _a=this.props,t=_a.t,onSubmit=_a.onSubmit,suggestedCountry=_a.suggestedCountry,countryOptions=this.memoizedCountryOptions(null==suggestedCountry?void 0:suggestedCountry.iso2);return(0,emotion_react_jsx_runtime_browser_esm.Y)("form",(0,tslib_es6.Cl)({onSubmit:this.props.handleSubmit(onSubmit)},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"grid grid-cols-4 gap-4 items-top"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"col-span-3"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{required:!0,responsive:!0,name:"description",component:Input.FO,type:"text",label:t("orders:calculateRates:tabs:shipmentInfo:modals:common:description"),labelProps})})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{required:!0,responsive:!0,name:"quantity",component:Input.FO,type:"text",inputMode:"decimal",label:t("orders:calculateRates:tabs:shipmentInfo:modals:common:quantity"),labelProps}),(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"col-span-2 md:col-span-1"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{required:!0,responsive:!0,name:"originalUnitWeight",component:Input.FO,type:"string",inputMode:"decimal",label:t("orders:calculateRates:tabs:shipmentInfo:modals:common:unitWeight"),labelProps})})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{required:!0,responsive:!0,name:"originalMassUnit",label:(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"invisible"},{children:t("orders:calculateRates:tabs:shipmentInfo:modals:common:unitWeight")})),component:SelectField,options:options.Ay.weightOptions,size:constants_form.YI.xs}),(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"md:col-span-2 text-left pt-8"},{children:this.displayCalculatedWeight()})),(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"col-span-2 md:col-span-1"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{required:!0,responsive:!0,name:"unitValue",component:Input.FO,type:"string",inputMode:"decimal",label:t("orders:calculateRates:tabs:shipmentInfo:modals:common:unitValue"),labelProps})})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{required:!0,responsive:!0,name:"valueCurrency",label:(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"invisible"},{children:t("orders:calculateRates:tabs:shipmentInfo:modals:common:unitValue")})),component:SelectField,options:options.Ay.currencyOptions,size:constants_form.YI.xs}),(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"md:col-span-2 text-left pt-8"},{children:this.displayCalculatedAmount()})),(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"col-span-4 md:col-span-3"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{required:!0,name:"originCountry",component:SmartSelect.s,label:t("orders:calculateRates:tabs:shipmentInfo:modals:common:originCountry"),options:countryOptions,labelProps,format:field_formaters._m,normalize:field_normalizers.p3,responsive:!0})})),(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"col-span-4 md:col-span-3"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{component:Input.FO,name:"skuCode",label:t("orders:calculateRates:tabs:shipmentInfo:modals:common:sku"),responsive:!0})})),(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"col-span-4 md:col-span-2"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{component:Input.FO,name:"tariffNumber",label:t("orders:calculateRates:tabs:shipmentInfo:modals:customsItemModal:harmonizationCode"),labelProps:{tooltipText:"The Harmonized System (HS) code, sometimes called Tariff code, is a 6-digit code managed by the World Customs Organization. Many governments add additional digits to the HS number to further distinguish products in certain categories according to their Harmonized Tariff Schedule (HTS). The HTS code is comprised of the 6-digit HS code + 1 to 4 digits determined by the country of import.",tooltipPosition:"top"},responsive:!0})})),(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"col-span-4 md:col-span-2"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{component:Input.FO,name:"eccnEar99",label:"ECCN/EAR99",responsive:!0})}))]}))}))},CustomsItemForm}(react.Component);const CustomsItemModal_CustomsItemForm=(0,redux.Zz)((0,utils_translate.Tl)(),(0,es.Ng)((function(state,ownProps){var valuesSelector=(0,formValueSelector.A)(constants_form.Y0),lineItem=ownProps.lineItem,customsItem=ownProps.customsItem,userConfigDefaults=(0,user_selectors.Og)(state),fallbackMassUnit=userConfigDefaults.defaultMassUnit||weight.VV.LB,currency=userConfigDefaults.defaultCurrency||constants_currency.q.USD,initialValues=null;return customsItem?initialValues=(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},customsItem),{unitValue:customsItem.unitValue,originalUnitWeight:customsItem.originalUnitWeight,originalMassUnit:customsItem.originalMassUnit?options.Ay.commonWeightOptions[customsItem.originalMassUnit]:null,valueCurrency:customsItem.valueCurrency?{value:customsItem.valueCurrency.iso,label:customsItem.valueCurrency.iso}:null}):lineItem&&(initialValues={description:lineItem.title,quantity:lineItem.quantity,originalUnitWeight:lineItem.unitWeight,originalMassUnit:lineItem.weightUnit?options.Ay.commonWeightOptions[lineItem.weightUnit]:null,unitValue:lineItem.unitAmount,valueCurrency:lineItem.currency?{value:lineItem.currency.iso,label:lineItem.currency.iso}:null,originCountry:lineItem.countryOfOrigin,skuCode:lineItem.sku,lineItemId:lineItem.id}),{suggestedCountry:(0,user_address_selectors.o)(state),isUpdatingBatchEntry:(0,orders_selectors.$m)(state),formValues:{quantity:valuesSelector(state,"quantity"),originalMassUnit:valuesSelector(state,"originalMassUnit"),originalUnitWeight:valuesSelector(state,"originalUnitWeight"),unitValue:valuesSelector(state,"unitValue"),valueCurrency:valuesSelector(state,"valueCurrency")},initialValues:lineItem||customsItem?initialValues:{originalMassUnit:options.Ay.commonWeightOptions[fallbackMassUnit],valueCurrency:{value:currency.iso,label:currency.iso}}}})),(0,reduxForm.A)({validate:CustomsItemForm_validate,form:constants_form.Y0,destroyOnUnmount:!1,enableReinitialize:!0}))(CustomsItemForm);var DeleteConfirmationDialog=function(_a){var t=_a.t,onClose=_a.onClose,isLoading=_a.isLoading,onConfirm=_a.onConfirm;return(0,emotion_react_jsx_runtime_browser_esm.Y)(Dialog_ErrorDialog,{isOpen:!0,onClose,isLoading,onConfirm,closeButtonText:t("orders:calculateRates:tabs:shipmentInfo:modals:common:cancel"),confirmButtonText:t("orders:calculateRates:tabs:shipmentInfo:modals:customsItemModal:deleteConfirm"),message:t("orders:calculateRates:tabs:shipmentInfo:modals:customsItemModal:deleteConfirmationMessage")})},DeleteLink=function(_a){var t=_a.t,handleDelete=_a.handleDelete;return(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"flex justify-center flex-col text-left w-full"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Link.k0,(0,tslib_es6.Cl)({onClick:handleDelete,"data-pendo":"customs-item-delete",id:"customs-item-delete"},{children:t("orders:calculateRates:tabs:shipmentInfo:modals:customsItemModal:deleteConfirm")}))})}))},ComposedCustomsItemModal=(0,utils_translate.Tl)()((function(props){var batchEntry=props.batchEntry,customsItem=props.customsItem,lineItem=props.lineItem,onClose=props.onClose,order=props.order,t=props.t,dispatch=(0,es.wA)(),_a=(0,tslib_es6.zs)(react.useState(null),2),dataForDelete=_a[0],setDataForDelete=_a[1],cachedIsDeleting=(0,react.useRef)(!1),initialValues=(0,es.d4)((0,getFormInitialValues.A)(constants_form.Y0)),submitting=(0,es.d4)((0,isSubmitting.A)(constants_form.Y0)),isUpdatingBatchEntry=(0,es.d4)(orders_selectors.$m),isDeletingCustomsItem=(0,es.d4)(getIsDeletingCustomsItem),showDeleteConfirm=!!dataForDelete,editMode=!!customsItem||!!lineItem,modalHeaderText=t("orders:calculateRates:tabs:shipmentInfo:modals:customsItemModal:".concat(editMode?"editTitle":"newTitle"));react.useEffect((function(){!cachedIsDeleting.current&&isDeletingCustomsItem&&onClose(),cachedIsDeleting.current=isDeletingCustomsItem}),[isDeletingCustomsItem,onClose]);var addOrEditCustomsItem=react.useCallback((function(formValues){var _a,_b,_c,_d,_e,orderSelection=((_a={})[order.objectId]=batchEntry?[batchEntry.id]:[],_a);dispatch(customsItem?function editCustomsItem(appLocation,orderSelection,customsItemPayload,initialValues,trackingData){return{type:constants.t.CUSTOMS_ITEM_UPDATE,payload:{appLocation,customsItemPayload,orderSelection,initialValues,trackingData}}}(props.appLocation,orderSelection,formValues,initialValues,{transactionId:(null==batchEntry?void 0:batchEntry.transactionObjectId)||"",location:schema.ID,senderCountry:null===(_c=null===(_b=null==batchEntry?void 0:batchEntry.addressFrom)||void 0===_b?void 0:_b.country)||void 0===_c?void 0:_c.iso2,recipientCountry:null===(_e=null===(_d=null==batchEntry?void 0:batchEntry.addressTo)||void 0===_d?void 0:_d.country)||void 0===_e?void 0:_e.iso2}):function createCustomsItem(orderSelection,customsItemPayload){return{type:constants.t.CUSTOMS_ITEM_CREATE,payload:{customsItemPayload,orderSelection}}}(orderSelection,formValues))}),[order,batchEntry,customsItem,initialValues]),handleSubmit=react.useCallback((function(){dispatch((0,redux_form_es.tA)(constants_form.Y0))}),[dispatch,redux_form_es.tA]),handleDelete=react.useCallback((function(){setDataForDelete(initialValues)}),[setDataForDelete,initialValues]),handleDeleteClose=react.useCallback((function(){setDataForDelete(null)}),[setDataForDelete]),handleDeleteConfirm=react.useCallback((function(){var _a;dataForDelete&&dispatch(deleteCustomsItem(((_a={})[order.objectId]=batchEntry?[batchEntry.id]:[],_a),[dataForDelete]))}),[dataForDelete,order,batchEntry,deleteCustomsItem,dispatch]);return(0,emotion_react_jsx_runtime_browser_esm.FD)(Modal.A.Container,(0,tslib_es6.Cl)({isOpen:!0,hasNoPaddingHeader:!0,size:"sm",onClose},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Modal.A.Header,(0,tslib_es6.Cl)({hidePadding:!0,hideBorder:!0},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(StyledComponents.a1,{children:modalHeaderText})})),(0,emotion_react_jsx_runtime_browser_esm.FD)(StyledComponents.hb,{children:[showDeleteConfirm&&(0,emotion_react_jsx_runtime_browser_esm.Y)(DeleteConfirmationDialog,{t,onClose:handleDeleteClose,isLoading:isDeletingCustomsItem,onConfirm:handleDeleteConfirm}),(0,emotion_react_jsx_runtime_browser_esm.Y)(CustomsItemModal_CustomsItemForm,{onSubmit:addOrEditCustomsItem,onClose,onDelete:handleDelete,batchEntry,order,customsItem,lineItem})]}),(0,emotion_react_jsx_runtime_browser_esm.FD)(StyledComponents.al,{children:[editMode&&(0,emotion_react_jsx_runtime_browser_esm.Y)(DeleteLink,{t,handleDelete}),(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"w-full"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(StyledComponents.Zb,(0,tslib_es6.Cl)({onClick:onClose,dataPendo:"customs-item-".concat(editMode?"edit":"add","-cancel"),id:"button-customs-item-".concat(editMode?"edit":"add","-cancel")},{children:"Cancel"})),(0,emotion_react_jsx_runtime_browser_esm.Y)(StyledComponents.Tk,(0,tslib_es6.Cl)({fullWidth:!0,onClick:handleSubmit,disabled:submitting||isUpdatingBatchEntry,isLoading:submitting,dataPendo:"customs-item-".concat(editMode?"edit":"add","-submit"),id:"button-customs-item-".concat(editMode?"edit":"add","-submit")},{children:t("orders:calculateRates:tabs:shipmentInfo:modals:common:".concat(editMode?"save":"add"))}))]}))]})]}))}));const OrderItemsCard_CustomsItemModal=ComposedCustomsItemModal;function createLineItem(orderObjectId,lineItemPayload,trackingReference){return{type:constants.t.LINE_ITEM_CREATE,payload:{orderObjectId,lineItemPayload,trackingReference}}}function deleteLineItem(id,orderObjectId,trackingReference){return{payload:{id,orderObjectId,trackingReference},type:constants.t.LINE_ITEMS_DELETE}}function editLineItem(lineItemObjectId,orderObjectId,lineItemPayload,trackingReference){return{payload:{lineItemObjectId,orderObjectId,lineItemPayload,trackingReference},type:constants.t.LINE_ITEM_EDIT}}var locale=__webpack_require__("./app/utils/locale.ts");const LineItemForm_validate=function(values){var errors={title:"",quantity:"",unitWeight:"",weightUnit:"",unitAmount:"",currency:"",countryOfOrigin:"",sku:""};return values.title?(0,validations.JT)(0,400,values.title)||(errors.title="This field cannot be longer than 400 characters"):errors.title="Please enter the item title",values.quantity?(0,validations.M3)(values.quantity,0)||(errors.quantity="Please enter a valid quantity"):errors.quantity="Please enter the item quantity",values.unitWeight?(0,validations.aM)(values.unitWeight)||(errors.unitWeight="Please enter a valid unit weight"):errors.unitWeight="Please enter unit weight",values.weightUnit||(errors.weightUnit="Please select a weight unit"),values.unitAmount?(0,validations.aM)(values.unitAmount)||(errors.unitAmount="Please enter a valid unit value"):errors.unitAmount="Please enter unit value",values.currency||(errors.currency="Please select a currency"),values.countryOfOrigin||(errors.countryOfOrigin="Please select a country of origin"),errors};var LineItemForm=function(_super){function LineItemForm(props){var _this=_super.call(this,props)||this;return _this.memoizedCountryOptions=(0,memoize_one_esm.A)((function(suggestedCountryCode){return(0,Address.b8)(suggestedCountryCode,!1)})),_this.displayCalculatedWeight=function(){var _a=_this.props.formValues,weightUnit=_a.weightUnit,unitWeight=_a.unitWeight,quantity=_a.quantity,total=(0,numbers.T1)(unitWeight,quantity);if(total&&weightUnit)return"Total: ".concat(total.toFixed(2)," ").concat(weightUnit.value)},_this.displayCalculatedAmount=function(){var _a=_this.props,t=_a.t,formValues=_a.formValues,unitAmount=formValues.unitAmount,quantity=formValues.quantity,currency=formValues.currency,total=(0,numbers.T1)(unitAmount,quantity);if(total&&currency)return"Total: ".concat(t("currency",{value:{value:total,currency_iso:currency.value}}))},_this.memoizedCountryOptions=_this.memoizedCountryOptions.bind(_this),_this}return(0,tslib_es6.C6)(LineItemForm,_super),LineItemForm.prototype.componentDidUpdate=function(prevProps){this.props.submitSucceeded&&this.props.onClose(),prevProps.submitting&&!this.props.submitting&&this.props.submitFailed&&this.props.onClose()},LineItemForm.prototype.render=function(){var _a=this.props,t=_a.t,onSubmit=_a.onSubmit,suggestedCountryCode=_a.suggestedCountryCode,labelProps={required:!0},countryOptions=this.memoizedCountryOptions(suggestedCountryCode),disabled=!(0,Order.Dd)(this.props.order);return(0,emotion_react_jsx_runtime_browser_esm.Y)("form",(0,tslib_es6.Cl)({onSubmit:this.props.handleSubmit(onSubmit)},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"grid grid-cols-4 gap-4 items-top"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"col-span-3"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{required:!0,responsive:!0,tooltipOnDisabled:!0,name:"title",component:Input.FO,type:"text",label:t("orders:calculateRates:tabs:shipmentInfo:modals:common:description"),labelProps,disabled})})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{required:!0,responsive:!0,name:"quantity",component:Input.FO,type:"text",inputMode:"decimal",label:t("orders:calculateRates:tabs:shipmentInfo:modals:common:quantity"),labelProps,disabled}),(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"col-span-2 md:col-span-1"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{required:!0,responsive:!0,name:"unitWeight",inputMode:"decimal",component:Input.FO,type:"string",label:t("orders:calculateRates:tabs:shipmentInfo:modals:common:unitWeight"),labelProps,disabled})})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{required:!0,name:"weightUnit",label:(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"invisible"},{children:t("orders:calculateRates:tabs:shipmentInfo:modals:common:unitWeight")})),component:SelectField,options:options.Ay.weightOptions,disabled,responsive:!0}),(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"md:col-span-2 text-left pt-8"},{children:this.displayCalculatedWeight()})),(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"col-span-2 md:col-span-1"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{required:!0,responsive:!0,name:"unitAmount",inputMode:"decimal",component:Input.FO,type:"string",label:t("orders:calculateRates:tabs:shipmentInfo:modals:common:unitValue"),labelProps,disabled})})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{required:!0,name:"currency",label:(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"invisible"},{children:t("orders:calculateRates:tabs:shipmentInfo:modals:common:unitValue")})),component:SelectField,options:options.Ay.currencyOptions,disabled,responsive:!0}),(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"md:col-span-2 text-left pt-8"},{children:this.displayCalculatedAmount()})),(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"col-span-4 md:col-span-3"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{required:!0,name:"countryOfOrigin",component:SmartSelect.s,label:t("orders:calculateRates:tabs:shipmentInfo:modals:common:originCountry"),options:countryOptions,format:field_formaters._m,normalize:field_normalizers.p3,disabled,responsive:!0,labelProps})})),(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"col-span-4 md:col-span-3"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{component:Input.FO,name:"sku",label:t("orders:calculateRates:tabs:shipmentInfo:modals:common:sku"),responsive:!0})}))]}))}))},LineItemForm}(react.Component);const ItemModal_LineItemForm=(0,redux.Zz)((0,utils_translate.Tl)(),(0,es.Ng)((function(state,ownProps){var valuesSelector=(0,formValueSelector.A)(constants_form.aF),lineItem=ownProps.lineItem,userConfigDefaults=(0,user_selectors.Og)(state),fallbackMassUnit=userConfigDefaults.defaultMassUnit||weight.VV.LB,currency=userConfigDefaults.defaultCurrency||constants_currency.q.USD,unitWeight=(null==lineItem?void 0:lineItem.unitWeight)||"",lineItemInitialValues=lineItem?{unitWeight,title:lineItem.title,quantity:lineItem.quantity,weightUnit:lineItem.weightUnit?options.Ay.commonWeightOptions[lineItem.weightUnit]:null,unitAmount:lineItem.unitAmount,currency:lineItem.currency?{value:lineItem.currency.iso,label:lineItem.currency.iso}:null,countryOfOrigin:lineItem.countryOfOrigin,sku:lineItem.sku}:null;return{formValues:{quantity:valuesSelector(state,"quantity"),unitWeight:valuesSelector(state,"unitWeight"),weightUnit:valuesSelector(state,"weightUnit"),unitAmount:valuesSelector(state,"unitAmount"),currency:valuesSelector(state,"currency")},initialValues:lineItem?lineItemInitialValues:{weightUnit:options.Ay.commonWeightOptions[fallbackMassUnit],currency:{value:currency.iso,label:currency.iso}},isDeletingLineItem:getIsDeletingLineItem(state)}})),(0,reduxForm.A)({validate:LineItemForm_validate,form:constants_form.aF,destroyOnUnmount:!1,enableReinitialize:!0}))(LineItemForm);var ItemModal_DeleteConfirmationDialog=function(_a){var t=_a.t,onClose=_a.onClose,isLoading=_a.isLoading,onConfirm=_a.onConfirm;return(0,emotion_react_jsx_runtime_browser_esm.Y)(Dialog_ErrorDialog,{isOpen:!0,onClose,isLoading,onConfirm,closeButtonText:t("orders:calculateRates:tabs:shipmentInfo:modals:common:cancel"),confirmButtonText:t("orders:calculateRates:tabs:shipmentInfo:modals:lineItemModal:deleteConfirm"),message:t("orders:calculateRates:tabs:shipmentInfo:modals:lineItemModal:deleteConfirmationMessage")})},ItemModal_DeleteLink=function(_a){var t=_a.t,handleDelete=_a.handleDelete;return(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"flex justify-center flex-col text-left w-full"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Link.k0,(0,tslib_es6.Cl)({onClick:handleDelete,"data-pendo":"line-item-delete",id:"line-item-delete"},{children:t("orders:calculateRates:tabs:shipmentInfo:modals:lineItemModal:deleteConfirm")}))})}))},ComposedItemModal=(0,utils_translate.Tl)()((function(props){var lineItem=props.lineItem,order=props.order,onClose=props.onClose,t=props.t,dispatch=(0,es.wA)(),editMode=!!lineItem,actionButtonText=editMode?"Save":"Add",disabled=!(0,Order.Dd)(order),modalHeaderText=t("orders:calculateRates:tabs:shipmentInfo:modals:lineItemModal:".concat(editMode?"editTitle":"newTitle")),submitting=(0,es.d4)((0,isSubmitting.A)(constants_form.aF)),isUpdatingBatchEntry=(0,es.d4)(orders_selectors.$m),isDeletingLineItem=(0,es.d4)(getIsDeletingLineItem),defaultAddress=(0,es.d4)(address_selectors.dR),suggestedCountryCode=(0,locale.Ml)(defaultAddress),_a=(0,tslib_es6.zs)(react.useState(!1),2),showDeleteConfirm=_a[0],setShowDeleteConfirm=_a[1],showDeleteLink=(0,react.useMemo)((function(){return!!lineItem&&(0,Order.Dd)(order)}),[lineItem,Order.Dd,order]);(0,react.useEffect)((function(){var trackingReference=TrackingHelper.U.getTrackingReference(types.jv.name,props.appLocation,{});(0,utils.aX)(trackingReference,types.jv.operations.VIWED,{itemId:null==lineItem?void 0:lineItem.objectId})}),[]);var addOrEditItem=react.useCallback((function(formValues){var trackingReference=TrackingHelper.U.getTrackingReference(types.jv.name,props.appLocation,{});(0,utils.aX)(trackingReference,types.jv.operations.SAVED,{item_name:formValues.title,item_weight:+formValues.unitWeight,item_weight_units:formValues.weightUnit.value,item_value:+formValues.unitAmount,currency:formValues.currency.value,sku:formValues.sku,count_item:+formValues.quantity,total_item_weight:+formValues.quantity*+formValues.unitWeight,total_item_weight_units:formValues.weightUnit.value,orders_selected:1}),lineItem?((0,utils.aX)(trackingReference,types.jv.operations.EDITED,{itemId:lineItem.objectId}),dispatch(editLineItem(lineItem.objectId,order.objectId,formValues,trackingReference))):((0,utils.aX)(trackingReference,types.jv.operations.ADDED,{}),dispatch(createLineItem(order.objectId,formValues,trackingReference)))}),[lineItem,order,dispatch,createLineItem,editLineItem]),handleSubmit=react.useCallback((function(){dispatch((0,redux_form_es.tA)(constants_form.aF))}),[dispatch,redux_form_es.tA]),handleDelete=react.useCallback((function(){setShowDeleteConfirm(!0)}),[setShowDeleteConfirm]),handleDeleteClose=react.useCallback((function(){setShowDeleteConfirm(!1)}),[setShowDeleteConfirm]),handleDeleteConfirm=react.useCallback((function(){if(lineItem){var trackingReference=TrackingHelper.U.getTrackingReference(types.jv.name,props.appLocation,{});(0,utils.aX)(trackingReference,types.jv.operations.DELETED,{itemId:lineItem.objectId}),dispatch(deleteLineItem(lineItem.objectId,order.objectId,trackingReference))}}),[lineItem,order,dispatch,deleteLineItem]);return(0,emotion_react_jsx_runtime_browser_esm.FD)(Modal.A.Container,(0,tslib_es6.Cl)({isOpen:!0,hasNoPaddingHeader:!0,size:"sm",onClose},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Modal.A.Header,(0,tslib_es6.Cl)({hidePadding:!0,hideBorder:!0},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(StyledComponents.a1,{children:modalHeaderText})})),(0,emotion_react_jsx_runtime_browser_esm.FD)(StyledComponents.hb,{children:[showDeleteConfirm&&(0,emotion_react_jsx_runtime_browser_esm.Y)(ItemModal_DeleteConfirmationDialog,{t,onClose:handleDeleteClose,isLoading:isDeletingLineItem,onConfirm:handleDeleteConfirm}),(0,emotion_react_jsx_runtime_browser_esm.Y)(ItemModal_LineItemForm,{onSubmit:addOrEditItem,onClose,order,lineItem,suggestedCountryCode})]}),(0,emotion_react_jsx_runtime_browser_esm.FD)(StyledComponents.al,{children:[showDeleteLink&&(0,emotion_react_jsx_runtime_browser_esm.Y)(ItemModal_DeleteLink,{t,handleDelete}),(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"w-full"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(StyledComponents.Zb,(0,tslib_es6.Cl)({className:"hidden md:inline-block",onClick:onClose,dataPendo:"line-item-".concat(lineItem?"edit":"add","-cancel"),id:"button-line-item-".concat(lineItem?"edit":"add","-cancel")},{children:"Cancel"})),(0,emotion_react_jsx_runtime_browser_esm.Y)(StyledComponents.Tk,(0,tslib_es6.Cl)({fullWidth:!0,onClick:handleSubmit,disabled:submitting||disabled||isUpdatingBatchEntry,isLoading:submitting,dataPendo:"line-item-".concat(lineItem?"edit":"add","-submit"),id:"button-line-item-".concat(lineItem?"edit":"add","-submit")},{children:actionButtonText}))]}))]})]}))}));const OrderItemsCard_ItemModal=ComposedItemModal;var icon_info=__webpack_require__("./app/assets/icons/icon_info.svg"),ItemTitleInfo_Container=emotion_styled_browser_esm.A.div(ItemTitleInfo_templateObject_1||(ItemTitleInfo_templateObject_1=(0,tslib_es6.ue)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  border-bottom: 1px solid ",";\n  padding: 10px 0;\n  min-width: 96px;\n  min-height: 40px;\n"],["\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  border-bottom: 1px solid ",";\n  padding: 10px 0;\n  min-width: 96px;\n  min-height: 40px;\n"])),styles_constants.Tj.geyser),RowTitle=emotion_styled_browser_esm.A.div(ItemTitleInfo_templateObject_2||(ItemTitleInfo_templateObject_2=(0,tslib_es6.ue)(["\n  color: ",";\n  line-height: 1.25rem;\n  font-size: 0.875rem;\n  font-weight: 400;\n"],["\n  color: ",";\n  line-height: 1.25rem;\n  font-size: 0.875rem;\n  font-weight: 400;\n"])),styles_constants.Tj.gray1000),ItemTitleInfo_Subtitle=emotion_styled_browser_esm.A.div(ItemTitleInfo_templateObject_3||(ItemTitleInfo_templateObject_3=(0,tslib_es6.ue)(["\n  color: ",";\n  line-height: 1.25rem;\n  font-size: 0.75rem;\n  font-weight: ",";\n  margin-top: 2px;\n  margin-right: 8px;\n"],["\n  color: ",";\n  line-height: 1.25rem;\n  font-size: 0.75rem;\n  font-weight: ",";\n  margin-top: 2px;\n  margin-right: 8px;\n"])),styles_constants.Tj.gray700,styles_constants.Wy.normal);const OrderItemsCard_ItemTitleInfo=function(_a){var id=_a.id,title=_a.title,subtitle=_a.subtitle,onEditClick=_a.onEditClick,hasError=_a.hasError,variant=_a.variant;return(0,emotion_react_jsx_runtime_browser_esm.FD)(ItemTitleInfo_Container,{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(RowTitle,{children:[onEditClick?(0,emotion_react_jsx_runtime_browser_esm.Y)(Link.Oc,(0,tslib_es6.Cl)({onClick:function(){if(onEditClick)return onEditClick(id)}},{children:title})):title," "]}),(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"flex flex-col"},{children:[variant&&(0,emotion_react_jsx_runtime_browser_esm.Y)(ItemTitleInfo_Subtitle,{children:variant}),(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"flex"},{children:[hasError&&(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"mr-1"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(ErrorIcon,{})})),(0,emotion_react_jsx_runtime_browser_esm.Y)(ItemTitleInfo_Subtitle,{children:subtitle})]}))]}))]})};var ItemTitleInfo_templateObject_1,ItemTitleInfo_templateObject_2,ItemTitleInfo_templateObject_3,HeaderRow=(0,emotion_styled_browser_esm.A)("div")(ItemsList_templateObject_1||(ItemsList_templateObject_1=(0,tslib_es6.ue)(["\n  display: flex;\n  height: 18px;\n  line-height: 18px;\n  color: ",";\n  font-size: 12px;\n"],["\n  display: flex;\n  height: 18px;\n  line-height: 18px;\n  color: ",";\n  font-size: 12px;\n"])),styles_constants.Tj.rollingStone),HeaderRowSubtitle=(0,emotion_styled_browser_esm.A)("div")(ItemsList_templateObject_2||(ItemsList_templateObject_2=(0,tslib_es6.ue)(["\n  width: 100%;\n  display: flex;\n\n  &:last-of-type {\n    justify-content: flex-end;\n  }\n"],["\n  width: 100%;\n  display: flex;\n\n  &:last-of-type {\n    justify-content: flex-end;\n  }\n"]))),NoItems=emotion_styled_browser_esm.A.div(ItemsList_templateObject_3||(ItemsList_templateObject_3=(0,tslib_es6.ue)(["\n  text-align: center;\n  color: ",";\n  padding: 30px 0 5px 0;\n"],["\n  text-align: center;\n  color: ",";\n  padding: 30px 0 5px 0;\n"])),styles_constants.Tj.secondary),ItemsList_LineItemTextContainer=(0,emotion_styled_browser_esm.A)("div")(ItemsList_templateObject_4||(ItemsList_templateObject_4=(0,tslib_es6.ue)(["\n  font-size: 0.875rem;\n  font-weight: ",";\n  line-height: 1.25rem;\n  word-break: break-word;\n  width: 100%;\n  flex-direction: column;\n  display: flex;\n  justify-content: center;\n  color: ",";\n"],["\n  font-size: 0.875rem;\n  font-weight: ",";\n  line-height: 1.25rem;\n  word-break: break-word;\n  width: 100%;\n  flex-direction: column;\n  display: flex;\n  justify-content: center;\n  color: ",";\n"])),styles_constants.Wy.medium,styles_constants.Tj.fontColor),Amount=(0,emotion_styled_browser_esm.A)("div")(ItemsList_templateObject_5||(ItemsList_templateObject_5=(0,tslib_es6.ue)(["\n  display: flex;\n  align-items: center;\n  width: 100%;\n  line-height: 1.5rem;\n  border-bottom: 1px solid ",";\n  color: ",";\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n\n  &:last-of-type {\n    justify-content: flex-end;\n  }\n"],["\n  display: flex;\n  align-items: center;\n  width: 100%;\n  line-height: 1.5rem;\n  border-bottom: 1px solid ",";\n  color: ",";\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n\n  &:last-of-type {\n    justify-content: flex-end;\n  }\n"])),styles_constants.Tj.geyser,styles_constants.Tj.gray1000),ComposedItemsList=(0,utils_translate.Tl)()((function(props){var items=props.items,onEditClick=props.onEditClick,t=props.t,AddLink=props.addLink;return 0===items.length?(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"flex justify-center flex-col"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(NoItems,{children:t("orders:calculateRates:tabs:orderContents:noItems")}),(0,emotion_react_jsx_runtime_browser_esm.Y)(AddLink,{})]})):(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(HeaderRow,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(HalfSection,{children:"Item"}),(0,emotion_react_jsx_runtime_browser_esm.FD)(HalfSection,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(HeaderRowSubtitle,{children:"Quantity"}),(0,emotion_react_jsx_runtime_browser_esm.FD)(HeaderRowSubtitle,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("span",(0,tslib_es6.Cl)({className:"mr-1"},{children:"Weight"})),(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Popup.A,(0,tslib_es6.Cl)({inverted:!0,size:"mini",position:"top center",trigger:(0,emotion_react_jsx_runtime_browser_esm.Y)("img",{className:"align-middle",src:icon_info,alt:"info"}),hoverable:!0},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"w-48"},{children:t("orders:calculateRates:tabs:tooltip:info:weightApprox")}))}))]}),(0,emotion_react_jsx_runtime_browser_esm.Y)(HeaderRowSubtitle,{children:"Value"})]})]}),items.map((function(item){var _a,formattedPrice=t("currency",{value:{value:item.value||"0",currency_iso:(null===(_a=item.currency)||void 0===_a?void 0:_a.iso)||constants_currency.q.USD.iso}});return(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"flex"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(HalfSection,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(ItemsList_LineItemTextContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderItemsCard_ItemTitleInfo,{id:item.id,title:item.title,subtitle:item.subtitle,onEditClick,hasError:item.hasError,variant:item.variant})})}),(0,emotion_react_jsx_runtime_browser_esm.FD)(HalfSection,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Amount,{children:item.quantity}),(0,emotion_react_jsx_runtime_browser_esm.FD)(Amount,{children:[item.weight," ",item.weightUnit]}),(0,emotion_react_jsx_runtime_browser_esm.Y)(Amount,{children:formattedPrice})]})]}),(0,index_browser.Ak)())})),(0,emotion_react_jsx_runtime_browser_esm.Y)(AddLink,{})]})}));const OrderItemsCard_ItemsList=ComposedItemsList;var ItemsList_templateObject_1,ItemsList_templateObject_2,ItemsList_templateObject_3,ItemsList_templateObject_4,ItemsList_templateObject_5,index_esm=__webpack_require__("./node_modules/react-hook-form/dist/index.esm.js"),ComposedOrderNoteForm=(0,utils_translate.Tl)("orders")((function(props){var t=props.t,orderNoteFormMethods=props.orderNoteFormMethods,rows=props.rows,control=orderNoteFormMethods.control,errors=orderNoteFormMethods.formState.errors,renderTextField=react.useCallback((function(_a){var _b,field=_a.field,ref=field.ref,props=(0,tslib_es6.Tt)(field,["ref"]);return(0,emotion_react_jsx_runtime_browser_esm.Y)(TextArea.ol,(0,tslib_es6.Cl)({},props,{textAreaRef:ref,responsive:!0,rows:void 0!==rows?rows:10,errorMessage:null===(_b=errors.noteText)||void 0===_b?void 0:_b.message}))}),[errors]);return(0,emotion_react_jsx_runtime_browser_esm.Y)("form",{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(index_esm.xI,{name:"noteText",control,render:renderTextField,rules:{maxLength:{value:1e3,message:t("orderNoteForm.tooLongError")}}})})}));const OrderNoteForm_OrderNoteForm=ComposedOrderNoteForm;var prod_analytics_actions=__webpack_require__("./app/actions/prod-analytics.actions.ts");const OrderNoteForm_useOrderNoteForm=function(orderSelection,autoFocus){var selectedBatchEntryIds=(0,lodash.flatten)(Object.values(orderSelection)),selectedBatchEntries=(0,es.d4)((function(state){return(0,batch_entry_selectors.uq)(state,{batchEntryIds:selectedBatchEntryIds})})),dispatch=(0,es.wA)(),_a=(0,tslib_es6.zs)(react.useMemo((function(){var firstNote=function firstNoteFromBatchEntries(selectedBatchEntries){var _a,_b;return(null===(_b=null===(_a=selectedBatchEntries.find((function(batchEntry){var _a;return!!(null===(_a=batchEntry.extras)||void 0===_a?void 0:_a.packingSlipText)})))||void 0===_a?void 0:_a.extras)||void 0===_b?void 0:_b.packingSlipText)||""}(selectedBatchEntries),isAllNotesSameResult=function doAllNotesHaveSameResult(selectedBatchEntries,firstNote){return selectedBatchEntries.every((function(batchEntry){var _a,currBatchEntryText=null===(_a=batchEntry.extras)||void 0===_a?void 0:_a.packingSlipText;return currBatchEntryText===firstNote||!currBatchEntryText&&!firstNote}))}(selectedBatchEntries,firstNote);return[isAllNotesSameResult?firstNote:"",isAllNotesSameResult]}),[selectedBatchEntries]),2),defaultNote=_a[0],isAllNotesSame=_a[1],defaultValues=(0,react.useMemo)((function(){return{noteText:defaultNote}}),[defaultNote]),formToReturn=(0,index_esm.mN)({mode:"onBlur",reValidateMode:"onBlur",defaultValues}),getValues=formToReturn.getValues,reset=formToReturn.reset,setFocus=formToReturn.setFocus;return react.useEffect((function(){autoFocus&&setFocus("noteText")}),[setFocus]),react.useEffect((function(){reset({noteText:defaultNote})}),[reset,defaultNote]),[formToReturn,react.useCallback((function(){var formValues=getValues();dispatch((0,orders_actions.is)(orderSelection,formValues.noteText,selectedBatchEntryIds)),dispatch((0,prod_analytics_actions.o)("orders-add-note-submit",{numOrders:Object.keys(orderSelection).length}))}),[orderSelection]),isAllNotesSame]},OrderNoteModal_OrderNoteForm=OrderNoteForm_OrderNoteForm;var TitleSubtext=(0,emotion_styled_browser_esm.A)("span")(OrderNoteModal_templateObject_1||(OrderNoteModal_templateObject_1=(0,tslib_es6.ue)(["\n  font-size: 1.125rem;\n  color: ",";\n  font-weight: ",";\n"],["\n  font-size: 1.125rem;\n  color: ",";\n  font-weight: ",";\n"])),styles_constants.Tj.gray400,styles_constants.Wy.normal),ComposedOrderNoteModal=(0,utils_translate.Tl)("orders")((function(props){var t=props.t,isOpen=props.isOpen,orderSelection=props.orderSelection,onClose=props.onClose,onSuccessfulSubmit=props.onSuccessfulSubmit,_a=(0,tslib_es6.zs)(OrderNoteForm_useOrderNoteForm(orderSelection,!0),3),orderNoteFormMethods=_a[0],handleOrderNoteFormSubmit=_a[1],isAllNotesSame=_a[2],_b=orderNoteFormMethods.formState,isDirty=_b.isDirty,isValid=_b.isValid,handleSubmit=orderNoteFormMethods.handleSubmit,dispatch=(0,es.wA)(),patchBatchEntriesExtrasRequest=(0,es.d4)(orders_selectors.bL),numOrders=Object.keys(orderSelection).length;react.useEffect((function(){return function(){dispatch((0,orders_actions.Gp)())}}),[]);var isActionButtonDisabled=react.useMemo((function(){return!(!isDirty&&!isAllNotesSame)&&(!isValid||!isDirty)}),[isValid,isDirty,isAllNotesSame]),handleActionButtonNotRequesting=react.useCallback((function(){return(0,emotion_react_jsx_runtime_browser_esm.Y)(StyledComponents.Tk,(0,tslib_es6.Cl)({fullWidth:!0,disabled:isActionButtonDisabled,onClick:handleSubmit(handleOrderNoteFormSubmit)},{children:t("phrases.save")}))}),[isActionButtonDisabled]),handleActionButtonRequesting=react.useCallback((function(){return(0,emotion_react_jsx_runtime_browser_esm.Y)(StyledComponents.Tk,(0,tslib_es6.Cl)({disabled:!0,isLoading:!0,fullWidth:!0,onClick:handleSubmit(handleOrderNoteFormSubmit)},{children:t("phrases.save")}))}),[]),handleActionButtonSuccess=react.useCallback((function(){onSuccessfulSubmit&&onSuccessfulSubmit(),onClose(),dispatch((0,orders_actions.Gp)())}),[onSuccessfulSubmit,onClose]),renderActionButton=react.useCallback((function(){return(0,fetchable.A7)(handleActionButtonNotRequesting,handleActionButtonRequesting,handleActionButtonSuccess,handleActionButtonNotRequesting)(patchBatchEntriesExtrasRequest)}),[patchBatchEntriesExtrasRequest,handleActionButtonNotRequesting]),handleError=react.useCallback((function(errorMessage){return(0,emotion_react_jsx_runtime_browser_esm.Y)(Message.Kw,{children:errorMessage})}),[]),renderErrorMessage=react.useCallback((function(){return(0,fetchable.A7)(lodash.noop,lodash.noop,lodash.noop,handleError)(patchBatchEntriesExtrasRequest)}),[patchBatchEntriesExtrasRequest]);return(0,emotion_react_jsx_runtime_browser_esm.FD)(Modal.A.Container,(0,tslib_es6.Cl)({zIndex:1200,hasNoPaddingHeader:!0,isOpen,size:"mdl",onClose},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Modal.A.Header,(0,tslib_es6.Cl)({hideBorder:!0,hidePadding:!0},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(StyledComponents.a1,{children:[t("orderNoteModal.title",{count:numOrders||1})," ",numOrders>1&&(0,emotion_react_jsx_runtime_browser_esm.FD)(TitleSubtext,{children:[" ",t("orders:actions:multi:ordersCount",{count:numOrders})]})]})})),(0,emotion_react_jsx_runtime_browser_esm.FD)(StyledComponents.hb,{children:[renderErrorMessage(),(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderNoteModal_OrderNoteForm,{orderNoteFormMethods})]}),(0,emotion_react_jsx_runtime_browser_esm.Y)(StyledComponents.al,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"w-full"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(StyledComponents.Zb,(0,tslib_es6.Cl)({onClick:onClose,dataPendo:"orders-add-note-cancel"},{children:t("phrases.cancel")})),renderActionButton()]}))})]}))}));var OrderNoteModal_templateObject_1;const All_OrderNoteModal=ComposedOrderNoteModal;var PackingSlipTitle=emotion_styled_browser_esm.A.div(OrderNoteSection_templateObject_1||(OrderNoteSection_templateObject_1=(0,tslib_es6.ue)(["\n  font-size: 0.875rem;\n  color: ",";\n"],["\n  font-size: 0.875rem;\n  color: ",";\n"])),styles_constants.Tj.black),PackingSlipText=emotion_styled_browser_esm.A.div(OrderNoteSection_templateObject_2||(OrderNoteSection_templateObject_2=(0,tslib_es6.ue)(["\n  font-size: 0.75rem;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n  margin-top: 1rem;\n"],["\n  font-size: 0.75rem;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n  margin-top: 1rem;\n"]))),ComposedOrderNoteSection=(0,utils_translate.Tl)("orders")((function(props){var _a,_b,order=props.order,batchEntry=props.batchEntry,showActionLinkOnEmpty=props.showActionLinkOnEmpty,t=props.t,_c=(0,tslib_es6.zs)(react.useState(!1),2),isOrderNoteModalOpen=_c[0],setIsOrderNoteModalOpen=_c[1],handleOpenOrderNoteModal=react.useCallback((function(){return setIsOrderNoteModalOpen(!0)}),[]),handleCloseOrderNoteModal=react.useCallback((function(){return setIsOrderNoteModalOpen(!1)}),[]),orderSelection=((_a={})[order.objectId]=batchEntry?[batchEntry.id]:[],_a),packingSlipText=null===(_b=null==batchEntry?void 0:batchEntry.extras)||void 0===_b?void 0:_b.packingSlipText;return(0,emotion_react_jsx_runtime_browser_esm.FD)(emotion_react_jsx_runtime_browser_esm.FK,{children:[packingSlipText?(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"h-24 my-3"},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(GrayInfoCard,{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"flex justify-between leading-6"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(PackingSlipTitle,{children:t("orderNoteCard.title")}),(0,emotion_react_jsx_runtime_browser_esm.Y)(Link.Oc,(0,tslib_es6.Cl)({onClick:handleOpenOrderNoteModal},{children:t("orders:actions:single:edit")}))]})),(0,emotion_react_jsx_runtime_browser_esm.Y)(PackingSlipText,{children:packingSlipText})]})})):showActionLinkOnEmpty?(0,emotion_react_jsx_runtime_browser_esm.Y)(Link.Oc,(0,tslib_es6.Cl)({onClick:handleOpenOrderNoteModal},{children:t("orders:actions:single:addNote")})):null,isOrderNoteModalOpen&&(0,emotion_react_jsx_runtime_browser_esm.Y)(All_OrderNoteModal,{isOpen:!0,orderSelection,onClose:handleCloseOrderNoteModal})]})}));const OrderItemsCard_OrderNoteSection=ComposedOrderNoteSection;var OrderNoteSection_templateObject_1,OrderNoteSection_templateObject_2,CustomsItem=__webpack_require__("./app/types/CustomsItem.ts"),SummaryRow=(0,emotion_styled_browser_esm.A)("div")(OrderTotals_templateObject_1||(OrderTotals_templateObject_1=(0,tslib_es6.ue)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding: 4px 0;\n  ","\n\n  /* This is weird, but it acts as a border collapse. Due to component structure */\n  /* it gets difficult to avoid double borders in one case (Store order with items). */\n  margin-top: -1px;\n\n  ","\n"],["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding: 4px 0;\n  ","\n\n  /* This is weird, but it acts as a border collapse. Due to component structure */\n  /* it gets difficult to avoid double borders in one case (Store order with items). */\n  margin-top: -1px;\n\n  ","\n"])),(function(props){return props.withBorder?"border-top: 1px solid ".concat(styles_constants.Tj.geyser,";"):""}),(function(props){return"color: ".concat(props.total?styles_constants.Tj.gray1000:styles_constants.Tj.gray400)})),SummaryCell=(0,emotion_styled_browser_esm.A)("div")(OrderTotals_templateObject_2||(OrderTotals_templateObject_2=(0,tslib_es6.ue)(["\n  width: 100%;\n  display: flex;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n\n  &:last-of-type {\n    justify-content: flex-end;\n  }\n"],["\n  width: 100%;\n  display: flex;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n\n  &:last-of-type {\n    justify-content: flex-end;\n  }\n"]))),ComposedOrderTotals=(0,utils_translate.Tl)()((function(props){var items=props.items,showOrderTotal=props.showOrderTotal,t=props.t,order=props.order,batchEntry=props.batchEntry,isCustoms=props.isCustoms,_a=(0,tslib_es6.zs)(react.useState(!1),2),showDeleteConfirm=_a[0],setShowDeleteConfirm=_a[1],_b=(0,tslib_es6.zs)(react.useState(!1),2),cachedIsDeleting=_b[0],setCachedIsDeleting=_b[1],isDeletingCustomsItem=(0,es.d4)(getIsDeletingCustomsItem),dispatch=(0,es.wA)();if(react.useEffect((function(){cachedIsDeleting&&!isDeletingCustomsItem&&setShowDeleteConfirm(!1),setCachedIsDeleting(isDeletingCustomsItem)}),[isDeletingCustomsItem]),0===items.length)return null;var totals=items.reduce((function(totals,item){var _a,itemTotalWeight=Number(item.weight||"0"),itemTotalAmount=Number(item.value||"0");return{count:totals.count+item.quantity,totalWeight:totals.totalWeight+itemTotalWeight,weightUnit:item.weightUnit||totals.weightUnit,totalValue:totals.totalValue+itemTotalAmount,currencyIso:(null===(_a=item.currency)||void 0===_a?void 0:_a.iso)||totals.currencyIso}}),{count:0,totalWeight:0,weightUnit:null,totalValue:0,currencyIso:""}),formattedPrice=t("currency",{value:{value:totals.totalValue||"0.00",currency_iso:totals.currencyIso||constants_currency.q.USD.iso}}),formattedShippingCost=t("currency",{value:{value:order.shippingCost||"0.00",currency_iso:order.shippingCostCurrency}}),formattedTotalTax=t("currency",{value:{value:order.totalTax||"0.00",currency_iso:order.shippingCostCurrency}}),orderTotal=order.totalPrice?t("currency",{value:{value:order.totalPrice,currency_iso:order.currency||constants_currency.q.USD.iso}}):formattedPrice,closeDeleteConfirmation=function(){setShowDeleteConfirm(!1)},deleteAllCustomsItemsConfirm=function(){var _a,_b;dispatch(deleteCustomsItem(((_a={})[order.objectId]=batchEntry?[batchEntry.id]:[],_a),(null===(_b=null==batchEntry?void 0:batchEntry.customsItems)||void 0===_b?void 0:_b.map(CustomsItem.rx))||[]))};return(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[isCustoms&&showDeleteConfirm&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Dialog_ErrorDialog,{isOpen:!0,onClose:closeDeleteConfirmation,isLoading:isDeletingCustomsItem,onConfirm:deleteAllCustomsItemsConfirm,closeButtonText:t("orders:calculateRates:tabs:shipmentInfo:modals:common:cancel"),confirmButtonText:t("orders:calculateRates:tabs:shipmentInfo:modals:customsItemModal:deleteAllConfirm"),message:t("orders:calculateRates:tabs:shipmentInfo:modals:customsItemModal:deleteAllConfirmationMessage")}),(0,emotion_react_jsx_runtime_browser_esm.FD)(SummaryRow,(0,tslib_es6.Cl)({withBorder:!0},{children:[isCustoms?(0,emotion_react_jsx_runtime_browser_esm.Y)(HalfSection,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Link.k0,(0,tslib_es6.Cl)({onClick:function(){setShowDeleteConfirm(!0)}},{children:t("orders:calculateRates:tabs:orderContents:deleteAllCustomsItems")}))}):(0,emotion_react_jsx_runtime_browser_esm.Y)(HalfSection,{children:t("orders:calculateRates:tabs:orderContents:inThisShipment")}),(0,emotion_react_jsx_runtime_browser_esm.FD)(HalfSection,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(SummaryCell,{children:t("orders:calculateRates:tabs:orderContents:itemCount",{count:totals.count})}),(0,emotion_react_jsx_runtime_browser_esm.FD)(SummaryCell,{children:[totals.totalWeight.toFixed(2)," ",totals.weightUnit]}),(0,emotion_react_jsx_runtime_browser_esm.Y)(SummaryCell,{children:formattedPrice})]})]})),showOrderTotal&&!!order.shippingCost&&Number(order.shippingCost)>0&&(0,emotion_react_jsx_runtime_browser_esm.FD)(SummaryRow,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(HalfSection,{children:t("orders:calculateRates:tabs:orderContents:orderShippingCost")}),(0,emotion_react_jsx_runtime_browser_esm.FD)(HalfSection,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(SummaryCell,{}),(0,emotion_react_jsx_runtime_browser_esm.Y)(SummaryCell,{}),(0,emotion_react_jsx_runtime_browser_esm.Y)(SummaryCell,{children:formattedShippingCost})]})]}),showOrderTotal&&!!order.totalTax&&Number(order.totalTax)>0&&(0,emotion_react_jsx_runtime_browser_esm.FD)(SummaryRow,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(HalfSection,{children:t("orders:calculateRates:tabs:orderContents:orderTaxesTotal")}),(0,emotion_react_jsx_runtime_browser_esm.FD)(HalfSection,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(SummaryCell,{}),(0,emotion_react_jsx_runtime_browser_esm.Y)(SummaryCell,{}),(0,emotion_react_jsx_runtime_browser_esm.Y)(SummaryCell,{children:formattedTotalTax})]})]}),showOrderTotal&&(0,emotion_react_jsx_runtime_browser_esm.FD)(SummaryRow,(0,tslib_es6.Cl)({total:!0},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(HalfSection,{children:t("orders:calculateRates:tabs:orderContents:orderTotal")}),(0,emotion_react_jsx_runtime_browser_esm.FD)(HalfSection,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(SummaryCell,{}),(0,emotion_react_jsx_runtime_browser_esm.Y)(SummaryCell,{}),(0,emotion_react_jsx_runtime_browser_esm.Y)(SummaryCell,{children:orderTotal})]})]}))]})}));const OrderItemsCard_OrderTotals=ComposedOrderTotals;var OrderTotals_templateObject_1,OrderTotals_templateObject_2,OrderItemsCard_LineItemContainer=(0,emotion_styled_browser_esm.A)("div")(OrderItemsCard_templateObject_1||(OrderItemsCard_templateObject_1=(0,tslib_es6.ue)(["\n  display: flex;\n  ",";\n"],["\n  display: flex;\n  ",";\n"])),(function(props){return props.empty?"\n  justify-content: center;\n  font-weight: ".concat(styles_constants.Wy.normal,";\n  flex-direction: column;"):""})),AddLinkContainer=(0,emotion_styled_browser_esm.A)("div")(OrderItemsCard_templateObject_2||(OrderItemsCard_templateObject_2=(0,tslib_es6.ue)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding: 16px 0;\n\n  & > a:hover {\n    text-decoration: underline;\n  }\n"],["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding: 16px 0;\n\n  & > a:hover {\n    text-decoration: underline;\n  }\n"]))),MessageIconContainer=emotion_styled_browser_esm.A.div(OrderItemsCard_templateObject_3||(OrderItemsCard_templateObject_3=(0,tslib_es6.ue)(["\n  box-sizing: border-box;\n  height: 33px;\n  min-width: 33px;\n  border: 1px solid ",";\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  border-radius: 50%;\n  margin-right: 20px;\n  background-color: ",";\n"],["\n  box-sizing: border-box;\n  height: 33px;\n  min-width: 33px;\n  border: 1px solid ",";\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  border-radius: 50%;\n  margin-right: 20px;\n  background-color: ",";\n"])),styles_constants.Tj.gray50,styles_constants.Tj.white),OrderItemsCard_InfoContainer=(0,emotion_styled_browser_esm.A)(Layout.n5)(OrderItemsCard_templateObject_4||(OrderItemsCard_templateObject_4=(0,tslib_es6.ue)(["\n  align-items: center;\n  background-color: ",";\n  padding: 20px 16px;\n  border-radius: 3px;\n  box-shadow: 0 2px 5px 0 rgba(233, 233, 233, 0.5);\n"],["\n  align-items: center;\n  background-color: ",";\n  padding: 20px 16px;\n  border-radius: 3px;\n  box-shadow: 0 2px 5px 0 rgba(233, 233, 233, 0.5);\n"])),styles_constants.Tj.gray25),ListContainer=(0,emotion_styled_browser_esm.A)("div")(OrderItemsCard_templateObject_5||(OrderItemsCard_templateObject_5=(0,tslib_es6.ue)(["\n  margin-top: 16px;\n"],["\n  margin-top: 16px;\n"]))),ComposedOrderItemsCard=(0,utils_translate.Tl)()((function(props){var _a,_b,order=props.order,batchEntry=props.batchEntry,t=props.t,isLineItemMutable=(0,Order.Dd)(order),hasLineItems=!!order.lineItems.length,isBypassCustoms=!!(null===(_a=null==batchEntry?void 0:batchEntry.extras)||void 0===_a?void 0:_a.isBypassCustoms),defaultUserAddress=(0,es.d4)(user_selectors.GA),requiresCustoms=batchEntry?(0,OrderBatchEntry.p2)(batchEntry)&&!isBypassCustoms:(0,Order.p2)(order,defaultUserAddress),canEditCustomsItems=requiresCustoms&&!isBypassCustoms,dispatch=(0,es.wA)(),_c=(0,tslib_es6.zs)(react.useState({kind:"none"}),2),action=_c[0],setAction=_c[1],_d=(0,tslib_es6.zs)(react.useState(canEditCustomsItems?"customsItems":"lineItems"),2),selectedTab=_d[0],setSelectedTab=_d[1];react.useEffect((function(){setSelectedTab(requiresCustoms?"customsItems":"lineItems")}),[requiresCustoms]);var lineItems=(0,batchEntryRendering.nr)(order,batchEntry||void 0),customsItems=(null===(_b=null==batchEntry?void 0:batchEntry.customsItems)||void 0===_b?void 0:_b.length)?batchEntry.customsItems:[],hasCustomsError=requiresCustoms&&!(0,Order.sf)(order)&&!customsItems.length,orderHasValidLineItemsOrCustomsItems=!batchEntry&&(0,Order.xf)(order)||batchEntry&&!!customsItems.length,hasAtLeastOneItemInvalid=hasLineItems&&!orderHasValidLineItemsOrCustomsItems,orderCustomsErrors=order.errors.find((function(error){return["order_weight_exceeded","order_item_incomplete","customs_item_invalid"].includes(error.code||"")})),handleClose=function(){return setAction({kind:"none"})},handleSplitClick=function(){return dispatch((0,orders_actions.gW)(order.objectId))},handleAddLineItem=react.useCallback((function(){return setAction({kind:"add"})}),[]),handleAddCustomsItem=react.useCallback((function(){return setAction({kind:"add-customs"})}),[]),modal=react.useMemo((function(){switch(action.kind){case"none":return null;case"add":return(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderItemsCard_ItemModal,{appLocation:"order_details",order,lineItem:null,onClose:handleClose});case"edit":return(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderItemsCard_ItemModal,{appLocation:"order_details",order,onClose:handleClose,lineItem:lineItems.find((function(lineItem){return lineItem.id===action.lineItemId}))||null});case"add-customs":return(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderItemsCard_CustomsItemModal,{appLocation:"order_details",order,batchEntry,onClose:handleClose,customsItem:null,lineItem:null});case"edit-customs":var id_1=action.id,customsItem=null,lineItem=null;switch(id_1.kind){case"customsItem":customsItem=customsItems.find((function(ci){return ci.id===id_1.value}))||null;break;case"lineItem":lineItem=lineItems.find((function(lineItem){return lineItem.id===id_1.value}))||null}return(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderItemsCard_CustomsItemModal,{appLocation:"order_details",order,batchEntry,onClose:handleClose,customsItem,lineItem})}}),[action]),addCustomsItemAddOnComponent=react.useMemo((function(){return canEditCustomsItems?(0,emotion_react_jsx_runtime_browser_esm.Y)(Link.Oc,(0,tslib_es6.Cl)({onClick:handleAddCustomsItem},{children:t("orders:calculateRates:tabs:orderContents:addCustomsItemAddOnLink")})):null}),[isBypassCustoms,requiresCustoms,handleAddCustomsItem]),addLineItemAddOnComponent=react.useMemo((function(){return!isLineItemMutable||(0,Order.sf)(order)?null:(0,emotion_react_jsx_runtime_browser_esm.Y)(Link.Oc,(0,tslib_es6.Cl)({onClick:handleAddLineItem},{children:t("orders:calculateRates:tabs:orderContents:addLineItemAddOnLink")}))}),[isLineItemMutable,order,handleAddLineItem]),addons=react.useMemo((function(){return(0,Order.FC)(order)?(0,emotion_react_jsx_runtime_browser_esm.Y)(Link.Oc,(0,tslib_es6.Cl)({onClick:handleSplitClick,dataHeap:"split-order",id:"button-split-order"},{children:t("orders:calculateRates:tabs:orderItems:splitOrder")})):isBypassCustoms||!requiresCustoms?addLineItemAddOnComponent:null}),[addLineItemAddOnComponent,isBypassCustoms,requiresCustoms,order]),items=lineItems.map((function(li){return{id:{kind:"lineItem",value:li.id},title:li.title,subtitle:li.sku?t("orders:calculateRates:tabs:orderContents:sku",{sku:li.sku}):"",value:li.totalAmount,currency:li.currency,hasError:!1,quantity:li.quantity,weight:li.totalWeight,weightUnit:li.weightUnit,variant:li.variantTitle}})),customsItemsItems=[];customsItemsItems=batchEntry?customsItems.map((function(ci){var _a;return{id:{kind:"customsItem",value:ci.id},title:ci.description,subtitle:t("orders:calculateRates:tabs:orderContents:origin",{country:(null===(_a=ci.originCountry)||void 0===_a?void 0:_a.name)||"Unknown"}),value:ci.valueAmount.toString(),currency:ci.valueCurrency,hasError:!1,quantity:ci.quantity,weight:ci.convertedNetWeight,weightUnit:ci.convertedMassUnit}})):lineItems.map((function(li){var _a;return{hasError:!(0,LineItem.wY)(li),id:{kind:"lineItem",value:li.id},title:li.title,subtitle:t("orders:calculateRates:tabs:orderContents:origin",{country:(null===(_a=li.countryOfOrigin)||void 0===_a?void 0:_a.name)||"Unknown"}),value:li.totalAmount,currency:li.currency,quantity:li.quantity,weight:li.totalWeight,weightUnit:li.weightUnit}}));var showCantEditMessage,hasCustomsItemError=customsItemsItems.some((function(ci){return ci.hasError}))||0===customsItemsItems.length;return(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(Tabs_ShipmentInfoCardTitle,(0,tslib_es6.Cl)({invalid:hasCustomsError},{children:[t("orders:calculateRates:tabs:orderContents:lineItemsTitle"),addons]})),modal,(showCantEditMessage=(0,Order.sf)(order)&&"lineItems"===selectedTab,requiresCustoms&&(!orderHasValidLineItemsOrCustomsItems||"order_weight_exceeded"===(null==orderCustomsErrors?void 0:orderCustomsErrors.code))||showCantEditMessage?(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderItemsCard_LineItemContainer,(0,tslib_es6.Cl)({empty:!0},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(OrderItemsCard_InfoContainer,(0,tslib_es6.Cl)({flexDirection:Layout.bo.Row},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(MessageIconContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)("img",{src:icon_customs_declaration,alt:""})}),(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{children:showCantEditMessage?t("orders:calculateRates:tabs:orderContents:cantEditLineItems"):hasAtLeastOneItemInvalid||orderCustomsErrors&&"order_item_incomplete"===orderCustomsErrors.code?t("orders:calculateRates:rates:errors:order_item_incomplete"):!orderHasValidLineItemsOrCustomsItems||orderCustomsErrors&&"customs_item_invalid"===orderCustomsErrors.code?t("orders:calculateRates:rates:errors:customs_item_invalid"):t("orders:calculateRates:tabs:shipmentInfo:customsDeclarationEmpty")})]}))})):null),(0,emotion_react_jsx_runtime_browser_esm.FD)(components_Tabs.Container,(0,tslib_es6.Cl)({selectedTab,onTabClick:setSelectedTab,activeBorderBottom:!0},{children:[canEditCustomsItems&&(0,emotion_react_jsx_runtime_browser_esm.FD)(components_Tabs.TabsList,(0,tslib_es6.Cl)({activeBorderBottom:!0,addOn:"customsItems"===selectedTab?addCustomsItemAddOnComponent:addLineItemAddOnComponent},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Tabs.Tab,(0,tslib_es6.Cl)({tabKey:"lineItems"},{children:"Order"})),(0,emotion_react_jsx_runtime_browser_esm.FD)(components_Tabs.Tab,(0,tslib_es6.Cl)({tabKey:"customsItems"},{children:[hasCustomsItemError&&(0,emotion_react_jsx_runtime_browser_esm.Y)("span",(0,tslib_es6.Cl)({className:"text-base mr-1"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(ErrorIcon,{})}))," ","Customs"]}))]})),(0,emotion_react_jsx_runtime_browser_esm.Y)(ListContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(components_Tabs.Content,{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(components_Tabs.TabContent,(0,tslib_es6.Cl)({for:"lineItems"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderItemsCard_ItemsList,{onEditClick:(0,Order.c0)(order)?function(id){"lineItem"===id.kind&&setAction({lineItemId:id.value,kind:"edit"})}:void 0,items,addLink:function(){return!isLineItemMutable||(0,Order.sf)(order)||hasLineItems?null:(0,emotion_react_jsx_runtime_browser_esm.Y)(AddLinkContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Link.Oc,(0,tslib_es6.Cl)({onClick:handleAddLineItem,dataE2E:"order-details-add-line-item-link"},{children:t("orders:calculateRates:tabs:orderContents:addLineItem")}))})}}),(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderItemsCard_OrderTotals,{items,order,showOrderTotal:!0}),(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderItemsCard_OrderNoteSection,{order,batchEntry,showActionLinkOnEmpty:hasLineItems})]})),(0,emotion_react_jsx_runtime_browser_esm.FD)(components_Tabs.TabContent,(0,tslib_es6.Cl)({for:"customsItems"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderItemsCard_ItemsList,{onEditClick:function(id){setAction({id,kind:"edit-customs"})},items:customsItemsItems,addLink:function(){return isBypassCustoms||!requiresCustoms||customsItemsItems.length>0?null:(0,emotion_react_jsx_runtime_browser_esm.Y)(AddLinkContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Link.Oc,(0,tslib_es6.Cl)({onClick:handleAddCustomsItem,dataE2E:"order-details-add-customs-item-link"},{children:t("orders:calculateRates:tabs:orderContents:addCustomsItem")}))})}}),(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderItemsCard_OrderTotals,{items:customsItemsItems,order,showOrderTotal:!1,batchEntry,isCustoms:!0}),(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderItemsCard_OrderNoteSection,{order,batchEntry,showActionLinkOnEmpty:hasLineItems})]}))]})})]}))]})}));var OrderItemsCard_templateObject_1,OrderItemsCard_templateObject_2,OrderItemsCard_templateObject_3,OrderItemsCard_templateObject_4,OrderItemsCard_templateObject_5;const Tabs_OrderItemsCard=ComposedOrderItemsCard;const Tabs_CustomsDeclarationItemsCard=react.memo((function(props){var order=props.order,batchEntry=props.batchEntry,senderAddress=props.senderAddress,hideCustoms=props.hideCustoms;return(0,emotion_react_jsx_runtime_browser_esm.FD)(Tabs_ShipmentInfoCard,{children:[!hideCustoms&&(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Tabs_CustomsDeclarationCard,{order,batchEntry,senderAddress:(null==batchEntry?void 0:batchEntry.addressFrom)||order.addressFrom||senderAddress,customsDeclaration:null==batchEntry?void 0:batchEntry.customsDeclaration,customsItems:null==batchEntry?void 0:batchEntry.customsItems}),(0,emotion_react_jsx_runtime_browser_esm.Y)(BorderLine,{})]}),(0,emotion_react_jsx_runtime_browser_esm.Y)(Tabs_OrderItemsCard,{order,batchEntry})]})}));var BusinessRule=__webpack_require__("./app/types/BusinessRule.ts"),HeaderContainer=(0,emotion_styled_browser_esm.A)("div")(OrderRuleInfoCard_templateObject_1||(OrderRuleInfoCard_templateObject_1=(0,tslib_es6.ue)(["\n  display: flex;\n  flex-direction: row;\n"],["\n  display: flex;\n  flex-direction: row;\n"]))),RuleCardHeader=(0,emotion_styled_browser_esm.A)("header")(OrderRuleInfoCard_templateObject_2||(OrderRuleInfoCard_templateObject_2=(0,tslib_es6.ue)(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  height: auto;\n  font-size: 0.875rem;\n  color: ",";\n"],["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  height: auto;\n  font-size: 0.875rem;\n  color: ",";\n"])),styles_constants.Tj.gray1000),TitleIconGroup=(0,emotion_styled_browser_esm.A)("div")(OrderRuleInfoCard_templateObject_3||(OrderRuleInfoCard_templateObject_3=(0,tslib_es6.ue)(["\n  display: flex;\n"],["\n  display: flex;\n"]))),OrderRuleInfoCard_Icon=(0,emotion_styled_browser_esm.A)("img")(OrderRuleInfoCard_templateObject_4||(OrderRuleInfoCard_templateObject_4=(0,tslib_es6.ue)(["\n  margin-right: 0.625rem;\n"],["\n  margin-right: 0.625rem;\n"]))),OrderRuleInfoCard_CardSection=(0,emotion_styled_browser_esm.A)(components_Card)(OrderRuleInfoCard_templateObject_5||(OrderRuleInfoCard_templateObject_5=(0,tslib_es6.ue)(["\n  margin: 1rem 0;\n  padding: 1.25rem 1.375rem;\n  background-color: ",";\n  border-color: ",";\n"],["\n  margin: 1rem 0;\n  padding: 1.25rem 1.375rem;\n  background-color: ",";\n  border-color: ",";\n"])),styles_constants.Tj.sea50,styles_constants.Tj.sea300),FullWidth=(0,emotion_styled_browser_esm.A)("div")(OrderRuleInfoCard_templateObject_6||(OrderRuleInfoCard_templateObject_6=(0,tslib_es6.ue)(["\n  width: 100%;\n"],["\n  width: 100%;\n"]))),OrderRuleInfoCard_BodyContainer=(0,emotion_styled_browser_esm.A)("div")(OrderRuleInfoCard_templateObject_7||(OrderRuleInfoCard_templateObject_7=(0,tslib_es6.ue)(["\n  margin: 0.5rem 0.5rem 0.5rem 2rem;\n"],["\n  margin: 0.5rem 0.5rem 0.5rem 2rem;\n"]))),RuleCardSection=(0,emotion_styled_browser_esm.A)("div")(OrderRuleInfoCard_templateObject_8||(OrderRuleInfoCard_templateObject_8=(0,tslib_es6.ue)(["\n  margin: 0.5rem 0;\n"],["\n  margin: 0.5rem 0;\n"]))),OrderRuleInfoCard_SectionTitle=(0,emotion_styled_browser_esm.A)("div")(OrderRuleInfoCard_templateObject_9||(OrderRuleInfoCard_templateObject_9=(0,tslib_es6.ue)(["\n  font-weight: ",";\n  font-size: 0.75rem;\n  line-height: 1.125rem;\n  color: ",";\n"],["\n  font-weight: ",";\n  font-size: 0.75rem;\n  line-height: 1.125rem;\n  color: ",";\n"])),styles_constants.Wy.medium,styles_constants.Tj.gray1000),SectionText=(0,emotion_styled_browser_esm.A)("div")(OrderRuleInfoCard_templateObject_10||(OrderRuleInfoCard_templateObject_10=(0,tslib_es6.ue)(["\n  font-size: 0.75rem;\n  color: ",";\n"],["\n  font-size: 0.75rem;\n  color: ",";\n"])),styles_constants.Tj.gray1000);const Tabs_OrderRuleInfoCard=function(props){var _a=(0,tslib_es6.zs)((0,react.useState)(!1),2),isExpanded=_a[0],updateExpandedState=_a[1],dispatch=(0,es.wA)(),isServiceLevelsRequestInitiated=(0,es.d4)(providers_selectors.Hk),handleExpandLink=react.useCallback((function(event){event.stopPropagation(),event.preventDefault(),updateExpandedState(!isExpanded)}),[isExpanded]),expandLink=(0,emotion_react_jsx_runtime_browser_esm.Y)(Link.Oc,(0,tslib_es6.Cl)({href:"#",onClick:handleExpandLink,hideUnderline:!0},{children:isExpanded?"Hide details":"Show details"}));(0,react.useEffect)((function(){isServiceLevelsRequestInitiated||dispatch(fetchServiceLevelsByAccount())}),[]);var rules=props.rules,getConditionString=function(filterOrClause){if((0,BusinessRule.v)(filterOrClause)){var filter=filterOrClause,description=(0,businessRules.re)(filter);return(0,emotion_react_jsx_runtime_browser_esm.FD)(emotion_react_jsx_runtime_browser_esm.FK,{children:[null==description?void 0:description.prefix,(0,emotion_react_jsx_runtime_browser_esm.FD)("span",(0,tslib_es6.Cl)({className:"italic"},{children:[" ",null==description?void 0:description.value]}))]})}var filterClause_1=filterOrClause,conditions=filterClause_1.filters.map(getConditionString);return 1===conditions.length?conditions[0]:(0,emotion_react_jsx_runtime_browser_esm.Y)(emotion_react_jsx_runtime_browser_esm.FK,{children:conditions.map((function(condition,index){return(0,emotion_react_jsx_runtime_browser_esm.FD)(emotion_react_jsx_runtime_browser_esm.FK,{children:[!!index&&(0,emotion_react_jsx_runtime_browser_esm.Y)(emotion_react_jsx_runtime_browser_esm.FK,{children:" ".concat(filterClause_1.operator," ")}),"(",condition,")"]})}))})},conditionString=function(rule){if(rule.filterGroup){var fg=rule.filterGroup;return(0,emotion_react_jsx_runtime_browser_esm.Y)(emotion_react_jsx_runtime_browser_esm.FK,{children:fg.filters.map((function(filter,index){return(0,emotion_react_jsx_runtime_browser_esm.FD)(emotion_react_jsx_runtime_browser_esm.FK,{children:[!!index&&" AND ",getConditionString(filter)]})}))})}},renderAction=function(rule){return(0,emotion_react_jsx_runtime_browser_esm.FD)(RuleCardSection,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderRuleInfoCard_SectionTitle,{children:"Actions:"}),(0,emotion_react_jsx_runtime_browser_esm.Y)(SectionText,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(RuleDescription.A,{rules:new Array(rule)})})]})},ruleHeaderSummary=1===rules.length?(0,emotion_react_jsx_runtime_browser_esm.FD)("div",{children:["Automation ",(0,emotion_react_jsx_runtime_browser_esm.Y)("span",(0,tslib_es6.Cl)({className:"italic"},{children:rules[0].name}))," applied"]}):(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{children:"".concat(rules.length," automations applied")});return(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderRuleInfoCard_CardSection,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(HeaderContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(FullWidth,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(RuleCardHeader,{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(TitleIconGroup,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderRuleInfoCard_Icon,{src:icons.l2}),ruleHeaderSummary]}),expandLink]})})}),(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderRuleInfoCard_BodyContainer,(0,tslib_es6.Cl)({hidden:!isExpanded},{children:rules.map((function(rule){return function(rule){return(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(RuleCardSection,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderRuleInfoCard_SectionTitle,{children:"Conditions:"}),(0,emotion_react_jsx_runtime_browser_esm.FD)(SectionText,{children:["• ",conditionString(rule)]})]}),renderAction(rule)]})}(rule)}))}))]})})};var OrderRuleInfoCard_templateObject_1,OrderRuleInfoCard_templateObject_2,OrderRuleInfoCard_templateObject_3,OrderRuleInfoCard_templateObject_4,OrderRuleInfoCard_templateObject_5,OrderRuleInfoCard_templateObject_6,OrderRuleInfoCard_templateObject_7,OrderRuleInfoCard_templateObject_8,OrderRuleInfoCard_templateObject_9,OrderRuleInfoCard_templateObject_10;const components_FormError=FormError_FormError.A;var hooks_usePrevious=__webpack_require__("./app/hooks/usePrevious.ts"),isDirty=__webpack_require__("./node_modules/redux-form/es/isDirty.js"),PackageInformation_Icon=(0,emotion_styled_browser_esm.A)("i")(PackageInformation_templateObject_1||(PackageInformation_templateObject_1=(0,tslib_es6.ue)(["\n  margin-right: 0.3125rem;\n  font-size: 1rem;\n"],["\n  margin-right: 0.3125rem;\n  font-size: 1rem;\n"]))),ApplyButton=(0,emotion_styled_browser_esm.A)(components_Button.jn)(PackageInformation_templateObject_2||(PackageInformation_templateObject_2=(0,tslib_es6.ue)(["\n  width: auto;\n"],["\n  width: auto;\n"]))),FormActions=(0,emotion_styled_browser_esm.A)(Modal.A.Footer)(PackageInformation_templateObject_3||(PackageInformation_templateObject_3=(0,tslib_es6.ue)(["\n  border-top: none;\n  padding: 0.5rem 0 0 0;\n"],["\n  border-top: none;\n  padding: 0.5rem 0 0 0;\n"]))),PackageInformation_WeightDimensionsWarningWrapper=(0,emotion_styled_browser_esm.A)("div")(PackageInformation_templateObject_4||(PackageInformation_templateObject_4=(0,tslib_es6.ue)(["\n  margin: 1rem 0;\n"],["\n  margin: 1rem 0;\n"])));const Tabs_PackageInformation=(0,utils_translate.Tl)("orders")((function(_a){var t=_a.t,order=_a.order,batchEntry=_a.batchEntry,orderSelection=_a.orderSelection,initialExtrasValues=_a.initialExtrasValues,dispatch=(0,es.wA)(),defaultMassUnit=(0,es.d4)(user_selectors.cm),isParcelFormDirty=(0,es.d4)((function(state){return(0,isDirty.A)(constants_form.n6)(state)})),isSubmittingParcelForm=(0,es.d4)((function(state){return(0,isSubmitting.A)(constants_form.n6)(state)})),isInvalidParcelForm=(0,es.d4)((function(state){return(0,isInvalid.A)(constants_form.n6)(state)})),isExtrasDirty=(0,es.d4)((function(state){return(0,isDirty.A)(constants_form.n6)(state,"alcohol","dryIce","isReturnRequested","hazmat")})),batchEntryData=(0,es.d4)(batch_entry_selectors.zo),hasExceededPackageWeightError=(0,react.useMemo)((function(){return!!(null==batchEntry?void 0:batchEntry.errors.find((function(error){return"order_weight_exceeded"===error.code})))}),[null==batchEntry?void 0:batchEntry.errors]),importedWeightOption=(0,react.useMemo)((function(){return order.weightUnit?options.Ay.commonWeightOptions[order.weightUnit]:options.Ay.commonWeightOptions[defaultMassUnit]}),[order.weightUnit,defaultMassUnit]),batchEntryLineItems=(0,react.useMemo)((function(){return(null==batchEntry?void 0:batchEntry.lineItems)||[]}),[null==batchEntry?void 0:batchEntry.lineItems]),parcel=(0,react.useMemo)((function(){return(null==batchEntry?void 0:batchEntry.parcel)||null}),[null==batchEntry?void 0:batchEntry.parcel]),partialFulfillmentRequestImportedWeight=(0,react.useMemo)((function(){return batchEntry?(0,OrderBatchEntry.f2)(batchEntryLineItems,order.lineItems).toString():""}),[batchEntry,order.lineItems,batchEntryLineItems]),totalCustomsItemsWeight=(0,react.useMemo)((function(){return(0,OrderBatchEntry.Ag)(batchEntry)}),[batchEntry]),importedWeight=(0,react.useMemo)((function(){var _a;return batchEntry&&(0,OrderBatchEntry.p2)(batchEntry)&&totalCustomsItemsWeight?totalCustomsItemsWeight.toString():batchEntry&&batchEntry.partialFulfillmentRank>0?partialFulfillmentRequestImportedWeight:(null===(_a=(0,Order.J_)(order))||void 0===_a?void 0:_a.toString())||""}),[batchEntry,order,totalCustomsItemsWeight,partialFulfillmentRequestImportedWeight]),useImportedWeight=(0,react.useMemo)((function(){return!(!batchEntry||!batchEntry.parcel)&&batchEntry.useImportedWeight}),[batchEntry]),shouldRenderFooter=!parcel||isParcelFormDirty||hasExceededPackageWeightError,shouldRenderExceededPackageWeightError=hasExceededPackageWeightError&&!isSubmittingParcelForm,isValidPackage=!!parcel&&!hasExceededPackageWeightError;(0,react.useEffect)((function(){dispatch((0,orders_actions._W)(orderSelection))}),[dispatch,orderSelection]);var previousIsParcelFormDirty=(0,hooks_usePrevious.A)(isParcelFormDirty);(0,react.useEffect)((function(){isParcelFormDirty||previousIsParcelFormDirty===isParcelFormDirty||dispatch((0,orders_actions.m6)())}),[dispatch,isParcelFormDirty,previousIsParcelFormDirty]);var handleSubmit=(0,react.useCallback)((function(data){var _a,_b;trackPackageUpdateEvent(data,orderSelection,schema.ID,"order_details");var newParcel=shouldRenderFooter?(0,Parcel.On)(data):void 0,newExtras=isExtrasDirty?(0,Parcel.OS)(data):void 0,trackingReference=TrackingHelper.U.getTrackingReference(types.wK.name,"order_details",{parcelId:null===(_a=null==newParcel?void 0:newParcel.userParcelTemplate)||void 0===_a?void 0:_a.objectId,isAutoSave:!1,isQuickSelect:!1});utils_handleTrackPackageUpdatedOrAdded(trackingReference,orderSelection,batchEntryData,{parcelId:null===(_b=null==newParcel?void 0:newParcel.userParcelTemplate)||void 0===_b?void 0:_b.objectId,isAutoSave:!1,isQuickSelect:!1}),dispatch((0,orders_actions.xC)(orderSelection,newParcel,newExtras,trackingReference))}),[shouldRenderFooter,isExtrasDirty,dispatch,orderSelection,batchEntryData]),resetParcelForm=(0,react.useCallback)((function(){dispatch((0,redux_form_es.cL)(constants_form.n6))}),[]),onSubmitParcelForm=(0,react.useCallback)((function(event){event.preventDefault(),utils_observability.O.startEvent("RATE_REFRESH_ORDER_DETAILS"),dispatch((0,redux_form_es.tA)(constants_form.n6))}),[dispatch]);return(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Anchor,{id:"packageCard"}),(0,emotion_react_jsx_runtime_browser_esm.Y)(Tabs_ShipmentInfoCardTitle,(0,tslib_es6.Cl)({invalid:!isValidPackage},{children:t("orders:calculateRates:tabs:shipmentInfo:packageInfo")})),(0,emotion_react_jsx_runtime_browser_esm.Y)(PackageInformation_WeightDimensionsWarningWrapper,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Tabs_PackageWeightDimensionsWarning,{})}),(0,emotion_react_jsx_runtime_browser_esm.FD)("form",(0,tslib_es6.Cl)({onSubmit:onSubmitParcelForm},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(All_ParcelForm,{onSubmit:handleSubmit,existingParcel:parcel,useDefault:!!parcel,importedWeight,importedWeightOption,someOrderHasImportedWeight:(0,Order.vz)(order),useImportedWeight,batchEntryId:null==batchEntry?void 0:batchEntry.id,orderSelection,dataAnalyticsContext:"order_details",initialExtrasValues,shouldShowParcelExtras:!0,enableReinitialize:!0,showZeroState:!0,insideCard:!0,appLocation:"order_details"}),shouldRenderExceededPackageWeightError&&(0,emotion_react_jsx_runtime_browser_esm.FD)(components_FormError,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(PackageInformation_Icon,{className:"fa fa-exclamation-circle"}),t("orders:calculateRates:tabs:shipmentInfo:errors:orderWeightExceeded",{weight:totalCustomsItemsWeight,weightUnit:null==parcel?void 0:parcel.weightUnit})]}),shouldRenderFooter&&(0,emotion_react_jsx_runtime_browser_esm.Y)(FormActions,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"w-full"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Button.vM,(0,tslib_es6.Cl)({onClick:resetParcelForm,dataPendo:"package-cancel",dataAnalytics:"".concat("order_details","PackageInfo-click-cancelButton")},{children:t("phrases.cancel")})),(0,emotion_react_jsx_runtime_browser_esm.Y)(ApplyButton,(0,tslib_es6.Cl)({type:"submit",onClick:onSubmitParcelForm,disabled:isSubmittingParcelForm||isInvalidParcelForm,dataPendo:"package-save",dataAnalytics:"".concat("order_details","PackageInfo-click-saveButton"),fullWidth:!0,dataE2E:"order-details-parcel-form-submit-btn"},{children:t("phrases.save")}))]}))})]}))]})}));var PackageInformation_templateObject_1,PackageInformation_templateObject_2,PackageInformation_templateObject_3,PackageInformation_templateObject_4,ComposedPackageAdditionalServicesCard=react.memo((function(props){var order=props.order,batchEntry=props.batchEntry,initialExtrasValues=props.initialExtrasValues,orderSelection=(0,react.useMemo)((function(){var _a;return(_a={})[order.objectId]=batchEntry?[batchEntry.id]:[],_a}),[order.objectId,null==batchEntry?void 0:batchEntry.id]);return(0,emotion_react_jsx_runtime_browser_esm.Y)(Tabs_ShipmentInfoCard,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Tabs_PackageInformation,{order,orderSelection,batchEntry,initialExtrasValues})})}));const Tabs_PackageAdditionalServicesCard=ComposedPackageAdditionalServicesCard;var BorderLine=(0,emotion_styled_browser_esm.A)("div")(ShipmentInfo_templateObject_1||(ShipmentInfo_templateObject_1=(0,tslib_es6.ue)(["\n  /* set to outer card container's (ShipmentInfoCard) side padding */\n  margin: 0.5rem -1rem;\n  border-top: 1px solid ",";\n"],["\n  /* set to outer card container's (ShipmentInfoCard) side padding */\n  margin: 0.5rem -1rem;\n  border-top: 1px solid ",";\n"])),styles_constants.Tj.containerBorderColor),ShipmentInfoComponent=function(_super){function ShipmentInfoComponent(props){var _this=_super.call(this,props)||this;return _this.renderShipmentStatusMessage=function(){if(!(0,Order.sf)(_this.props.order))return(0,emotion_react_jsx_runtime_browser_esm.Y)(Message.Ay,(0,tslib_es6.Cl)({withIcon:!0},{children:"This shipment has not yet been fulfilled."}))},_this.getOrderSelection=function(){var _a,_b=_this.props,batchEntry=_b.batchEntry,order=_b.order,batchEntryIds=batchEntry?[batchEntry.id]:[];return(_a={})[order.objectId]=batchEntryIds,_a},_this}return(0,tslib_es6.C6)(ShipmentInfoComponent,_super),ShipmentInfoComponent.prototype.componentDidMount=function(){var batchEntry=this.props.batchEntry;batchEntry&&this.props.fetchBatchEntryRules(batchEntry.id)},ShipmentInfoComponent.prototype.componentDidUpdate=function(prevProps){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,hasChangedParcel=(null===(_c=null===(_b=null===(_a=null==prevProps?void 0:prevProps.batchEntry)||void 0===_a?void 0:_a.parcel)||void 0===_b?void 0:_b.userParcelTemplate)||void 0===_c?void 0:_c.objectId)!==(null===(_g=null===(_f=null===(_e=null===(_d=this.props)||void 0===_d?void 0:_d.batchEntry)||void 0===_e?void 0:_e.parcel)||void 0===_f?void 0:_f.userParcelTemplate)||void 0===_g?void 0:_g.objectId),hasChangedServiceLevel=(null===(_h=null==prevProps?void 0:prevProps.batchEntry)||void 0===_h?void 0:_h.preferredServiceLevelToken)!==(null===(_k=null===(_j=this.props)||void 0===_j?void 0:_j.batchEntry)||void 0===_k?void 0:_k.preferredServiceLevelToken);this.props.batchEntry&&(!prevProps.batchEntry||hasChangedParcel||hasChangedServiceLevel)&&this.props.fetchBatchEntryRules(this.props.batchEntry.id)},ShipmentInfoComponent.prototype.render=function(){var _a=this.props,order=_a.order,orderBatchEntries=_a.orderBatchEntries,batchEntry=_a.batchEntry,appliedRules=_a.appliedRules,isBatchEntryTransactionSuccess=_a.isBatchEntryTransactionSuccess,userSenderAddress=_a.userSenderAddress,t=_a.t,defaultMassUnit=_a.defaultMassUnit,alwaysCreateReturns=_a.alwaysCreateReturns,hasTabs=orderBatchEntries.length>1,initialExtrasValues=getInitialShipmentExtrasFormValues(batchEntry,defaultMassUnit,!!alwaysCreateReturns),batchEntryCustomsExempt=batchEntry&&!(0,OrderBatchEntry.p2)(batchEntry),orderCustomsExempt=!(0,Order.p2)(order,userSenderAddress),hideCustoms=batchEntryCustomsExempt||orderCustomsExempt,displayedRules=appliedRules?(0,businessRules.aJ)(appliedRules):[];return(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[displayedRules&&displayedRules.length>0&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Tabs_OrderRuleInfoCard,{rules:displayedRules}),hasTabs&&!isBatchEntryTransactionSuccess&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Message.Ay,(0,tslib_es6.Cl)({withIcon:!0},{children:t("calculateRates.tabs.notifications.notFulfilled")})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Tabs_CustomsDeclarationItemsCard,{order,batchEntry,senderAddress:(null==batchEntry?void 0:batchEntry.addressFrom)||order.addressFrom||userSenderAddress,hideCustoms}),(0,emotion_react_jsx_runtime_browser_esm.Y)(Tabs_PackageAdditionalServicesCard,{order,batchEntry,initialExtrasValues}),(0,emotion_react_jsx_runtime_browser_esm.Y)(AddressCard_container,{order,batchEntry})]})},ShipmentInfoComponent}(react.PureComponent);function getInitialShipmentExtrasFormValues(batchEntry,defaultMassUnit,alwaysCreateReturns){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p,_q,_r,defaultInsurance={purchaseInsurance:!1,amount:"",currency:options.Ay.commonCurrencyOptions.USD,content:"",useImportedAmount:!1},initialExtrasValues=batchEntry&&batchEntry.extras?{isReturnRequested:null!==(_a=batchEntry.extras.isReturnRequested)&&void 0!==_a?_a:alwaysCreateReturns,insurance:batchEntry.extras.insurance?{purchaseInsurance:!0,amount:batchEntry.extras.insurance.amount,currency:{value:batchEntry.extras.insurance.currency.iso,label:batchEntry.extras.insurance.currency.iso},content:"",useImportedAmount:batchEntry.extras.insurance.useImportedAmount}:defaultInsurance,isBypassAddressValidation:!!batchEntry.extras.isBypassAddressValidation,alcohol:{containsAlcohol:!!(null===(_b=batchEntry.extras.alcohol)||void 0===_b?void 0:_b.containsAlcohol),recipientType:recipientTypeOptions.find((function(o){var _a,_b,_c;return!!batchEntry&&o.value.toString().toUpperCase()===(null===(_c=null===(_b=null===(_a=batchEntry.extras)||void 0===_a?void 0:_a.alcohol)||void 0===_b?void 0:_b.recipientType)||void 0===_c?void 0:_c.toUpperCase())}))||recipientTypeOptions[0]},signatureConfirmation:{hasSignatureConfirmation:!!(null===(_c=batchEntry.extras.signatureConfirmation)||void 0===_c?void 0:_c.hasSignatureConfirmation),signatureConfirmationType:(0,signatureConfirmation.mS)(null===(_d=batchEntry.extras.signatureConfirmation)||void 0===_d?void 0:_d.signatureConfirmationType)},isBypassCustoms:!!batchEntry.extras.isBypassCustoms,dryIce:{containsDryIce:null!==(_f=null===(_e=batchEntry.extras.dryIce)||void 0===_e?void 0:_e.containsDryIce)&&void 0!==_f&&_f,weight:(null===(_g=batchEntry.extras.dryIce)||void 0===_g?void 0:_g.weight)?"".concat(null===(_h=batchEntry.extras.dryIce)||void 0===_h?void 0:_h.weight):"",weightUnitId:null!==(_l=null!==(_k=null===(_j=batchEntry.extras.dryIce)||void 0===_j?void 0:_j.weightUnitId)&&void 0!==_k?_k:weight.FU[defaultMassUnit])&&void 0!==_l?_l:weight.Rg.Pound,packageWeight:null===(_m=batchEntry.parcel)||void 0===_m?void 0:_m.weight,packageWeightUnit:(null===(_o=batchEntry.parcel)||void 0===_o?void 0:_o.weightUnit)||weight.VV.LB,inBatchMode:!1},hazmat:{containsHazmat:!!(null===(_p=batchEntry.extras.hazmat)||void 0===_p?void 0:_p.isHazmat),containsBiologicalMaterial:!!(null===(_q=batchEntry.extras.hazmat)||void 0===_q?void 0:_q.isBiologicalMaterial),containsLithiumBatteries:!!(null===(_r=batchEntry.extras.hazmat)||void 0===_r?void 0:_r.isLithiumBatteries)},packingSlipText:batchEntry.extras.packingSlipText||""}:void 0;return initialExtrasValues}var ComposedShipmentInfo=(0,redux.Zz)((0,es.Ng)((function(){var getOrderById=(0,orders_selectors.H4)(),getBatchEntryById=(0,batch_entry_selectors.Xv)();return function(state,ownProps){var _a,orderId=ownProps.match.params.orderId,batchEntryIdString=ownProps.match.params.batchEntryId,order=getOrderById(state,{orderId}),batchEntry=(0,batch_entry_selectors.Dz)(state,{orderObjectId:orderId});batchEntryIdString&&!isNaN(Number(batchEntryIdString))&&(batchEntry=getBatchEntryById(state,{batchEntryId:Number(batchEntryIdString)}));var defaultMassUnit=null!==(_a=(0,user_selectors.cm)(state))&&void 0!==_a?_a:weight.VV.LB;return{order,batchEntry,alwaysCreateReturns:(0,user_selectors.pi)(state),appliedRules:batchEntry?(0,batch_entry_selectors.gR)(state,{batchEntryId:batchEntry.id}):null,userSenderAddress:(0,user_selectors.GA)(state),isBatchEntryTransactionSuccess:!!batchEntry&&(0,batch_entry_composite_selectors.oV)(state,{batchEntryId:batchEntry.id}),orderBatchEntries:(0,batch_entry_selectors.rk)(state,{orderObjectId:orderId}),defaultMassUnit}}}),(function(dispatch){return{fetchBatchEntryRules:function(batchEntryId){return dispatch((0,orders_actions.SJ)(batchEntryId))}}})),(0,utils_translate.Tl)("orders"),react_router.y)(ShipmentInfoComponent);const ShipmentInfo=ComposedShipmentInfo;var ShipmentInfo_templateObject_1,icon_success_green_bg=__webpack_require__("./app/assets/icons/icon_success_green_bg.svg"),NotificationImage=(0,emotion_styled_browser_esm.A)("img")(ShipmentTab_templateObject_1||(ShipmentTab_templateObject_1=(0,tslib_es6.ue)(["\n  margin-left: 8px;\n"],["\n  margin-left: 8px;\n"]))),ShipmentTab=function(_super){function ShipmentTab(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.renderAddons=function(){var isBatchEntryTransactionSuccess=_this.props.isBatchEntryTransactionSuccess;return(0,emotion_react_jsx_runtime_browser_esm.Y)(NotificationImage,{src:isBatchEntryTransactionSuccess?icon_success_green_bg:exclamation_circle_yellow})},_this}return(0,tslib_es6.C6)(ShipmentTab,_super),ShipmentTab.prototype.render=function(){var _a=this.props,location=_a.history.location,tabIndex=_a.tabIndex,tabsCount=_a.tabsCount,orderId=_a.orderId,batchEntryId=_a.batchEntryId,t=_a.t;return(0,emotion_react_jsx_runtime_browser_esm.FD)(components_Tabs.TabLink,(0,tslib_es6.Cl)({to:"/orders/".concat(orderId,"/shipments/").concat(batchEntryId).concat(location.search),addons:this.renderAddons},{children:[t("calculateRates.tabs.navigation.shipmentTitle")," ",tabIndex+1," ",t("calculateRates.tabs.navigation.shipmentTitleSeparator")," ",tabsCount]}))},ShipmentTab}(react.Component);const Tabs_ShipmentTab=(0,redux.Zz)((0,utils_translate.Tl)("orders"),react_router.y,(0,es.Ng)((function(state,ownProps){var batchEntryId=ownProps.batchEntryId;return{isBatchEntryTransactionSuccess:(0,batch_entry_composite_selectors.oV)(state,{batchEntryId})}})))(ShipmentTab);var ShipmentTab_templateObject_1,TabsContainer=(0,emotion_styled_browser_esm.A)("div")(Tabs_templateObject_1||(Tabs_templateObject_1=(0,tslib_es6.ue)(["\n  background: ",";\n  width: 100%;\n  margin: auto;\n  margin-top: 0px;\n  padding: 0;\n  @media screen and (min-width: ","px) {\n    margin: 0;\n  }\n"],["\n  background: ",";\n  width: 100%;\n  margin: auto;\n  margin-top: 0px;\n  padding: 0;\n  @media screen and (min-width: ","px) {\n    margin: 0;\n  }\n"])),styles_constants.Tj.gray25,responsive.P.Tablet),Tabs_ListContainer=(0,emotion_styled_browser_esm.A)("nav")(Tabs_templateObject_2||(Tabs_templateObject_2=(0,tslib_es6.ue)(["\n  width: 100%;\n  ",";\n"],["\n  width: 100%;\n  ",";\n"])),(function(_a){return!_a.hasTabs&&"margin-bottom: 16px;"})),ShipmentTabs=function(_super){function ShipmentTabs(){return null!==_super&&_super.apply(this,arguments)||this}return(0,tslib_es6.C6)(ShipmentTabs,_super),ShipmentTabs.prototype.render=function(){var _a=this.props,match=_a.match,partialFulfillmentRequests=_a.partialFulfillmentRequests,orderId=match.params.orderId,tabsCount=partialFulfillmentRequests.length,hasTabs=tabsCount>1;return(0,emotion_react_jsx_runtime_browser_esm.FD)(TabsContainer,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Tabs_ListContainer,(0,tslib_es6.Cl)({hasTabs},{children:hasTabs?(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Tabs.ScrollableTabsList,(0,tslib_es6.Cl)({gradientColor:styles_constants.Tj.gray25},{children:partialFulfillmentRequests.map((function(batchEntryId,i){return(0,emotion_react_jsx_runtime_browser_esm.Y)(Tabs_ShipmentTab,{tabIndex:i,tabsCount,orderId,batchEntryId},"tab".concat(batchEntryId))}))})):null})),(0,emotion_react_jsx_runtime_browser_esm.Y)(react_router.dO,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(react_router.qh,{exact:!0,path:"".concat(match.path),component:ShipmentInfo})})]})},ShipmentTabs}(react.Component);(0,redux.Zz)((0,utils_translate.Tl)("orders"),(0,es.Ng)((function(state,ownProps){var props={orderObjectId:ownProps.orderId};return{partialFulfillmentRequests:(0,batch_entry_selectors.rk)(state,props)}})),react_router.y)(ShipmentTabs);var Tabs_templateObject_1,Tabs_templateObject_2;var Stack=__webpack_require__("./node_modules/@goshippo/components/esm/Stack/Stack.js");const hooks_useSendTrackEvent=function useSendTrackEvent(){var dispatch=(0,es.wA)();return function(event,properties){dispatch((0,prod_analytics_actions.o)(event,properties))}};const hooks_useTrackRateSelect=function useTrackRateSelect(selectedRate,hasErrors,dataAnalytics){var sendTrackEvent=hooks_useSendTrackEvent();(0,react.useEffect)((function(){selectedRate&&(hasErrors||sendTrackEvent("App - Rate Selected",{carrier:null==selectedRate?void 0:selectedRate.provider,serviceLevel:null==selectedRate?void 0:selectedRate.servicelevel.name,shippoPrice:null==selectedRate?void 0:selectedRate.amount,retailPrice:"",areSavingsShown:!1,rateRequestLocation:dataAnalytics||""}))}),[selectedRate])};var insurance_a,INSURANCE_AVAILABLE_IN_COUNTRIES=((insurance_a={})[constants_countries.Xr.US.iso2]=!0,insurance_a[constants_countries.Xr.VI.iso2]=!0,insurance_a[constants_countries.Xr.GU.iso2]=!0,insurance_a[constants_countries.Xr.AS.iso2]=!0,insurance_a[constants_countries.Xr.MP.iso2]=!0,insurance_a[constants_countries.Xr.PR.iso2]=!0,insurance_a[constants_countries.Xr.DE.iso2]=!0,insurance_a[constants_countries.Xr.FR.iso2]=!0,insurance_a[constants_countries.Xr.IT.iso2]=!0,insurance_a[constants_countries.Xr.ES.iso2]=!0,insurance_a[constants_countries.Xr.NL.iso2]=!0,insurance_a[constants_countries.Xr.GB.iso2]=!0,insurance_a[constants_countries.Xr.CA.iso2]=!0,insurance_a);var featureflags=__webpack_require__("./app/utils/featureflags/index.ts");function getBestRate(rates){if(void 0===rates&&(rates=[]),0===rates.length)return[];var lowestRate=(0,tslib_es6.fX)([],(0,tslib_es6.zs)(rates),!1).sort((function(a,b){return Number(a.amount)-Number(b.amount)}))[0],upsGround=rates.find((function(rate){return"ups_ground"===rate.servicelevel.token})),uspsPriority=rates.find((function(rate){return"usps_priority"===rate.servicelevel.token})),bestOption=null;bestOption=upsGround&&uspsPriority?Number(upsGround.amount)<Number(uspsPriority.amount)?upsGround:uspsPriority:upsGround||uspsPriority||null;var target=1.5*Number(lowestRate.amount);return lowestRate.attributes=[],bestOption&&Number(bestOption.amount)<Number(target)&&(bestOption.attributes=[Rate.jf.BEST_OPTION]),rates}function fetchCarrierAccountsSuccess(payload){return{payload,type:constants.t.FETCH_CARRIER_ACCOUNTS_SUCCESS}}function fetchCarrierAccountsError(payload){return{payload,type:constants.t.FETCH_CARRIER_ACCOUNTS_ERROR}}function fetchCarrierAccountRegStatusesError(payload){return{payload,type:constants.t.FETCH_CARRIER_ACCOUNT_REG_STATUSES_ERROR}}function connectCarrierAccountSuccess(payload){return{payload,type:constants.t.CONNECT_CARRIER_ACCOUNT_SUCCESS}}function carrier_accounts_actions_editCarrierAccount(payload){return{payload,type:constants.t.EDIT_CARRIER_ACCOUNT}}function editCarrierAccountError(payload){return{payload,type:constants.t.EDIT_CARRIER_ACCOUNT_ERROR}}function editCarrierAccountServiceLevelsError(payload){return{payload,type:constants.t.EDIT_CARRIER_ACCOUNT_SERVICE_LEVELS_ERROR}}function carrier_accounts_actions_createCarrierAccount(payload){return{payload,type:constants.t.CREATE_CARRIER_ACCOUNT}}function createCarrierAccountError(payload){return{payload,type:constants.t.CREATE_CARRIER_ACCOUNT_ERROR}}var Notification_templateObject_1,Notification_templateObject_2,Notification_templateObject_3,Notification_templateObject_4,Notification_templateObject_5,Notification_templateObject_6,Notification_templateObject_7,Notification_templateObject_8,icon_close_dark_gray=__webpack_require__("./app/assets/icons/icon_close_dark_gray.svg"),CloseIcon_CloseIcon=(__webpack_require__("./app/assets/icons/icon_error_frame.svg"),__webpack_require__("./app/assets/icons/icon_success_bg_green.svg"),__webpack_require__("./app/components/CloseIcon/CloseIcon.tsx")),NotificationContainer=(0,emotion_styled_browser_esm.A)("div",{shouldForwardProp:is_prop_valid_browser_esm.A})(Notification_templateObject_1||(Notification_templateObject_1=(0,tslib_es6.ue)(["\n  position: ",";\n  top: 16px;\n  left: 0;\n  right: 0;\n  width: 90%;\n  max-width: 1200px;\n  padding: 16px;\n  z-index: 1000;\n  background-color: ",";\n  display: flex;\n  align-items: center;\n  box-sizing: border-box;\n  border-radius: 3px;\n  margin: 0 auto;\n"],["\n  position: ",";\n  top: 16px;\n  left: 0;\n  right: 0;\n  width: 90%;\n  max-width: 1200px;\n  padding: 16px;\n  z-index: 1000;\n  background-color: ",";\n  display: flex;\n  align-items: center;\n  box-sizing: border-box;\n  border-radius: 3px;\n  margin: 0 auto;\n"])),(function(props){return props.dock?"fixed":"absolute"}),styles_constants.Tj.white),carrier_accounts_selectors=((0,emotion_styled_browser_esm.A)(NotificationContainer)(Notification_templateObject_2||(Notification_templateObject_2=(0,tslib_es6.ue)(["\n  border: 1px solid ",";\n  box-shadow:\n    0px 4px 8px ",",\n    inset 4px 0px 0px ",";\n"],["\n  border: 1px solid ",";\n  box-shadow:\n    0px 4px 8px ",",\n    inset 4px 0px 0px ",";\n"])),styles_constants.Tj.sea700,styles_constants.Tj.notification.boxShadow,styles_constants.Tj.sea700),(0,emotion_styled_browser_esm.A)(NotificationContainer)(Notification_templateObject_3||(Notification_templateObject_3=(0,tslib_es6.ue)(["\n  border: 1px solid ",";\n  box-shadow:\n    0px 4px 8px ",",\n    inset 4px 0px 0px ",";\n"],["\n  border: 1px solid ",";\n  box-shadow:\n    0px 4px 8px ",",\n    inset 4px 0px 0px ",";\n"])),styles_constants.Tj.forest600,styles_constants.Tj.notification.boxShadow,styles_constants.Tj.forest600),(0,emotion_styled_browser_esm.A)(NotificationContainer)(Notification_templateObject_4||(Notification_templateObject_4=(0,tslib_es6.ue)(["\n  border: 1px solid ",";\n  box-shadow:\n    0px 4px 8px ",",\n    inset 4px 0px 0px ",";\n"],["\n  border: 1px solid ",";\n  box-shadow:\n    0px 4px 8px ",",\n    inset 4px 0px 0px ",";\n"])),styles_constants.Tj.ruby600,styles_constants.Tj.notification.boxShadow,styles_constants.Tj.ruby600),(0,emotion_styled_browser_esm.A)("div")(Notification_templateObject_5||(Notification_templateObject_5=(0,tslib_es6.ue)(["\n  margin-left: auto;\n  padding-left: 20px;\n"],["\n  margin-left: auto;\n  padding-left: 20px;\n"]))),(0,emotion_styled_browser_esm.A)("div")(Notification_templateObject_6||(Notification_templateObject_6=(0,tslib_es6.ue)(["\n  height: 28px;\n  width: 28px;\n"],["\n  height: 28px;\n  width: 28px;\n"]))),(0,emotion_styled_browser_esm.A)("img")(Notification_templateObject_7||(Notification_templateObject_7=(0,tslib_es6.ue)(["\n  height: 28px;\n"],["\n  height: 28px;\n"]))),(0,emotion_styled_browser_esm.A)("div")(Notification_templateObject_8||(Notification_templateObject_8=(0,tslib_es6.ue)(["\n  margin-left: 13px;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  font-weight: ",";\n  color: ",";\n"],["\n  margin-left: 13px;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  font-weight: ",";\n  color: ",";\n"])),styles_constants.Wy.medium,styles_constants.Tj.gray1000),__webpack_require__("./app/selectors/carrier-accounts.selectors.ts")),plans_selectors=__webpack_require__("./app/selectors/plans.selectors.ts"),IDVerification=__webpack_require__("./app/types/IDVerification.ts");function updateCompanySuccess(payload){return{payload,type:constants.t.COMPANY_UPDATE_SUCCESS}}function fetchCompany(){return{type:constants.t.COMPANY_FETCH}}function fetchUserSuccess(payload){return{payload,type:constants.t.USER_FETCH_SUCCESS}}function fetchUserError(){return{type:constants.t.USER_FETCH_ERROR}}function updateUserDefaultAddress(payload){return{payload,type:constants.t.UPDATE_DEFAULT_ADDRESS}}function updateUserDefaultReturnAddress(payload){return{payload,type:constants.t.UPDATE_DEFAULT_RETURN_ADDRESS}}function refreshUser(){return{type:constants.t.USER_REFRESH}}function updateCreditCard(elementId,tokenId,billingAddress){return{elementId,type:constants.t.USER_UPDATE_CREDIT_CARD,payload:{tokenId,billingAddress}}}function fetchAssets(){return{type:constants.t.USER_ASSETS_FETCH}}function fetchAssetsSuccess(assets){return{type:constants.t.USER_ASSETS_FETCH_SUCCESS,payload:{assets}}}function uploadAssetDraftSuccess(assetType,rank){return{type:constants.t.USER_ASSET_UPLOAD_DRAFT_SUCCESS,payload:{assetType,rank}}}function uploadAssetDraftError(assetType,rank,errorCode){return{type:constants.t.USER_ASSET_UPLOAD_DRAFT_ERROR,payload:{assetType,rank,errorCode}}}function clearAssetDraftSuccess(assetType,rank){return{type:constants.t.USER_ASSET_CLEAR_DRAFT_SUCCESS,payload:{assetType,rank}}}function clearAssetDraftError(assetType,rank,errorCode){return{type:constants.t.USER_ASSET_CLEAR_DRAFT_ERROR,payload:{assetType,rank,errorCode}}}function revertAssetDraftSuccess(assetType,rank){return{type:constants.t.USER_ASSET_REVERT_DRAFT_SUCCESS,payload:{assetType,rank}}}function revertAssetDraftError(assetType,rank,errorCode){return{type:constants.t.USER_ASSET_REVERT_DRAFT_ERROR,payload:{assetType,rank,errorCode}}}function publishAssetSuccess(assetType,rank){return{type:constants.t.USER_ASSET_PUBLISH_SUCCESS,payload:{assetType,rank}}}function publishAssetError(assetType,rank,errorCode){return{type:constants.t.USER_ASSET_PUBLISH_ERROR,payload:{assetType,rank,errorCode}}}function setIdVerificationStatus(idVerification){return{type:constants.t.USER_SET_VERIFICATION_STATUS,payload:{idVerification}}}function updateUserSuccess(user){return{type:constants.t.USER_UPDATE_SUCCESS,payload:{user}}}function updateUserError(error){return{type:constants.t.USER_UPDATE_ERROR,payload:{error}}}var Link_Link=__webpack_require__("./node_modules/@goshippo/components/esm/Link/Link.js");function carrierFormFieldsClearState(){return{type:constants.t.CARRIER_FORM_FIELDS_CLEAR_STATE}}function fetchCarrierFormFields(payload){return{payload,type:constants.t.FETCH_CARRIER_FORM_FIELDS}}function fetchCarrierFormFieldsError(payload){return{payload,type:constants.t.FETCH_CARRIER_FORM_FIELDS_ERROR}}var DateTimePicker_styled_templateObject_1,arrow_sea600=__webpack_require__("./app/assets/icons/arrow-sea600.svg"),ic_checked=__webpack_require__("./app/assets/icons/checkboxes/ic_checked.svg"),ic_indeterminate=__webpack_require__("./app/assets/icons/checkboxes/ic_indeterminate.svg"),ic_unchecked=__webpack_require__("./app/assets/icons/checkboxes/ic_unchecked.svg"),exclamation_circle=__webpack_require__("./app/assets/icons/exclamation-circle.svg"),icon_alert_info_filled=__webpack_require__("./app/assets/icons/icon_alert_info_filled.svg"),DateTimePicker_styled_dateRangePopperStyle=(0,emotion_react_browser_esm.AH)(DateTimePicker_styled_templateObject_1||(DateTimePicker_styled_templateObject_1=(0,tslib_es6.ue)(["\n  .react-datepicker {\n    font-size: 14px;\n    border-radius: 0;\n    border: 1px solid ",";\n  }\n\n  .react-datepicker__header {\n    background: none;\n    border-bottom: none;\n  }\n\n  .react-datepicker__navigation {\n    top: 0.6rem;\n  }\n\n  .react-datepicker__month-container {\n    padding: 0.3rem 0.3rem 1rem;\n  }\n\n  .react-datepicker__month {\n    margin: 0;\n  }\n\n  .react-datepicker__current-month {\n    margin-bottom: 0.8rem;\n  }\n\n  .react-datepicker__day-name {\n    color: #3d5560;\n    font-weight: ",";\n    font-size: 12px;\n  }\n\n  .react-datepicker__day--selected,\n  .react-datepicker__day--in-selecting-range,\n  .react-datepicker__day--in-range,\n  .react-datepicker__month-text--selected,\n  .react-datepicker__month-text--in-selecting-range,\n  .react-datepicker__month-text--in-range,\n  .react-datepicker__quarter-text--selected,\n  .react-datepicker__quarter-text--in-selecting-range,\n  .react-datepicker__quarter-text--in-range,\n  .react-datepicker__year-text--selected,\n  .react-datepicker__year-text--in-selecting-range,\n  .react-datepicker__year-text--in-range {\n    background: ",";\n    color: #000;\n  }\n\n  .react-datepicker__day--selected,\n  .react-datepicker__day--in-selecting-range:hover {\n    background: ",";\n    color: ",";\n  }\n\n  .react-datepicker__day--selected:hover,\n  .react-datepicker__day--in-range:hover {\n    background: ",";\n  }\n\n  .react-datepicker__day--in-selecting-range:not(.react-datepicker__day--in-range) {\n    background: ",";\n  }\n\n  .react-datepicker__navigation-icon::before {\n    border-color: #000;\n  }\n\n  .react-datepicker__triangle {\n    display: none;\n  }\n\n  .react-datepicker__time-container\n    .react-datepicker__time\n    .react-datepicker__time-box\n    ul.react-datepicker__time-list\n    li.react-datepicker__time-list-item--selected {\n    background-color: ",";\n    color: white;\n    font-weight: ",";\n  }\n  .react-datepicker__time-container\n    .react-datepicker__time\n    .react-datepicker__time-box\n    ul.react-datepicker__time-list\n    li.react-datepicker__time-list-item--selected:hover {\n    background-color: ",";\n  }\n"],["\n  .react-datepicker {\n    font-size: 14px;\n    border-radius: 0;\n    border: 1px solid ",";\n  }\n\n  .react-datepicker__header {\n    background: none;\n    border-bottom: none;\n  }\n\n  .react-datepicker__navigation {\n    top: 0.6rem;\n  }\n\n  .react-datepicker__month-container {\n    padding: 0.3rem 0.3rem 1rem;\n  }\n\n  .react-datepicker__month {\n    margin: 0;\n  }\n\n  .react-datepicker__current-month {\n    margin-bottom: 0.8rem;\n  }\n\n  .react-datepicker__day-name {\n    color: #3d5560;\n    font-weight: ",";\n    font-size: 12px;\n  }\n\n  .react-datepicker__day--selected,\n  .react-datepicker__day--in-selecting-range,\n  .react-datepicker__day--in-range,\n  .react-datepicker__month-text--selected,\n  .react-datepicker__month-text--in-selecting-range,\n  .react-datepicker__month-text--in-range,\n  .react-datepicker__quarter-text--selected,\n  .react-datepicker__quarter-text--in-selecting-range,\n  .react-datepicker__quarter-text--in-range,\n  .react-datepicker__year-text--selected,\n  .react-datepicker__year-text--in-selecting-range,\n  .react-datepicker__year-text--in-range {\n    background: ",";\n    color: #000;\n  }\n\n  .react-datepicker__day--selected,\n  .react-datepicker__day--in-selecting-range:hover {\n    background: ",";\n    color: ",";\n  }\n\n  .react-datepicker__day--selected:hover,\n  .react-datepicker__day--in-range:hover {\n    background: ",";\n  }\n\n  .react-datepicker__day--in-selecting-range:not(.react-datepicker__day--in-range) {\n    background: ",";\n  }\n\n  .react-datepicker__navigation-icon::before {\n    border-color: #000;\n  }\n\n  .react-datepicker__triangle {\n    display: none;\n  }\n\n  .react-datepicker__time-container\n    .react-datepicker__time\n    .react-datepicker__time-box\n    ul.react-datepicker__time-list\n    li.react-datepicker__time-list-item--selected {\n    background-color: ",";\n    color: white;\n    font-weight: ",";\n  }\n  .react-datepicker__time-container\n    .react-datepicker__time\n    .react-datepicker__time-box\n    ul.react-datepicker__time-list\n    li.react-datepicker__time-list-item--selected:hover {\n    background-color: ",";\n  }\n"])),styles_constants.Tj.form.greyBorder,styles_constants.Wy.medium,styles_constants.Tj.forest700,styles_constants.Tj.forest700,styles_constants.Tj.white,styles_constants.Tj.forest700,styles_constants.Tj.forest200,styles_constants.Tj.forest700,styles_constants.Wy.medium,styles_constants.Tj.forest700),react_datepicker_min=__webpack_require__("./node_modules/react-datepicker/dist/react-datepicker.min.js"),react_datepicker_min_default=__webpack_require__.n(react_datepicker_min),DateTimePickerInput=function(props){var _a;return(0,emotion_react_jsx_runtime_browser_esm.Y)(Input.Ay,(0,tslib_es6.Cl)({},props,{readOnly:!0,autoComplete:"off",errorMessage:void 0,onChange:void 0,value:null===(_a=props.value)||void 0===_a?void 0:_a.toString()}))},DateTimePicker_DateTimePicker=function(props){var isValidDate=react.useCallback((function(date){var current=moment_moment(date);return!props.disableWeekends||0!==current.day()&&6!==current.day()}),[props.disableWeekends]),renderErrors=react.useCallback((function(){if(props.errorMessage)return(0,emotion_react_jsx_runtime_browser_esm.Y)(components_FormError,{children:props.errorMessage})}),[props.errorMessage]),onChange=react.useCallback((function(date){var momentDate=moment_moment(date);return props.onChange(momentDate)}),[props.onChange]),isValidValue=react.useMemo((function(){return moment_moment(props.value).isValid()}),[props.value]),momentDate=react.useMemo((function(){return isValidValue?moment_moment(props.value):moment_moment()}),[props.value]),onKeyDown=(0,react.useCallback)((function(e){e.key===keys.D.Tab&&e.stopPropagation()}),[]);return(0,emotion_react_jsx_runtime_browser_esm.FD)("div",{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(react_datepicker_min_default(),{id:props.id,onKeyDown,wrapperClassName:props.wrapperClassName,showTimeSelect:props.hasTime,minDate:props.disablePastDates?new Date:props.minDate?moment_moment(props.minDate).toDate():null,maxDate:props.dateLimit?moment_moment(props.dateLimit).toDate():null,onChange,selected:isValidValue?momentDate.toDate():void 0,disabled:props.disabled,customInput:props.input||(0,emotion_react_jsx_runtime_browser_esm.Y)(DateTimePickerInput,(0,tslib_es6.Cl)({},props)),filterDate:isValidDate,placeholderText:props.placeholder,popperClassName:DateTimePicker_styled_dateRangePopperStyle,className:props.className,autoComplete:"off"}),renderErrors()]})},DateTimePickerField=function(props){var input=props.input,meta=props.meta,invalid=meta&&meta.touched&&meta.error,requiredDatePickerProperties={errorMessage:invalid?meta.error:null,id:props.id,name:props.name,label:props.label,labelProps:props.labelProps,disablePastDates:props.disablePastDates,disableWeekends:props.disableWeekends,dateLimit:props.dateLimit},date=react.useMemo((function(){return moment_moment(input.value)}),[input.value]),onDateChange=react.useCallback((function(date){input.onChange(date.toString())}),[input.onChange]);return(0,emotion_react_jsx_runtime_browser_esm.Y)(DateTimePicker_DateTimePicker,(0,tslib_es6.Cl)({value:date,onChange:onDateChange},requiredDatePickerProperties,{tabIndex:props.tabIndex,dataAnalytics:props.dataAnalytics,dataPendo:props.dataPendo,dataTestid:props.dataTestid,invalid}))};var Typography_templateObject_1,Typography_templateObject_2,Typography_templateObject_3,Typography_templateObject_4,Typography_templateObject_5,Typography_templateObject_6,Typography_templateObject_7,Typography_templateObject_8,CarrierFormType,CarrierFormEventType,TabbedCarrierFormName,ServiceLevelsIsHidden,components_Link_Link=__webpack_require__("./app/components/Link/Link.tsx"),typographyBaseCss=(__webpack_require__("./app/assets/icons/icon_error.svg"),(0,emotion_react_browser_esm.AH)(Typography_templateObject_1||(Typography_templateObject_1=(0,tslib_es6.ue)(["\n  font-family: inherit, serif;\n  font-style: normal;\n  color: ",";\n  padding: 0;\n  margin: 0;\n"],["\n  font-family: inherit, serif;\n  font-style: normal;\n  color: ",";\n  padding: 0;\n  margin: 0;\n"])),styles_constants.Tj.gray1000)),overrideCss=function(props){var color=props.color,fontSize=props.fontSize,lineHeight=props.lineHeight;return(0,emotion_react_browser_esm.AH)(Typography_templateObject_2||(Typography_templateObject_2=(0,tslib_es6.ue)(["\n    ","\n    ","\n    ","\n  "],["\n    ","\n    ","\n    ","\n  "])),color?"color: ".concat(color,";"):"",fontSize?"font-size: ".concat(fontSize,";"):"",lineHeight?"line-height: ".concat(lineHeight,";"):"")},Body=(emotion_styled_browser_esm.A.h4(Typography_templateObject_3||(Typography_templateObject_3=(0,tslib_es6.ue)(["\n  ","\n  font-weight: ",";\n  font-size: 16px;\n  line-height: 24px;\n  ","\n"],["\n  ","\n  font-weight: ",";\n  font-size: 16px;\n  line-height: 24px;\n  ","\n"])),typographyBaseCss,styles_constants.Wy.normal,(function(props){return overrideCss(props)})),emotion_styled_browser_esm.A.p(Typography_templateObject_4||(Typography_templateObject_4=(0,tslib_es6.ue)(["\n  ","\n  font-weight: ",";\n  font-size: 14px;\n  line-height: 24px;\n  ","\n"],["\n  ","\n  font-weight: ",";\n  font-size: 14px;\n  line-height: 24px;\n  ","\n"])),typographyBaseCss,styles_constants.Wy.normal,(function(props){return overrideCss(props)}))),getCarrierFormFieldsStore=(emotion_styled_browser_esm.A.p(Typography_templateObject_5||(Typography_templateObject_5=(0,tslib_es6.ue)(["\n  ","\n  font-weight: ",";\n  font-size: 12px;\n  line-height: 20px;\n  ","\n"],["\n  ","\n  font-weight: ",";\n  font-size: 12px;\n  line-height: 20px;\n  ","\n"])),typographyBaseCss,styles_constants.Wy.normal,(function(props){return overrideCss(props)})),emotion_styled_browser_esm.A.div(Typography_templateObject_6||(Typography_templateObject_6=(0,tslib_es6.ue)(["\n  margin-top: -8px;\n\n  & > * {\n    margin-top: 8px;\n  }\n"],["\n  margin-top: -8px;\n\n  & > * {\n    margin-top: 8px;\n  }\n"]))),emotion_styled_browser_esm.A.div(Typography_templateObject_7||(Typography_templateObject_7=(0,tslib_es6.ue)(["\n  display: flex;\n  align-items: center;\n"],["\n  display: flex;\n  align-items: center;\n"]))),emotion_styled_browser_esm.A.img(Typography_templateObject_8||(Typography_templateObject_8=(0,tslib_es6.ue)(["\n  width: 16px;\n  height: 16px;\n  margin-right: 12px;\n"],["\n  width: 16px;\n  height: 16px;\n  margin-right: 12px;\n"]))),function(state){return state.carrierFormFields}),getCarrierFormFields=(0,reselect_es.createSelector)(getCarrierFormFieldsStore,(function(carrierFormFieldsStore){return carrierFormFieldsStore.carrierFormFields})),getIsFetchingCarrierFormFields=(0,reselect_es.createSelector)(getCarrierFormFieldsStore,(function(carrierFormFieldsStore){return carrierFormFieldsStore.isFetchingCarrierFormFields})),getCarrierFormFieldsErrorMessage=(0,reselect_es.createSelector)(getCarrierFormFieldsStore,(function(carrierFormFieldsStore){return carrierFormFieldsStore.errorMessage})),getCarrierFormFieldValidations=(0,reselect_es.createSelector)(getCarrierFormFieldsStore,(function(carrierFormFieldsStore){return carrierFormFieldsStore.carrierFormFieldValidations})),upsEditParameters=[{rank:5,key:"account_number",label:"UPS Account Number",placeholderText:null,fieldType:"string",displayType:"show",minLength:null,maxLength:6,isRequired:!0,helpUrl:null,disabled:!0},{rank:10,key:"cost_center",label:"Mail Innovations Cost Center",placeholderText:null,fieldType:"string",displayType:"show",minLength:null,maxLength:20,isRequired:!1,helpUrl:null,tooltip:"An identifier that UPS Mail Innovations assigned to your account."},{rank:15,key:"usps_endorsement",label:"USPS Endorsement",placeholderText:null,fieldType:"choice",displayType:"show",minLength:null,maxLength:null,isRequired:!1,helpUrl:null,options:[{value:1,label:"Return Service Requested (1)"},{value:2,label:"Forwarding Service Requested (2)"},{value:3,label:"Address Service Requested (3)"},{value:4,label:"Change Service Requested (4)"},{value:5,label:"No Service Selected (5)"}],hiddenByKey:"cost_center",hiddenByValue:void 0,tooltip:"Specify how USPS, the last-mile carrier for UPS Mail Innovations, should handle non-deliverable packages."},{rank:20,key:"surepost",label:"Activate UPS Surepost",placeholderText:null,fieldType:"boolean",displayType:"show",minLength:null,maxLength:null,isRequired:!1,helpUrl:null,tooltip:"Activate this field if your account supports UPS Surepost. This needs to be explicitly enabled by UPS."}],eBayCanadaPostConnectParameters=[{rank:20,key:"customer_number",label:"Canada Post Customer Number",placeholderText:null,fieldType:"string",displayType:"show",minLength:null,maxLength:10,isRequired:!0,helpUrl:null},{rank:40,key:"postal_zip_code",label:"Zip / Postal Code",placeholderText:null,fieldType:"string",displayType:"show",minLength:null,maxLength:10,isRequired:!0,helpUrl:null}],canadaPostParameters=[{rank:20,key:"customer_number",label:"Canada Post Customer Number",placeholderText:null,fieldType:"string",displayType:"show",minLength:null,maxLength:10,isRequired:!0,helpUrl:null},{rank:40,key:"account_id",label:"API Username",placeholderText:null,fieldType:"string",displayType:"show",minLength:null,maxLength:16,isRequired:!0,helpUrl:"https://support.goshippo.com/hc/en-us/articles/201772755-Where-do-I-get-my-Canada-Post-API-username-and-password-"},{rank:60,key:"api_password",label:"API Password",placeholderText:null,fieldType:"string",displayType:"show",minLength:null,maxLength:22,isRequired:!0,helpUrl:null},{rank:80,key:"contract_id",label:"Contract ID (optional)",placeholderText:null,fieldType:"string",displayType:"show",minLength:null,maxLength:10,isRequired:!1,helpUrl:null},{rank:100,key:"payment_method",label:"Payment Method",placeholderText:null,fieldType:"choice",displayType:"show",minLength:null,maxLength:null,isRequired:!0,helpUrl:null,options:[{value:"CreditCard",label:"Credit Card"},{value:"Account",label:"Bill Account"}],defaultValue:"CreditCard"},{rank:120,key:"use_manifests",label:"Use Manifests",placeholderText:null,fieldType:"boolean",displayType:"show",minLength:null,maxLength:null,isRequired:!1,helpUrl:null}],lasershipParameters=[{rank:20,key:"account_id",label:"Lasership API Key",placeholderText:null,fieldType:"string",displayType:"mask",minLength:null,maxLength:255,isRequired:!0,helpUrl:null},{rank:40,key:"lasership_apiid",label:"API ID",placeholderText:null,fieldType:"string",displayType:"show",minLength:null,maxLength:255,isRequired:!0,helpUrl:null},{rank:60,key:"critical_pull_time",label:"Critical Pull Time",placeholderText:"HH:MM 24-hour time format",fieldType:"military_time",displayType:"show",minLength:null,maxLength:null,isRequired:!0,helpUrl:null},{rank:80,key:"default_customer_branch",label:"Default Customer Branch",placeholderText:null,fieldType:"string",displayType:"show",minLength:null,maxLength:255,isRequired:!1,helpUrl:null}],dhlExpressParameters=[{rank:20,key:"account_id",label:"DHL Express Account Number",placeholderText:null,fieldType:"string",displayType:"show_partial",minLength:null,maxLength:10,isRequired:!0,helpUrl:null},{rank:30,key:"site_id",label:"Site ID",placeholderText:null,fieldType:"string",displayType:"show_partial",minLength:6,maxLength:20,isRequired:!0,helpUrl:"https://support.goshippo.com/hc/en-us/articles/4409158652571"},{rank:40,key:"password",label:"Password",placeholderText:null,fieldType:"string",displayType:"mask",minLength:8,maxLength:20,isRequired:!0,helpUrl:null},{rank:60,key:"payment_country",label:"Registered Country",placeholderText:null,fieldType:"choice",displayType:"show",minLength:null,maxLength:null,isRequired:!0,helpUrl:null,options:(0,Address.b8)()}],AUSPOST_MYPOST_OPTIONS=[{value:"is_mypost",label:"MyPost (under 1,000 labels per year)"},{value:"is_eparcel",label:"eParcel (1,000+ labels a year)"}],UPS_REGISTRATION_COUNTRIES=[{value:"AR",label:"Argentina"},{value:"AU",label:"Australia"},{value:"AT",label:"Austria"},{value:"BE",label:"Belgium"},{value:"BR",label:"Brazil"},{value:"CA",label:"Canada"},{value:"CL",label:"Chile"},{value:"CN",label:"China"},{value:"CR",label:"Costa Rica"},{value:"CZ",label:"Czech Republic"},{value:"DK",label:"Denmark"},{value:"DO",label:"Dominican Republic"},{value:"EC",label:"Ecuador"},{value:"FI",label:"Finland"},{value:"FR",label:"France"},{value:"DE",label:"Germany"},{value:"GR",label:"Greece"},{value:"GT",label:"Guatemala"},{value:"GG",label:"Guernsey"},{value:"HK",label:"Hong Kong"},{value:"HU",label:"Hungary"},{value:"IN",label:"India"},{value:"ID",label:"Indonesia"},{value:"IE",label:"Ireland"},{value:"IL",label:"Israel"},{value:"IT",label:"Italy"},{value:"JP",label:"Japan"},{value:"JE",label:"Jersey"},{value:"KR",label:"Korea, Republic of"},{value:"MO",label:"Macao"},{value:"MY",label:"Malaysia"},{value:"MX",label:"Mexico"},{value:"NL",label:"Netherlands"},{value:"NZ",label:"New Zealand"},{value:"NO",label:"Norway"},{value:"PA",label:"Panama"},{value:"PH",label:"Philippines"},{value:"PL",label:"Poland"},{value:"PT",label:"Portugal"},{value:"PR",label:"Puerto Rico"},{value:"RO",label:"Romania"},{value:"RU",label:"Russian Federation"},{value:"SG",label:"Singapore"},{value:"ES",label:"Spain"},{value:"SE",label:"Sweden"},{value:"CH",label:"Switzerland"},{value:"TW",label:"Taiwan, Province of China"},{value:"TH",label:"Thailand"},{value:"TR",label:"Turkey"},{value:"AE",label:"United Arab Emirates"},{value:"GB",label:"United Kingdom"},{value:"US",label:"United States"},{value:"VN",label:"Viet Nam"}],parametersMap={ups:{create:null,edit:upsEditParameters,connect:[{rank:10,key:"full_name",label:"Full Name",placeholderText:null,fieldType:"string",displayType:"show",minLength:null,maxLength:20,isRequired:!0,helpUrl:null},{rank:15,key:"title",label:"Title",placeholderText:"Your title (e.g. Doctor, Artist, Manager, ...)",fieldType:"string",displayType:"show",minLength:null,maxLength:20,isRequired:!0,helpUrl:null},{rank:20,key:"company",label:"Company",placeholderText:"If you don't have a company please fill with your full name",fieldType:"string",displayType:"show",minLength:null,maxLength:30,isRequired:!0,helpUrl:null},{rank:25,key:"email",label:"Email",placeholderText:null,fieldType:"string",displayType:"show",minLength:null,maxLength:50,isRequired:!0,helpUrl:null},{rank:30,key:"phone",label:"Phone",placeholderText:null,fieldType:"string",displayType:"show",minLength:null,maxLength:30,isRequired:!0,helpUrl:null},{rank:35,key:"billing_address_street1",label:"Street (1)",placeholderText:null,fieldType:"string",displayType:"show",minLength:null,maxLength:30,isRequired:!0,helpUrl:null},{rank:40,key:"billing_address_street2",label:"Street (2)",placeholderText:"Apartment, suit, unit, floor, etc.",fieldType:"string",displayType:"show",minLength:null,maxLength:50,isRequired:!1,helpUrl:null},{rank:50,key:"billing_address_city",label:"City",placeholderText:null,fieldType:"string",displayType:"show",minLength:null,maxLength:30,isRequired:!0,helpUrl:null},{rank:55,key:"billing_address_state",label:"State (required for USA and Canada)",placeholderText:"Use official code for other countries if applicable",fieldType:"string",displayType:"show",minLength:null,maxLength:20,isRequired:!1,helpUrl:null},{rank:60,key:"billing_address_zip",label:"Zip / Postal Code",placeholderText:null,fieldType:"string",displayType:"show",minLength:null,maxLength:10,isRequired:!0,helpUrl:null},{rank:65,key:"billing_address_country_iso2",label:"Country",placeholderText:null,fieldType:"choice",displayType:"show",minLength:null,maxLength:null,isRequired:!0,helpUrl:null,options:UPS_REGISTRATION_COUNTRIES},{rank:70,key:"account_number",label:"UPS Account Number",placeholderText:null,fieldType:"string",displayType:"show",minLength:null,maxLength:20,isRequired:!0,helpUrl:null},{rank:80,key:"collec_zip",label:"Postcode (collection location)",placeholderText:null,fieldType:"string",displayType:"show",minLength:null,maxLength:10,isRequired:!0,helpUrl:null},{rank:85,key:"collec_country_iso2",label:"Country",placeholderText:null,fieldType:"choice",displayType:"show",minLength:null,maxLength:null,isRequired:!0,helpUrl:null,options:UPS_REGISTRATION_COUNTRIES},{rank:90,key:"has_invoice",label:'<b>Show personalized rates (requires latest invoice).</b><br />If disabled, you\'ll only see retail rates. <a style="color: #226015" href="https://support.goshippo.com/hc/en-us/articles/204781715-How-to-Connect-Your-UPS-Account-in-Shippo#h_877e2e40-64ad-4051-95fc-ea3b5afe6a4a">Learn more</a>',placeholderText:null,fieldType:"boolean",displayType:"show",minLength:null,maxLength:null,isRequired:!1,helpUrl:null,defaultValue:!1},{rank:95,key:"invoice_number",label:"Invoice Number",placeholderText:"Invoice number of a Regular account",fieldType:"string",displayType:"show",minLength:null,maxLength:30,isRequired:!0,helpUrl:null,hiddenByKey:"has_invoice",hiddenByValue:!1},{rank:100,key:"currency_code",label:"Currency Code",placeholderText:null,fieldType:"choice",displayType:"show",minLength:null,maxLength:null,isRequired:!0,helpUrl:null,options:[{value:"AED",label:"AED - United Arab Emirates Dirham"},{value:"AFN",label:"AFN - Afghan Afghani"},{value:"ALL",label:"ALL - Albanian Lek"},{value:"AMD",label:"AMD - Armenian Dram"},{value:"ANG",label:"ANG - Netherlands Antillean Guilder"},{value:"AOA",label:"AOA - Angolan Kwanza"},{value:"ARS",label:"ARS - Argentine Peso"},{value:"AUD",label:"AUD - Australian Dollar"},{value:"AWG",label:"AWG - Aruban Florin"},{value:"AZN",label:"AZN - Azerbaijani Manat"},{value:"BAM",label:"BAM - Bosnia-Herzegovina Convertible Mark"},{value:"BBD",label:"BBD - Barbadian Dollar"},{value:"BDT",label:"BDT - Bangladeshi Taka"},{value:"BGN",label:"BGN - Bulgarian Lev"},{value:"BHD",label:"BHD - Bahraini Dinar"},{value:"BIF",label:"BIF - Burundian Franc"},{value:"BMD",label:"BMD - Bermudan Dollar"},{value:"BND",label:"BND - Brunei Dollar"},{value:"BOB",label:"BOB - Bolivian Boliviano"},{value:"BRL",label:"BRL - Brazilian Real"},{value:"BSD",label:"BSD - Bahamian Dollar"},{value:"BTN",label:"BTN - Bhutanese Ngultrum"},{value:"BWP",label:"BWP - Botswanan Pula"},{value:"BYR",label:"BYR - Belarusian Ruble"},{value:"BZD",label:"BZD - Belize Dollar"},{value:"CAD",label:"CAD - Canadian Dollar"},{value:"CDF",label:"CDF - Congolese Franc"},{value:"CHF",label:"CHF - Swiss Franc"},{value:"CLF",label:"CLF - Chilean Unit of Account (UF)"},{value:"CLP",label:"CLP - Chilean Peso"},{value:"COP",label:"COP - Colombian Peso"},{value:"CRC",label:"CRC - Costa Rican Colón"},{value:"CUP",label:"CUP - Cuban Peso"},{value:"CVE",label:"CVE - Cape Verdean Escudo"},{value:"CZK",label:"CZK - Czech Republic Koruna"},{value:"DJF",label:"DJF - Djiboutian Franc"},{value:"DKK",label:"DKK - Danish Krone"},{value:"DOP",label:"DOP - Dominican Peso"},{value:"DZD",label:"DZD - Algerian Dinar"},{value:"EGP",label:"EGP - Egyptian Pound"},{value:"ERN",label:"ERN - Eritrean Nakfa"},{value:"ETB",label:"ETB - Ethiopian Birr"},{value:"EUR",label:"EUR - Euro"},{value:"FJD",label:"FJD - Fijian Dollar"},{value:"FKP",label:"FKP - Falkland Islands Pound"},{value:"GBP",label:"GBP - British Pound Sterling"},{value:"GEL",label:"GEL - Georgian Lari"},{value:"GHS",label:"GHS - Ghanaian Cedi"},{value:"GIP",label:"GIP - Gibraltar Pound"},{value:"GMD",label:"GMD - Gambian Dalasi"},{value:"GNF",label:"GNF - Guinean Franc"},{value:"GTQ",label:"GTQ - Guatemalan Quetzal"},{value:"GYD",label:"GYD - Guyanaese Dollar"},{value:"HKD",label:"HKD - Hong Kong Dollar"},{value:"HNL",label:"HNL - Honduran Lempira"},{value:"HRK",label:"HRK - Croatian Kuna"},{value:"HTG",label:"HTG - Haitian Gourde"},{value:"HUF",label:"HUF - Hungarian Forint"},{value:"IDR",label:"IDR - Indonesian Rupiah"},{value:"ILS",label:"ILS - Israeli New Sheqel"},{value:"INR",label:"INR - Indian Rupee"},{value:"IQD",label:"IQD - Iraqi Dinar"},{value:"IRR",label:"IRR - Iranian Rial"},{value:"ISK",label:"ISK - Icelandic Króna"},{value:"JMD",label:"JMD - Jamaican Dollar"},{value:"JOD",label:"JOD - Jordanian Dinar"},{value:"JPY",label:"JPY - Japanese Yen"},{value:"KES",label:"KES - Kenyan Shilling"},{value:"KGS",label:"KGS - Kyrgystani Som"},{value:"KHR",label:"KHR - Cambodian Riel"},{value:"KMF",label:"KMF - Comorian Franc"},{value:"KPW",label:"KPW - North Korean Won"},{value:"KRW",label:"KRW - South Korean Won"},{value:"KWD",label:"KWD - Kuwaiti Dinar"},{value:"KYD",label:"KYD - Cayman Islands Dollar"},{value:"KZT",label:"KZT - Kazakhstani Tenge"},{value:"LAK",label:"LAK - Laotian Kip"},{value:"LBP",label:"LBP - Lebanese Pound"},{value:"LKR",label:"LKR - Sri Lankan Rupee"},{value:"LRD",label:"LRD - Liberian Dollar"},{value:"LSL",label:"LSL - Lesotho Loti"},{value:"LYD",label:"LYD - Libyan Dinar"},{value:"MAD",label:"MAD - Moroccan Dirham"},{value:"MDL",label:"MDL - Moldovan Leu"},{value:"MGA",label:"MGA - Malagasy Ariary"},{value:"MKD",label:"MKD - Macedonian Denar"},{value:"MMK",label:"MMK - Myanma Kyat"},{value:"MNT",label:"MNT - Mongolian Tugrik"},{value:"MOP",label:"MOP - Macanese Pataca"},{value:"MRO",label:"MRO - Mauritanian Ouguiya"},{value:"MUR",label:"MUR - Mauritian Rupee"},{value:"MVR",label:"MVR - Maldivian Rufiyaa"},{value:"MWK",label:"MWK - Malawian Kwacha"},{value:"MXN",label:"MXN - Mexican Peso"},{value:"MYR",label:"MYR - Malaysian Ringgit"},{value:"MZN",label:"MZN - Mozambican Metical"},{value:"NAD",label:"NAD - Namibian Dollar"},{value:"NGN",label:"NGN - Nigerian Naira"},{value:"NIO",label:"NIO - Nicaraguan Córdoba"},{value:"NOK",label:"NOK - Norwegian Krone"},{value:"NPR",label:"NPR - Nepalese Rupee"},{value:"NZD",label:"NZD - New Zealand Dollar"},{value:"OMR",label:"OMR - Omani Rial"},{value:"PAB",label:"PAB - Panamanian Balboa"},{value:"PEN",label:"PEN - Peruvian Nuevo Sol"},{value:"PGK",label:"PGK - Papua New Guinean Kina"},{value:"PHP",label:"PHP - Philippine Peso"},{value:"PKR",label:"PKR - Pakistani Rupee"},{value:"PLN",label:"PLN - Polish Zloty"},{value:"PYG",label:"PYG - Paraguayan Guarani"},{value:"QAR",label:"QAR - Qatari Rial"},{value:"RMB",label:"RMB - Chinese Yuan Renminbi"},{value:"RON",label:"RON - Romanian Leu"},{value:"RSD",label:"RSD - Serbian Dinar"},{value:"RUB",label:"RUB - Russian Ruble"},{value:"RWF",label:"RWF - Rwandan Franc"},{value:"SAR",label:"SAR - Saudi Riyal"},{value:"SBD",label:"SBD - Solomon Islands Dollar"},{value:"SCR",label:"SCR - Seychellois Rupee"},{value:"SEK",label:"SEK - Swedish Krona"},{value:"SGD",label:"SGD - Singapore Dollar"},{value:"SHP",label:"SHP - Saint Helena Pound"},{value:"SLL",label:"SLL - Sierra Leonean Leone"},{value:"SOS",label:"SOS - Somali Shilling"},{value:"SRD",label:"SRD - Surinamese Dollar"},{value:"STD",label:"STD - São Tomé and Príncipe Dobra"},{value:"SVC",label:"SVC - Salvadoran Colón"},{value:"SYP",label:"SYP - Syrian Pound"},{value:"SZL",label:"SZL - Swazi Lilangeni"},{value:"THB",label:"THB - Thai Baht"},{value:"TJS",label:"TJS - Tajikistani Somoni"},{value:"TND",label:"TND - Tunisian Dinar"},{value:"TOP",label:"TOP - Tongan Pa´anga"},{value:"TRY",label:"TRY - Turkish Lira"},{value:"TTD",label:"TTD - Trinidad and Tobago Dollar"},{value:"TWD",label:"TWD - New Taiwan Dollar"},{value:"TZS",label:"TZS - Tanzanian Shilling"},{value:"UAH",label:"UAH - Ukrainian Hryvnia"},{value:"UGX",label:"UGX - Ugandan Shilling"},{value:"USD",label:"USD - United States Dollar"},{value:"UYU",label:"UYU - Uruguayan Peso"},{value:"UZS",label:"UZS - Uzbekistan Som"},{value:"VND",label:"VND - Vietnamese Dong"},{value:"VUV",label:"VUV - Vanuatu Vatu"},{value:"WST",label:"WST - Samoan Tala"},{value:"XAF",label:"XAF - CFA Franc BEAC"},{value:"XCD",label:"XCD - East Caribbean Dollar"},{value:"XOF",label:"XOF - CFA Franc BCEAO"},{value:"XPF",label:"XPF - CFP Franc"},{value:"YER",label:"YER - Yemeni Rial"},{value:"ZAR",label:"ZAR - South African Rand"},{value:"ZMK",label:"ZMK - Zambian Kwacha (pre-2013)"}],hiddenByKey:"has_invoice",hiddenByValue:!1},{rank:105,key:"invoice_value",label:"Charges This Period",placeholderText:null,fieldType:"string",displayType:"show",minLength:null,maxLength:30,isRequired:!0,helpUrl:null,hiddenByKey:"has_invoice",hiddenByValue:!1,tooltip:"Value of the invoice. Max of 16 digits before decimal and 2 digits after decimal."},{rank:110,key:"aia_country_iso2",label:"Country",placeholderText:"Country associated with the account that issued the invoice",fieldType:"choice",displayType:"show",minLength:null,maxLength:30,isRequired:!0,helpUrl:null,options:UPS_REGISTRATION_COUNTRIES,hiddenByKey:"has_invoice",hiddenByValue:!1},{rank:115,key:"invoice_date",label:"Invoice Date",placeholderText:null,fieldType:"date",displayType:"show",minLength:null,maxLength:null,isRequired:!0,helpUrl:null,hiddenByKey:"has_invoice",hiddenByValue:!1},{rank:120,key:"invoice_controlid",label:"Control ID (required for USA)",placeholderText:null,fieldType:"string",displayType:"show",minLength:null,maxLength:30,isRequired:!1,helpUrl:null,hiddenByKey:"has_invoice",hiddenByValue:!1},{rank:125,key:"ups_agreements",label:'By checking this box, you agree to the <a style="color: #226015" href="https://goshippo.com/external_registration/ups/technology_agreement">UPS Technology Agreement</a>',placeholderText:null,fieldType:"boolean",displayType:"show",minLength:null,maxLength:null,isRequired:!0,helpUrl:null}]},canada_post:{create:[{rank:10,key:"street_number",label:"Street #",placeholderText:null,fieldType:"string",displayType:"show",minLength:null,maxLength:10,isRequired:!0,helpUrl:null},{rank:20,key:"street",label:"Street",placeholderText:null,fieldType:"string",displayType:"show",minLength:null,maxLength:60,isRequired:!0,helpUrl:null},{rank:30,key:"unit_suite_apt",label:"Unit",placeholderText:null,fieldType:"string",displayType:"show",minLength:null,maxLength:10,isRequired:!1,helpUrl:null},{rank:40,key:"city",label:"City",placeholderText:null,fieldType:"string",displayType:"show",minLength:null,maxLength:40,isRequired:!0,helpUrl:null},{rank:50,key:"prov_state",label:"State / Province",placeholderText:"Enter a 2-letter state code",fieldType:"string",displayType:"show",minLength:null,maxLength:2,isRequired:!0,helpUrl:null},{rank:60,key:"postal_zip_code",label:"Zip / Postal Code",placeholderText:null,fieldType:"string",displayType:"show",minLength:null,maxLength:10,isRequired:!0,helpUrl:null},{rank:70,key:"country_code",label:"Country",placeholderText:null,fieldType:"choice",displayType:"show",minLength:null,maxLength:null,isRequired:!0,helpUrl:null,options:[{value:"CA",label:"Canada"},{value:"US",label:"United States"}]},{rank:80,key:"phone_number",label:"Phone",placeholderText:null,fieldType:"string",displayType:"show",minLength:null,maxLength:30,isRequired:!0,helpUrl:null},{rank:90,key:"legal_name",label:"Business Name",placeholderText:null,fieldType:"string",displayType:"show",minLength:null,maxLength:40,isRequired:!0,helpUrl:null},{rank:100,key:"canada_parcel_volume",label:"How many items do you ship monthly to Canada?",placeholderText:null,fieldType:"integer",displayType:"show",minLength:null,maxLength:7,isRequired:!1,helpUrl:null},{rank:110,key:"us_parcel_volume",label:"How many items do you ship monthly to United States?",placeholderText:null,fieldType:"integer",displayType:"show",minLength:null,maxLength:7,isRequired:!1,helpUrl:null},{rank:120,key:"international_parcel_volume",label:"How many items do you ship monthly to international countries?",placeholderText:null,fieldType:"integer",displayType:"show",minLength:null,maxLength:7,isRequired:!1,helpUrl:null},{rank:150,key:"canada_post_agreement",label:'By checking this box, you agree to the <a href="https://goshippo.com/partners_static/canada_post/terms/">Canada Post Shipping Service Agreement</a>',placeholderText:null,fieldType:"boolean",displayType:"show",minLength:null,maxLength:null,isRequired:!0,helpUrl:null,defaultValue:!0}],edit:canadaPostParameters,connect:canadaPostParameters},lasership:{create:lasershipParameters,edit:lasershipParameters,connect:lasershipParameters},dhl_express:{create:dhlExpressParameters,edit:dhlExpressParameters,connect:dhlExpressParameters}},isCarrierFormMocked=function(carrier,formType){return!(!parametersMap.hasOwnProperty(carrier)||!parametersMap[carrier][formType])},CarrierForm_SectionTitle=(0,emotion_styled_browser_esm.A)("header")(CarrierForm_templateObject_1||(CarrierForm_templateObject_1=(0,tslib_es6.ue)(["\n  font-size: 18px;\n  color: ",";\n  padding-bottom: 10px;\n  font-weight: ",";\n"],["\n  font-size: 18px;\n  color: ",";\n  padding-bottom: 10px;\n  font-weight: ",";\n"])),styles_constants.Tj.form.fontColor,styles_constants.Wy.medium),SectionBorder=(0,emotion_styled_browser_esm.A)("div")(CarrierForm_templateObject_2||(CarrierForm_templateObject_2=(0,tslib_es6.ue)(["\n  margin: 20px auto;\n  border: 0.5px solid ",";\n"],["\n  margin: 20px auto;\n  border: 0.5px solid ",";\n"])),styles_constants.Tj.gray50),CarrierFormModalBody=(0,emotion_styled_browser_esm.A)(Modal.A.Body)(CarrierForm_templateObject_3||(CarrierForm_templateObject_3=(0,tslib_es6.ue)(["\n  padding: "," "," 0.625rem;\n  line-height: 20px;\n  font-weight: ",";\n"],["\n  padding: "," "," 0.625rem;\n  line-height: 20px;\n  font-weight: ",";\n"])),"20px","32px",styles_constants.Wy.normal),StyledErrorMessage=(0,emotion_styled_browser_esm.A)("div")(CarrierForm_templateObject_4||(CarrierForm_templateObject_4=(0,tslib_es6.ue)(["\n  display: flex;\n  align-items: flex-start;\n  gap: 0.625rem;\n"],["\n  display: flex;\n  align-items: flex-start;\n  gap: 0.625rem;\n"]))),StyledAlertIcon=(0,emotion_styled_browser_esm.A)("i")(CarrierForm_templateObject_5||(CarrierForm_templateObject_5=(0,tslib_es6.ue)(["\n  color: ",";\n  vertical-align: middle;\n  font-size: 2em;\n  margin-right: 15px;\n"],["\n  color: ",";\n  vertical-align: middle;\n  font-size: 2em;\n  margin-right: 15px;\n"])),styles_constants.Tj.dangerRed),AgreementLabel=(0,emotion_styled_browser_esm.A)("span")(CarrierForm_templateObject_6||(CarrierForm_templateObject_6=(0,tslib_es6.ue)(["\n  a {\n    color: ",";\n  }\n"],["\n  a {\n    color: ",";\n  }\n"])),styles_constants.Tj.aqua),Centered=(0,emotion_styled_browser_esm.A)("div")(CarrierForm_templateObject_7||(CarrierForm_templateObject_7=(0,tslib_es6.ue)(["\n  text-align: center;\n  margin: 20px;\n"],["\n  text-align: center;\n  margin: 20px;\n"]))),TestCheckbox=(0,emotion_styled_browser_esm.A)(components_Checkbox.Y)(CarrierForm_templateObject_8||(CarrierForm_templateObject_8=(0,tslib_es6.ue)(["\n  margin-bottom: 4px;\n"],["\n  margin-bottom: 4px;\n"]))),TestLabel=(0,emotion_styled_browser_esm.A)("div")(CarrierForm_templateObject_9||(CarrierForm_templateObject_9=(0,tslib_es6.ue)(["\n  font-weight: ",";\n"],["\n  font-weight: ",";\n"])),styles_constants.Wy.medium),TestModeInfo=(0,emotion_styled_browser_esm.A)("div")(CarrierForm_templateObject_10||(CarrierForm_templateObject_10=(0,tslib_es6.ue)(["\n  color: ",";\n"],["\n  color: ",";\n"])),(function(props){return props.disabled?styles_constants.Tj.form.disabledLabelFontColor:styles_constants.Tj.form.labelFontColor})),TestHelpLink=(0,emotion_styled_browser_esm.A)(components_Link_Link.oJ)(CarrierForm_templateObject_11||(CarrierForm_templateObject_11=(0,tslib_es6.ue)(["\n  font-size: inherit;\n"],["\n  font-size: inherit;\n"]))),FedExAdvantageSection=(0,emotion_styled_browser_esm.A)("div")(CarrierForm_templateObject_12||(CarrierForm_templateObject_12=(0,tslib_es6.ue)(["\n  color: ",";\n"],["\n  color: ",";\n"])),(function(props){return props.disabled?styles_constants.Tj.form.disabledLabelFontColor:styles_constants.Tj.form.labelFontColor})),FedExAdvantageLink=(0,emotion_styled_browser_esm.A)(components_Link_Link.tp)(CarrierForm_templateObject_13||(CarrierForm_templateObject_13=(0,tslib_es6.ue)(["\n  font-size: inherit;\n"],["\n  font-size: inherit;\n"]))),Disclaimer=(0,emotion_styled_browser_esm.A)("div")(CarrierForm_templateObject_14||(CarrierForm_templateObject_14=(0,tslib_es6.ue)(["\n  line-height: 24px;\n  font-size: 14px;\n  color: ",";\n  padding-bottom: 10px;\n"],["\n  line-height: 24px;\n  font-size: 14px;\n  color: ",";\n  padding-bottom: 10px;\n"])),styles_constants.Tj.gray700),CarrierForm_Subtext=(0,emotion_styled_browser_esm.A)("div")(CarrierForm_templateObject_15||(CarrierForm_templateObject_15=(0,tslib_es6.ue)(["\n  color: ",";\n  font-size: 0.75rem;\n"],["\n  color: ",";\n  font-size: 0.75rem;\n"])),styles_constants.Tj.gray400),ServiceLevelsSection=(0,emotion_styled_browser_esm.A)("section")(CarrierForm_templateObject_16||(CarrierForm_templateObject_16=(0,tslib_es6.ue)(["\n  margin-bottom: 1rem;\n"],["\n  margin-bottom: 1rem;\n"]))),SectionSubtitle=(0,emotion_styled_browser_esm.A)("div")(CarrierForm_templateObject_17||(CarrierForm_templateObject_17=(0,tslib_es6.ue)(["\n  color: ",";\n  font-size: 0.875rem;\n  line-height: 1.25rem;\n  margin-bottom: 1.25rem;\n"],["\n  color: ",";\n  font-size: 0.875rem;\n  line-height: 1.25rem;\n  margin-bottom: 1.25rem;\n"])),styles_constants.Tj.gray700),ShowHideLabel=(0,emotion_styled_browser_esm.A)("div")(templateObject_18||(templateObject_18=(0,tslib_es6.ue)(["\n  font-weight: ",";\n  color: ",";\n"],["\n  font-weight: ",";\n  color: ",";\n"])),styles_constants.Wy.medium,styles_constants.Tj.gray400),ServiceLevelCheckbox=(0,emotion_styled_browser_esm.A)(components_Checkbox.Y)(templateObject_19||(templateObject_19=(0,tslib_es6.ue)(["\n  margin-bottom: 0.75rem;\n  margin-left: 0.25rem;\n"],["\n  margin-bottom: 0.75rem;\n  margin-left: 0.25rem;\n"]))),SelectAllToggleShowHide=(0,emotion_styled_browser_esm.A)("div")(templateObject_20||(templateObject_20=(0,tslib_es6.ue)(["\n  margin-bottom: 1rem;\n  display: flex;\n  gap: 0.3125rem;\n  cursor: pointer;\n"],["\n  margin-bottom: 1rem;\n  display: flex;\n  gap: 0.3125rem;\n  cursor: pointer;\n"]))),CarrierForm_Icon=(0,emotion_styled_browser_esm.A)("img")(templateObject_21||(templateObject_21=(0,tslib_es6.ue)(["\n  margin: 0 0.19rem;\n  vertical-align: middle;\n"],["\n  margin: 0 0.19rem;\n  vertical-align: middle;\n"]))),ViewMoreBtn=(0,emotion_styled_browser_esm.A)(components_Button.AL)(templateObject_22||(templateObject_22=(0,tslib_es6.ue)(["\n  font-weight: ",";\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  gap: 3px;\n  border: none;\n  width: 100%;\n"],["\n  font-weight: ",";\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  gap: 3px;\n  border: none;\n  width: 100%;\n"])),styles_constants.Wy.normal),ErrorHeader=(0,emotion_styled_browser_esm.A)("div")(templateObject_23||(templateObject_23=(0,tslib_es6.ue)(["\n  font-size: 0.8125rem;\n  font-weight: ",";\n  line-height: 1.25rem;\n  color: ",";\n  margin-bottom: 0.5rem;\n"],["\n  font-size: 0.8125rem;\n  font-weight: ",";\n  line-height: 1.25rem;\n  color: ",";\n  margin-bottom: 0.5rem;\n"])),styles_constants.Wy.medium,styles_constants.Tj.black),ErrorDetails=(0,emotion_styled_browser_esm.A)("div")(templateObject_24||(templateObject_24=(0,tslib_es6.ue)(["\n  font-size: 0.75rem;\n  font-weight: ",";\n  line-height: 1.25rem;\n  color: ",";\n"],["\n  font-size: 0.75rem;\n  font-weight: ",";\n  line-height: 1.25rem;\n  color: ",";\n"])),styles_constants.Wy.normal,styles_constants.Tj.black),AlertPanel=(0,emotion_styled_browser_esm.A)(InfoCard)(templateObject_25||(templateObject_25=(0,tslib_es6.ue)(["\n  background-color: ",";\n  border-color: ",";\n  border-radius: 3px;\n  font-size: 0.875rem;\n  margin-bottom: '0.5rem';\n  padding: 1rem 1rem 1rem 0.75rem;\n\n  @media only screen and (min-width: 1024px) {\n    border-radius: 3px;\n  }\n"],["\n  background-color: ",";\n  border-color: ",";\n  border-radius: 3px;\n  font-size: 0.875rem;\n  margin-bottom: '0.5rem';\n  padding: 1rem 1rem 1rem 0.75rem;\n\n  @media only screen and (min-width: 1024px) {\n    border-radius: 3px;\n  }\n"])),styles_constants.Tj.macaroni50,styles_constants.Tj.macaroni700);!function(CarrierFormType){CarrierFormType.Create="create",CarrierFormType.Connect="connect",CarrierFormType.Edit="edit"}(CarrierFormType||(CarrierFormType={})),function(CarrierFormEventType){CarrierFormEventType.Click="Click",CarrierFormEventType.Submit="Submit",CarrierFormEventType.Close="Close"}(CarrierFormEventType||(CarrierFormEventType={})),function(TabbedCarrierFormName){TabbedCarrierFormName.EbayCanadaPost="Ebay Canada Post",TabbedCarrierFormName.UpsMarketplace="UPS Marketplace"}(TabbedCarrierFormName||(TabbedCarrierFormName={})),function(ServiceLevelsIsHidden){ServiceLevelsIsHidden.Mix="mix",ServiceLevelsIsHidden.All="all",ServiceLevelsIsHidden.None="none"}(ServiceLevelsIsHidden||(ServiceLevelsIsHidden={}));var CarrierForm=function(_super){function CarrierForm(props){var _this=_super.call(this,props)||this;return _this.validateMetadataField=function(value){return value&&value.length>100?"Maximum length is ".concat(100," characters (currently ").concat(value.length,")"):void 0},_this.setValidations=function(parameters){var e_1,_a,mockedValidations={},validateIsRequired=function(value){return value?void 0:"Required"},validateMaxLength=function(max){return function(value){return value&&value.length>max?"Maximum length is ".concat(max," characters (currently ").concat(value.length,")"):void 0}},validateMinLength=function(min){return function(value){return value&&value.length<min?"Minimum length is ".concat(min," characters (currently ").concat(value.length,")"):void 0}},validateIntegerType=function(value){return value&&isNaN(Number(value))?"Must be a number":void 0},validateRegex=function(regex,errorFormat){return function(value){return value&&!regex.test(value)?"Must be in format ".concat(errorFormat):void 0}};try{for(var parameters_1=(0,tslib_es6.Ju)(parameters),parameters_1_1=parameters_1.next();!parameters_1_1.done;parameters_1_1=parameters_1.next()){var parameter=parameters_1_1.value,parameterValidations=[];"integer"===parameter.fieldType&&parameterValidations.push(validateIntegerType),parameter.isRequired&&parameterValidations.push(validateIsRequired),parameter.maxLength&&parameterValidations.push(validateMaxLength(parameter.maxLength)),parameter.minLength&&parameterValidations.push(validateMinLength(parameter.minLength)),"military_time"===parameter.fieldType&&parameterValidations.push(validateRegex(/^(2[0-3]|[0-1][\d]):[0-5][\d]$/,"HH:MM")),mockedValidations[parameter.key]=parameterValidations}}catch(e_1_1){e_1={error:e_1_1}}finally{try{parameters_1_1&&!parameters_1_1.done&&(_a=parameters_1.return)&&_a.call(parameters_1)}finally{if(e_1)throw e_1.error}}_this.setState({mockedValidations})},_this.handleClickedFedExAdvantageEvent=function(){_this.props.clickFedExAdvantageLink("CLICKED_FEDEX_ADVANTAGE_LINK")},_this.renderServiceLevelsErrorMessage=function(){var errors=_this.props.getServiceLevelsError;if(0!==errors.length)return(0,emotion_react_jsx_runtime_browser_esm.Y)(Message.Kw,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(StyledErrorMessage,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierForm_Icon,{src:exclamation_circle}),(0,emotion_react_jsx_runtime_browser_esm.FD)("div",{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(ErrorHeader,{children:"Some settings could not be saved."}),(0,emotion_react_jsx_runtime_browser_esm.Y)("ul",{children:errors.map((function(error){return(0,emotion_react_jsx_runtime_browser_esm.Y)("li",{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(ErrorDetails,{children:error})},error)}))})]})]})})},_this.renderFetchErrorMessage=function(){return""!==_this.props.fetchErrorMessage&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Message.Kw,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(StyledErrorMessage,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(StyledAlertIcon,{className:"fa fa-exclamation-circle"}),(0,emotion_react_jsx_runtime_browser_esm.Y)("strong",{children:_this.props.fetchErrorMessage})]})})},_this.renderApiOnlyMessage=function(){return(0,emotion_react_jsx_runtime_browser_esm.Y)(AlertPanel,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"flex"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Icon.Ay,{src:icon_alert_info_filled,alt:"",size:"16px",className:"mr-3"}),(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"leading-6"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(utils_translate.x6,{i18nKey:"carriers.form.serviceLevelsSection.apiOnlyMsg",components:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Link_Link.A,(0,tslib_es6.Cl)({href:"https://goshippo.com/docs/reference#carrier-accounts",color:"secondary"},{children:"_"}),(0,index_browser.Ak)()),(0,emotion_react_jsx_runtime_browser_esm.Y)(Link_Link.A,(0,tslib_es6.Cl)({href:"mailto:support@shippo.com",color:"secondary"},{children:"_"}),(0,index_browser.Ak)())]})}))]}))})},_this.renderErrorMessage=function(){return""!==_this.props.errorMessage&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Message.Kw,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(StyledErrorMessage,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(StyledAlertIcon,{className:"fa fa-exclamation-circle"}),(0,emotion_react_jsx_runtime_browser_esm.Y)("strong",{children:_this.props.errorMessage})]})})},_this.renderTestLabel=function(carrier){var _a=_this.props,disabled=_a.disabled,t=_a.t;return(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{name:"test",component:TestCheckbox,label:(0,emotion_react_jsx_runtime_browser_esm.Y)(TestLabel,{children:carriers.$k.includes(carrier.id)?t("carriers.form.enableActualTestAccount"):t("carriers.form.enableTestMode")}),responsive:!0,disabled,labelProps:{disabled},props:{dataTestid:"test-mode-checkbox"}}),(0,emotion_react_jsx_runtime_browser_esm.Y)(TestModeInfo,(0,tslib_es6.Cl)({disabled},{children:carriers.$k.includes(carrier.id)?t("carriers.form.actualTestAccount",{carrierName:carrier.name}):(0,emotion_react_jsx_runtime_browser_esm.FD)("span",{children:[t("carriers.form.testAccountInfo")," ",(0,emotion_react_jsx_runtime_browser_esm.Y)(TestHelpLink,(0,tslib_es6.Cl)({href:"https://support.goshippo.com/hc/en-us/articles/360003902611",target:"_blank"},{children:t("carriers.form.testLearnMore")})),"."]})}))]})},_this.setServiceLevelState=function(){var e_2,_a;if(_this.props.carrierAccountWithServiceLevels){var _b=_this.props,formType=_b.formType,carrierAccountWithServiceLevels=_b.carrierAccountWithServiceLevels,isEditForm=formType===CarrierFormType.Edit,isHiddenReadyToSet=null===_this.state.serviceLevelsIsHidden,hasServiceLevels=carrierAccountWithServiceLevels.hasOwnProperty("serviceLevels");if(isEditForm&&isHiddenReadyToSet&&hasServiceLevels){var serviceLevels=carrierAccountWithServiceLevels.serviceLevels,carrierAccountServiceLevels=[],hiddenCount={isHidden:0,notHidden:0},toggleState=ServiceLevelsIsHidden.All;try{for(var serviceLevels_1=(0,tslib_es6.Ju)(serviceLevels),serviceLevels_1_1=serviceLevels_1.next();!serviceLevels_1_1.done;serviceLevels_1_1=serviceLevels_1.next()){var serviceLevel=serviceLevels_1_1.value;carrierAccountServiceLevels.push(serviceLevel.token),serviceLevel.is_used||(serviceLevel.is_hidden?hiddenCount.isHidden++:hiddenCount.notHidden++)}}catch(e_2_1){e_2={error:e_2_1}}finally{try{serviceLevels_1_1&&!serviceLevels_1_1.done&&(_a=serviceLevels_1.return)&&_a.call(serviceLevels_1)}finally{if(e_2)throw e_2.error}}toggleState=hiddenCount.isHidden&&hiddenCount.notHidden?ServiceLevelsIsHidden.Mix:hiddenCount.isHidden>=hiddenCount.notHidden?ServiceLevelsIsHidden.All:ServiceLevelsIsHidden.None,_this.setState({selectedCarrier:carrierAccountWithServiceLevels,serviceLevelsIsHidden:toggleState})}}},_this.onToggleSelectAll=function(){var e_3,_a,_b=_this.state,serviceLevelsIsHidden=_b.serviceLevelsIsHidden,selectedCarrier=_b.selectedCarrier;if(selectedCarrier){var allCheckboxChecked=serviceLevelsIsHidden===ServiceLevelsIsHidden.None;try{for(var _c=(0,tslib_es6.Ju)(selectedCarrier.serviceLevels),_d=_c.next();!_d.done;_d=_c.next()){var serviceLevel=_d.value;serviceLevel.is_used||_this.props.change(serviceLevel.token,!allCheckboxChecked)}}catch(e_3_1){e_3={error:e_3_1}}finally{try{_d&&!_d.done&&(_a=_c.return)&&_a.call(_c)}finally{if(e_3)throw e_3.error}}var setCheckboxState=allCheckboxChecked?ServiceLevelsIsHidden.All:ServiceLevelsIsHidden.None;_this.setState({serviceLevelsIsHidden:setCheckboxState})}},_this.onToggleViewMore=function(){var _a=_this.state,selectedCarrier=_a.selectedCarrier,viewMoreStatus=_a.viewMoreStatus;if(selectedCarrier&&!(selectedCarrier.serviceLevels.length<=10)){var content=viewMoreStatus?"less":"more",arrowPosition={transform:"rotate(".concat(viewMoreStatus?"180":"0","deg)")};return(0,emotion_react_jsx_runtime_browser_esm.FD)(ViewMoreBtn,(0,tslib_es6.Cl)({onClick:function(){return _this.setState({viewMoreStatus:!viewMoreStatus})}},{children:["View ".concat(content),(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierForm_Icon,{style:arrowPosition,src:arrow_sea600})]}))}},_this.serviceLevelCheckboxInput=function(_a){var name=_a.name,label=_a.label,disabled=_a.disabled,labelProps=_a.labelProps;return(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Popup.A,(0,tslib_es6.Cl)({inverted:!0,open:!!disabled&&void 0,style:{maxWidth:"18.75rem",fontSize:"0.8125rem",lineHeight:"1.25rem"},trigger:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{responsive:!0,name,label,disabled,labelProps,component:ServiceLevelCheckbox})},{children:_this.props.t("carriers.form.newFedExFooterCopy")}),name)},_this.renderServiceLevelsList=function(){var _a=_this.state,selectedCarrier=_a.selectedCarrier,viewMoreStatus=_a.viewMoreStatus;if(selectedCarrier)return(viewMoreStatus?selectedCarrier.serviceLevels:selectedCarrier.serviceLevels.slice(0,10)).map((function(serviceLevel){var inputProps={name:serviceLevel.token,label:serviceLevel.name,disabled:serviceLevel.is_used,labelProps:{}};return _this.serviceLevelCheckboxInput(inputProps)}))},_this.renderServiceLevelsSection=function(){var CheckboxIconsState,t=_this.props.t;return function(CheckboxIconsState){CheckboxIconsState[CheckboxIconsState.all=ic_unchecked]="all",CheckboxIconsState[CheckboxIconsState.none=ic_checked]="none",CheckboxIconsState[CheckboxIconsState.mix=ic_indeterminate]="mix"}(CheckboxIconsState||(CheckboxIconsState={})),(0,emotion_react_jsx_runtime_browser_esm.FD)(emotion_react_jsx_runtime_browser_esm.FK,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(SectionBorder,{}),(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierForm_SectionTitle,{children:t("carriers.form.serviceLevelsSection.header")}),(0,emotion_react_jsx_runtime_browser_esm.Y)(SectionSubtitle,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(utils_translate.x6,(0,tslib_es6.Cl)({i18nKey:"carriers.form.serviceLevelsSection.subtitle"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)("b",{children:"hide it everywhere"})}))}),_this.renderServiceLevelsErrorMessage(),(0,emotion_react_jsx_runtime_browser_esm.FD)(ServiceLevelsSection,{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(SelectAllToggleShowHide,(0,tslib_es6.Cl)({onClick:_this.onToggleSelectAll},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierForm_Icon,{src:CheckboxIconsState[_this.state.serviceLevelsIsHidden||"none"]}),(0,emotion_react_jsx_runtime_browser_esm.Y)(ShowHideLabel,{children:t("carriers.form.serviceLevelsSection.showHideAll")})]})),_this.renderServiceLevelsList(),_this.onToggleViewMore()]})]})},_this.renderSectionBorder=function(shouldHideSectionBorder){return!shouldHideSectionBorder&&(0,emotion_react_jsx_runtime_browser_esm.Y)(SectionBorder,{})},_this.state={mockedValidations:{},selectedCarrier:null,serviceLevelsIsHidden:null,viewMoreStatus:!1},_this}return(0,tslib_es6.C6)(CarrierForm,_super),CarrierForm.prototype.componentDidMount=function(){var _a=this.props,carrier=_a.carrier,formType=_a.formType;isCarrierFormMocked(carrier.id,formType)?this.setValidations(this.props.parameters):this.props.fetchCarrierFormFields({carrier,formType}),this.setServiceLevelState()},CarrierForm.prototype.componentDidUpdate=function(prevProps){var parameters=this.props.parameters;prevProps.parameters!==parameters&&parameters&&this.setValidations(parameters),this.setServiceLevelState()},CarrierForm.prototype.componentWillUnmount=function(){this.props.clearCarrierFormFieldsState()},CarrierForm.prototype.handleLinkOnClick=function(e){"a"===e.target.tagName.toLowerCase()&&(e.stopPropagation(),e.preventDefault(),openLinkInNewTab(e.target.href))},CarrierForm.prototype.render=function(){var carrierFormFields,_this=this,_a=this.props,formType=_a.formType,carrier=_a.carrier,disabled=_a.disabled,formState=_a.formState,isFetchingCarrierFormFields=_a.isFetchingCarrierFormFields,validations=_a.validations,fetchErrorMessage=_a.fetchErrorMessage,masterAccountForm=_a.masterAccountForm,hideTestMode=_a.hideTestMode,hideAccountNickname=_a.hideAccountNickname,accountCountry=_a.accountCountry,mockedValidations=this.state.mockedValidations;carrierFormFields=isCarrierFormMocked(carrier.id,formType)?this.props.parameters:this.props.carrierFormFields;var defaultErrorMessage=this.renderFetchErrorMessage(),showErrorMessage=""!==fetchErrorMessage&&!masterAccountForm;return"lasership"===carrier.id&&(defaultErrorMessage=this.renderApiOnlyMessage(),showErrorMessage=!0),isFetchingCarrierFormFields?(0,emotion_react_jsx_runtime_browser_esm.Y)(Centered,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Spinner.hQ,{})}):(0,emotion_react_jsx_runtime_browser_esm.Y)("form",{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierFormModalBody,{children:showErrorMessage?defaultErrorMessage:(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[!masterAccountForm&&(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[this.renderErrorMessage(),!hideAccountNickname&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Grid.f,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Grid.V,(0,tslib_es6.Cl)({width:"100%"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{name:"metadata",component:Input.FO,label:"Account Nickname",placeholder:"e.g. Test Account, US Domestic, CA Facility",responsive:!0,disabled,labelProps:{disabled},validate:this.validateMetadataField})}))}),carrierFormFields.map((function(carrierFormField,index){var _a,_b,component,shouldHideSectionBorder=0===index&&hideAccountNickname,isAusPostMyPostRadioField=carrier.id===carriers.io.id&&formType===CarrierFormType.Connect&&"is_mypost"===carrierFormField.key;isAusPostMyPostRadioField&&(carrierFormField.options=AUSPOST_MYPOST_OPTIONS),isAusPostMyPostRadioField&&!selector(formState,carrierFormField.key)&&_this.props.setField("is_mypost",AUSPOST_MYPOST_OPTIONS[0]);var isUPSCreateCountryField="ups"===carrier.id&&formType===CarrierFormType.Create&&carrierFormField.key.endsWith("country_iso2");if("ups"===carrier.id&&formType===CarrierFormType.Create&&"ups_agreements"===carrierFormField.key&&accountCountry===constants_countries.Xr.CA.iso2&&(carrierFormField.label='By checking this box, you agree to the <a href="https://goshippo.com/external_registration/ups/technology_agreement/ca">UPS Technology Agreement</a> and <a href="https://shippo.com/CA-TToCos">UPS Tariff/Terms and Conditions of Service</a> and <a href="https://shippo.com/CA-LoPI">List of Prohibited Items for Shipping</a>'),carrierFormField.hiddenByKey){var valuePresent=selector(formState,carrierFormField.hiddenByKey),shouldHideAusPostFields=!1;if("is_mypost"===carrierFormField.hiddenByKey&&(carrierFormField.hiddenByValue&&"is_mypost"===(null==valuePresent?void 0:valuePresent.value)?shouldHideAusPostFields=!0:carrierFormField.hiddenByValue||"is_eparcel"!==(null==valuePresent?void 0:valuePresent.value)||(shouldHideAusPostFields=!0)),valuePresent===carrierFormField.hiddenByValue||shouldHideAusPostFields)return selector(formState,carrierFormField.key)&&_this.props.clearField(carrierFormField.key),null;if("pickup_address_country_iso2"===carrierFormField.key&&!selector(formState,carrierFormField.key)){var countryOption=void 0;accountCountry&&carrierFormField.options&&(countryOption=carrierFormField.options.filter((function(o){return o.value===accountCountry}))[0]),countryOption||(countryOption={value:constants_countries.Xr.US.iso2,label:constants_countries.Xr.US.name}),_this.props.setField("pickup_address_country_iso2",countryOption)}}var label=carrierFormField.label;switch(carrierFormField.fieldType){case"integer":case"string":case"military_time":component=formType!==CarrierFormType.Edit||"account_id"===carrierFormField.key||"mask"!==carrierFormField.displayType&&"show_partial"!==carrierFormField.displayType?Input.FO:Input.Ex;break;case"boolean":if(isAusPostMyPostRadioField){component=Radio_RadioField;break}component=components_Checkbox.Y,label=(0,emotion_react_jsx_runtime_browser_esm.Y)(AgreementLabel,{onClick:_this.handleLinkOnClick,dangerouslySetInnerHTML:{__html:label}});break;case"choice":component=SmartSelect.s;break;case"date":component=DateTimePickerField;break;default:return null}var formField=(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{name:carrierFormField.key,id:carrierFormField.key,component,label,type:carrierFormField.key.includes("password")&&!carrierFormField.key.includes("api_password")?"password":void 0,placeholder:carrierFormField.placeholderText,options:isUPSCreateCountryField&&carrierFormField.options?carrierFormField.options.filter((function(o){return o.value===(accountCountry||constants_countries.Xr.US.iso2)})):carrierFormField.options,linkUrl:carrierFormField.helpUrl,linkText:"Where is this?",responsive:!0,disabled:formType===CarrierFormType.Edit&&"account_id"===carrierFormField.key||disabled||carrierFormField.disabled||isUPSCreateCountryField,validate:function(){var _a;return(null===(_a=_this.props.initialValues)||void 0===_a?void 0:_a.password)===selector(formState,carrierFormField.key)&&formType===CarrierFormType.Edit&&"mask"===carrierFormField.displayType&&"password"===carrierFormField.key}()||formType===CarrierFormType.Edit&&"account_id"===carrierFormField.key||carrierFormField.disabled?void 0:isCarrierFormMocked(carrier.id,formType)?mockedValidations[carrierFormField.key]:validations[carrierFormField.key],labelProps:{disabled:disabled||carrierFormField.disabled,required:!(formType===CarrierFormType.Edit&&"account_id"===carrierFormField.key||carrierFormField.disabled)&&carrierFormField.isRequired,tooltipText:carrierFormField.tooltip},onClick:component===Input.Ex?function(){return _this.props.clearField(carrierFormField.key)}:void 0});return(0,emotion_react_jsx_runtime_browser_esm.Y)(react.Fragment,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Grid.f,(0,tslib_es6.Cl)({className:isAusPostMyPostRadioField?"mb-4":""},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(Grid.V,(0,tslib_es6.Cl)({width:"100%"},{children:[carrierFormField.key.endsWith("full_name")&&(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[_this.renderSectionBorder(shouldHideSectionBorder),formType===CarrierFormType.Connect&&(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierForm_SectionTitle,{children:"Contact Information"})]}),carrierFormField.key.endsWith("first_name")&&(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[_this.renderSectionBorder(shouldHideSectionBorder),(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierForm_SectionTitle,{children:"Contact Information"})]}),carrier===carriers.$5&&formType===CarrierFormType.Create&&(null===(_b=null===(_a=carrierFormFields[index-1])||void 0===_a?void 0:_a.key)||void 0===_b?void 0:_b.endsWith("company"))&&(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierForm_Subtext,{children:_this.props.t("carriers.upsMasterForm.companySubtext")}),(carrierFormField.key.endsWith("billing_address_st")||carrierFormField.key.endsWith("billing_address_st1")||carrierFormField.key.endsWith("billing_address_street")||carrierFormField.key.endsWith("billing_address_street1")||carrierFormField.key.endsWith("street_number"))&&(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[_this.renderSectionBorder(shouldHideSectionBorder),(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierForm_SectionTitle,{children:"Billing Address"})]}),(carrierFormField.key.endsWith("from_address_st")||carrierFormField.key.endsWith("from_address_st1")||carrierFormField.key.endsWith("from_address_street")||carrierFormField.key.endsWith("from_address_street1"))&&(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[_this.renderSectionBorder(shouldHideSectionBorder),(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierForm_SectionTitle,{children:"Shipping Address"})]}),carrierFormField.key.endsWith("same_as_billing_address")&&(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[_this.renderSectionBorder(shouldHideSectionBorder),(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierForm_SectionTitle,{children:"Pickup Address"}),(0,emotion_react_jsx_runtime_browser_esm.Y)(Disclaimer,{children:"Note: Pickup address cannot be a PO Box"})]}),carrierFormField.key.includes("agreement")&&_this.renderSectionBorder(shouldHideSectionBorder),carrierFormField.key.endsWith("account")&&(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[_this.renderSectionBorder(shouldHideSectionBorder),(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierForm_SectionTitle,{children:"Account Information"})]}),carrierFormField.key.endsWith("has_invoice")&&(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[_this.renderSectionBorder(shouldHideSectionBorder),(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierForm_SectionTitle,{children:"Personalized UPS Rates"})]}),carrierFormField.key.endsWith("legal_name")&&(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[_this.renderSectionBorder(shouldHideSectionBorder),(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierForm_SectionTitle,{children:"Business Information"})]}),carrierFormField.key.endsWith("customer_number")&&(0,emotion_react_jsx_runtime_browser_esm.Y)(react.Fragment,{children:_this.renderSectionBorder(shouldHideSectionBorder)}),carrierFormField.key.endsWith("is_mypost")&&carrier.id===carriers.io.id&&(0,emotion_react_jsx_runtime_browser_esm.Y)(react.Fragment,{children:_this.renderSectionBorder(shouldHideSectionBorder)}),carrierFormField.key.endsWith("merchant_token")&&carrier.id===carriers.io.id&&(0,emotion_react_jsx_runtime_browser_esm.FD)(Body,(0,tslib_es6.Cl)({className:"mb-2"},{children:["".concat(_this.props.t("carriers.createAtCarrierWebsite",{accountType:"MyPost",carrierName:carrier.name})," "),(0,emotion_react_jsx_runtime_browser_esm.Y)(TestHelpLink,(0,tslib_es6.Cl)({target:"_blank",href:"https://auspost.com.au/mypost-business"},{children:_this.props.t("carriers.clickToGetStarted")}))]})),formField]}))}))},carrierFormField.key)}))]}),(formType===CarrierFormType.Connect||formType===CarrierFormType.Edit)&&!masterAccountForm&&(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(SectionBorder,{}),"ups"!==carrier.id&&!this.props.newFedExAPI&&(0,emotion_react_jsx_runtime_browser_esm.Y)(utils_translate.x6,{i18nKey:"carriers.form.retailRatesDisclaimer",components:[(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Link_Link.ec,(0,tslib_es6.Cl)({href:"mailto:support@shippo.com"},{children:"_"}),0)]})]}),this.props.fedExInternationalSection&&(0,emotion_react_jsx_runtime_browser_esm.Y)(react.Fragment,{children:this.props.fedExInternationalSection}),formType===CarrierFormType.Connect&&this.props.isUserPaygPlan&&!this.props.newFedExAPI&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Body,(0,tslib_es6.Cl)({color:styles_constants.Tj.gray400},{children:"".concat(this.props.t("carriers.planInfo.formPaygPlanDisclaimer"),".")})),!(formType===CarrierFormType.Connect&&"ups"===carrier.id||formType===CarrierFormType.Create&&carriers.mp.includes(carrier.id)||hideTestMode)&&(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[this.renderSectionBorder(masterAccountForm),(0,emotion_react_jsx_runtime_browser_esm.Y)(Grid.f,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Grid.V,(0,tslib_es6.Cl)({width:"100%"},{children:this.renderTestLabel(carrier)}))})]}),formType===CarrierFormType.Connect&&"fedex"===carrier.id&&(0,emotion_react_jsx_runtime_browser_esm.Y)(react.Fragment,{children:this.props.newFedExAPI?(0,emotion_react_jsx_runtime_browser_esm.FD)(emotion_react_jsx_runtime_browser_esm.FK,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Divider.A,{}),(0,emotion_react_jsx_runtime_browser_esm.Y)(Typography.A,(0,tslib_es6.Cl)({variant:"caption",component:"p",style:{margin:"".concat(shippoTheme.A.spacing(2)," 0px")}},{children:this.props.t("carriers.form.newFedExFooterCopy")})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Divider.A,{})]}):(0,emotion_react_jsx_runtime_browser_esm.FD)(FedExAdvantageSection,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(SectionBorder,{}),(0,emotion_react_jsx_runtime_browser_esm.FD)("span",{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(FedExAdvantageLink,(0,tslib_es6.Cl)({target:"_blank",href:"https://advantagemember.van.fedex.com/7502/",onClick:this.handleClickedFedExAdvantageEvent,dataAnalytics:"click-fedex-advantage-link"},{children:"Apply here to save up to 29% off with FedEx"})),". Signing up is completely free for both new and existing FedEx accounts."]})]})}),formType===CarrierFormType.Edit&&this.renderServiceLevelsSection(),this.props.children]})})})},CarrierForm}(react.Component),selector=(0,formValueSelector.A)(constants_form.QW);const CarrierForm_CarrierForm=(0,redux.Zz)((0,utils_translate.Tl)("settings"),(0,reduxForm.A)({form:constants_form.QW,enableReinitialize:!0}),(0,es.Ng)((function(state){return{formState:state,fetchErrorMessage:getCarrierFormFieldsErrorMessage(state),carrierFormFields:getCarrierFormFields(state),isFetchingCarrierFormFields:getIsFetchingCarrierFormFields(state),validations:getCarrierFormFieldValidations(state),isUserPaygPlan:(0,plans_selectors.YJ)(state),serviceLevelsByAccount:(0,providers_selectors.eA)(state),getServiceLevelsError:(0,carrier_accounts_selectors.Xs)(state)}}),(function(dispatch){return{clearField:function(key){return dispatch((0,redux_form_es.Zg)(constants_form.QW,key,""))},setField:function(key,value){return dispatch((0,redux_form_es.Zg)(constants_form.QW,key,value))},fetchCarrierFormFields:function(payload){return dispatch(fetchCarrierFormFields(payload))},clearCarrierFormFieldsState:function(){return dispatch(carrierFormFieldsClearState())},fetchServiceLevelsAccounts:function(){return dispatch(fetchServiceLevelsByAccount())},clickFedExAdvantageLink:function(value){return dispatch((0,prod_analytics_actions.o)(value))}}})))(CarrierForm);var CarrierForm_templateObject_1,CarrierForm_templateObject_2,CarrierForm_templateObject_3,CarrierForm_templateObject_4,CarrierForm_templateObject_5,CarrierForm_templateObject_6,CarrierForm_templateObject_7,CarrierForm_templateObject_8,CarrierForm_templateObject_9,CarrierForm_templateObject_10,CarrierForm_templateObject_11,CarrierForm_templateObject_12,CarrierForm_templateObject_13,CarrierForm_templateObject_14,CarrierForm_templateObject_15,CarrierForm_templateObject_16,CarrierForm_templateObject_17,templateObject_18,templateObject_19,templateObject_20,templateObject_21,templateObject_22,templateObject_23,templateObject_24,templateObject_25,components_Header=__webpack_require__("./app/components/Header/index.ts"),headerMobileHeight="".concat("40px"," + 92px"),CarrierLogo=(0,emotion_styled_browser_esm.A)("img")(CarrierModalHeader_templateObject_1||(CarrierModalHeader_templateObject_1=(0,tslib_es6.ue)(["\n  max-height: 42px;\n  max-width: 75px;\n  width: auto;\n  height: auto;\n"],["\n  max-height: 42px;\n  max-width: 75px;\n  width: auto;\n  height: auto;\n"]))),CarrierModalHeader_HeaderContainer=(0,emotion_styled_browser_esm.A)("div")(CarrierModalHeader_templateObject_2||(CarrierModalHeader_templateObject_2=(0,tslib_es6.ue)(["\n  margin-top: ",";\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n\n  @media screen and (min-width: ","px) {\n    margin-top: 0px;\n    position: relative;\n    top: auto;\n    left: auto;\n    right: auto;\n  }\n"],["\n  margin-top: ",";\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n\n  @media screen and (min-width: ","px) {\n    margin-top: 0px;\n    position: relative;\n    top: auto;\n    left: auto;\n    right: auto;\n  }\n"])),"40px",responsive.P.Mobile),StyledAddons=(0,emotion_styled_browser_esm.A)(components_Header.A.Addons)(CarrierModalHeader_templateObject_3||(CarrierModalHeader_templateObject_3=(0,tslib_es6.ue)(["\n  font-size: 14px;\n"],["\n  font-size: 14px;\n"]))),StyledHeaderFlexContainer=(0,emotion_styled_browser_esm.A)(components_Header.A.FlexContainer)(CarrierModalHeader_templateObject_4||(CarrierModalHeader_templateObject_4=(0,tslib_es6.ue)(["\n  flex-direction: row;\n  justify-content: space-between;\n"],["\n  flex-direction: row;\n  justify-content: space-between;\n"]))),StyledCheckbox=(0,emotion_styled_browser_esm.A)(Checkbox.Ay)(CarrierModalHeader_templateObject_5||(CarrierModalHeader_templateObject_5=(0,tslib_es6.ue)([""],[""])));const CarrierModalHeader_CarrierModalHeader=(0,redux.Zz)((0,utils_translate.Tl)("settings"))((function(props){var titleText,formType=props.formType,carrier=props.carrier,active=props.active,onActiveToggle=props.onActiveToggle,test=props.test,t=props.t,customTitleText=props.customTitleText;if(customTitleText)titleText=customTitleText;else switch(formType){case CarrierFormType.Create:titleText=t("carriers.form.titleText",{formType:t("carriers.form.create"),carrierName:carrier.name});break;case CarrierFormType.Edit:titleText=t("carriers.form.titleText",{formType:t("carriers.form.edit"),carrierName:carrier.name});break;default:titleText=t("carriers.form.titleText",{formType:t("carriers.form.connect"),carrierName:carrier.name})}return(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierModalHeader_HeaderContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Modal.A.Header,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(StyledHeaderFlexContainer,{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(Modal.A.Title,{children:[titleText," ",test&&(0,emotion_react_jsx_runtime_browser_esm.Y)(TestTag.A,{type:TestTag.d.Account})]}),(0,emotion_react_jsx_runtime_browser_esm.Y)(StyledAddons,{children:formType===CarrierFormType.Edit?(0,emotion_react_jsx_runtime_browser_esm.Y)(StyledCheckbox,{label:"".concat(t("carriers.active"),":"),checked:active,onChange:onActiveToggle,toggle:!0,labelPosition:"left"}):carrier.img&&(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierLogo,{src:carrier.img})})]})})})}));var CarrierModalHeader_templateObject_1,CarrierModalHeader_templateObject_2,CarrierModalHeader_templateObject_3,CarrierModalHeader_templateObject_4,CarrierModalHeader_templateObject_5,isValidPhoneNumber=__webpack_require__("./node_modules/libphonenumber-js/min/exports/isValidPhoneNumber.js"),APIAddressSelectionModalContent=__webpack_require__("./app/components/withAddressBook/APIAddressSelectionModalContent.tsx"),StyledPrimaryButton=(0,emotion_styled_browser_esm.A)(components_Button.jn)(CarrierModalFooter_templateObject_1||(CarrierModalFooter_templateObject_1=(0,tslib_es6.ue)(["\n  width: 100%;\n  padding: 0px;\n  margin-left: 0px;\n\n  @media screen and (min-width: ","px) {\n    width: initial;\n    padding: 0 20px;\n  }\n"],["\n  width: 100%;\n  padding: 0px;\n  margin-left: 0px;\n\n  @media screen and (min-width: ","px) {\n    width: initial;\n    padding: 0 20px;\n  }\n"])),responsive.P.Mobile),CancelButtonExtended=(0,emotion_styled_browser_esm.A)(APIAddressSelectionModalContent.Zb)(CarrierModalFooter_templateObject_2||(CarrierModalFooter_templateObject_2=(0,tslib_es6.ue)(["\n  border: none;\n  font-weight: ",";\n"],["\n  border: none;\n  font-weight: ",";\n"])),styles_constants.Wy.normal),FooterButtons=(0,emotion_styled_browser_esm.A)("div")(CarrierModalFooter_templateObject_3||(CarrierModalFooter_templateObject_3=(0,tslib_es6.ue)(["\n  display: flex;\n  justify-content: space-between;\n  width: 100%;\n  & button.formSubmit {\n    margin-left: 0px;\n  }\n\n  @media screen and (min-width: ","px) {\n    & button.formSubmit {\n      margin-left: 10px;\n    }\n    :only-of-type {\n      margin-left: auto;\n    }\n  }\n"],["\n  display: flex;\n  justify-content: space-between;\n  width: 100%;\n  & button.formSubmit {\n    margin-left: 0px;\n  }\n\n  @media screen and (min-width: ","px) {\n    & button.formSubmit {\n      margin-left: 10px;\n    }\n    :only-of-type {\n      margin-left: auto;\n    }\n  }\n"])),responsive.P.Mobile);const CarrierModalFooter_CarrierModalFooter=(0,redux.Zz)((0,utils_translate.Tl)("settings"))((function(props){var loadingText,primaryButtonText,formType=props.formType,carrier=props.carrier,onPrimaryClick=props.onPrimaryClick,onCancelClick=props.onCancelClick,isLoading=props.isLoading,t=props.t,customPrimaryButtonText=props.customPrimaryButtonText,customSecondaryButtonText=props.customSecondaryButtonText;switch(formType){case CarrierFormType.Create:loadingText="".concat(t("carriers.form.verifying"),"..."),primaryButtonText=t("carriers.form.createACarrierAccount",{carrierName:carrier.name});break;case CarrierFormType.Edit:loadingText="".concat(t("carriers.form.updating"),"..."),primaryButtonText=t("carriers.form.updateAccount");break;default:loadingText="".concat(t("carriers.form.verifying"),"..."),primaryButtonText=t("carriers.form.connectAccount")}return(0,emotion_react_jsx_runtime_browser_esm.Y)(Modal.A.MobileFooter,(0,tslib_es6.Cl)({hideBorder:!0},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(FooterButtons,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(CancelButtonExtended,(0,tslib_es6.Cl)({onClick:onCancelClick,disabled:isLoading},{children:customSecondaryButtonText||t("carriers.cancel")})),(0,emotion_react_jsx_runtime_browser_esm.Y)(StyledPrimaryButton,(0,tslib_es6.Cl)({className:"formSubmit",onClick:onPrimaryClick,isLoading,loadingText,disabled:isLoading,dataAnalytics:"UPS"===carrier.name&&formType===CarrierFormType.Create?"ups-master-long-form-submit":"carrier-form-submit"},{children:customPrimaryButtonText||primaryButtonText}))]})}))}));var CarrierModalFooter_templateObject_1,CarrierModalFooter_templateObject_2,CarrierModalFooter_templateObject_3;const Carriers_CarrierModalFooter=CarrierModalFooter_CarrierModalFooter;var CarrierErrorMessageDisplay_styles_templateObject_1,CarrierErrorMessageDisplay_styles_templateObject_2,styles_StyledErrorMessage=(0,emotion_styled_browser_esm.A)("div")(CarrierErrorMessageDisplay_styles_templateObject_1||(CarrierErrorMessageDisplay_styles_templateObject_1=(0,tslib_es6.ue)(["\n  display: flex;\n  align-items: center;\n"],["\n  display: flex;\n  align-items: center;\n"]))),styles_StyledAlertIcon=(0,emotion_styled_browser_esm.A)("i")(CarrierErrorMessageDisplay_styles_templateObject_2||(CarrierErrorMessageDisplay_styles_templateObject_2=(0,tslib_es6.ue)(["\n  color: ",";\n  vertical-align: middle;\n  font-size: 2em;\n  margin-right: 15px;\n"],["\n  color: ",";\n  vertical-align: middle;\n  font-size: 2em;\n  margin-right: 15px;\n"])),styles_constants.Tj.dangerRed);const Carriers_CarrierErrorMessageDisplay=function(){var errorMessage=(0,es.d4)((function(state){return(0,carrier_accounts_selectors.E3)(state)})),displayErrorMessage="Account is not in a valid state for registration (may already be processing). Please try again after a few seconds. If problem persists, please contact support@goshippo.com"===errorMessage?"Account is not in a valid state for registration (may already be processing). Please try again after a few seconds or refresh the page. If problem persists, please contact support@goshippo.com":errorMessage;return(0,emotion_react_jsx_runtime_browser_esm.Y)(emotion_react_jsx_runtime_browser_esm.FK,{children:errorMessage&&errorMessage.length>0&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Message.Kw,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(styles_StyledErrorMessage,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(styles_StyledAlertIcon,{className:"fa fa-exclamation-circle"}),(0,emotion_react_jsx_runtime_browser_esm.Y)("strong",{children:displayErrorMessage})]})})})};var SlideModal=__webpack_require__("./app/components/SlideModal/index.ts"),USER_REGISTER_SUCCESS_COOKIE_NAME="user_register_success",STORE_CONNECTION_SUCCESS_COOKIE_NAME="store_connection_success";function getCookie(name){var match=document.cookie.match(new RegExp("(^| )".concat(name,"=([^;]+)")));if(match)return match[2]}var CanadaPostConnectRedirect_Container=emotion_styled_browser_esm.A.section(CanadaPostConnectRedirect_templateObject_1||(CanadaPostConnectRedirect_templateObject_1=(0,tslib_es6.ue)(["\n  color: ",";\n"],["\n  color: ",";\n"])),styles_constants.Tj.black),ComposedCanadaPostConnectRedirect=(0,utils_translate.Tl)("settings")((function(_a){var t=_a.t;return(0,emotion_react_jsx_runtime_browser_esm.FD)(CanadaPostConnectRedirect_Container,(0,tslib_es6.Cl)({className:"flex flex-col items-center text-center"},{children:[t("carriers.canadaPostRedirectForm.description"),(0,emotion_react_jsx_runtime_browser_esm.FD)(components_Button.FS,(0,tslib_es6.Cl)({target:"_blank",isExternal:!0,href:"".concat("https://dev-qa.shippodev.com","/carriers/canada-post/signup/initiate"),className:"my-4"},{children:[t("carriers.canadaPostRedirectForm.buttonText")," ",(0,emotion_react_jsx_runtime_browser_esm.Y)("i",{className:"fa fa-external-link"})]})),t("carriers.canadaPostRedirectForm.reloadInstruction")]}))}));var CanadaPostConnectRedirect_templateObject_1;const Carriers_CanadaPostConnectRedirect=ComposedCanadaPostConnectRedirect;var stores_actions=__webpack_require__("./app/actions/stores.actions.ts"),stores_selectors=__webpack_require__("./app/selectors/stores.selectors.ts"),withCarrierForm_Context=react.createContext({getInitialFormValues:function(){return[]},shouldHideAccountNickname:function(){return!1},submitCarrierForm:function(){},connectCarrierAccount:function(){},editCarrierAccount:function(){},editCarrierAccountServiceLevels:function(){},createCarrierAccount:function(){},submitting:!1,isSavingCarrierAccount:!1,errorMessage:"",user:null,isEBayConnected:!1,hasEBayCanadaPostAccount:!1,hasUpsMarketplaceOrMasterAcc:!1,successfullyFetchedAccounts:!1,carrierFormFields:[],fetchStores:function(){},serviceLevelsByAccounts:(0,fetchable.uk)(),fetchServiceLevelsAccount:function(){},carrierAccountWithServiceLevels:{}});var withCarrierForm_mapStateToProps=function(state,ownProps){return{submitting:(0,isSubmitting.A)(constants_form.QW)(state),isSavingCarrierAccount:(0,carrier_accounts_selectors.sy)(state),errorMessage:(0,carrier_accounts_selectors.E3)(state),user:(0,user_selectors.wz)(state),isEBayConnected:(0,stores_selectors.Z1)(state),hasEBayCanadaPostAccount:(0,carrier_accounts_selectors.lg)(state),hasUpsMarketplaceOrMasterAcc:(0,carrier_accounts_selectors.An)(state),successfullyFetchedAccounts:(0,carrier_accounts_selectors.h$)(state),carrierFormFields:getCarrierFormFields(state),serviceLevelsByAccounts:(0,providers_selectors.eA)(state),carrierAccountWithServiceLevels:(0,providers_selectors.jH)(state,{carrierAccount:ownProps.carrierAccount})}},withCarrierForm_mapDispatchToProps=function(dispatch){return{submitCarrierForm:function(){return dispatch((0,redux_form_es.tA)(constants_form.QW))},connectCarrierAccount:function(payload){return dispatch(function carrier_accounts_actions_connectCarrierAccount(payload){return{payload,type:constants.t.CONNECT_CARRIER_ACCOUNT}}(payload))},editCarrierAccount:function(payload){return dispatch(carrier_accounts_actions_editCarrierAccount(payload))},editCarrierAccountServiceLevels:function(payload){return dispatch(function carrier_accounts_actions_editCarrierAccountServiceLevels(payload){return{payload,type:constants.t.EDIT_CARRIER_ACCOUNT_SERVICE_LEVELS}}(payload))},createCarrierAccount:function(payload){return dispatch(carrier_accounts_actions_createCarrierAccount(payload))},fetchStores:function(){return dispatch((0,stores_actions.hO)())},fetchServiceLevelsAccount:function(){return dispatch(fetchServiceLevelsByAccount())}}};const withCarrierForm_withCarrierForm=function withCarrierForm(Component){return(0,es.Ng)(withCarrierForm_mapStateToProps,withCarrierForm_mapDispatchToProps)(function(_super){function class_1(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.prepopulateAddressField=function(initialValues,address,parameter,carrier){var key=parameter.key,accountCountry=_this.props.accountCountry?_this.props.accountCountry:constants_countries.Xr.US.iso2;if(address&&(carrier!==carriers.$5||!address.country||address.country.iso2===accountCountry||key.includes("country"))){var addressSplit=address.street1.split(" ");"street"===key?initialValues[key]=addressSplit.slice(1,addressSplit.length).join(" "):"street_number"===key&&addressSplit.length>1?initialValues[key]=addressSplit[0]:key.endsWith("street1")||key.endsWith("_st1")?initialValues[key]=address.street1:key.endsWith("street2")||key.endsWith("_st2")?initialValues[key]=address.street2:key.endsWith("_st")||key.endsWith("street")?initialValues[key]=address.street1&&address.street2?"".concat(address.street1," ").concat(address.street2):address.street1:key.endsWith("city")?initialValues[key]=address.city:key.includes("state")||key.includes("province")?initialValues[key]=address.state:key.includes("zip")||key.includes("postal")?(initialValues[key]=address.zip,carrier===carriers.$5&&(initialValues[key]=initialValues[key].slice(0,5))):key.includes("country")&&(initialValues[key]=address.country?address.country.iso2:null,carrier===carriers.$5&&(initialValues[key]=accountCountry)),"choice"===parameter.fieldType&&parameter.options&&initialValues.hasOwnProperty(key)&&(initialValues[key]=parameter.options.find((function(option){return option.value===initialValues[key]})))}},_this.shouldHideAccountNickname=function(carrier,formType){return formType===CarrierFormType.Create&&carrier===carriers.$5},_this.getInitialFormValues=function(carrierAccount,carrier,formType,mockedParameters){var e_1,_a,e_2,_b,e_3,_c,parameters,_d=_this.props,user=_d.user,carrierAccountWithServiceLevels=_d.carrierAccountWithServiceLevels,optionParameters={},initialValues={},providerServiceLevels={};parameters=mockedParameters&&mockedParameters.length>0?mockedParameters:isCarrierFormMocked(carrier.id,formType)?parametersMap[carrier.id][formType]:_this.props.carrierFormFields,carrier===carriers.$5&&formType===CarrierFormType.Create&&(initialValues.pickup_address_same_as_billing_address=!0);var _loop_1=function(parameter){if(parameter.hiddenByKey)return"continue";var key=parameter.key;if(void 0!==parameter.defaultValue&&null!==parameter.defaultValue){if(initialValues[key]=parameter.defaultValue,"choice"===parameter.fieldType&&parameter.options){var option=parameter.options.find((function(option){return option.value===parameter.defaultValue}));option&&(initialValues[key]=option)}}else key.endsWith("first_name")?initialValues[key]=user?user.firstName:null:key.endsWith("last_name")?initialValues[key]=user?user.lastName:null:key.endsWith("full_name")||key.endsWith("address_name")?initialValues[key]=user?user.firstName&&user.lastName?"".concat(user.firstName," ").concat(user.lastName):user.firstName:null:key.includes("email")?initialValues[key]=user?user.email:null:key.endsWith("company")||key.endsWith("company_name")||"legal_name"===key?initialValues[key]=user&&user.address?user.address.company:null:key.includes("phone")?initialValues[key]=user&&user.address?user.address.phone:null:user&&_this.prepopulateAddressField(initialValues,user.address,parameter,carrier)};try{for(var parameters_1=(0,tslib_es6.Ju)(parameters),parameters_1_1=parameters_1.next();!parameters_1_1.done;parameters_1_1=parameters_1.next()){_loop_1(parameters_1_1.value)}}catch(e_1_1){e_1={error:e_1_1}}finally{try{parameters_1_1&&!parameters_1_1.done&&(_a=parameters_1.return)&&_a.call(parameters_1)}finally{if(e_1)throw e_1.error}}if(carrierAccount){var _loop_2=function(parameter){if("choice"===parameter.fieldType&&parameter.options&&carrierAccount.parameters){var key=parameter.key,value_1=carrierAccount.parameters[key],option=parameter.options.find((function(option){return option.value===value_1}));option&&(optionParameters[key]=option)}};try{for(var parameters_2=(0,tslib_es6.Ju)(parameters),parameters_2_1=parameters_2.next();!parameters_2_1.done;parameters_2_1=parameters_2.next()){_loop_2(parameters_2_1.value)}}catch(e_2_1){e_2={error:e_2_1}}finally{try{parameters_2_1&&!parameters_2_1.done&&(_b=parameters_2.return)&&_b.call(parameters_2)}finally{if(e_2)throw e_2.error}}if(carrierAccountWithServiceLevels)try{for(var _e=(0,tslib_es6.Ju)(carrierAccountWithServiceLevels.serviceLevels),_f=_e.next();!_f.done;_f=_e.next()){var serviceLevel=_f.value;providerServiceLevels[serviceLevel.token]||(providerServiceLevels[serviceLevel.token]=!serviceLevel.is_hidden)}}catch(e_3_1){e_3={error:e_3_1}}finally{try{_f&&!_f.done&&(_c=_e.return)&&_c.call(_e)}finally{if(e_3)throw e_3.error}}var initialValuesOnEdit=(0,tslib_es6.Cl)((0,tslib_es6.Cl)((0,tslib_es6.Cl)({account_id:carrierAccount.accountId,test:carrierAccount.test,metadata:carrierAccount.metadata},carrierAccount.parameters),optionParameters),providerServiceLevels);initialValues=(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},initialValues),initialValuesOnEdit)}return initialValues},_this}return(0,tslib_es6.C6)(class_1,_super),class_1.prototype.componentDidMount=function(){var _a=this.props,fetchStores=_a.fetchStores,serviceLevelsByAccounts=_a.serviceLevelsByAccounts,fetchServiceLevelsAccount=_a.fetchServiceLevelsAccount;fetchStores(),"success"!==serviceLevelsByAccounts.kind&&fetchServiceLevelsAccount()},class_1.prototype.render=function(){return(0,emotion_react_jsx_runtime_browser_esm.Y)(withCarrierForm_Context.Provider,(0,tslib_es6.Cl)({value:{getInitialFormValues:this.getInitialFormValues,shouldHideAccountNickname:this.shouldHideAccountNickname,submitting:this.props.submitting,isSavingCarrierAccount:this.props.isSavingCarrierAccount,errorMessage:this.props.errorMessage,user:this.props.user,isEBayConnected:this.props.isEBayConnected,hasEBayCanadaPostAccount:this.props.hasEBayCanadaPostAccount,hasUpsMarketplaceOrMasterAcc:this.props.hasUpsMarketplaceOrMasterAcc,successfullyFetchedAccounts:this.props.successfullyFetchedAccounts,carrierFormFields:this.props.carrierFormFields,serviceLevelsByAccounts:this.props.serviceLevelsByAccounts,carrierAccountWithServiceLevels:this.props.carrierAccountWithServiceLevels,submitCarrierForm:this.props.submitCarrierForm,connectCarrierAccount:this.props.connectCarrierAccount,editCarrierAccount:this.props.editCarrierAccount,editCarrierAccountServiceLevels:this.props.editCarrierAccountServiceLevels,createCarrierAccount:this.props.createCarrierAccount,fetchStores:this.props.fetchStores,fetchServiceLevelsAccount:this.props.fetchServiceLevelsAccount}},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Component,(0,tslib_es6.Cl)({},this.props))}))},class_1}(react.Component))},Carriers_withCarrierForm=withCarrierForm_withCarrierForm;var RequiredError,useNewFedExAPIFeatureFlag=function(){var isNewFedExAPI=(0,featureflags.u)(featureflags.gH.FEDEX_NEW_API_ENABLED);return{isNewFedExAPI:null==isNewFedExAPI?void 0:isNewFedExAPI.enabled}},VerificationOptions_SMS="SMS",VerificationOptions_EMAIL="EMAIL",VerificationOptions_PHONE="PHONE",VerificationOptions_INVOICE="INVOICE",DefaultVerificationOption=VerificationOptions_SMS,DefaultInitialDate=moment_moment().format("YYYY-MM-DD");!function(RequiredError){RequiredError.LOGO_REQUIRED="logo_required",RequiredError.SIGNATURE_REQUIRED="signature_required",RequiredError.BOTH_REQUIRED="both_required",RequiredError.NONE=""}(RequiredError||(RequiredError={}));var esm_exports=__webpack_require__("./node_modules/@sentry/browser/node_modules/@sentry/core/esm/exports.js"),handleFedexVerificationError=function(t,addSnackbarActionAlert,errorDetails){addSnackbarActionAlert({message:errorDetails||t("carriers.form.fedexVerificationError"),severity:"error"})},zod=__webpack_require__("./node_modules/@hookform/resolvers/zod/dist/zod.mjs"),zod_lib=__webpack_require__("./node_modules/zod/lib/index.mjs"),validationFormZodResolver=zod_lib.z.object({verification_option:zod_lib.z.enum([VerificationOptions_SMS,VerificationOptions_EMAIL,VerificationOptions_PHONE,VerificationOptions_INVOICE]),verification_pin:zod_lib.z.string().optional(),verification_invoice_number:zod_lib.z.string().optional(),verification_invoice_amount:zod_lib.z.string().optional(),verification_invoice_date:zod_lib.z.string().optional(),verification_invoice_currency:zod_lib.z.string().optional()}).refine((function(data){return data.verification_option===VerificationOptions_INVOICE||!!data.verification_pin}),{message:"settings:carriers:form:requiredError",path:["verification_pin"]}).refine((function(data){if(data.verification_option===VerificationOptions_INVOICE)return!0;return/^\d{7}$/.test(data.verification_pin||"")}),{message:"settings:carriers:accountValidation:contactMethod:pinValidationLength",path:["verification_pin"]}).refine((function(data){return data.verification_option!==VerificationOptions_INVOICE||!!(data.verification_invoice_number&&data.verification_invoice_amount&&data.verification_invoice_date&&data.verification_invoice_currency)}),(function(data){var message="settings:carriers:form:requiredError",path=[];return data.verification_option!==VerificationOptions_INVOICE?{message:"",path}:data.verification_invoice_number?data.verification_invoice_amount?data.verification_invoice_date?data.verification_invoice_currency?{message,path}:{message,path:["verification_invoice_currency"]}:{message,path:["verification_invoice_date"]}:{message,path:["verification_invoice_amount"]}:{message,path:["verification_invoice_number"]}})),useFedExInternationalSection=function(){var _a=(0,tslib_es6.zs)((0,react.useState)(!1),2),showFedExInternational=_a[0],setShowFedExInternational=_a[1],_b=(0,tslib_es6.zs)((0,react.useState)(RequiredError.NONE),2),showFedExImageUploadError=_b[0],setShowFedExImageUploadError=_b[1],_c=(0,tslib_es6.zs)((0,react.useState)(null),2),uploadedImage=_c[0],setUploadedImage=_c[1],validateImageUpload=(0,react.useCallback)((function(){return!showFedExInternational||((null==uploadedImage?void 0:uploadedImage.companyLogo)||(null==uploadedImage?void 0:uploadedImage.digitalSignature)?(null==uploadedImage?void 0:uploadedImage.companyLogo)?(null==uploadedImage?void 0:uploadedImage.digitalSignature)?(setShowFedExImageUploadError(RequiredError.NONE),!0):(setShowFedExImageUploadError(RequiredError.SIGNATURE_REQUIRED),!1):(setShowFedExImageUploadError(RequiredError.LOGO_REQUIRED),!1):(setShowFedExImageUploadError(RequiredError.BOTH_REQUIRED),!1))}),[showFedExInternational,uploadedImage]);return{uploadedImage,showFedExInternational,showFedExImageUploadError,validateImageUpload,handleImageUpload:function(files){setUploadedImage(files)},onFedExInternationalCheckboxChange:function(e){setShowFedExInternational(e.target.checked),e.target.checked||setUploadedImage(null)}}},useFedExAccountVerification=function(_a){var t=_a.t,_b=(0,tslib_es6.zs)((0,react.useState)(!1),2),showFedExVerification=_b[0],setShowFedExVerification=_b[1],_c=(0,tslib_es6.zs)((0,react.useState)(!1),2),showPinField=_c[0],setShowPinField=_c[1],fedexCarrierAccountRef=(0,react.useRef)(null),formMethods=(0,index_esm.mN)({mode:"onSubmit",reValidateMode:"onSubmit",resolver:(0,zod.u)(validationFormZodResolver),defaultValues:{verification_option:DefaultVerificationOption,verification_pin:"",verification_invoice_number:"",verification_invoice_amount:"",verification_invoice_date:DefaultInitialDate,verification_invoice_currency:"USD"}}),_d=useFedExInternationalSection(),uploadedImage=_d.uploadedImage,showFedExInternational=_d.showFedExInternational,showFedExImageUploadError=_d.showFedExImageUploadError,validateImageUpload=_d.validateImageUpload,handleImageUpload=_d.handleImageUpload,onFedExInternationalCheckboxChange=_d.onFedExInternationalCheckboxChange,handleSubmit=formMethods.handleSubmit,getValues=formMethods.getValues,_e=function(_a){var t=_a.t,_b=(0,hooks_useRequest.A)(),requestPin=_b.request,requestingPin=_b.loading,requestPinResponse=_b.data,requestPinError=_b.error,requestPinErrorDetails=_b.errorDetails,addSnackbarActionAlert=(0,GlobalComponentsProvider.s)().snackbar.addSnackbarActionAlert;return(0,react.useEffect)((function(){var _a,_b;"PENDING"===(null===(_b=null===(_a=null==requestPinResponse?void 0:requestPinResponse.data)||void 0===_a?void 0:_a.parameters)||void 0===_b?void 0:_b.verification_status)&&addSnackbarActionAlert({message:t("carriers.form.pinSent"),severity:"success"})}),[t,requestPinResponse,addSnackbarActionAlert]),(0,react.useEffect)((function(){var _a;requestPinError&&handleFedexVerificationError(t,addSnackbarActionAlert,null===(_a=null==requestPinErrorDetails?void 0:requestPinErrorDetails.data)||void 0===_a?void 0:_a.detail)}),[addSnackbarActionAlert,requestPinErrorDetails,requestPinError,t]),{requestPin,requestingPin,requestPinResponse,requestPinError}}({t}),requestPin=_e.requestPin,requestingPin=_e.requestingPin,requestPinResponse=_e.requestPinResponse,_f=function(_a){var t=_a.t,uploadedImage=_a.uploadedImage,_b=(0,hooks_useRequest.A)(),requestVerification=_b.request,requestingVerification=_b.loading,requestVerificationResponse=_b.data,requestVerificationError=_b.error,requestVerificationErrorDetails=_b.errorDetails,dispatch=(0,es.wA)(),_c=(0,tslib_es6.zs)((0,react.useState)(!1),2),uploadingImage=_c[0],setUploadingImage=_c[1],addSnackbarActionAlert=(0,GlobalComponentsProvider.s)().snackbar.addSnackbarActionAlert;return(0,react.useEffect)((function(){!requestVerificationError&&requestVerificationResponse&&(0,tslib_es6.sH)(void 0,void 0,void 0,(function(){var carrierAccount,error_1,error_2;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:if(!(carrierAccount=CarrierAccount.rS(requestVerificationResponse.data)).objectId)return[3,9];if(!(null==uploadedImage?void 0:uploadedImage.companyLogo))return[3,4];setUploadingImage(!0),_a.label=1;case 1:return _a.trys.push([1,3,,4]),[4,uploadCompanyLogo(carrierAccount.objectId,uploadedImage.companyLogo)];case 2:return _a.sent(),[3,4];case 3:return error_1=_a.sent(),esm_exports.Cp(new Error("Failed to upload company logo",error_1)),[3,4];case 4:if(!(null==uploadedImage?void 0:uploadedImage.digitalSignature))return[3,9];_a.label=5;case 5:return _a.trys.push([5,7,,8]),[4,uploadDigitalSignature(carrierAccount.objectId,uploadedImage.digitalSignature)];case 6:return _a.sent(),[3,8];case 7:return error_2=_a.sent(),esm_exports.Cp(new Error("Failed to upload digital signature",error_2)),[3,8];case 8:setUploadingImage(!1),_a.label=9;case 9:return dispatch(connectCarrierAccountSuccess({carrierAccount})),[2]}}))}))}),[t,requestVerificationResponse,requestVerificationError,addSnackbarActionAlert,dispatch,uploadedImage]),(0,react.useEffect)((function(){var _a;requestVerificationError&&handleFedexVerificationError(t,addSnackbarActionAlert,null===(_a=null==requestVerificationErrorDetails?void 0:requestVerificationErrorDetails.data)||void 0===_a?void 0:_a.detail)}),[requestVerificationError,requestVerificationErrorDetails,addSnackbarActionAlert,t]),{requestVerification,requestingVerification:requestingVerification||uploadingImage,requestVerificationResponse,requestVerificationError}}({t,uploadedImage}),requestVerification=_f.requestVerification,requestingVerification=_f.requestingVerification;return(0,react.useEffect)((function(){var _a,_b;if("PENDING"===(null===(_b=null===(_a=null==requestPinResponse?void 0:requestPinResponse.data)||void 0===_a?void 0:_a.parameters)||void 0===_b?void 0:_b.verification_status)){var carrierAccount=CarrierAccount.rS(requestPinResponse.data);fedexCarrierAccountRef.current=carrierAccount,setShowPinField(!0)}}),[t,requestPinResponse]),{formMethods,requestingVerification,requestingPin,showFedExVerification,fedexCarrierAccountRef,showPinField,showFedExInternational,showFedExImageUploadError,validateImageUpload,handleImageUpload,onFedExInternationalCheckboxChange,generateVerificationCode:function(){if(fedexCarrierAccountRef.current){var verificationOption=getValues("verification_option")||DefaultVerificationOption,carrierAccount=function(carrierData,verificationOption){var carrierAccount=(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},carrierData),{parameters:(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},null==carrierData?void 0:carrierData.parameters),{verification_option:verificationOption,use_multi_factor_registration:!0})});return"objectOwner"in carrierAccount&&delete carrierAccount.objectOwner,carrierAccount}(fedexCarrierAccountRef.current,verificationOption);requestPin((function(){return(0,tslib_es6.sH)(void 0,void 0,void 0,(function(){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,connectCarrierAccount(CarrierAccount.U2(carrierAccount))];case 1:return[2,_a.sent()]}}))}))}))}},setShowFedExVerification,onVerificationFormSubmit:handleSubmit((function(verificationData){if(fedexCarrierAccountRef.current){var carrierAccount=function(carrierData,verificationData){var carrierAccount=(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},carrierData),{parameters:(0,tslib_es6.Cl)((0,tslib_es6.Cl)((0,tslib_es6.Cl)({},null==carrierData?void 0:carrierData.parameters),verificationData),{use_multi_factor_registration:!0})});return"objectOwner"in carrierAccount&&delete carrierAccount.objectOwner,carrierAccount}(fedexCarrierAccountRef.current,verificationData);requestVerification((function(){return(0,tslib_es6.sH)(void 0,void 0,void 0,(function(){var jsonCarrierAccount,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return jsonCarrierAccount=CarrierAccount.U2(carrierAccount),"INVOICE"!==(null===(_a=carrierAccount.parameters)||void 0===_a?void 0:_a.verification_option)?[3,2]:[4,connectCarrierAccount(jsonCarrierAccount)];case 1:case 3:return[2,_b.sent()];case 2:return[4,editCarrierAccount(jsonCarrierAccount,(null==carrierAccount?void 0:carrierAccount.objectId)||"")]}}))}))}))}}))}},FedexInternationalSection=__webpack_require__("./node_modules/@goshippo/libraries/dist/esm/shared/FedexInternationalSection/index.js"),TabsListWrapper=(0,emotion_styled_browser_esm.A)("div")(CarrierFormTabContainer_templateObject_1||(CarrierFormTabContainer_templateObject_1=(0,tslib_es6.ue)(["\n  margin-bottom: 30px;\n  @media screen and (min-width: ","px) {\n    margin-bottom: 9px;\n  }\n"],["\n  margin-bottom: 30px;\n  @media screen and (min-width: ","px) {\n    margin-bottom: 9px;\n  }\n"])),responsive.P.ExtraSmallMobile+1),StyledTabsList=(0,emotion_styled_browser_esm.A)(components_Tabs.TabsList)(CarrierFormTabContainer_templateObject_2||(CarrierFormTabContainer_templateObject_2=(0,tslib_es6.ue)(["\n  justify-content: space-evenly;\n"],["\n  justify-content: space-evenly;\n"]))),StyledTab=(0,emotion_styled_browser_esm.A)(components_Tabs.Tab)(CarrierFormTabContainer_templateObject_3||(CarrierFormTabContainer_templateObject_3=(0,tslib_es6.ue)(["\n  display: block;\n  margin-left: auto;\n  margin-right: auto;\n  width: 240px;\n  padding-top: 16px;\n"],["\n  display: block;\n  margin-left: auto;\n  margin-right: auto;\n  width: 240px;\n  padding-top: 16px;\n"]))),CarrierFormTabContainer_CarrierLogo=(0,emotion_styled_browser_esm.A)("img")(CarrierFormTabContainer_templateObject_4||(CarrierFormTabContainer_templateObject_4=(0,tslib_es6.ue)(["\n  display: block;\n  max-width: 100px;\n  padding-top: 20px;\n  margin: 0 auto;\n"],["\n  display: block;\n  max-width: 100px;\n  padding-top: 20px;\n  margin: 0 auto;\n"]))),StyledHeader=(0,emotion_styled_browser_esm.A)("div")(CarrierFormTabContainer_templateObject_5||(CarrierFormTabContainer_templateObject_5=(0,tslib_es6.ue)(["\n  color: ",";\n  font-weight: ",";\n  text-align: center;\n  border-bottom: 1px solid ",";\n  padding: 16px;\n"],["\n  color: ",";\n  font-weight: ",";\n  text-align: center;\n  border-bottom: 1px solid ",";\n  padding: 16px;\n"])),styles_constants.Tj.fontColor,styles_constants.Wy.medium,styles_constants.Tj.gray50);const CarrierFormTabContainer_CarrierFormTabContainer=(0,redux.Zz)((0,es.Ng)(null,(function(dispatch){return{sendCarrierFormTrackEvent:function(formName,eventType,formType){return dispatch(function trackCarrierFormEvent(formName,eventType,formType){return{formName,eventType,formType,type:constants.t.CARRIER_FORM_INPUT_EVENT}}(formName,eventType,formType))}}})),(0,utils_translate.Tl)("settings"),Carriers_withCarrierForm)((function(props){var showFedExInternationalSection,mockedParameters,formInitialValues,carrier=props.carrier,onClose=props.onClose,initialValues=props.initialValues,hideAccountNickname=props.hideAccountNickname,customHeader=props.customHeader,renderEbayCanadaPostForm=props.renderEbayCanadaPostForm,context=react.useContext(withCarrierForm_Context),_a=useFedExAccountVerification({t:props.t}),formMethods=_a.formMethods,showFedExVerification=_a.showFedExVerification,fedexCarrierAccountRef=_a.fedexCarrierAccountRef,requestingVerification=_a.requestingVerification,requestingPin=_a.requestingPin,showPinField=_a.showPinField,showFedExInternational=_a.showFedExInternational,showFedExImageUploadError=_a.showFedExImageUploadError,validateImageUpload=_a.validateImageUpload,handleImageUpload=_a.handleImageUpload,onFedExInternationalCheckboxChange=_a.onFedExInternationalCheckboxChange,generateVerificationCode=_a.generateVerificationCode,onVerificationFormSubmit=_a.onVerificationFormSubmit,setShowFedExVerification=_a.setShowFedExVerification,isNewFedExAPI=useNewFedExAPIFeatureFlag().isNewFedExAPI,shouldDisplayEbayCanadaPostForm=function(){return carrier===carriers.i3&&context.isEBayConnected&&!context.hasEBayCanadaPostAccount||renderEbayCanadaPostForm},showCreateTab=function(){var user=context.user;if(context.successfullyFetchedAccounts&&carriers.mp.includes(carrier.id)||renderEbayCanadaPostForm){if(shouldDisplayEbayCanadaPostForm())return!0;if(!(carrier!==carriers.$5||user&&user.address&&user.address.country&&"US"!==user.address.country.iso2||context.hasUpsMarketplaceOrMasterAcc))return!0}return!1}(),_b=(0,tslib_es6.zs)(react.useState(showCreateTab?CarrierFormType.Create:CarrierFormType.Connect),2),selectedTab=_b[0],setSelectedTab=_b[1],shouldShowFedEXInternationalSection=!(!isNewFedExAPI||carrier!==carriers.jr),onCarrierFormSubmit=function(formValues){var e_1,_a,_b,carrierAccount={carrier,active:!0,test:!1,accountId:formValues.account_id?"".concat(formValues.account_id):"filler_id"},trackingReference=TrackingHelper.U.getTrackingReference(types.UQ.name,"settings",{carrierName:carrier.name,carrierAccountId:carrierAccount.accountId,carrierType:void 0});try{for(var _c=(0,tslib_es6.Ju)(Object.keys(formValues)),_d=_c.next();!_d.done;_d=_c.next()){var key=_d.value;if("account_id"!==key)if("metadata"===key)carrierAccount.metadata=formValues[key];else if("test"===key)carrierAccount.test=formValues[key];else if(carrierAccount.parameters||(carrierAccount.parameters={}),carrierAccount.parameters[key]=formValues[key],"is_mypost"===key){var is_mypost_field=JSON.parse(JSON.stringify(formValues[key]));is_mypost_field.value="is_mypost"===(null===(_b=formValues[key])||void 0===_b?void 0:_b.value),carrierAccount.parameters[key]=is_mypost_field,carrierAccount.metadata||(carrierAccount.metadata="MyPost")}}}catch(e_1_1){e_1={error:e_1_1}}finally{try{_d&&!_d.done&&(_a=_c.return)&&_a.call(_c)}finally{if(e_1)throw e_1.error}}if(fedexCarrierAccountRef.current=carrierAccount,!shouldShowFedEXInternationalSection||showFedExVerification)return(0,utils.EE)(trackingReference,types.UQ.operations.SAVE_ATTEMPTED,{}),shouldDisplayEbayCanadaPostForm()&&props.sendCarrierFormTrackEvent(TabbedCarrierFormName.EbayCanadaPost,CarrierFormEventType.Submit,selectedTab),selectedTab===CarrierFormType.Create?((0,utils.EE)(trackingReference,types.UQ.operations.ADDED,{}),context.createCarrierAccount({carrierAccount,trackingReference})):((0,utils.EE)(trackingReference,types.UQ.operations.ACTIVATED,{}),carrierAccount.active=!0,context.connectCarrierAccount({carrierAccount,trackingReference}));validateImageUpload()&&setShowFedExVerification(!0)};return(0,emotion_react_jsx_runtime_browser_esm.FD)(components_Tabs.Container,(0,tslib_es6.Cl)({activeBorderBottom:!0,selectedTab,onTabClick:function(tab){var userSelectedTab=CarrierFormType.Create;tab===CarrierFormType.Create||(userSelectedTab=CarrierFormType.Connect),setSelectedTab(userSelectedTab),shouldDisplayEbayCanadaPostForm()&&props.sendCarrierFormTrackEvent(TabbedCarrierFormName.EbayCanadaPost,CarrierFormEventType.Click,userSelectedTab)}},{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[customHeader||carrier.img260&&(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierFormTabContainer_CarrierLogo,{src:carrier.img260}),showCreateTab?(0,emotion_react_jsx_runtime_browser_esm.Y)(TabsListWrapper,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(StyledTabsList,(0,tslib_es6.Cl)({activeBorderBottom:!0},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(StyledTab,(0,tslib_es6.Cl)({tabKey:CarrierFormType.Create},{children:props.t("carriers.form.createFormTab")})),(0,emotion_react_jsx_runtime_browser_esm.Y)(StyledTab,(0,tslib_es6.Cl)({tabKey:CarrierFormType.Connect},{children:props.t("carriers.form.connectFormTab")}))]}))}):(0,emotion_react_jsx_runtime_browser_esm.Y)(StyledHeader,{children:props.t("carriers.connectCarrierAccount",{carrierName:carrier.name})})]}),carrier!==carriers.i3||showCreateTab?(0,emotion_react_jsx_runtime_browser_esm.FD)(emotion_react_jsx_runtime_browser_esm.FK,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({style:{display:showFedExVerification?"none":"block"}},{children:(mockedParameters=isCarrierFormMocked(carrier.id,selectedTab)?showCreateTab&&carrier===carriers.i3&&selectedTab===CarrierFormType.Connect?eBayCanadaPostConnectParameters:parametersMap[carrier.id][selectedTab]:[],formInitialValues=context.getInitialFormValues(null,carrier,selectedTab,mockedParameters),initialValues&&Object.keys(initialValues).forEach((function(key){formInitialValues[key]=initialValues[key]})),(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierForm_CarrierForm,{hideTestMode:showCreateTab,hideAccountNickname:hideAccountNickname||context.shouldHideAccountNickname(carrier,selectedTab),parameters:mockedParameters,carrier,onSubmit:onCarrierFormSubmit,formType:selectedTab,errorMessage:context.errorMessage,initialValues:formInitialValues,fedExInternationalSection:(showFedExInternationalSection=shouldShowFedEXInternationalSection,showFedExInternationalSection?(0,emotion_react_jsx_runtime_browser_esm.Y)(FedexInternationalSection.M6,{t:props.t,requiredError:showFedExImageUploadError,showFedExInternational,onChangeCheckbox:onFedExInternationalCheckboxChange,onImageUpload:handleImageUpload}):null),newFedExAPI:isNewFedExAPI}))})),(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({style:{display:showFedExVerification?"block":"none"}},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(FedexInternationalSection.hW,{formMethods,isSendingPin:requestingPin,hasSentVerificationPin:showPinField,onSendVerificationPin:generateVerificationCode,onVerificationFormSubmit,t:props.t})})),(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierModalFooter_CarrierModalFooter,{formType:selectedTab,carrier,onPrimaryClick:showFedExVerification?onVerificationFormSubmit:context.submitCarrierForm,onCancelClick:function(){showFedExVerification?setShowFedExVerification(!1):(onClose(),shouldDisplayEbayCanadaPostForm()&&props.sendCarrierFormTrackEvent(TabbedCarrierFormName.EbayCanadaPost,CarrierFormEventType.Close))},isLoading:context.isSavingCarrierAccount||requestingVerification,customPrimaryButtonText:function(){if(shouldShowFedEXInternationalSection&&!showFedExVerification)return props.t("carriers.form.next")}(),customSecondaryButtonText:function(){if(showFedExVerification)return props.t("carriers.form.back")}()})]}):(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"px-8 py-5"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Carriers_CanadaPostConnectRedirect,{})}))]}))}));var CarrierFormTabContainer_templateObject_1,CarrierFormTabContainer_templateObject_2,CarrierFormTabContainer_templateObject_3,CarrierFormTabContainer_templateObject_4,CarrierFormTabContainer_templateObject_5,SearchFilterContainer=(0,emotion_styled_browser_esm.A)(FlexContainer.Ay)(CarrierSearchAndFilter_templateObject_1||(CarrierSearchAndFilter_templateObject_1=(0,tslib_es6.ue)(["\n  flex-direction: column;\n  @media screen and (min-width: ","px) {\n    flex-direction: row;\n  }\n  margin-bottom: 12px;\n"],["\n  flex-direction: column;\n  @media screen and (min-width: ","px) {\n    flex-direction: row;\n  }\n  margin-bottom: 12px;\n"])),responsive.P.Mobile),CarrierSearchBar=(0,emotion_styled_browser_esm.A)(components_InputExtended)(CarrierSearchAndFilter_templateObject_2||(CarrierSearchAndFilter_templateObject_2=(0,tslib_es6.ue)(["\n  flex-grow: 1;\n  margin-bottom: 8px;\n  padding: 0px;\n  max-width: calc(100% - 2px);\n  @media screen and (min-width: ","px) {\n    margin-bottom: inherit;\n    margin-right: 10px;\n  }\n  height: ","px;\n"],["\n  flex-grow: 1;\n  margin-bottom: 8px;\n  padding: 0px;\n  max-width: calc(100% - 2px);\n  @media screen and (min-width: ","px) {\n    margin-bottom: inherit;\n    margin-right: 10px;\n  }\n  height: ","px;\n"])),responsive.P.Mobile,constants_form.hx.mediumLarge),CarrierFilter=(0,emotion_styled_browser_esm.A)(Select_Select)(CarrierSearchAndFilter_templateObject_3||(CarrierSearchAndFilter_templateObject_3=(0,tslib_es6.ue)(["\n  width: ","px;\n"],["\n  width: ","px;\n"])),constants_form.YI.medium),CarrierSearchIcon=(0,emotion_styled_browser_esm.A)("i")(CarrierSearchAndFilter_templateObject_4||(CarrierSearchAndFilter_templateObject_4=(0,tslib_es6.ue)(["\n  margin: 0px 12px;\n"],["\n  margin: 0px 12px;\n"]))),DefaultOption=(0,emotion_styled_browser_esm.A)("span")(CarrierSearchAndFilter_templateObject_5||(CarrierSearchAndFilter_templateObject_5=(0,tslib_es6.ue)(["\n  color: ",";\n  font-weight: ",";\n"],["\n  color: ",";\n  font-weight: ",";\n"])),styles_constants.Tj.form.placeholderFontColor,styles_constants.Wy.medium),SelectedOption=(0,emotion_styled_browser_esm.A)("span")(CarrierSearchAndFilter_templateObject_6||(CarrierSearchAndFilter_templateObject_6=(0,tslib_es6.ue)(["\n  font-weight: ",";\n"],["\n  font-weight: ",";\n"])),styles_constants.Wy.medium);const CarrierSearchAndFilter_CarrierSearchAndFilter=(0,redux.Zz)((0,utils_translate.Tl)("settings"))((function(props){var carrierOriginCountryOptions=Object.keys(carriers.vX).map((function(regionName){return{label:regionName,value:regionName.toLowerCase()}}));carrierOriginCountryOptions.unshift({label:props.t("carriers.filterCarriersZeroState"),value:""});return(0,emotion_react_jsx_runtime_browser_esm.FD)(SearchFilterContainer,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierSearchBar,{onChange:function(input){props.onChange(input.target.value)},value:props.value,id:"carrier-search-bar",placeholder:props.t("carriers.searchCarriers"),renderPrefix:function(){return(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierSearchIcon,{className:"fa fa-search"})}}),(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierFilter,{onChange:function(option){props.onChangeFilter(option)},value:props.filterValue,options:carrierOriginCountryOptions,placeholder:props.t("carriers.filterCarriers"),renderSelectButtonContent:function(selectedOption){return selectedOption&&""===selectedOption.value?selectedOption&&(0,emotion_react_jsx_runtime_browser_esm.Y)(DefaultOption,{children:selectedOption.label}):selectedOption&&(0,emotion_react_jsx_runtime_browser_esm.Y)(SelectedOption,{children:selectedOption.label})},height:constants_form.hx.mediumLarge+2})]})}));var CarrierSearchAndFilter_templateObject_1,CarrierSearchAndFilter_templateObject_2,CarrierSearchAndFilter_templateObject_3,CarrierSearchAndFilter_templateObject_4,CarrierSearchAndFilter_templateObject_5,CarrierSearchAndFilter_templateObject_6,headerCSS=(0,emotion_react_browser_esm.AH)(ConnectCarrierSelection_templateObject_1||(ConnectCarrierSelection_templateObject_1=(0,tslib_es6.ue)(["\n  margin-top: 0px;\n  font-size: 20px;\n  color: ",";\n  font-weight: ",";\n"],["\n  margin-top: 0px;\n  font-size: 20px;\n  color: ",";\n  font-weight: ",";\n"])),styles_constants.Tj.fontColor,styles_constants.Wy.medium),MobileModalHeader=(0,emotion_styled_browser_esm.A)("h3")(ConnectCarrierSelection_templateObject_2||(ConnectCarrierSelection_templateObject_2=(0,tslib_es6.ue)(["\n  "," margin: 0px;\n  padding: 30px;\n  position: fixed;\n  top: 0px;\n\n  @media screen and (min-width: ","px) {\n    display: none;\n  }\n"],["\n  "," margin: 0px;\n  padding: 30px;\n  position: fixed;\n  top: 0px;\n\n  @media screen and (min-width: ","px) {\n    display: none;\n  }\n"])),headerCSS,responsive.P.Mobile),FirstSlideHeader=(0,emotion_styled_browser_esm.A)("h3")(ConnectCarrierSelection_templateObject_3||(ConnectCarrierSelection_templateObject_3=(0,tslib_es6.ue)(["\n  "," display: none;\n  @media screen and (min-width: ","px) {\n    display: block;\n  }\n  font-weight: ",";\n"],["\n  "," display: none;\n  @media screen and (min-width: ","px) {\n    display: block;\n  }\n  font-weight: ",";\n"])),headerCSS,responsive.P.Mobile,styles_constants.Wy.medium),MobileModalFooterContainer=(0,emotion_styled_browser_esm.A)("div")(ConnectCarrierSelection_templateObject_4||(ConnectCarrierSelection_templateObject_4=(0,tslib_es6.ue)(["\n  display: none;\n  @media screen and (min-width: ","px) {\n    display: block;\n  }\n"],["\n  display: none;\n  @media screen and (min-width: ","px) {\n    display: block;\n  }\n"])),responsive.P.Mobile),CarrierModalContainer=(0,emotion_styled_browser_esm.A)(Modal.A.Body)(ConnectCarrierSelection_templateObject_5||(ConnectCarrierSelection_templateObject_5=(0,tslib_es6.ue)(["\n  overflow: auto;\n  padding-top: 0px;\n  padding-bottom: 0px;\n  position: fixed;\n  top: 90px;\n  bottom: 0;\n  left: 0;\n  right: 0;\n\n  @media screen and (min-width: ","px) {\n    height: 65vh;\n    padding-top: 30px;\n    position: relative;\n    top: auto;\n    bottom: auto;\n    right: auto;\n    left: auto;\n  }\n"],["\n  overflow: auto;\n  padding-top: 0px;\n  padding-bottom: 0px;\n  position: fixed;\n  top: 90px;\n  bottom: 0;\n  left: 0;\n  right: 0;\n\n  @media screen and (min-width: ","px) {\n    height: 65vh;\n    padding-top: 30px;\n    position: relative;\n    top: auto;\n    bottom: auto;\n    right: auto;\n    left: auto;\n  }\n"])),responsive.P.Mobile),CarrierImg=(0,emotion_styled_browser_esm.A)("img")(ConnectCarrierSelection_templateObject_6||(ConnectCarrierSelection_templateObject_6=(0,tslib_es6.ue)(["\n  margin-bottom: 18px;\n  cursor: pointer;\n  max-width: 100%;\n"],["\n  margin-bottom: 18px;\n  cursor: pointer;\n  max-width: 100%;\n"]))),CarrierList=(0,emotion_styled_browser_esm.A)("ul")(ConnectCarrierSelection_templateObject_7||(ConnectCarrierSelection_templateObject_7=(0,tslib_es6.ue)(["\n  margin: 0;\n  padding: 0;\n"],["\n  margin: 0;\n  padding: 0;\n"]))),SegmentHeader=(0,emotion_styled_browser_esm.A)("div")(ConnectCarrierSelection_templateObject_8||(ConnectCarrierSelection_templateObject_8=(0,tslib_es6.ue)(["\n  padding-bottom: 10px;\n  font-size: 14px;\n  font-weight: ",";\n"],["\n  padding-bottom: 10px;\n  font-size: 14px;\n  font-weight: ",";\n"])),styles_constants.Wy.medium),SegmentImgsContainer=(0,emotion_styled_browser_esm.A)("div")(ConnectCarrierSelection_templateObject_9||(ConnectCarrierSelection_templateObject_9=(0,tslib_es6.ue)(["\n  display: grid;\n  column-gap: 14px;\n  grid-template-columns: repeat(2, 1fr);\n  @media screen and (min-width: ","px) {\n    grid-template-columns: repeat(4, 120px);\n  }\n"],["\n  display: grid;\n  column-gap: 14px;\n  grid-template-columns: repeat(2, 1fr);\n  @media screen and (min-width: ","px) {\n    grid-template-columns: repeat(4, 120px);\n  }\n"])),responsive.P.Mobile),CarrierUnderline=(0,emotion_styled_browser_esm.A)("div")(ConnectCarrierSelection_templateObject_10||(ConnectCarrierSelection_templateObject_10=(0,tslib_es6.ue)(["\n  width: 20px;\n  border-bottom: 3px solid ",";\n"],["\n  width: 20px;\n  border-bottom: 3px solid ",";\n"])),styles_constants.Tj.form.successBar),filterCarriers=function(searchValue,filterValue){var filteredCarriers={};for(var segment in carriers.TN){var filtered=carriers.TN[segment].filter((function(value){var searchMatch=!0,filterMatch=!0;return carriers.vX[filterValue]&&(filterMatch=carriers.vX[filterValue].includes(carriers.Ps[value.id])),""!==searchValue&&filterMatch&&(searchMatch=value.name.toLowerCase().includes(searchValue.toLowerCase())),searchMatch&&filterMatch}));filteredCarriers[segment]=filtered}return filteredCarriers},ComposedConnectCarrierSelection=(0,redux.Zz)((0,utils_translate.Tl)("settings"))((function(props){var _a=(0,tslib_es6.zs)(react.useState(props.carrierSearchQuery),2),carrierSearchQuery=_a[0],setCarrierSearchQuery=_a[1],_b=(0,tslib_es6.zs)(react.useState(props.carrierFilter),2),carrierFilter=_b[0],setCarrierFilter=_b[1],_c=(0,tslib_es6.zs)(react.useState(props.carrierSearchResults),2),carrierSearchResults=_c[0],setCarrierSearchResults=_c[1],onSearchFilterChange=function(searchValue,filterValue){if(""===searchValue&&""===filterValue)setCarrierSearchResults(carriers.TN);else{var filteredCarriers=filterCarriers(searchValue,filterValue);setCarrierSearchResults(filteredCarriers),props.setCarrierSearchResults(filteredCarriers)}},renderCarrierSegment=function(segmentName,segment){var t=props.t,onClickCarrier=props.onClickCarrier;return segment.map((function(carrier){return(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierImg,{src:carrier.img260?carrier.img260:carrier.img,alt:t("carriers.connectCarrierImageAltText",{carrierName:carrier.name}),id:carrier.id,onClick:onClickCarrier},"".concat(segmentName,"_").concat(carrier.id))}))},t=props.t;return(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(MobileModalHeader,{children:t("carriers.connectButtonText")}),(0,emotion_react_jsx_runtime_browser_esm.FD)(CarrierModalContainer,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(FirstSlideHeader,{children:t("carriers.connectButtonText")}),(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierSearchAndFilter_CarrierSearchAndFilter,{onChange:function(searchValue){setCarrierSearchQuery(searchValue),onSearchFilterChange(searchValue,carrierFilter.label),props.setCarrierSearchQuery(searchValue)},value:carrierSearchQuery,onChangeFilter:function(filterOption){setCarrierFilter(filterOption),onSearchFilterChange(carrierSearchQuery,filterOption.label),props.setCarrierFilter(filterOption)},filterValue:carrierFilter}),function(){var t=props.t,carrierArray=[];for(var segment in carrierSearchResults)0!==carrierSearchResults[segment].length&&(carrierArray.push((0,emotion_react_jsx_runtime_browser_esm.FD)(SegmentHeader,{children:[segment,(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierUnderline,{})]},"".concat(segment,"_seg"))),carrierArray.push((0,emotion_react_jsx_runtime_browser_esm.Y)(SegmentImgsContainer,{children:renderCarrierSegment(segment,carrierSearchResults[segment])},segment)));return 0===carrierArray.length?(0,emotion_react_jsx_runtime_browser_esm.FD)("div",{children:[t("carriers.searchCarriersNoResult")," ",(0,emotion_react_jsx_runtime_browser_esm.Y)("i",{children:carrierSearchQuery})]}):(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierList,{children:carrierArray})}()]}),(0,emotion_react_jsx_runtime_browser_esm.Y)(MobileModalFooterContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Modal.A.Footer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Button.vM,(0,tslib_es6.Cl)({onClick:props.onClose},{children:t("carriers.cancel")}))})})]})}));const ConnectCarrierSelection_ConnectCarrierSelection=ComposedConnectCarrierSelection;var ConnectCarrierSelection_templateObject_1,ConnectCarrierSelection_templateObject_2,ConnectCarrierSelection_templateObject_3,ConnectCarrierSelection_templateObject_4,ConnectCarrierSelection_templateObject_5,ConnectCarrierSelection_templateObject_6,ConnectCarrierSelection_templateObject_7,ConnectCarrierSelection_templateObject_8,ConnectCarrierSelection_templateObject_9,ConnectCarrierSelection_templateObject_10,growCSS=(0,emotion_react_browser_esm.AH)(SlideConnectCarrierModal_templateObject_1||(SlideConnectCarrierModal_templateObject_1=(0,tslib_es6.ue)(["\n  flex-grow: 1;\n  flex-shrink: 1;\n  flex-basis: auto;\n"],["\n  flex-grow: 1;\n  flex-shrink: 1;\n  flex-basis: auto;\n"]))),StyledSlideModal=(0,emotion_styled_browser_esm.A)(SlideModal.A)(SlideConnectCarrierModal_templateObject_2||(SlideConnectCarrierModal_templateObject_2=(0,tslib_es6.ue)(["\n  overflow: hidden !important;\n  position: fixed;\n  top: 0;\n  bottom: 0;\n\n  @media screen and (min-width: ","px) {\n    top: auto;\n    bottom: auto;\n    position: relative;\n  }\n"],["\n  overflow: hidden !important;\n  position: fixed;\n  top: 0;\n  bottom: 0;\n\n  @media screen and (min-width: ","px) {\n    top: auto;\n    bottom: auto;\n    position: relative;\n  }\n"])),responsive.P.Mobile),CarrierFormGrowContainer=(0,emotion_styled_browser_esm.A)(SlideModal.U)(SlideConnectCarrierModal_templateObject_3||(SlideConnectCarrierModal_templateObject_3=(0,tslib_es6.ue)(["\n  display: block;\n  overflow: auto;\n  position: fixed;\n  top: 71px;\n  bottom: 0px;\n  left: 0;\n  right: 0;\n  padding-bottom: calc(",");\n\n  @media screen and (min-width: ","px) {\n    position: relative;\n    top: auto;\n    bottom: auto;\n    left: auto;\n    right: auto;\n    padding-bottom: initial;\n  }\n"],["\n  display: block;\n  overflow: auto;\n  position: fixed;\n  top: 71px;\n  bottom: 0px;\n  left: 0;\n  right: 0;\n  padding-bottom: calc(",");\n\n  @media screen and (min-width: ","px) {\n    position: relative;\n    top: auto;\n    bottom: auto;\n    left: auto;\n    right: auto;\n    padding-bottom: initial;\n  }\n"])),"66px",responsive.P.Mobile);(0,redux.Zz)((0,es.Ng)(null,(function(dispatch){return{track:function(eventName,properties){return dispatch((0,prod_analytics_actions.o)(eventName,properties))},clearCarrierAccountsState:function(){return dispatch(function carrier_accounts_actions_carrierAccountsClearState(){return{type:constants.t.CARRIER_ACCOUNTS_CLEAR_STATE}}())}}})),(0,utils_translate.Tl)("settings"))((function(props){var isEbayCanadaRegistrationCookiePresent="true"===getCookie("ebay_ca_connect_start"),_a=(0,tslib_es6.zs)(react.useState(null),2),selectedCarrier=_a[0],setSelectedCarrier=_a[1],_b=(0,tslib_es6.zs)(react.useState(!1),2),canSlide=_b[0],setCanSlide=_b[1],_c=(0,tslib_es6.zs)(react.useState(""),2),carrierSearchCache=_c[0],setCarrierSearchCache=_c[1],_d=(0,tslib_es6.zs)(react.useState(isEbayCanadaRegistrationCookiePresent?{label:"Canada",value:"canada"}:props.carrierFilter?{label:props.carrierFilter,value:props.carrierFilter.toLowerCase()}:{label:props.t("carriers.filterCarriers"),value:""}),2),carrierFilterCache=_d[0],setCarrierFilterCache=_d[1],_e=(0,tslib_es6.zs)(react.useState(isEbayCanadaRegistrationCookiePresent?filterCarriers("","Canada"):props.carrierFilter?filterCarriers("",props.carrierFilter):carriers.TN),2),carrierSearchResultsCache=_e[0],setCarrierSearchResultsCache=_e[1];react.useEffect((function(){isEbayCanadaRegistrationCookiePresent&&props.track("EBAYCA_CARRIER_SLIDE_MODAL_RENDERED",{Filter:carrierFilterCache.value})}),[]);var clearSlideModal=function(){setCanSlide(!1),setSelectedCarrier(null),props.clearCarrierAccountsState()},onCancelClick=function(){clearSlideModal(),props.onClose()},t=props.t,onClose=props.onClose;return(0,emotion_react_jsx_runtime_browser_esm.FD)(StyledSlideModal,(0,tslib_es6.Cl)({isOpen:!0,closeOnClickOutside:!1,isSlided:canSlide,backText:t("carriers.back"),backTextAsTitle:!0,size:"md",onClose,onBackClick:clearSlideModal},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(ConnectCarrierSelection_ConnectCarrierSelection,{onClickCarrier:function(e){var carrier=carriers.Ps[e.target.id],trackingReferece=TrackingHelper.U.getTrackingReference(types.UQ.name,"settings",{carrierAccountId:carrier.id,carrierName:null==carrier?void 0:carrier.name,carrierType:void 0});(0,utils.EE)(trackingReferece,types.UQ.operations.SELECTED,{}),setSelectedCarrier(carrier),setCanSlide(!0),props.track("CARRIER_SLIDE_MODAL_CARRIER_SELECTED",{Carrier:carrier.name})},onClose:onCancelClick,carrierSearchQuery:carrierSearchCache,setCarrierSearchQuery:setCarrierSearchCache,carrierFilter:carrierFilterCache,setCarrierFilter:setCarrierFilterCache,carrierSearchResults:carrierSearchResultsCache,setCarrierSearchResults:setCarrierSearchResultsCache}),selectedCarrier?(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierFormGrowContainer,(0,tslib_es6.Cl)({slideContent:!0},{children:selectedCarrier?(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierFormTabContainer_CarrierFormTabContainer,{carrier:selectedCarrier,onClose:onCancelClick}):null})):(0,emotion_react_jsx_runtime_browser_esm.Y)(emotion_react_jsx_runtime_browser_esm.FK,{})]}))}));var SlideConnectCarrierModal_templateObject_1,SlideConnectCarrierModal_templateObject_2,SlideConnectCarrierModal_templateObject_3,CanadaPostRegistrationModal_styles_templateObject_1,CanadaPostRegistrationModal_styles_templateObject_2,CanadaPostRegistrationModal_styles_templateObject_3,styles_FormGroup=(0,emotion_styled_browser_esm.A)("div")(CanadaPostRegistrationModal_styles_templateObject_1||(CanadaPostRegistrationModal_styles_templateObject_1=(0,tslib_es6.ue)(["\n  margin-bottom: 1rem;\n  label {\n    margin-bottom: 0.25rem;\n  }\n  &.hidden {\n    display: none;\n  }\n"],["\n  margin-bottom: 1rem;\n  label {\n    margin-bottom: 0.25rem;\n  }\n  &.hidden {\n    display: none;\n  }\n"]))),styles_CarrierFormGrowContainer=(0,emotion_styled_browser_esm.A)("div")(CanadaPostRegistrationModal_styles_templateObject_2||(CanadaPostRegistrationModal_styles_templateObject_2=(0,tslib_es6.ue)(["\n  ",";\n  position: fixed;\n  top: calc(",");\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: auto;\n  padding-bottom: ",";\n\n  @media screen and (min-width: ","px) {\n    position: relative;\n    top: auto;\n    left: auto;\n    right: auto;\n    bottom: auto;\n    overflow: visible;\n    padding-bottom: initial;\n  }\n"],["\n  ",";\n  position: fixed;\n  top: calc(",");\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: auto;\n  padding-bottom: ",";\n\n  @media screen and (min-width: ","px) {\n    position: relative;\n    top: auto;\n    left: auto;\n    right: auto;\n    bottom: auto;\n    overflow: visible;\n    padding-bottom: initial;\n  }\n"])),growCSS,headerMobileHeight,"66px",responsive.P.Mobile),TermsWrapper=(0,emotion_styled_browser_esm.A)("span")(CanadaPostRegistrationModal_styles_templateObject_3||(CanadaPostRegistrationModal_styles_templateObject_3=(0,tslib_es6.ue)(["\n  > a {\n    color: ",";\n  }\n"],["\n  > a {\n    color: ",";\n  }\n"])),styles_constants.Tj.sea600),formBaseName="canada_post-master",ComposedCanadaPostRegistrationLongForm=(0,utils_translate.Tl)("settings")((function(props){var t=props.t,header=props.header,_a=props.primaryButtonText,primaryButtonText=void 0===_a?"":_a,_b=props.description,description=void 0===_b?"":_b,initialFormValues=props.initialFormValues,_c=props.isSubmitting,isSubmitting=void 0!==_c&&_c,onSubmit=props.onSubmit,onClose=props.onClose,formType=props.formType,_d=(0,index_esm.mN)(),register=_d.register,control=_d.control,watch=_d.watch,getValues=_d.getValues,setValue=_d.setValue,handleSubmit=_d.handleSubmit,trigger=_d.trigger,formState=_d.formState,dispatch=(0,es.wA)(),_e=(0,tslib_es6.zs)(react.useState("I agree to the Canada Post <a href='https://www.canadapost-postescanada.ca/tools/pg/serviceoverview/ParcelsContractCustomersCanada-e.asp' target='_blank' rel='noreferrer' > Terms of Use </a> and <a href='https://www.canadapost-postescanada.ca/cpc/en/our-company/about-us/privacy-policy/privacy-policy-introduction.page' target='_blank' rel='noreferrer' >Privacy Statement</a>"),2),termsConditionsTitle=_e[0],setTermsConditionsTitle=_e[1],carrierFormFields=(0,es.d4)((function(state){return getCarrierFormFields(state)}));react.useEffect((function(){return dispatch((0,prod_analytics_actions.o)("CANADA_POST_MASTER_LONG_FORM_SHOWN")),dispatch(fetchCarrierFormFields({carrier:carriers.i3,formType:CarrierFormType.Create})),function(){dispatch(carrierFormFieldsClearState())}}),[]),react.useEffect((function(){if(carrierFormFields&&carrierFormFields.length>0){var termsFieldParams=carrierFormFields[carrierFormFields.length-1];"canada_post_terms"===(null==termsFieldParams?void 0:termsFieldParams.key)&&setTermsConditionsTitle(termsFieldParams.label)}}),[carrierFormFields]),react.useEffect((function(){initialFormValues&&Object.keys(initialFormValues).forEach((function(fieldName){setValue(fieldName,initialFormValues[fieldName])}))}),[initialFormValues]);var onFormSubmit=react.useCallback((function(){trigger().then((function(valid){if(valid){var formValues=getValues();onSubmit(formValues)}}))}),[onSubmit]),getErrorMessage=react.useCallback((function(fieldName){var fieldErrors=formState.errors[fieldName];return fieldErrors&&fieldErrors.type?"phone"!==fieldName?fieldErrors.message:"isValidPhoneNumber"===fieldErrors.type?t("carriers.canadaPostMasterForm.fieldError.invalidPhone"):fieldErrors.message:""}),[formState]);return(0,emotion_react_jsx_runtime_browser_esm.FD)("form",(0,tslib_es6.Cl)({onSubmit:handleSubmit(onFormSubmit)},{children:[header&&header,(0,emotion_react_jsx_runtime_browser_esm.Y)(styles_CarrierFormGrowContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(CarrierFormModalBody,(0,tslib_es6.Cl)({"data-testid":"canada-post-registration-long-form"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Carriers_CarrierErrorMessageDisplay,{}),(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"flex flex-col"},{children:[description&&(0,emotion_react_jsx_runtime_browser_esm.Y)("p",{children:description}),(0,emotion_react_jsx_runtime_browser_esm.Y)(Grid.f,(0,tslib_es6.Cl)({className:"mb-4"},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(Grid.V,(0,tslib_es6.Cl)({width:"100%"},{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(styles_FormGroup,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Label.A,(0,tslib_es6.Cl)({htmlFor:"".concat(formBaseName,"-company"),required:!0},{children:t("carriers.canadaPostMasterForm.fields.company")})),(0,emotion_react_jsx_runtime_browser_esm.Y)(index_esm.xI,{name:"company",render:function(_a){var field=_a.field;return(0,emotion_react_jsx_runtime_browser_esm.Y)(Input.Ay,(0,tslib_es6.Cl)({},field,{id:"".concat(formBaseName,"-company"),name:"company",responsive:!0,inputRef:register("company",{required:{value:!0,message:t("carriers.canadaPostMasterForm.fieldError.required")}}).ref,errorMessage:getErrorMessage("company"),invalid:getErrorMessage("company").length>0}))},control})]}),(0,emotion_react_jsx_runtime_browser_esm.FD)(styles_FormGroup,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Label.A,(0,tslib_es6.Cl)({htmlFor:"".concat(formBaseName,"-full_name"),required:!0},{children:t("carriers.canadaPostMasterForm.fields.full_name")})),(0,emotion_react_jsx_runtime_browser_esm.Y)(index_esm.xI,{control,rules:{required:{value:!0,message:t("carriers.canadaPostMasterForm.fieldError.required")}},render:function(_a){var field=_a.field;return(0,emotion_react_jsx_runtime_browser_esm.Y)(Input.Ay,(0,tslib_es6.Cl)({},field,{id:"".concat(formBaseName,"-full_name"),name:"full_name",responsive:!0,inputRef:register("full_name",{required:{value:!0,message:t("carriers.canadaPostMasterForm.fieldError.required")}}).ref,errorMessage:getErrorMessage("full_name"),invalid:getErrorMessage("full_name").length>0}))},name:"full_name"})]}),(0,emotion_react_jsx_runtime_browser_esm.FD)(styles_FormGroup,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Label.A,(0,tslib_es6.Cl)({htmlFor:"".concat(formBaseName,"-email"),required:!0},{children:t("carriers.canadaPostMasterForm.fields.email")})),(0,emotion_react_jsx_runtime_browser_esm.Y)(index_esm.xI,{control,rules:{required:{value:!0,message:t("carriers.canadaPostMasterForm.fieldError.required")}},render:function(_a){var field=_a.field;return(0,emotion_react_jsx_runtime_browser_esm.Y)(Input.Ay,(0,tslib_es6.Cl)({},field,{id:"".concat(formBaseName,"-email"),name:"email",responsive:!0,inputRef:register("email",{required:{value:!0,message:t("carriers.canadaPostMasterForm.fieldError.required")}}).ref,errorMessage:getErrorMessage("email"),invalid:getErrorMessage("email").length>0}))},name:"email"})]}),(0,emotion_react_jsx_runtime_browser_esm.FD)(styles_FormGroup,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Label.A,(0,tslib_es6.Cl)({htmlFor:"".concat(formBaseName,"-phone"),required:!0},{children:t("carriers.canadaPostMasterForm.fields.phone")})),(0,emotion_react_jsx_runtime_browser_esm.Y)(index_esm.xI,{name:"phone",rules:{required:{value:!0,message:t("carriers.canadaPostMasterForm.fieldError.required")},validate:{isValidPhoneNumber:function(value){var _a,countryCode=null===(_a=null==initialFormValues?void 0:initialFormValues.country)||void 0===_a?void 0:_a.iso2;return!value||!countryCode||(0,isValidPhoneNumber.g)(value,countryCode)}}},render:function(_a){var field=_a.field;return(0,emotion_react_jsx_runtime_browser_esm.Y)(Input.Ay,(0,tslib_es6.Cl)({},field,{id:"".concat(formBaseName,"-phone"),name:"phone",responsive:!0,inputRef:register("phone",{required:{value:!0,message:t("carriers.canadaPostMasterForm.fieldError.required")},validate:{isValidPhoneNumber:function(value){var _a,countryCode=null===(_a=null==initialFormValues?void 0:initialFormValues.country)||void 0===_a?void 0:_a.iso2;return!value||!countryCode||(0,isValidPhoneNumber.g)(value,countryCode)}}}).ref,errorMessage:getErrorMessage("phone"),invalid:getErrorMessage("phone").length>0}))},control})]}),(0,emotion_react_jsx_runtime_browser_esm.Y)(styles_FormGroup,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(index_esm.xI,{render:function(_a){var field=_a.field;return(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Checkbox.A,(0,tslib_es6.Cl)({},field,{id:"".concat(formBaseName,"-terms"),"data-testid":"".concat(formBaseName,"-terms"),checked:watch("canada_post_terms"),label:(0,emotion_react_jsx_runtime_browser_esm.Y)(TermsWrapper,{dangerouslySetInnerHTML:{__html:termsConditionsTitle}}),errorMessage:getErrorMessage("canada_post_terms")}))},"data-testid":"".concat(formBaseName,"-terms"),name:"canada_post_terms",control,defaultValue:!0,rules:{required:{value:!0,message:t("carriers.canadaPostMasterForm.fieldError.required")}}})})]}))}))]}))]}))}),(0,emotion_react_jsx_runtime_browser_esm.Y)(Carriers_CarrierModalFooter,{formType,carrier:carriers.i3,onCancelClick:onClose,onPrimaryClick:onFormSubmit,isLoading:isSubmitting,customPrimaryButtonText:primaryButtonText})]}))}));const CanadaPostRegistrationModal_CanadaPostRegistrationLongForm=ComposedCanadaPostRegistrationLongForm;(0,utils_translate.Tl)("orders")((function(props){var t=props.t,onClose=props.onClose,formType=CarrierFormType.Create,carrier=carriers.i3,dispatch=(0,es.wA)(),user=(0,es.d4)((function(state){return(0,user_selectors.wz)(state)})),userCompany=(0,es.d4)(user_selectors.Zg)||"",isFormSubmitting=(0,es.d4)((function(state){return(0,carrier_accounts_selectors.sy)(state)})),_a=(0,tslib_es6.zs)(react.useState({}),2),formInitialValues=_a[0],setFormInitialValues=_a[1],customModalProps=react.useMemo((function(){return{titleText:t("canadaPostRegModal.title"),primaryButtonText:t("canadaPostRegModal.submit")}}),[]);react.useEffect((function(){user?setFormInitialValues((function(){var _a,_b,_c;return{company:(null===(_a=null==user?void 0:user.address)||void 0===_a?void 0:_a.company)||userCompany,full_name:"".concat(null==user?void 0:user.firstName," ").concat(null==user?void 0:user.lastName).trim(),email:null==user?void 0:user.email,phone:(null===(_b=null==user?void 0:user.address)||void 0===_b?void 0:_b.phone)||"",country:null===(_c=null==user?void 0:user.address)||void 0===_c?void 0:_c.country}})):userCompany&&setFormInitialValues((function(){return{company:userCompany}}))}),[user,userCompany]),react.useEffect((function(){""===userCompany&&dispatch(fetchCompany())}),[]);var onFormSubmit=react.useCallback((function(formValues){var carrierAccount={active:!0,carrier,test:!!formValues.test,accountId:formValues.account_id?"".concat(formValues.account_id):"filler_id",parameters:(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},formValues),{isMasterAccount:!0})},trackingReference=TrackingHelper.U.getTrackingReference(types.UQ.name,"settings",{carrierName:carrier.name,carrierAccountId:carrierAccount.accountId,carrierType:"Shippo Master"});(0,utils.EE)(trackingReference,types.UQ.operations.SAVE_ATTEMPTED,{}),(0,utils.EE)(trackingReference,types.UQ.operations.ADDED,{}),dispatch(carrier_accounts_actions_createCarrierAccount({carrierAccount,trackingReference}))}),[]);return(0,emotion_react_jsx_runtime_browser_esm.Y)(Modal.A.MobileContainer,(0,tslib_es6.Cl)({isOpen:!0,closeOnClickOutside:!1,onClose,size:"md"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(CanadaPostRegistrationModal_CanadaPostRegistrationLongForm,{header:(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierModalHeader_CarrierModalHeader,{carrier,formType,customTitleText:customModalProps.titleText}),description:t("canadaPostRegModal.description"),initialFormValues:formInitialValues,onSubmit:onFormSubmit,primaryButtonText:customModalProps.primaryButtonText,onClose,formType,isSubmitting:isFormSubmitting})}))}));var TermsAndConditions=function(_super){function TermsAndConditions(){return null!==_super&&_super.apply(this,arguments)||this}return(0,tslib_es6.C6)(TermsAndConditions,_super),TermsAndConditions.prototype.onLinkClick=function(e){e.stopPropagation()},TermsAndConditions.prototype.render=function(){var _this=this,_a=this.props,agreements=_a.agreements,disabled=_a.disabled,checked=_a.checked,focused=_a.focused,onChange=_a.onChange,onFocus=_a.onFocus,onBlur=_a.onBlur,dataPendo=_a.dataPendo,hideErrors=_a.hideErrors,errorMessage=_a.errorMessage,labelText=_a.labelText;if(!agreements)return null;var startingText=(null==labelText?void 0:labelText.startingText)||"By checking this box, you agree to the",concatWithText=(null==labelText?void 0:labelText.concatWith)||"and",label=(0,emotion_react_jsx_runtime_browser_esm.FD)("span",{children:["".concat(startingText," "),agreements.map((function(agreement){return(0,emotion_react_jsx_runtime_browser_esm.Y)(Link.zN,(0,tslib_es6.Cl)({href:agreement.agreementUrl,target:"_blank",onClick:_this.onLinkClick},{children:agreement.label}),agreement.label)})).reduce((function(prev,curr){return[prev," ".concat(concatWithText," "),curr]}))]});return(0,emotion_react_jsx_runtime_browser_esm.Y)(Checkbox.Ay,{disabled,checked,focused,onChange,onFocus,onBlur,dataPendo,hideErrors,errorMessage,label})},TermsAndConditions}(react.Component);const components_TermsAndConditions=TermsAndConditions;var CarrierRegistrationModal_styles_templateObject_1,CarrierRegistrationModal_styles_templateObject_2,CarrierRegistrationModal_styles_templateObject_3,CarrierRegistrationModal_styles_templateObject_4,CarrierRegistrationModal_styles_templateObject_5,CarrierRegistrationModal_styles_templateObject_6,styles_templateObject_7,styles_templateObject_8,styles_templateObject_9,CarrierRegistrationModal_styles_CarrierFormGrowContainer=(0,emotion_styled_browser_esm.A)("div")(CarrierRegistrationModal_styles_templateObject_1||(CarrierRegistrationModal_styles_templateObject_1=(0,tslib_es6.ue)(["\n  ",";\n  position: fixed;\n  top: 91px;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: auto;\n  padding-bottom: ",";\n\n  @media screen and (min-width: ","px) {\n    position: relative;\n    top: auto;\n    left: auto;\n    right: auto;\n    bottom: auto;\n    overflow: visible;\n    padding-bottom: initial;\n  }\n"],["\n  ",";\n  position: fixed;\n  top: 91px;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: auto;\n  padding-bottom: ",";\n\n  @media screen and (min-width: ","px) {\n    position: relative;\n    top: auto;\n    left: auto;\n    right: auto;\n    bottom: auto;\n    overflow: visible;\n    padding-bottom: initial;\n  }\n"])),growCSS,"66px",responsive.P.Mobile),styles_Description=(0,emotion_styled_browser_esm.A)("div")(CarrierRegistrationModal_styles_templateObject_2||(CarrierRegistrationModal_styles_templateObject_2=(0,tslib_es6.ue)(["\n  color: ",";\n  padding-bottom: 16px;\n"],["\n  color: ",";\n  padding-bottom: 16px;\n"])),styles_constants.Tj.gray1000),styles_StyledPrimaryButton=(0,emotion_styled_browser_esm.A)(components_Button.jn)(CarrierRegistrationModal_styles_templateObject_3||(CarrierRegistrationModal_styles_templateObject_3=(0,tslib_es6.ue)(["\n  width: 100%;\n  padding: 0;\n  margin-left: 0;\n\n  @media screen and (min-width: ","px) {\n    width: initial;\n    padding: 0 20px;\n  }\n"],["\n  width: 100%;\n  padding: 0;\n  margin-left: 0;\n\n  @media screen and (min-width: ","px) {\n    width: initial;\n    padding: 0 20px;\n  }\n"])),responsive.P.Mobile),CenteredButtonFooter=(0,emotion_styled_browser_esm.A)(Modal.A.MobileFooter)(CarrierRegistrationModal_styles_templateObject_4||(CarrierRegistrationModal_styles_templateObject_4=(0,tslib_es6.ue)(["\n  @media screen and (min-width: ","px) {\n    justify-content: center;\n  }\n"],["\n  @media screen and (min-width: ","px) {\n    justify-content: center;\n  }\n"])),responsive.P.Mobile),NoBottomPaddingModalBody=(0,emotion_styled_browser_esm.A)(CarrierFormModalBody)(CarrierRegistrationModal_styles_templateObject_5||(CarrierRegistrationModal_styles_templateObject_5=(0,tslib_es6.ue)(["\n  padding-bottom: 0;\n"],["\n  padding-bottom: 0;\n"]))),styles_CarrierLogo=(0,emotion_styled_browser_esm.A)("img")(CarrierRegistrationModal_styles_templateObject_6||(CarrierRegistrationModal_styles_templateObject_6=(0,tslib_es6.ue)(["\n  max-height: 42px;\n  max-width: 75px;\n  width: auto;\n  height: auto;\n"],["\n  max-height: 42px;\n  max-width: 75px;\n  width: auto;\n  height: auto;\n"]))),styles_StyledAddons=(0,emotion_styled_browser_esm.A)(components_Header.A.Addons)(styles_templateObject_7||(styles_templateObject_7=(0,tslib_es6.ue)(["\n  flex-direction: column;\n  align-self: flex-start;\n"],["\n  flex-direction: column;\n  align-self: flex-start;\n"]))),styles_StyledHeaderFlexContainer=(0,emotion_styled_browser_esm.A)(components_Header.A.FlexContainer)(styles_templateObject_8||(styles_templateObject_8=(0,tslib_es6.ue)(["\n  flex-direction: row;\n  justify-content: space-between;\n"],["\n  flex-direction: row;\n  justify-content: space-between;\n"]))),StyledTitle=(0,emotion_styled_browser_esm.A)(Modal.A.Title)(styles_templateObject_9||(styles_templateObject_9=(0,tslib_es6.ue)(["\n  margin-left: 12px;\n  font-weight: ",";\n"],["\n  margin-left: 12px;\n  font-weight: ",";\n"])),styles_constants.Wy.medium);const CarrierRegistrationModal_CarrierRegistrationModalHeader=function(props){var titleText=props.titleText,onClose=props.onClose,carrier=props.carrier;return(0,emotion_react_jsx_runtime_browser_esm.Y)(Modal.A.Header,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(styles_StyledHeaderFlexContainer,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(styles_CarrierLogo,{src:carrier.icon}),(0,emotion_react_jsx_runtime_browser_esm.Y)(StyledTitle,{children:titleText}),(0,emotion_react_jsx_runtime_browser_esm.Y)(styles_StyledAddons,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(CloseIcon_CloseIcon.U,{onClose,iconSvg:icon_close_dark_gray})})]})})};var agreements={ups_us:[{label:"technology agreement",agreementUrl:carriers.LO},{label:"tariff/terms and conditions of service",agreementUrl:carriers.F0},{label:"list of prohibited items for shipping",agreementUrl:carriers.Df},{label:"UPS Ground Saver terms of service",agreementUrl:carriers.EU}],ups_ca:[{label:"technology agreement",agreementUrl:carriers.Sv},{label:"tariff/terms and conditions of service",agreementUrl:carriers.is},{label:"list of prohibited items for shipping",agreementUrl:carriers.aM}],canada_post:[{label:"Terms of Use",agreementUrl:carriers.NL},{label:"Privacy Statement",agreementUrl:carriers.Sr}],dhl_express:[{label:"Terms and Conditions",agreementUrl:carriers.bJ}]},labelText={ups:{startingText:"I agree to the UPS",concatWith:"and"},canada_post:{startingText:"I agree to the Canada Post",concatWith:"and"},dhl_express:{startingText:"I agree to the DHL"}},ComposedCarrierRegistrationShortFormModal=(0,utils_translate.Tl)("settings")((function(props){var onClose=props.onClose,onSubmit=props.onSubmit,t=props.t,_a=props.carrier,carrier=void 0===_a?carriers.$5:_a,_b=props.accountCountry,accountCountry=void 0===_b?constants_countries.Xr.US.iso2:_b,_c=(0,tslib_es6.zs)(react.useState(!0),2),hasAgreedTerms=_c[0],setHasAgreedTerms=_c[1],carrierKey=carrier.id===carriers.$5.id?"".concat(carrier.id,"_").concat(accountCountry.toLowerCase()):carrier.id,address=(0,es.d4)((function(state){return(0,user_selectors.GA)(state)})),submitting=(0,es.d4)((function(state){return(0,carrier_accounts_selectors.sy)(state)})),onTermsChange=react.useCallback((function(){setHasAgreedTerms((function(prevState){return!prevState}))}),[]),register=react.useCallback((function(){var _a,parameters={};carrier===carriers.$5&&(parameters={billing_address_street1:(null==address?void 0:address.street1)||"",billing_address_street2:(null==address?void 0:address.street2)||"",billing_address_city:(null==address?void 0:address.city)||"",billing_address_state:(null==address?void 0:address.state)||"",billing_address_zip:(null==address?void 0:address.zip)||"",billing_address_country_iso2:(null===(_a=null==address?void 0:address.country)||void 0===_a?void 0:_a.iso2)||"",pickup_address_same_as_billing_address:!0,agreements:!0}),onSubmit&&onSubmit(parameters)}),[address,onSubmit,carrier]);return(0,emotion_react_jsx_runtime_browser_esm.FD)(Modal.A.MobileContainer,(0,tslib_es6.Cl)({isOpen:!0,alwaysHideCloseIcon:!0,closeOnClickOutside:!1,onClose,size:"md",minHeight:"100px"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierRegistrationModal_CarrierRegistrationModalHeader,{onClose,titleText:t("settings:carriers:shortform:".concat(carrierKey,":title")),carrier}),(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierRegistrationModal_styles_CarrierFormGrowContainer,(0,tslib_es6.Cl)({"data-testid":"".concat(carrierKey,"-registration-modal")},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(NoBottomPaddingModalBody,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Carriers_CarrierErrorMessageDisplay,{}),(0,emotion_react_jsx_runtime_browser_esm.Y)(styles_Description,{children:t("settings:carriers:shortform:".concat(carrierKey,":description"))}),(0,emotion_react_jsx_runtime_browser_esm.Y)(components_TermsAndConditions,{checked:hasAgreedTerms,onChange:onTermsChange,agreements:agreements[carrierKey],labelText:labelText[carrier.id.toLowerCase()]})]})})),(0,emotion_react_jsx_runtime_browser_esm.Y)(CenteredButtonFooter,(0,tslib_es6.Cl)({hideBorder:!0},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(styles_StyledPrimaryButton,(0,tslib_es6.Cl)({disabled:!hasAgreedTerms||submitting,onClick:register,isLoading:submitting,dataAnalytics:"".concat(carrier.id,"-master-short-form-submit")},{children:t("settings:carriers:shortform:".concat(carrierKey,":primaryButton"))}))}))]}))}));const CarrierRegistrationModal_CarrierRegistrationShortFormModal=ComposedCarrierRegistrationShortFormModal;var build=__webpack_require__("./node_modules/react-click-outside/build/index.js"),ArrowBase=(0,emotion_styled_browser_esm.A)("div")(MessageBox_templateObject_1||(MessageBox_templateObject_1=(0,tslib_es6.ue)(["\n  position: absolute;\n  display: inline-block;\n  top: -30px;\n  width: 15px;\n  height: 15px;\n  z-index: 3;\n"],["\n  position: absolute;\n  display: inline-block;\n  top: -30px;\n  width: 15px;\n  height: 15px;\n  z-index: 3;\n"]))),ArrowRight=(0,emotion_styled_browser_esm.A)(ArrowBase)(MessageBox_templateObject_2||(MessageBox_templateObject_2=(0,tslib_es6.ue)(["\n  top: 0;\n  right: 0;\n  background: linear-gradient(to top right, #fff 40%, rgba(0, 0, 0, 0.05) 40%, transparent 52%);\n"],["\n  top: 0;\n  right: 0;\n  background: linear-gradient(to top right, #fff 40%, rgba(0, 0, 0, 0.05) 40%, transparent 52%);\n"]))),ArrowLeft=(0,emotion_styled_browser_esm.A)(ArrowBase)(MessageBox_templateObject_3||(MessageBox_templateObject_3=(0,tslib_es6.ue)(["\n  top: 0;\n  right: 15px;\n  background: linear-gradient(to top left, #fff 40%, rgba(0, 0, 0, 0.05) 40%, transparent 52%);\n"],["\n  top: 0;\n  right: 15px;\n  background: linear-gradient(to top left, #fff 40%, rgba(0, 0, 0, 0.05) 40%, transparent 52%);\n"]))),MessageBoxWrapper=(0,emotion_styled_browser_esm.A)(build.A)(MessageBox_templateObject_4||(MessageBox_templateObject_4=(0,tslib_es6.ue)(["\n  display: block;\n  position: relative;\n"],["\n  display: block;\n  position: relative;\n"]))),MessageBoxContainer=(0,emotion_styled_browser_esm.A)("div")(MessageBox_templateObject_5||(MessageBox_templateObject_5=(0,tslib_es6.ue)(["\n  position: absolute;\n  display: inline-block;\n  right: -10rem;\n  z-index: 2;\n  top: 0.9rem;\n  border-radius: 4px;\n  background: white;\n  box-shadow: 0 2px 6px 3px rgba(0, 0, 0, 0.1);\n  width: 350px;\n  overflow: hidden;\n"],["\n  position: absolute;\n  display: inline-block;\n  right: -10rem;\n  z-index: 2;\n  top: 0.9rem;\n  border-radius: 4px;\n  background: white;\n  box-shadow: 0 2px 6px 3px rgba(0, 0, 0, 0.1);\n  width: 350px;\n  overflow: hidden;\n"]))),MessageInnerContainer=(0,emotion_styled_browser_esm.A)("div")(MessageBox_templateObject_6||(MessageBox_templateObject_6=(0,tslib_es6.ue)(["\n  overflow-y: scroll;\n  max-height: 400px;\n  overflow: auto;\n"],["\n  overflow-y: scroll;\n  max-height: 400px;\n  overflow: auto;\n"]))),MessageBoxInner=(0,emotion_styled_browser_esm.A)("div")(MessageBox_templateObject_7||(MessageBox_templateObject_7=(0,tslib_es6.ue)(["\n  padding: 0.75rem 1rem;\n  background-color: #fff;\n  font-size: 13px;\n  text-align: left;\n"],["\n  padding: 0.75rem 1rem;\n  background-color: #fff;\n  font-size: 13px;\n  text-align: left;\n"]))),MessageBoxTitleContainer=(0,emotion_styled_browser_esm.A)("div")(MessageBox_templateObject_8||(MessageBox_templateObject_8=(0,tslib_es6.ue)(["\n  border-bottom: 1px solid ",";\n  text-align: left;\n"],["\n  border-bottom: 1px solid ",";\n  text-align: left;\n"])),styles_constants.Tj.gray50),MessageBoxTitle=(0,emotion_styled_browser_esm.A)("div")(MessageBox_templateObject_9||(MessageBox_templateObject_9=(0,tslib_es6.ue)(["\n  display: inline-block;\n  font-weight: 400;\n  color: black;\n  padding: 0.8rem 1.2rem;\n  font-size: 14px;\n"],["\n  display: inline-block;\n  font-weight: 400;\n  color: black;\n  padding: 0.8rem 1.2rem;\n  font-size: 14px;\n"]))),MessageBox_CloseIcon=(0,emotion_styled_browser_esm.A)("i")(MessageBox_templateObject_10||(MessageBox_templateObject_10=(0,tslib_es6.ue)(["\n  display: inline-block;\n  float: right;\n  padding: 1rem;\n  font-size: 16px;\n  cursor: pointer;\n"],["\n  display: inline-block;\n  float: right;\n  padding: 1rem;\n  font-size: 16px;\n  cursor: pointer;\n"])));!function(_super){function MessageBox(){return null!==_super&&_super.apply(this,arguments)||this}(0,tslib_es6.C6)(MessageBox,_super),MessageBox.prototype.render=function(){return this.props.isOpen?(0,emotion_react_jsx_runtime_browser_esm.FD)(MessageBoxWrapper,(0,tslib_es6.Cl)({onClickOutside:this.props.closeOnClickOutside?this.props.onClose:function(){}},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(ArrowLeft,{}),(0,emotion_react_jsx_runtime_browser_esm.Y)(ArrowRight,{}),(0,emotion_react_jsx_runtime_browser_esm.FD)(MessageBoxContainer,{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(MessageBoxTitleContainer,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(MessageBoxTitle,{children:this.props.title}),(0,emotion_react_jsx_runtime_browser_esm.Y)(MessageBox_CloseIcon,{onClick:this.props.onClose,className:"fa fa-times"})]}),(0,emotion_react_jsx_runtime_browser_esm.Y)(MessageInnerContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(MessageBoxInner,{children:this.props.messages})})]})]})):null},MessageBox.defaultProps={isOpen:!1,closeOnClickOutside:!0}}(react.Component);var MessageBox_templateObject_1,MessageBox_templateObject_2,MessageBox_templateObject_3,MessageBox_templateObject_4,MessageBox_templateObject_5,MessageBox_templateObject_6,MessageBox_templateObject_7,MessageBox_templateObject_8,MessageBox_templateObject_9,MessageBox_templateObject_10;const Carriers_CarrierForm=CarrierForm_CarrierForm,Carriers_CarrierModalHeader=CarrierModalHeader_CarrierModalHeader;var SaveCarrierAccountModal_CarrierFormGrowContainer=(0,emotion_styled_browser_esm.A)("div")(SaveCarrierAccountModal_templateObject_1||(SaveCarrierAccountModal_templateObject_1=(0,tslib_es6.ue)(["\n  ",";\n  position: fixed;\n  top: calc(",");\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: auto;\n  padding-bottom: ",";\n\n  @media screen and (min-width: ","px) {\n    position: relative;\n    top: auto;\n    left: auto;\n    right: auto;\n    bottom: auto;\n    overflow: visible;\n    padding-bottom: initial;\n  }\n"],["\n  ",";\n  position: fixed;\n  top: calc(",");\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: auto;\n  padding-bottom: ",";\n\n  @media screen and (min-width: ","px) {\n    position: relative;\n    top: auto;\n    left: auto;\n    right: auto;\n    bottom: auto;\n    overflow: visible;\n    padding-bottom: initial;\n  }\n"])),growCSS,headerMobileHeight,"66px",responsive.P.Mobile),AlertInformation=(0,emotion_styled_browser_esm.A)("div")(SaveCarrierAccountModal_templateObject_2||(SaveCarrierAccountModal_templateObject_2=(0,tslib_es6.ue)(["\n  margin: 10px 30px 0px 30px;\n\n  & div {\n    margin-bottom: 0px;\n  }\n"],["\n  margin: 10px 30px 0px 30px;\n\n  & div {\n    margin-bottom: 0px;\n  }\n"])));const Carriers_SaveCarrierAccountModal_SaveCarrierAccountModal=(0,redux.Zz)((0,utils_translate.Tl)("settings"),Carriers_withCarrierForm)((function(props){var carrier=props.carrier,carrierAccount=props.carrierAccount,onClose=props.onClose,t=props.t,customizableProps=props.customizableProps,accountCountry=props.accountCountry,_a=(0,tslib_es6.zs)(react.useState(!carrierAccount||carrierAccount.active),2),active=_a[0],setActive=_a[1],formType=carrierAccount?CarrierFormType.Edit:props.formType,carrierFormContext=react.useContext(withCarrierForm_Context),isNewFedExAPI=useNewFedExAPIFeatureFlag().isNewFedExAPI,_b=(0,tslib_es6.zs)(react.useState(!1),2),uploadingImage=_b[0],setUploadingImage=_b[1],_c=useFedExInternationalSection(),uploadedImage=_c.uploadedImage,showFedExImageUploadError=_c.showFedExImageUploadError,showFedExInternational=_c.showFedExInternational,onFedExInternationalCheckboxChange=_c.onFedExInternationalCheckboxChange,handleImageUpload=_c.handleImageUpload,shouldShowFedEXInternationalSection=!(!isNewFedExAPI||carrier.id!==carriers.jr.id),onSaveCarrierAccountFormSubmit=react.useCallback((function(formValues){var e_1,_a,e_2,_b,carrier=props.carrier,formType=props.formType,carrierAccountWithServiceLevels=props.carrierAccountWithServiceLevels,trackingReference=TrackingHelper.U.getTrackingReference(types.UQ.name,"settings",{carrierName:carrier.name,carrierAccountId:null==formValues?void 0:formValues.account_id,carrierType:void 0});(0,utils.EE)(trackingReference,types.UQ.operations.SAVE_ATTEMPTED,{}),(0,utils.EE)(trackingReference,types.UQ.operations.EDITED,{});var serviceLevelsPayload=[],localCarrierAccount={active,carrier,test:!!formValues.test,accountId:formValues.account_id?"".concat(formValues.account_id):"filler_id"};function findMatchServiceLevel(key){if(carrierAccountWithServiceLevels)return carrierAccountWithServiceLevels.serviceLevels.find((function(el){return el.token===key}))}try{for(var _c=(0,tslib_es6.Ju)(Object.keys(formValues)),_d=_c.next();!_d.done;_d=_c.next()){if("account_id"!==(key=_d.value)&&"test"!==key){var matchedServiceLevel=findMatchServiceLevel(key);if("metadata"===key)localCarrierAccount.metadata=formValues[key];else if(matchedServiceLevel){var initialValueFromDB=!formValues[key];if(matchedServiceLevel.is_hidden!==initialValueFromDB){var serviceLevelPayload={op:"replace",path:"/".concat(key,"/is_hidden"),value:!formValues[key]};serviceLevelsPayload.push(serviceLevelPayload)}}else localCarrierAccount.parameters||(localCarrierAccount.parameters={}),localCarrierAccount.parameters[key]=formValues[key]}}}catch(e_1_1){e_1={error:e_1_1}}finally{try{_d&&!_d.done&&(_a=_c.return)&&_a.call(_c)}finally{if(e_1)throw e_1.error}}if(!carrierAccount)return formType===CarrierFormType.Create?((0,utils.EE)(trackingReference,types.UQ.operations.ADDED,{}),carrierFormContext.createCarrierAccount({carrierAccount:localCarrierAccount,trackingReference})):((0,utils.EE)(trackingReference,types.UQ.operations.ACTIVATED,{}),localCarrierAccount.active=!0,carrierFormContext.connectCarrierAccount({carrierAccount:localCarrierAccount,trackingReference}));var accountLevelParams=["account_id","test","active","metadata"];if(carrierAccount.parameters)try{for(var _e=(0,tslib_es6.Ju)(Object.keys(formValues)),_f=_e.next();!_f.done;_f=_e.next()){var key=_f.value;if(!accountLevelParams.includes(key))((0,CarrierAccount.oL)(formValues[key])?formValues[key].value:formValues[key])===carrierAccount.parameters[key]&&delete localCarrierAccount.parameters[key]}}catch(e_2_1){e_2={error:e_2_1}}finally{try{_f&&!_f.done&&(_b=_e.return)&&_b.call(_e)}finally{if(e_2)throw e_2.error}}var id_1=carrierAccount.objectId;(0,tslib_es6.sH)(void 0,void 0,void 0,(function(){var error_1,error_2;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:if(!(null==uploadedImage?void 0:uploadedImage.companyLogo)&&!(null==uploadedImage?void 0:uploadedImage.digitalSignature))return[3,9];if(setUploadingImage(!0),!(null==uploadedImage?void 0:uploadedImage.companyLogo))return[3,4];_a.label=1;case 1:return _a.trys.push([1,3,,4]),[4,uploadCompanyLogo(id_1,uploadedImage.companyLogo)];case 2:return _a.sent(),[3,4];case 3:return error_1=_a.sent(),esm_exports.Cp(new Error("Failed to upload company logo",error_1)),[3,4];case 4:if(!(null==uploadedImage?void 0:uploadedImage.digitalSignature))return[3,8];_a.label=5;case 5:return _a.trys.push([5,7,,8]),[4,uploadDigitalSignature(id_1,uploadedImage.digitalSignature)];case 6:return _a.sent(),[3,8];case 7:return error_2=_a.sent(),esm_exports.Cp(new Error("Failed to upload digital signature",error_2)),[3,8];case 8:setUploadingImage(!1),_a.label=9;case 9:return serviceLevelsPayload.length>0?[2,carrierFormContext.editCarrierAccountServiceLevels({carrierAccount:localCarrierAccount,serviceLevelsPayload,id:id_1,trackingReference})]:[2,carrierFormContext.editCarrierAccount({carrierAccount:localCarrierAccount,id:id_1,trackingReference})]}}))}))}),[active,carrierAccount,carrierFormContext,props,uploadedImage]),mockedParameters=isCarrierFormMocked(carrier.id,formType)?parametersMap[carrier.id][formType]:[];carrier.id===carriers.i3.id&&mockedParameters&&(carrierAccount&&carrierAccount.parameters&&carrierAccount.parameters.platform_id_key?mockedParameters=mockedParameters.filter((function(field){return"customer_number"===field.key})):formType===CarrierFormType.Connect&&(mockedParameters=mockedParameters.filter((function(field){return"postal_zip_code"!==field.key}))));return(0,emotion_react_jsx_runtime_browser_esm.FD)(Modal.A.MobileContainer,(0,tslib_es6.Cl)({isOpen:!0,onClose,size:"mdl",minHeight:"100px",closeOnClickOutside:!1},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Carriers_CarrierModalHeader,{formType,carrier,active,test:carrierAccount&&carrierAccount.test,onActiveToggle:function(){setActive(!active)},customTitleText:null==customizableProps?void 0:customizableProps.titleText}),carrierAccount&&carrierAccount.parameters&&"eBay"===carrierAccount.parameters.platform_id_key&&formType===CarrierFormType.Edit&&(0,emotion_react_jsx_runtime_browser_esm.Y)(AlertInformation,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Message.Ay,{children:t("carriers.ebayOnly")})}),(0,emotion_react_jsx_runtime_browser_esm.Y)(SaveCarrierAccountModal_CarrierFormGrowContainer,(0,tslib_es6.Cl)({"data-testid":"save-carrier-account-modal"},{children:carrier===carriers.i3&&formType===CarrierFormType.Connect?(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"px-8 py-5"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Carriers_CanadaPostConnectRedirect,{})})):(0,emotion_react_jsx_runtime_browser_esm.FD)(emotion_react_jsx_runtime_browser_esm.FK,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Carriers_CarrierForm,{parameters:mockedParameters,carrier,onSubmit:onSaveCarrierAccountFormSubmit,formType:formType!==CarrierFormType.Edit||carrierAccount?formType:CarrierFormType.Connect,disabled:!active,errorMessage:carrierFormContext.errorMessage,initialValues:carrierFormContext.getInitialFormValues(carrierAccount,carrier,formType,mockedParameters),masterAccountForm:carrierAccount&&carrierAccount.isShippoAccount,hideTestMode:formType===CarrierFormType.Create,hideAccountNickname:carrierFormContext.shouldHideAccountNickname(carrier,formType),carrierAccountWithServiceLevels:carrierFormContext.carrierAccountWithServiceLevels,accountCountry,newFedExAPI:shouldShowFedEXInternationalSection,fedExInternationalSection:function(showFedExInternationalSection){var _a,_b;return showFedExInternationalSection?(0,emotion_react_jsx_runtime_browser_esm.Y)(FedexInternationalSection.M6,{t:props.t,requiredError:showFedExImageUploadError,showFedExInternational,onChangeCheckbox:onFedExInternationalCheckboxChange,onImageUpload:handleImageUpload,assetReferences:{companyLogo:"".concat((null===(_a=null==carrierAccount?void 0:carrierAccount.parameters)||void 0===_a?void 0:_a.letterhead_reference_id)||""),digitalSignature:"".concat((null===(_b=null==carrierAccount?void 0:carrierAccount.parameters)||void 0===_b?void 0:_b.signature_reference_id)||"")}}):null}(shouldShowFedEXInternationalSection)}),(0,emotion_react_jsx_runtime_browser_esm.Y)(Carriers_CarrierModalFooter,{formType,carrier,onPrimaryClick:carrierFormContext.submitCarrierForm,onCancelClick:onClose,isLoading:carrierFormContext.isSavingCarrierAccount||uploadingImage,customPrimaryButtonText:null==customizableProps?void 0:customizableProps.primaryButtonText})]})}))]}))}));var SaveCarrierAccountModal_templateObject_1,SaveCarrierAccountModal_templateObject_2;const Carriers_SaveCarrierAccountModal=Carriers_SaveCarrierAccountModal_SaveCarrierAccountModal;(0,redux.Zz)((0,es.Ng)((function(state){return{errorMessage:(0,carrier_accounts_selectors.E3)(state),hasValidAddress:(0,user_selectors.Oz)(state),userCountryIso2:(0,user_selectors.XM)(state)}}),(function(dispatch){return{sendTrackEvent:function(event){return dispatch((0,prod_analytics_actions.o)(event))}}})),(0,utils_translate.Tl)("orders"))((function(props){var errorMessage=props.errorMessage,hasValidAddress=props.hasValidAddress,userCountryIso2=props.userCountryIso2,t=props.t,onClose=props.onClose,showFullForm=props.showFullForm,_a=props.accountCountry,accountCountry=void 0===_a?constants_countries.Xr.US.iso2:_a,sendTrackEvent=props.sendTrackEvent,dispatch=(0,es.wA)(),customModalProps={titleText:t("upsRegModal.title"),primaryButtonText:t("upsRegModal.submit")},onShortFormSubmit=react.useCallback((function(parameters){var carrierAccount={accountId:"",carrier:carriers.$5,parameters:(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},parameters),{ups_agreements:!0})},trackingReference=TrackingHelper.U.getTrackingReference(types.UQ.name,"settings",{carrierName:"UPS",carrierType:"Shippo Master",carrierAccountId:void 0});(0,utils.EE)(trackingReference,types.UQ.operations.SAVE_ATTEMPTED,{}),(0,utils.EE)(trackingReference,types.UQ.operations.ACTIVATED,{}),dispatch(carrier_accounts_actions_createCarrierAccount({carrierAccount,trackingReference}))}),[]);return showFullForm||errorMessage||!(hasValidAddress&&userCountryIso2===accountCountry)?(sendTrackEvent("UPS_MASTER_LONG_FORM_SHOWN"),(0,emotion_react_jsx_runtime_browser_esm.Y)(Carriers_SaveCarrierAccountModal,{onClose,carrier:carriers.$5,formType:CarrierFormType.Create,customizableProps:customModalProps,accountCountry})):(sendTrackEvent("UPS_MASTER_SHORT_FORM_SHOWN"),(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierRegistrationModal_CarrierRegistrationShortFormModal,{onSubmit:onShortFormSubmit,onClose,carrier:carriers.$5,accountCountry}))}));var withCarrierAccounts_Context=react.createContext({masterAccounts:[],totalMasterCarrierAccounts:0,userAccounts:[],totalUserCarrierAccounts:0,carrierAccountRegStatuses:{},successfulSubmit:null,isUserPaygPlan:!1,openEditModal:function(){},openModal:function(){},openSlideModal:function(){},openUpsRegistrationModal:function(){},openCanadaPostRegistrationModal:function(){},setRegistrationCarrierAccount:function(){},clearCarrierAccountsSubmit:function(){},getAccountRegStatus:function(){return null},fetchCarrierAccountRegStatuses:function(){}});var CarrierAccountRegStatus=__webpack_require__("./app/types/CarrierAccountRegStatus.ts"),types_utils=__webpack_require__("./app/pages/Orders/Blackbeard/types/utils.ts");const hooks_useSingleCarrierRates=function useSingleCarrierRates_useSingleCarrierRates(selectRate,batchEntryId){var dispatch=(0,es.wA)(),rates=function useRates(batchEntryId){var memoizedBatchEntryId=(0,react.useMemo)((function(){return batchEntryId||-1}),[batchEntryId]),rates=(0,es.d4)((function(state){return(0,batch_entry_composite_selectors.jl)(state,{batchEntryId:memoizedBatchEntryId})})),ratesBestOptionFlag=(0,featureflags.u)(featureflags.gH.RATES_BEST_OPTION);return"variant"===(null==ratesBestOptionFlag?void 0:ratesBestOptionFlag.variation)?getBestRate(rates):rates}(batchEntryId),shipment=function useShipment(batchEntryId){var memoizedBatchEntryId=(0,react.useMemo)((function(){return batchEntryId||-1}),[batchEntryId]);return(0,es.d4)((function(state){return(0,batch_entry_composite_selectors.Qb)(state,{batchEntryId:memoizedBatchEntryId})}))}(batchEntryId),carrierAccountsMap=(0,es.d4)(carrier_accounts_selectors.Nf),hasValidSenderAddress=(0,es.d4)(user_selectors.Oz),registrationStatus=(0,es.d4)((function(state){return(0,batch_entry_composite_selectors.yu)(state,{batchEntryIds:[batchEntryId]})}),types_utils.t7),selectedRate=(0,es.d4)((function(state){return batchEntryId?(0,batch_entry_composite_selectors.aq)(state,{batchEntryId}):null})),_a=react.useContext(withCarrierAccounts_Context),setRegistrationCarrierAccount=_a.setRegistrationCarrierAccount,masterAccounts=_a.masterAccounts,sendTrackEvent=(0,react.useCallback)((function(event,properties){dispatch((0,prod_analytics_actions.o)(event,properties))}),[dispatch]);return{rates,selectRateWithAccountCheck:(0,react.useCallback)((function(shipmentId,rate){selectRate({rateObjectId:rate.objectId,serviceLevelToken:rate.servicelevel.token,shipmentObjectId:shipmentId,accountObjectId:rate.carrierAccount});var carrier=carrierAccountsMap[rate.carrierAccount].carrier,incompleteRegStatus=registrationStatus[carrier.id];if(incompleteRegStatus){switch(carrier.id){case"ups":sendTrackEvent("UPS_MASTER_PENDING_RATE_SELECTED");break;case"canada_post":sendTrackEvent("CANADA_POST_MASTER_PENDING_RATE_SELECTED")}var showFullForm=!(incompleteRegStatus===CarrierAccountRegStatus.n.PENDING_TERMS&&hasValidSenderAddress);setRegistrationCarrierAccount(carrier.id,showFullForm)}"USPS"===rate.provider&&masterAccounts.some((function(carrierAccount){return carrierAccount.objectId===rate.carrierAccount}))&&sendTrackEvent("USPS_MASTER_RATE_SELECTED")}),[selectRate,carrierAccountsMap,registrationStatus,masterAccounts,hasValidSenderAddress,setRegistrationCarrierAccount,sendTrackEvent]),selectedRate,shipment}};var OrdersBatch=__webpack_require__("./app/types/OrdersBatch.ts"),Box=__webpack_require__("./node_modules/@goshippo/components/esm/Box/Box.js"),Chip=__webpack_require__("./node_modules/@goshippo/components/esm/Chip/Chip.js"),RatingErrors_util=__webpack_require__("./app/pages/Orders/All/OrderDetailsPage/RatingErrors/util.ts"),Card_SelectableCard=__webpack_require__("./app/pages/Orders/Blackbeard/LabelPurchase/modules/Card/SelectableCard.tsx"),CarrierIconMui=__webpack_require__("./app/pages/Orders/Blackbeard/LabelPurchase/modules/CarrierIconMui.tsx"),modules_utils=__webpack_require__("./app/pages/Orders/Blackbeard/LabelPurchase/modules/utils.ts");const CarrierRatesCard_AnalyticsWrapper=function(_a){var children=_a.children,dataAnalytics=_a.dataAnalytics,dataE2E=_a.dataE2E,dataCarrier=_a.dataCarrier,isTestRate=_a.isTestRate,className=_a.className;return(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({"data-e2e":dataE2E,"data-carrier":dataCarrier,"data-type":isTestRate?"test-rate":"live-rate","data-analytics":dataAnalytics,className},{children}))};var ExpandLess=__webpack_require__("./node_modules/@mui/icons-material/esm/ExpandLess.js"),ExpandMore=__webpack_require__("./node_modules/@mui/icons-material/esm/ExpandMore.js"),Warning=__webpack_require__("./node_modules/@mui/icons-material/esm/Warning.js"),RetailRateContainerMui=(0,styled.Ay)(Stack.A,{shouldForwardProp:function(prop){return"clickable"!==prop}})(RateDetailExpandable_templateObject_1||(RateDetailExpandable_templateObject_1=(0,tslib_es6.ue)(["\n  flex-direction: row;\n  justify-content: space-between;\n  background-color: ",";\n  margin: 0.5rem -1rem -1rem;\n  padding: "," ",";\n  border-top: 1px solid ",";\n  border-bottom-left-radius: 4px;\n  border-bottom-right-radius: 4px;\n\n  ","\n"],["\n  flex-direction: row;\n  justify-content: space-between;\n  background-color: ",";\n  margin: 0.5rem -1rem -1rem;\n  padding: "," ",";\n  border-top: 1px solid ",";\n  border-bottom-left-radius: 4px;\n  border-bottom-right-radius: 4px;\n\n  ","\n"])),styles_colors.T.white,shippoTheme.A.spacing(1),shippoTheme.A.spacing(2),styles_colors.T.borders,(function(_a){return _a.clickable?"\n      &:hover {\n        background-color: ".concat(styles_colors.T.accent.background.success,";\n      }\n    "):""}));const CarrierRatesCard_RateDetailExpandable=function(_a){var showMoreDetailsSection=_a.showMoreDetailsSection,handleShowRateDetails=_a.handleShowRateDetails,showDetails=_a.showDetails,UPSWarning=_a.UPSWarning,t=_a.t;return(0,emotion_react_jsx_runtime_browser_esm.FD)(RetailRateContainerMui,(0,tslib_es6.Cl)({clickable:!!showMoreDetailsSection,onClick:showMoreDetailsSection?handleShowRateDetails:void 0,"data-testid":"rate-detail-expandable"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Typography.A,(0,tslib_es6.Cl)({component:"p",variant:"body",sx:{display:"flex"}},{children:showMoreDetailsSection?showDetails?(0,emotion_react_jsx_runtime_browser_esm.FD)(emotion_react_jsx_runtime_browser_esm.FK,{children:[t("orders:calculateRates:rates:lessDetails"),(0,emotion_react_jsx_runtime_browser_esm.Y)(ExpandLess.A,{})]}):(0,emotion_react_jsx_runtime_browser_esm.FD)(emotion_react_jsx_runtime_browser_esm.FK,{children:[t("orders:calculateRates:rates:moreDetails"),(0,emotion_react_jsx_runtime_browser_esm.Y)(ExpandMore.A,{})]}):""})),!!UPSWarning&&(0,emotion_react_jsx_runtime_browser_esm.FD)(Stack.A,(0,tslib_es6.Cl)({direction:"row",spacing:1},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Typography.A,(0,tslib_es6.Cl)({component:"p",variant:"body"},{children:UPSWarning})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Warning.A,{fontSize:"small",style:{color:styles_colors.T.accent.foreground.warning}})]}))]}))};var RateDetailExpandable_templateObject_1,RateWarningConstants=__webpack_require__("./app/pages/Orders/All/OrderDetailsPage/RatingErrors/RateWarningConstants.ts");const CarrierRatesCard_RateDetailsTerm=function(_a){var breakdown=_a.breakdown,currency=_a.currency,t=_a.t;return(0,emotion_react_jsx_runtime_browser_esm.FD)(emotion_react_jsx_runtime_browser_esm.FK,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Typography.A,(0,tslib_es6.Cl)({component:"p",variant:"body",sx:{textAlign:"right"}},{children:(null==breakdown?void 0:breakdown.shouldTranslate)?t(breakdown.copy):breakdown.copy})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Typography.A,(0,tslib_es6.Cl)({component:"p",variant:"bodyEmphasized",sx:{textAlign:"right"}},{children:t("translations:currency",{value:{value:breakdown.value,currency_iso:(currency||constants_currency.q.USD).iso}})}))]})};const CarrierRatesCard_RateDetails=function(_a){var data,showTrackingUnavailable=_a.showTrackingUnavailable,noTrackingCopy=_a.noTrackingCopy,surcharges=_a.surcharges,warnings=_a.warnings,t=_a.t;return(0,emotion_react_jsx_runtime_browser_esm.FD)(Stack.A,(0,tslib_es6.Cl)({justifyItems:"flex-start",sx:{backgroundColor:"white",borderTop:"1px solid ".concat(styles_colors.T.borders),margin:"1rem -1rem -1rem",padding:"1rem"}},{children:[showTrackingUnavailable&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Typography.A,(0,tslib_es6.Cl)({component:"div",variant:"bodyItalic"},{children:noTrackingCopy})),!!surcharges&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Stack.A,(0,tslib_es6.Cl)({sx:{display:"inline-grid",rowGap:1,columnGap:2,gridTemplateColumns:"auto min-content"}},{children:(data=surcharges,Object.entries(data).filter((function(record){var name=record[0];return"currency"!==name}))).map((function(_a,i){var _b=(0,tslib_es6.zs)(_a,2),breakdown=(_b[0],_b[1]);return(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierRatesCard_RateDetailsTerm,{breakdown,currency:surcharges.currency||void 0,t},i)}))})),!!warnings.length&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Stack.A,{children:warnings.map((function(warning,idx){return function(warning,key){var message=warning.message,linkURL=warning.linkURL,linkCopy=warning.linkCopy,messageArgs=warning.messageArgs,title=t("orders:table:errors:warningTitle");return warning.kind!==RateWarningConstants.zt&&warning.kind!==RateWarningConstants.pn||(title=t("orders:table:errors:warningTitleUPS")),(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(Stack.A,(0,tslib_es6.Cl)({direction:"row",className:"mb-2"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Warning.A,{className:"mr-2",fontSize:"small",style:{color:styles_constants.Tj.macaroni600}}),(0,emotion_react_jsx_runtime_browser_esm.Y)(Typography.A,(0,tslib_es6.Cl)({component:"p",variant:"caption"},{children:title}))]})),(0,emotion_react_jsx_runtime_browser_esm.FD)(Typography.A,(0,tslib_es6.Cl)({component:"p",variant:"body"},{children:[t(message,messageArgs)," ",!(!linkURL||!linkCopy)&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Link_Link.A,(0,tslib_es6.Cl)({color:"primary",rel:"noopener",target:"_blank",href:linkURL},{children:t(linkCopy)}))]}))]},key)}(warning,idx.toString())}))})]}))};var RateTransitTime_styled_templateObject_1,RateTransitTime_styled_templateObject_2,HelpOutline=__webpack_require__("./node_modules/@mui/icons-material/esm/HelpOutline.js"),Popover=__webpack_require__("./node_modules/@goshippo/components/esm/Popover/Popover.js"),TransitTimeRateBlock=(0,styled.Ay)(Stack.A,{shouldForwardProp:function(prop){return"clickable"!==prop}})(RateTransitTime_styled_templateObject_1||(RateTransitTime_styled_templateObject_1=(0,tslib_es6.ue)(["\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  background-color: ",";\n  margin: 0.5rem -1rem -1rem;\n  padding: "," ",";\n  border-top: 1px solid ",";\n  border-bottom-left-radius: 4px;\n  border-bottom-right-radius: 4px;\n"],["\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  background-color: ",";\n  margin: 0.5rem -1rem -1rem;\n  padding: "," ",";\n  border-top: 1px solid ",";\n  border-bottom-left-radius: 4px;\n  border-bottom-right-radius: 4px;\n"])),styles_colors.T.white,shippoTheme.A.spacing(1),shippoTheme.A.spacing(2),styles_colors.T.borders),TransitTimePopover=(0,styled.Ay)(Stack.A,{shouldForwardProp:function(prop){return"clickable"!==prop}})(RateTransitTime_styled_templateObject_2||(RateTransitTime_styled_templateObject_2=(0,tslib_es6.ue)(["\n  pointer-events: none;\n  padding: "," ",";\n  font-size: 0.875rem;\n  box-sizing: border-box;\n  max-width: 500px;\n  & > *:not(:last-child) {\n    margin-bottom: ",";\n  }\n"],["\n  pointer-events: none;\n  padding: "," ",";\n  font-size: 0.875rem;\n  box-sizing: border-box;\n  max-width: 500px;\n  & > *:not(:last-child) {\n    margin-bottom: ",";\n  }\n"])),shippoTheme.A.spacing(1),shippoTheme.A.spacing(1.5),shippoTheme.A.spacing(.5)),RateTransitTime=function(_a){var t=_a.t,message=_a.message,_b=(0,tslib_es6.zs)((0,react.useState)(null),2),anchorEl=_b[0],setAnchorEl=_b[1],status=message.status,days=message.days,handlePopoverOpen=(0,react.useCallback)((function(event){setAnchorEl(event.currentTarget)}),[setAnchorEl]),handlePopoverClose=(0,react.useCallback)((function(){setAnchorEl(null)}),[setAnchorEl]),open=Boolean(anchorEl);return(0,emotion_react_jsx_runtime_browser_esm.FD)(TransitTimeRateBlock,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Typography.A,(0,tslib_es6.Cl)({component:"p",variant:"body",sx:{display:"flex"}},{children:0!==days?t("orders:carrierRatesCard:insightTransitTime",{count:days,status,days}):t("orders:carrierRatesCard:insightsTransitOnTime")})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Box.A,(0,tslib_es6.Cl)({"aria-haspopup":"true",sx:{display:"flex"},"data-testid":"time-transit-hover",onMouseEnter:handlePopoverOpen,onMouseLeave:handlePopoverClose},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(HelpOutline.A,{color:"secondary",fontSize:"small"})})),(0,emotion_react_jsx_runtime_browser_esm.FD)(Popover.A,(0,tslib_es6.Cl)({id:"insights-mouse-over-popover",open,sx:{pointerEvents:"none"},anchorEl,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},onClose:handlePopoverClose,disableRestoreFocus:!0},{children:[" ",(0,emotion_react_jsx_runtime_browser_esm.Y)(TransitTimePopover,(0,tslib_es6.Cl)({"data-testid":"time-transit-popover"},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(Typography.A,(0,tslib_es6.Cl)({component:"p",variant:"body",sx:{display:"flex"}},{children:[t("orders:carrierRatesCard:insightTooltipTitle"),t("orders:carrierRatesCard:insightTooltipContent")]}))}))]}))]})};const hooks_useMatchedTransitLevel=function(serviceLevels,rate,featureFlag){var _a=(0,tslib_es6.zs)((0,react.useState)(),2),matchedTransitLevel=_a[0],setMatchedTransitLevel=_a[1],_b=(0,tslib_es6.zs)((0,react.useState)(),2),shouldShowTransitTimeMax=_b[0],setShouldShowTransitTimeMax=_b[1],_c=(0,tslib_es6.zs)((0,react.useState)(),2),transitTimeMax=_c[0],setTransitTimeMax=_c[1];return(0,react.useEffect)((function(){if(featureFlag&&serviceLevels){var matchedData=null==serviceLevels?void 0:serviceLevels.find((function(x){return x.shippo_servicelevel_token===rate.servicelevel.token}));if(setMatchedTransitLevel(matchedData),featureFlag){var rateTransitServiceLevel=matchedTransitLevel?matchedData.shippo_servicelevel_token:void 0,rateTransitLevelMean=matchedTransitLevel?matchedTransitLevel.mean:void 0,transitTimeMax_1=(0,modules_utils.HU)(rate.provider,rate.servicelevel.token,rate.estimatedDays,rateTransitServiceLevel,rateTransitLevelMean);setShouldShowTransitTimeMax(!!transitTimeMax_1),setTransitTimeMax(transitTimeMax_1)}else setShouldShowTransitTimeMax(void 0)}}),[serviceLevels,matchedTransitLevel,rate.servicelevel.token,featureFlag,rate]),{shouldShowTransitTimeMax,transitTimeMax}};var ComposedCalculatedRateItem=(0,react.memo)((function(_a){var rate=_a.rate,t=_a.t,isSelected=_a.isSelected,selectRate=_a.selectRate,shipmentId=_a.shipmentId,carrierAccount=_a.carrierAccount,isUntrackable=_a.isUntrackable,dataAnalyticsContext=_a.dataAnalyticsContext,warnings=_a.warnings,transitDataServiceLevels=_a.transitDataServiceLevels,handleKeyboardEvents=_a.handleKeyboardEvents,UPSWarnings=(0,RatingErrors_util.Lj)(warnings||[]).UPSWarnings,hasUPSWarning=!!UPSWarnings.length,upsWarningCardExpandableHeader=hasUPSWarning?(0,RatingErrors_util.KF)(t,UPSWarnings[0].kind||""):"",_b=(0,tslib_es6.zs)((0,react.useState)(!1),2),showDetails=_b[0],setShowDetails=_b[1],handleShowRateDetails=(0,react.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),setShowDetails(!showDetails)}),[showDetails]),provider=rate.provider,servicelevel=rate.servicelevel,estimatedDays=rate.estimatedDays,amount=rate.amount,currency=rate.currency,test=rate.test,includedInsurancePrice=rate.includedInsurancePrice,onClick=(0,react.useCallback)((function(){selectRate(shipmentId,rate)}),[shipmentId,rate,selectRate]),hasSurcharges=function serviceLevelHasSurchargeInfo(serviceLevelTerms){return!!serviceLevelTerms&&"string"!=typeof serviceLevelTerms}(servicelevel.terms),serviceLabelText=(0,Rate.$O)(rate),estimatedDaysTranslated=(0,modules_utils.gG)(estimatedDays,t),rateValueTranslatedNoInsurance=(0,modules_utils.WM)(String(Number(amount)-Number(includedInsurancePrice)),currency,t),_c=hooks_useMatchedTransitLevel(transitDataServiceLevels,rate,!!transitDataServiceLevels),shouldShowTransitTimeMax=_c.shouldShowTransitTimeMax,transitTimeMax=_c.transitTimeMax,noTrackingCopy=(0,Rate.CC)(rate)?t("orders:calculateRates:rates:info:noTracking",{provider:rate.provider}):"",showTrackingUnavailable=function shouldShowTrackingUnavailable(_a){var hasTrackingCopy=_a.hasTrackingCopy,isUntrackable=_a.isUntrackable;return hasTrackingCopy&&isUntrackable}({hasTrackingCopy:!!noTrackingCopy,isUntrackable:!!isUntrackable}),showMoreDetailsSection=function shouldShowMoreDetailsSection(_a){var hasSurcharges=_a.hasSurcharges,showTrackingUnavailable=_a.showTrackingUnavailable,hasUPSWarning=_a.hasUPSWarning;return hasSurcharges||showTrackingUnavailable||hasUPSWarning}({hasSurcharges,showTrackingUnavailable,hasUPSWarning}),showDetailBar=function shouldShowRateDetailBar(_a){var isSelected=_a.isSelected,showMoreDetailsSection=_a.showMoreDetailsSection;return isSelected&&showMoreDetailsSection}({showMoreDetailsSection,isSelected:!!isSelected}),surcharges=(0,react.useMemo)((function(){if("string"!=typeof servicelevel.terms)return servicelevel.terms}),[servicelevel]);return(0,emotion_react_jsx_runtime_browser_esm.Y)(Card_SelectableCard.A,(0,tslib_es6.Cl)({id:"".concat(rate.servicelevel.token,"-rate-card"),isSelected,"data-testid":"calculated-rates-list-item","data-key":rate.objectId,onClick,handleKeyboardEvents,rate},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(CarrierRatesCard_AnalyticsWrapper,(0,tslib_es6.Cl)({isTestRate:test,"data-pendo":"orders-rate-select",dataE2E:"calculated-rate",dataCarrier:provider.toLowerCase(),dataAnalytics:"".concat(dataAnalyticsContext,"-click-item")},{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(Stack.A,(0,tslib_es6.Cl)({direction:"row",justifyContent:"space-between"},{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(Stack.A,(0,tslib_es6.Cl)({direction:"row",gap:1,alignItems:"center",overflow:"hidden"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierIconMui.A,{size:32,provider}),(0,emotion_react_jsx_runtime_browser_esm.FD)(Box.A,(0,tslib_es6.Cl)({overflow:"hidden"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Typography.A,(0,tslib_es6.Cl)({component:"p",variant:"body"},{children:serviceLabelText})),carrierAccount&&!carrierAccount.isShippoAccount&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Chip.A,{iconVariant:null,color:"info",label:carrierAccount.metadata||t("orders:carrierRatesCard:carrierNickname",{carrier:carrierAccount.carrier.name})}),test&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Chip.A,{iconVariant:null,color:"info",label:t("orders:table:testChipMessage"),"data-testid":"calculated-rates-item-test-chip"})]}))]})),(0,emotion_react_jsx_runtime_browser_esm.FD)(Stack.A,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Typography.A,(0,tslib_es6.Cl)({align:"right",component:"p",variant:"bodyEmphasized"},{children:rateValueTranslatedNoInsurance})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Typography.A,(0,tslib_es6.Cl)({align:"right",component:"p",variant:"body"},{children:estimatedDaysTranslated}))]})]})),!!shouldShowTransitTimeMax&&transitTimeMax&&(0,emotion_react_jsx_runtime_browser_esm.Y)(RateTransitTime,{t,message:transitTimeMax}),showDetailBar&&(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierRatesCard_RateDetailExpandable,{showMoreDetailsSection,handleShowRateDetails,showDetails,UPSWarning:upsWarningCardExpandableHeader,t}),showDetails&&isSelected&&(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierRatesCard_RateDetails,{showTrackingUnavailable,noTrackingCopy,surcharges,warnings,t})]}))}))}));const CalculatedRatesItem=ComposedCalculatedRateItem;const RateList_RateList=function(_a){var rates=_a.rates,shipment=_a.shipment,selectedRate=_a.selectedRate,attributeText=_a.attributeText,onSelectRate=_a.onSelectRate,isUntrackable=_a.isUntrackable,carrierAccountsMap=_a.carrierAccountsMap,dataAnalyticsContext=_a.dataAnalyticsContext,warnings=_a.warnings,t=_a.t,handleKeyboardEvents=_a.handleKeyboardEvents,transitDataServiceLevels=_a.transitDataServiceLevels;return rates.length&&shipment&&selectedRate?(0,emotion_react_jsx_runtime_browser_esm.FD)(Stack.A,(0,tslib_es6.Cl)({gap:1,"data-testid":"order-details-calculated-rates-list"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Typography.A,(0,tslib_es6.Cl)({component:"h3",variant:"h3",color:"primary"},{children:attributeText})),rates.map((function(rate){return(0,emotion_react_jsx_runtime_browser_esm.Y)(CalculatedRatesItem,{rate,isSelected:selectedRate.objectId===rate.objectId,selectRate:onSelectRate,shipmentId:shipment.objectId,isUntrackable,carrierAccount:carrierAccountsMap[rate.carrierAccount],t,dataAnalyticsContext,warnings,transitDataServiceLevels,handleKeyboardEvents},rate.objectId)}))]})):null},OrderDetailsPage_RateList=RateList_RateList;var RatingErrors_styles_templateObject_1,RatingErrors_styles_templateObject_2,RatingErrors_styles_templateObject_3,RatingErrors_styles_templateObject_4,RatingErrors_styles_templateObject_5,RatingErrors_styles_templateObject_6,getRateWarnings=__webpack_require__("./app/pages/Orders/All/OrderDetailsPage/RatingErrors/getRateWarnings.ts"),hasRatingErrors=__webpack_require__("./app/pages/Orders/All/OrderDetailsPage/RatingErrors/hasRatingErrors.ts"),styles_ErrorText=(0,emotion_styled_browser_esm.A)("li")(RatingErrors_styles_templateObject_1||(RatingErrors_styles_templateObject_1=(0,tslib_es6.ue)(["\n  line-height: 1.25rem;\n  color: ",";\n  margin-top: 0.25rem;\n"],["\n  line-height: 1.25rem;\n  color: ",";\n  margin-top: 0.25rem;\n"])),styles_constants.Tj.fontColor),styles_IconContainer=(0,emotion_styled_browser_esm.A)("img")(RatingErrors_styles_templateObject_2||(RatingErrors_styles_templateObject_2=(0,tslib_es6.ue)(["\n  margin-right: 0.75rem;\n"],["\n  margin-right: 0.75rem;\n"]))),ErrorTitle=(0,emotion_styled_browser_esm.A)("div")(RatingErrors_styles_templateObject_3||(RatingErrors_styles_templateObject_3=(0,tslib_es6.ue)(["\n  font-size: 0.75rem;\n  line-height: 1.25rem;\n  letter-spacing: 0.031rem;\n"],["\n  font-size: 0.75rem;\n  line-height: 1.25rem;\n  letter-spacing: 0.031rem;\n"]))),ErrorCTA=(0,emotion_styled_browser_esm.A)("div")(RatingErrors_styles_templateObject_4||(RatingErrors_styles_templateObject_4=(0,tslib_es6.ue)(["\n  font-weight: ",";\n  margin-top: 0.75rem;\n"],["\n  font-weight: ",";\n  margin-top: 0.75rem;\n"])),styles_constants.Wy.medium),ErrorList=(0,emotion_styled_browser_esm.A)("ul")(RatingErrors_styles_templateObject_5||(RatingErrors_styles_templateObject_5=(0,tslib_es6.ue)(["\n  list-style: disc;\n  padding-left: 1.25rem;\n  margin-top: 0.5rem;\n"],["\n  list-style: disc;\n  padding-left: 1.25rem;\n  margin-top: 0.5rem;\n"]))),AnchorLinkButton=(0,emotion_styled_browser_esm.A)("button")(RatingErrors_styles_templateObject_6||(RatingErrors_styles_templateObject_6=(0,tslib_es6.ue)(["\n  color: ",";\n"],["\n  color: ",";\n"])),styles_constants.Tj.sea600),ComposedRateWarnings=(0,redux.Zz)(components_withAddressBook({name:addressBook.MQ,appLocation:"order_details"}),(0,utils_translate.Tl)("orders"))((function(props){var warnings=props.warnings,addressTo=props.addressTo,addressFrom=props.addressFrom,orderID=props.orderID,batchEntryID=props.batchEntryID,t=props.t,addressBookContext=react.useContext(context.o);react.useEffect((function(){addressBookContext.initSelectedAddresses({to:addressTo,sender:addressFrom})}),[]);var handleOpenRecipientAddress=react.useCallback((function(){var _a;addressTo&&addressBookContext.selectAddress(addressBook.i1,addressTo),addressFrom&&addressBookContext.selectAddress(addressBook.y9,addressFrom);var orderSelection=((_a={})[orderID]=batchEntryID?[batchEntryID]:[],_a);addressBookContext.openEditAddress(addressBook.i1,orderSelection)}),[addressTo,addressFrom]),dedupedWarnings=(0,RatingErrors_util.Gz)(warnings);return(0,emotion_react_jsx_runtime_browser_esm.FD)(Message._j,{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(FlexContainer.Ay,(0,tslib_es6.Cl)({flexDirection:FlexContainer.bo.Row},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(styles_IconContainer,{src:question_circle_yellow,alt:"error"}),(0,emotion_react_jsx_runtime_browser_esm.Y)(ErrorTitle,{children:t("orders:table:errors:ratesWarning")})]})),!!dedupedWarnings.length&&(0,emotion_react_jsx_runtime_browser_esm.Y)(ErrorList,{children:dedupedWarnings.map((function(warning){var kind=warning.kind,message=warning.message,linkCopy=warning.linkCopy,messageArgs=warning.messageArgs;return kind===RateWarningConstants.pp?(0,emotion_react_jsx_runtime_browser_esm.Y)(styles_ErrorText,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)("p",{children:[t(message,messageArgs)," ",(0,emotion_react_jsx_runtime_browser_esm.Y)(AnchorLinkButton,(0,tslib_es6.Cl)({className:"bg-transparent border-none cursor-pointer p-0",onClick:handleOpenRecipientAddress},{children:t(linkCopy)}))]})},(0,index_browser.Ak)()):(0,emotion_react_jsx_runtime_browser_esm.Y)(styles_ErrorText,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)("p",{children:t(message,messageArgs)})},(0,index_browser.Ak)())}))})]})}));const RatingErrors_RateWarnings=ComposedRateWarnings;var Alert=__webpack_require__("./node_modules/@goshippo/components/esm/Alert/Alert.js"),RatingErrorsSwitch=function(_a){var t=_a.t,history=_a.history,order=_a.order,batchEntry=_a.batchEntry,shipment=_a.shipment,transaction=_a.transaction,rates=_a.rates,hasValidSenderAddress=_a.hasValidSenderAddress,_b=(0,hasRatingErrors.A)(order,batchEntry,shipment,transaction,rates,hasValidSenderAddress),hasExceededPackageWeightError=_b.hasExceededPackageWeightError,transactionHasErrors=_b.transactionHasErrors,hasShipmentErrors=_b.hasShipmentErrors,hasParcelWeightErrors=_b.hasParcelWeightErrors,showRecipientAddressError=_b.showRecipientAddressError,showSenderAddressError=_b.showSenderAddressError,showParcelError=_b.showParcelError,hasPhoneNumberRequiredError=_b.hasPhoneNumberRequiredError;return transactionHasErrors?(0,emotion_react_jsx_runtime_browser_esm.Y)(TransactionErrors,{t,transaction}):hasExceededPackageWeightError?(0,emotion_react_jsx_runtime_browser_esm.Y)(ExceededPackageWeightError,{batchEntryId:null==batchEntry?void 0:batchEntry.id,orderId:order.objectId,history}):(0,emotion_react_jsx_runtime_browser_esm.Y)(Errors,{t,shipment,hasRates:rates.length>0,hasShipmentErrors,hasParcelWeightErrors,showRecipientAddressError,showSenderAddressError,showParcelError,hasPhoneNumberRequiredError})},TransactionErrors=function(_a){var messages,t=_a.t,transaction=_a.transaction;return messages=transaction&&transaction.messages.length>0?transaction.messages.map((function(message){return message.text})):[t("orders:calculateRates:rates:errors:transactionFailure")],(0,react.useEffect)((function(){utils_observability.O.errorEvent("RATE_REFRESH_ORDER_DETAILS",{errorMessage:messages.join(", ")})}),[messages]),(0,emotion_react_jsx_runtime_browser_esm.Y)(emotion_react_jsx_runtime_browser_esm.FK,{children:messages.map((function(message){return(0,emotion_react_jsx_runtime_browser_esm.Y)(ErrorList,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(Typography.A,(0,tslib_es6.Cl)({component:"li",variant:"body",color:"primary"},{children:[t("orders:table:errors:transactionFailedTitle"),". ",message]}))},message)}))})},ExceededPackageWeightError=function(_a){var batchEntryId=_a.batchEntryId,orderId=_a.orderId,history=_a.history;(0,react.useEffect)((function(){utils_observability.O.errorEvent("RATE_REFRESH_ORDER_DETAILS",{orderWeightExceeded:1})}),[]);var batchEntryUri=batchEntryId?"/shipments/".concat(batchEntryId):"";return(0,emotion_react_jsx_runtime_browser_esm.Y)(ErrorList,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Typography.A,(0,tslib_es6.Cl)({component:"li",variant:"body",color:"primary"},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(utils_translate.x6,(0,tslib_es6.Cl)({i18nKey:"orders:calculateRates:rates:errors:order_weight_exceeded"},{children:["We cannot generate rates because the total order item weight is heavier than the total package weight. Please check your order items, and then update your"," ",(0,emotion_react_jsx_runtime_browser_esm.Y)(react_router_dom.N_,(0,tslib_es6.Cl)({to:"/orders/".concat(orderId).concat(batchEntryUri).concat(history.location.search)},{children:"package info"})),"."]}))}))})},Errors=function(_a){var t=_a.t,shipment=_a.shipment,hasRates=_a.hasRates,hasShipmentErrors=_a.hasShipmentErrors,hasParcelWeightErrors=_a.hasParcelWeightErrors,hasPhoneNumberRequiredError=_a.hasPhoneNumberRequiredError,showRecipientAddressError=_a.showRecipientAddressError,showSenderAddressError=_a.showSenderAddressError,showParcelError=_a.showParcelError;return(0,react.useEffect)((function(){utils_observability.O.errorEvent("RATE_REFRESH_ORDER_DETAILS",{recipientAddressErrors:showRecipientAddressError?1:0,parcelErrors:showParcelError?1:0,parcelWeightErrors:hasParcelWeightErrors?1:0,senderAddressErrors:showSenderAddressError?1:0,phoneNumberRequiredError:hasPhoneNumberRequiredError?1:0,shipmentErrors:hasShipmentErrors?null==shipment?void 0:shipment.messages.length:0,shipmentErrorMessages:null==shipment?void 0:shipment.messages.map((function(message){return message.text})).join(", ")})}),[hasParcelWeightErrors,hasPhoneNumberRequiredError,hasShipmentErrors,shipment,showParcelError,showRecipientAddressError,showSenderAddressError]),(0,emotion_react_jsx_runtime_browser_esm.FD)(emotion_react_jsx_runtime_browser_esm.FK,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(ErrorCTA,{children:hasShipmentErrors&&!hasRates?"There is an issue with your package":t("orders:calculateRates:rates:errors:title")}),(0,emotion_react_jsx_runtime_browser_esm.FD)(ErrorList,{children:[showRecipientAddressError&&(0,emotion_react_jsx_runtime_browser_esm.FD)(Typography.A,(0,tslib_es6.Cl)({component:"li",variant:"body",color:"primary"},{children:[t("orders:calculateRates:rates:errors:recipient")," ",(0,emotion_react_jsx_runtime_browser_esm.Y)(Link_Link.A,(0,tslib_es6.Cl)({color:"primary",href:"#addressCard"},{children:t("orders:actions:single:jumpToError")}))]})),showParcelError&&(0,emotion_react_jsx_runtime_browser_esm.FD)(Typography.A,(0,tslib_es6.Cl)({component:"li",variant:"body",color:"primary"},{children:[t("orders:calculateRates:rates:errors:parcel")," ",(0,emotion_react_jsx_runtime_browser_esm.Y)(Link_Link.A,(0,tslib_es6.Cl)({color:"primary",href:"#packageCard"},{children:t("orders:actions:single:jumpToError")}))]})),hasParcelWeightErrors&&(0,emotion_react_jsx_runtime_browser_esm.FD)(Typography.A,(0,tslib_es6.Cl)({component:"li",variant:"body",color:"primary"},{children:[t("orders:calculateRates:rates:errors:parcelWeight")," ",(0,emotion_react_jsx_runtime_browser_esm.Y)(Link_Link.A,(0,tslib_es6.Cl)({color:"primary",href:"#packageCard"},{children:t("orders:actions:single:jumpToError")}))]})),showSenderAddressError&&(0,emotion_react_jsx_runtime_browser_esm.FD)(Typography.A,(0,tslib_es6.Cl)({component:"li",variant:"body",color:"primary"},{children:[t("orders:calculateRates:rates:errors:sender")," ",(0,emotion_react_jsx_runtime_browser_esm.Y)(Link_Link.A,(0,tslib_es6.Cl)({color:"primary",href:"#addressCard"},{children:t("orders:actions:single:jumpToError")}))]})),hasPhoneNumberRequiredError&&(0,emotion_react_jsx_runtime_browser_esm.FD)(Typography.A,(0,tslib_es6.Cl)({component:"li",variant:"body",color:"primary"},{children:[t("orders:calculateRates:rates:errors:senderPhoneNumber")," ",(0,emotion_react_jsx_runtime_browser_esm.Y)(Link_Link.A,(0,tslib_es6.Cl)({color:"primary",href:"#addressCard"},{children:t("orders:actions:single:jumpToError")}))]})),hasShipmentErrors&&!hasRates&&shipment&&shipment.messages.map((function(_a){var text=_a.text;return(0,emotion_react_jsx_runtime_browser_esm.Y)(Typography.A,(0,tslib_es6.Cl)({component:"li",variant:"body",color:"primary"},{children:text}),text)}))]})]})};const RatingErrors_RatingErrors=function(props){var batchEntry=props.batchEntry,rates=props.rates,shipment=props.shipment,order=props.order,hasValidSenderAddress=props.hasValidSenderAddress,transaction=props.transaction,t=props.t;return(0,emotion_react_jsx_runtime_browser_esm.Y)(Alert.A,(0,tslib_es6.Cl)({severity:"warning",title:t("orders:table:errors:ratesUnavailable")},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(RatingErrorsSwitch,{t,history:props.history,order,batchEntry,shipment,transaction,rates,hasValidSenderAddress})}))};const RatingErrors_container=(0,redux.Zz)((0,es.Ng)((function(){var getOrderById=(0,orders_selectors.H4)(),getBatchEntryById=(0,batch_entry_selectors.Xv)(),getBatchEntryTransactionFromOrder=(0,batch_entry_composite_selectors.B6)();return function(state,ownProps){var batchEntryId=ownProps.batchEntryId,props={batchEntryId};return{order:getOrderById(state,ownProps),batchEntry:batchEntryId?getBatchEntryById(state,props):null,shipment:batchEntryId?(0,batch_entry_composite_selectors.Qb)(state,props):null,transaction:batchEntryId?getBatchEntryTransactionFromOrder(state,props):null,rates:batchEntryId?(0,batch_entry_composite_selectors.jl)(state,props):[],hasValidSenderAddress:(0,user_selectors.Oz)(state)}}})),(0,utils_translate.Tl)("orders"),react_router.y)(RatingErrors_RatingErrors);var ShipmentErrors_styled_templateObject_1,ShipmentErrors_styled_templateObject_2,AccordionSummary=__webpack_require__("./node_modules/@goshippo/components/esm/Accordion/AccordionSummary/AccordionSummary.js"),AccordionDetails=__webpack_require__("./node_modules/@goshippo/components/esm/Accordion/AccordionDetails/AccordionDetails.js"),CardSummaryButton=__webpack_require__("./app/pages/Orders/Blackbeard/LabelPurchase/modules/Card/CardSummaryButton.tsx"),Accordion=__webpack_require__("./node_modules/@goshippo/components/esm/Accordion/Accordion.js"),StyledAccordion=(0,styled.Ay)(Accordion.A)(ShipmentErrors_styled_templateObject_1||(ShipmentErrors_styled_templateObject_1=(0,tslib_es6.ue)(["\n  border: none;\n  margin-top: ",";\n\n  &.Mui-expanded {\n    margin-top: ",";\n  }\n\n  .MuiAccordionSummary-content,\n  .MuiAccordionSummary-content.Mui-expanded {\n    margin: 0;\n  }\n\n  .MuiAccordionSummary-root,\n  .MuiAccordionSummary-root.Mui-expanded {\n    min-height: auto;\n  }\n\n  .MuiAccordionDetails-root {\n    padding: 0;\n  }\n"],["\n  border: none;\n  margin-top: ",";\n\n  &.Mui-expanded {\n    margin-top: ",";\n  }\n\n  .MuiAccordionSummary-content,\n  .MuiAccordionSummary-content.Mui-expanded {\n    margin: 0;\n  }\n\n  .MuiAccordionSummary-root,\n  .MuiAccordionSummary-root.Mui-expanded {\n    min-height: auto;\n  }\n\n  .MuiAccordionDetails-root {\n    padding: 0;\n  }\n"])),shippoTheme.A.spacing(1),shippoTheme.A.spacing(1)),StyledList=(0,styled.Ay)("ul")(ShipmentErrors_styled_templateObject_2||(ShipmentErrors_styled_templateObject_2=(0,tslib_es6.ue)(["\n  list-style: none;\n  padding: ",";\n\n  li {\n    color: ",";\n  }\n\n  li:not(:last-child) {\n    margin-bottom: ",";\n  }\n"],["\n  list-style: none;\n  padding: ",";\n\n  li {\n    color: ",";\n  }\n\n  li:not(:last-child) {\n    margin-bottom: ",";\n  }\n"])),shippoTheme.A.spacing(0,1),styles_colors.T.secondary,shippoTheme.A.spacing(1)),ShipmentErrors=function(_a){var messages=_a.messages,t=_a.t,_b=(0,tslib_es6.zs)((0,react.useState)(!1),2),showMessages=_b[0],setShowMessages=_b[1];return messages.length?(0,emotion_react_jsx_runtime_browser_esm.FD)(StyledAccordion,(0,tslib_es6.Cl)({"data-testid":"shipment-errors",onChange:function(_,isExpanded){return setShowMessages(isExpanded)}},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(AccordionSummary.A,(0,tslib_es6.Cl)({role:void 0,id:"shipment-errors-header","aria-controls":"shipment-errors-content"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(CardSummaryButton.A,{isError:!1,isOpen:showMessages,text:t("calculateRates.rates.carrierMessages")})})),(0,emotion_react_jsx_runtime_browser_esm.Y)(AccordionDetails.A,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(StyledList,{children:messages.map((function(_a){var source=_a.source,text=_a.text;return(0,emotion_react_jsx_runtime_browser_esm.FD)("li",{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Typography.A,(0,tslib_es6.Cl)({component:"span",variant:"bodyEmphasized",color:"inherit"},{children:"".concat(source,": ")})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Typography.A,(0,tslib_es6.Cl)({component:"span",variant:"body",color:"inherit"},{children:text}))]},text)}))})})]})):null};const useFetchTransitTime=function(featureFlag,zipFrom,zipTo){var zipCodeFrom=null==zipFrom?void 0:zipFrom.substring(0,5),zipCodeTo=null==zipTo?void 0:zipTo.substring(0,5),_a=(0,tslib_es6.zs)((0,react.useState)(),2),transitData=_a[0],setData=_a[1],_b=(0,tslib_es6.zs)((0,react.useState)(!1),2),isLoadingTransit=_b[0],setIsLoading=_b[1],_c=(0,tslib_es6.zs)((0,react.useState)(null),2),transitError=_c[0],setError=_c[1];return(0,react.useEffect)((function(){if(featureFlag&&zipCodeFrom&&zipCodeTo){(0,tslib_es6.sH)(void 0,void 0,void 0,(function(){var response,error_1;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:setIsLoading(!0),setError(null),_a.label=1;case 1:return _a.trys.push([1,3,4,5]),[4,(zip_from=zipCodeFrom,zip_to=zipCodeTo,services_api.i5.request({method:"GET",url:"/insights/time_in_transit_by_service_level",params:{zip_from,zip_to}}))];case 2:return response=_a.sent(),setData(response.data.servicelevels),[3,5];case 3:return error_1=_a.sent(),setError(error_1),[3,5];case 4:return setIsLoading(!1),[7];case 5:return[2]}var zip_from,zip_to}))}))}}),[featureFlag,zipCodeFrom,zipCodeTo]),{isLoadingTransit,transitData,transitError}};var Refresh=__webpack_require__("./node_modules/@mui/icons-material/esm/Refresh.js"),actions=__webpack_require__("./node_modules/connected-react-router/esm/actions.js"),compact=__webpack_require__("./node_modules/lodash-es/compact.js"),uniq=__webpack_require__("./node_modules/lodash-es/uniq.js"),redux_saga_effects_npm_proxy_esm=__webpack_require__("./node_modules/redux-saga/dist/redux-saga-effects-npm-proxy.esm.js");function getApiAddresses(){return services_api.Ay.request({url:"/ui/user_addresses",method:"GET",params:{results:100}})}function createApiAddress(address){return services_api.Ay.request({url:"/ui/user_addresses",method:"POST",data:(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},address),{hard_validate:!0})})}function editApiAddress(id,address){return services_api.Ay.request({url:"/ui/user_addresses/".concat(id),method:"PUT",data:(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},address),{hard_validate:!0})})}function deleteApiAddress(id){return services_api.Ay.request({url:"/ui/user_addresses/".concat(id),method:"DELETE"})}var APIAddress=__webpack_require__("./app/types/APIAddress.ts"),esm=__webpack_require__("./node_modules/@sentry/browser/esm/index.js");function didSaveLabel(response){return{type:constants.t.SAVE_LABEL_SETTINGS_SUCCESS,payload:response}}function fetchLabelSettingsSuccess(response){return{type:constants.t.FETCH_LABEL_SETTINGS_SUCCESS,payload:response}}var CONNECTED_STORE_SUCCESS="CONNECTED_STORE_SUCCESS",FIRST_STORE_CONNECTED="FIRST_STORE_CONNECTED",onboarding_constants=__webpack_require__("./app/pages/Onboarding/onboarding.constants.ts"),onboarding_actions=__webpack_require__("./app/pages/Onboarding/store/onboarding.actions.ts"),store_connect_actions=__webpack_require__("./app/pages/StoreConnections/store/store-connect.actions.ts"),PackingSlipFormat=__webpack_require__("./app/types/PackingSlipFormat.ts"),getLabelSettingsStore=function(state){return state.labelSettings},label_settings_selectors_getDefaultLabelFormat=((0,reselect_es.createSelector)(getLabelSettingsStore,(function(labelSettingsStore){return labelSettingsStore.data.defaultPackingSlipFormat||PackingSlipFormat.Ay.PSLIP_8X11_PDF})),(0,reselect_es.createSelector)(getLabelSettingsStore,(function(labelSettingsStore){return labelSettingsStore.data.defaultLabelFormat}))),label_settings_selectors_getLabelSettings=(0,reselect_es.createSelector)(getLabelSettingsStore,(function(labelSettingsStore){return labelSettingsStore.data}));function sendAdditionalInformation(payload){return services_api.YZ.request({url:"setting/user-info",method:"POST",data:payload})}function saveLabelSettings(payload){return services_api.YZ.request({url:"/setting/label",method:"POST",data:payload})}function settings_service_fetchLabelSettings(){return services_api.YZ.request({url:"/setting/label",method:"GET"})}function saveDefaultServiceLevel(defaultServiceLevel,defaultReturnServiceLevel){return services_api.Ay.request({url:"v1/ui/account",method:"PATCH",data:{default_service_level:defaultServiceLevel,default_return_service_level:defaultReturnServiceLevel}})}function closeAccount(payload){return services_api.YZ.request({url:"/setting/close-account",method:"POST",data:payload,validateStatus:function(status){return 200===status||201===status||400===status}})}const settings_service={saveLabelSettings,fetchLabelSettings:settings_service_fetchLabelSettings,saveDefaultServiceLevel,closeAccount};function LabelSettings_fromJSON(data){return{defaultLabelFormat:data.default_label_format,defaultPackingSlipFormat:data.default_packing_slip_format,isMergeLabelsAndPackingSlips:data.is_merged_labels_packing_slips,refText1:data.default_shipment_reference_1,refText2:data.default_shipment_reference_2,outboundServiceLevel:data.default_outbound_service_level,isRequireSignatureConfirmation:data.is_signature_confirmation_selected,outboundReturnLabelServiceLevel:data.default_return_service_level,isAutoCreateReturnLabels:data.is_auto_create_return_label,isUseOrderNumber:data.is_use_order_number,labelLogoType:data.label_logo_type,storePolicyText:data.store_policy_text,packingSlipText:data.packing_slip_text,packingSlipShowPrices:!data.is_packing_slip_hide_prices}}var Store=__webpack_require__("./app/types/Store.ts");function getUserPlans(){return services_api.Ay.request({url:"/billing/current-features/"})}function getPricingPlans(){return services_api.Ay.request({url:"/billing/plans"})}function setUserPlan(planName,isDeveloperPlan){var devPlan=isDeveloperPlan?{is_developer_plan:isDeveloperPlan}:{};return services_api.Ay.request({url:"/billing/plan-upgrade",method:"POST",data:(0,tslib_es6.Cl)({plan:planName},devPlan)})}function fetchUserPlansSuccess(userPlans){return{type:constants.t.FETCH_USER_PLANS_SUCCESS,payload:{userPlans}}}function fetchPricingPlansSuccess(pricingPlans){return{type:constants.t.FETCH_PRICING_PLANS_SUCCESS,payload:{pricingPlans}}}function updateUserPlanSuccess(userPlan){return{type:constants.t.UPDATE_USER_PLAN_SUCCESS,payload:{userPlan}}}function updateUserPlanError(errorMessage){return{type:constants.t.UPDATE_USER_PLAN_ERROR,payload:{errorMessage}}}function closeAccountSuccess(closeStatus){return{type:constants.t.CLOSE_ACCOUNT_SUCCESS,payload:{closeStatus}}}function closeAccountError(errorMessage){return{type:constants.t.CLOSE_ACCOUNT_ERROR,payload:{errorMessage}}}var BillingFrequency,getOnboardingStore=function(state){return state.onboarding},getNavigationCurrentStep=((0,reselect_es.createSelector)(getOnboardingStore,(function(onboardingStore){return onboardingStore.ready})),(0,reselect_es.createSelector)(getOnboardingStore,(function(onboardingStore){return onboardingStore.navigation.steps})),(0,reselect_es.createSelector)(getOnboardingStore,(function(onboardingStore){return onboardingStore.navigation.currentStepIndex}))),getNavigationCurrentStepName=(0,reselect_es.createSelector)(getOnboardingStore,(function(onboardingStore){return onboardingStore.navigation.steps[onboardingStore.navigation.currentStepIndex].label})),getNavigationLastCompletedStep=(0,reselect_es.createSelector)(getOnboardingStore,(function(onboardingStore){return onboardingStore.navigation.lastCompletedStepIndex})),getNavigationLastCompletedStepName=(0,reselect_es.createSelector)(getOnboardingStore,(function(onboardingStore){return onboardingStore.navigation.steps[onboardingStore.navigation.lastCompletedStepIndex].label})),getOnboardingInfo=(0,reselect_es.createSelector)(getOnboardingStore,(function(onboardingStore){return onboardingStore[onboarding_constants.hv.info]})),getOnboardingBusinessType=((0,reselect_es.createSelector)(getOnboardingStore,(function(onboardingStore){return onboardingStore[onboarding_constants.hv.info].country})),(0,reselect_es.createSelector)(getOnboardingStore,(function(onboardingStore){return onboardingStore[onboarding_constants.hv.info].phone})),(0,reselect_es.createSelector)(getOnboardingStore,(function(onboardingStore){return onboardingStore[onboarding_constants.hv.info].companyName})),(0,reselect_es.createSelector)(getOnboardingStore,(function(onboardingStore){return onboardingStore[onboarding_constants.hv.info].businessType}))),getOnboardingBusinessNeed=(0,reselect_es.createSelector)(getOnboardingStore,(function(onboardingStore){return onboardingStore[onboarding_constants.hv.info].businessNeed})),getOnboardingPreferences=(0,reselect_es.createSelector)(getOnboardingStore,(function(onboardingStore){return onboardingStore[onboarding_constants.hv.preferences]})),getOnboardingOrders=(0,reselect_es.createSelector)(getOnboardingStore,(function(onboardingStore){return onboardingStore[onboarding_constants.hv.orders]})),getOrderMechanism=(0,reselect_es.createSelector)(getOnboardingStore,(function(onboardingStore){return onboardingStore[onboarding_constants.hv.orders].orderMechanism})),getOnboardingApi=(0,reselect_es.createSelector)(getOnboardingStore,(function(onboardingStore){return onboardingStore[onboarding_constants.hv.api]})),getOnboardingPlan=((0,reselect_es.createSelector)(getOnboardingStore,(function(onboardingStore){return onboardingStore[onboarding_constants.hv.getting_started]})),(0,reselect_es.createSelector)(getOnboardingStore,(function(onboardingStore){return onboardingStore[onboarding_constants.hv.shipping_details]})),(0,reselect_es.createSelector)(getOnboardingStore,(function(onboardingStore){return onboardingStore[onboarding_constants.hv.pro_plan]}))),getOnboardingUserInfo=(0,reselect_es.createSelector)(user_selectors.wz,(function(user){var _a,_b,_c,_d,_e,_f,_g,_h;return{id:null!==(_a=null==user?void 0:user.id)&&void 0!==_a?_a:null,name:null!==(_c=null===(_b=null==user?void 0:user.address)||void 0===_b?void 0:_b.name)&&void 0!==_c?_c:"",email:null!==(_d=null==user?void 0:user.email)&&void 0!==_d?_d:null,phone:null!==(_f=null===(_e=null==user?void 0:user.address)||void 0===_e?void 0:_e.phone)&&void 0!==_f?_f:null,company:null!==(_h=null===(_g=null==user?void 0:user.address)||void 0===_g?void 0:_g.company)&&void 0!==_h?_h:""}})),getOrdersAddressObject=(0,reselect_es.createSelector)(getOnboardingOrders,(function(onboardingOrders){return onboardingOrders.addressObject})),getPreferencesAddressObject=(0,reselect_es.createSelector)(getOnboardingPreferences,(function(onboardingPreferences){return onboardingPreferences.addressObject})),getConnectedStoreName=(0,reselect_es.createSelector)(getOnboardingStore,(function(onboardingStore){return onboardingStore.connectedStore?onboardingStore.connectedStore.storePlatform.name:void 0}));(0,reselect_es.createSelector)(getOnboardingStore,(function(onboardingStore){var _a;return(_a={global:onboardingStore.error})[onboarding_constants.hv.info]=onboardingStore[onboarding_constants.hv.info].error,_a[onboarding_constants.hv.preferences]=onboardingStore[onboarding_constants.hv.preferences].error,_a[onboarding_constants.hv.orders]=onboardingStore[onboarding_constants.hv.orders].error,_a}));!function(BillingFrequency){BillingFrequency.YEARLY="YEARLY",BillingFrequency.MONTHLY="MONTHLY"}(BillingFrequency||(BillingFrequency={}));function Plan_fromJSON(jsonPlan){return{isPro:jsonPlan.is_pro,isFullAccess:jsonPlan.is_full_access,displayName:jsonPlan.display_name,name:jsonPlan.name,isFreeTrial:jsonPlan.is_free_trial,billingFrequency:jsonPlan.frequency,subscriptionPrice:Number(jsonPlan.subscription_price),originalSubscriptionPrice:Number(jsonPlan.original_subscription_price),numberOfLabelsIncluded:jsonPlan.number_of_labels_included,numberOfSeats:jsonPlan.number_of_seats}}function userPlanFromJSON(jsonUserPlan){return{plan:Plan_fromJSON(jsonUserPlan.plan),startDate:moment_moment(jsonUserPlan.start_date),endDate:jsonUserPlan.end_date?moment_moment(jsonUserPlan.end_date):null,nextBillingDate:jsonUserPlan.next_billing_date?moment_moment(jsonUserPlan.next_billing_date):null}}var planToTrackingDetails=function(rawPlan){var _a,_b,planName;return{plan_name:rawPlan.plan.name,plan_frequency:rawPlan.plan.billingFrequency,plan_start_date:rawPlan.startDate.toISOString(),plan_end_date:null!==(_b=null===(_a=rawPlan.endDate)||void 0===_a?void 0:_a.toISOString())&&void 0!==_b?_b:null,plan_next_end_date:null,plan_next_bill_date:null,plan_cost:rawPlan.plan.subscriptionPrice,plan_label_estimate:rawPlan.plan.numberOfLabelsIncluded,plan_display_name:rawPlan.plan.displayName,plan_level:(planName=rawPlan.plan.displayName,planName.toLowerCase().includes("trial")?"trial":planName.toLowerCase().includes("pro")?"pro":planName.toLowerCase().includes("premier")?"premier":"basic")}},onboarding=__webpack_require__("./app/pages/Onboarding2024/utils/onboarding.ts");function safeNavigate(path){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return 0!==path.indexOf("/")?[3,2]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,actions.VC)({pathname:path}))];case 1:return _a.sent(),[3,3];case 2:window.location.href=path,_a.label=3;case 3:return[2]}}))}function persistConnectedStore(stores){var connectedStores;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return connectedStores=stores.filter((function(store){var _a;return(null===(_a=null==store?void 0:store.status)||void 0===_a?void 0:_a.name)===Store.Hu.Connected})),connectedStores.length?[4,(0,redux_saga_effects_npm_proxy_esm.T1)([localStorage,localStorage.setItem],onboarding_constants.kB.ONBOARDING_ACTIVE_STORE,connectedStores[0].storePlatform.name)]:[3,2];case 1:_a.sent(),_a.label=2;case 2:return[2]}}))}function addOrUpdateAddress(addressObject,address){var apiAddress,addressReq,response,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return apiAddress=(0,APIAddress.ZC)((0,tslib_es6.Cl)({},address)),addressReq=APIAddress.U2((0,tslib_es6.Cl)((0,tslib_es6.Cl)({},(0,Address.ko)(apiAddress)),{isDefaultSender:!0,isDefaultReturn:!0})),addressObject&&addressObject.id?[4,(0,redux_saga_effects_npm_proxy_esm.T1)(editApiAddress,addressObject.id,(0,tslib_es6.Cl)({id:addressObject.id},addressReq))]:[3,2];case 1:return _a=_b.sent(),[3,4];case 2:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(createApiAddress,addressReq)];case 3:_a=_b.sent(),_b.label=4;case 4:return response=_a,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(refreshUser())];case 5:return _b.sent(),[2,APIAddress.rS(response.data)]}}))}function handleError(view,error){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,onboarding_actions.Zw)("Onboarding - API Error",{view,error}))];case 1:return _a.sent(),error&&error.response&&esm_exports.wd("Onboarding Address API Error",{level:"warning",extra:{responseBody:JSON.stringify(error.response.data)}}),[2]}}))}function navigateForward(){var currentStep;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,selectState(getNavigationCurrentStep)];case 1:return currentStep=_a.sent(),[4,selectState(getNavigationLastCompletedStep)];case 2:return _a.sent()<=currentStep?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,onboarding_actions.SM)(currentStep))]:[3,4];case 3:_a.sent(),_a.label=4;case 4:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,onboarding_actions.oo)(currentStep+1))];case 5:return _a.sent(),[2]}}))}function persistOnboardingCompletion(){var orderMechanism,businessType,businessNeed;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,selectState(getOrderMechanism)];case 1:return orderMechanism=_a.sent(),[4,selectState(getOnboardingBusinessType)];case 2:return businessType=_a.sent(),[4,selectState(getOnboardingBusinessNeed)];case 3:return"Developer"!==(businessNeed=_a.sent())&&"partner"!==businessType||"partner"===businessType&&"Other"===businessNeed?[4,(0,redux_saga_effects_npm_proxy_esm.T1)([localStorage,localStorage.setItem],onboarding_constants.kB.ONBOARDING_SHOW_WELCOME_MESSAGE,"true")]:[3,6];case 4:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)([localStorage,localStorage.setItem],onboarding_constants.kB.ONBOARDING_ORDER_MECHANISM,orderMechanism)];case 5:_a.sent(),_a.label=6;case 6:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)([localStorage,localStorage.removeItem],onboarding_constants.kB.ONBOARDING_ACTIVE)];case 7:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)([localStorage,localStorage.removeItem],onboarding_constants.kB.ONBOARDING_BUSINESS_NEED)];case 8:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)([localStorage,localStorage.removeItem],onboarding_constants.kB.ONBOARDING_LAST_COMPLETED_STEP)];case 9:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)([localStorage,localStorage.removeItem],onboarding_constants.kB.ONBOARDING_CURRENT_STEP)];case 10:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)([localStorage,localStorage.removeItem],onboarding_constants.kB.ONBOARDING_ACTIVE_STORE)];case 11:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)([localStorage,localStorage.removeItem],onboarding_constants.kB.ONBOARDING_USER_COUNTRY)];case 12:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)([localStorage,localStorage.removeItem],onboarding_constants.kB.ONBOARDING_COMPLETED)];case 13:return _a.sent(),[2]}}))}var getStoreConnectParams=function(_a){var storeSelection=_a.storeSelection,storeConnectProps=_a.storeConnectProps;switch(storeSelection.name){case Store.F8.Amazon:return{country:storeConnectProps};case Store.F8.Shopify:return{shop:storeConnectProps};default:return{}}};function onboarding_sagas_updateUserPlan(){var plan,currentPlan,response,userPlan,_a,_b;return(0,tslib_es6.YH)(this,(function(_c){switch(_c.label){case 0:return[4,selectState(getOnboardingPlan)];case 1:return plan=_c.sent().plan,[4,selectState((function(state){return(0,plans_selectors.P8)(state)}))];case 2:return currentPlan=_c.sent(),plan?(null===(_a=null==currentPlan?void 0:currentPlan.plan)||void 0===_a?void 0:_a.name)===plan?[2]:[4,(0,redux_saga_effects_npm_proxy_esm.T1)(setUserPlan,plan)]:[2];case 3:return response=_c.sent(),userPlan=userPlanFromJSON(response.data),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(segment.u4,segment.sV.plan_updated,(0,tslib_es6.Cl)((0,tslib_es6.Cl)({operation:"started"},planToTrackingDetails(userPlan)),{previous_plan_name:null===(_b=null==currentPlan?void 0:currentPlan.plan)||void 0===_b?void 0:_b.displayName,entry_point:"onboarding"}))];case 4:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(updateUserPlanSuccess(userPlan))];case 5:return _c.sent(),[2]}}))}(0,redux_saga_effects_npm_proxy_esm.jP)(onboarding_actions.CT.COMPLETE_STEP,(function persistLastCompletedStep(action){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,3]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)([localStorage,localStorage.setItem],onboarding_constants.kB.ONBOARDING_LAST_COMPLETED_STEP,action.payload.index.toString())];case 1:return _a.sent(),[3,3];case 2:return _a.sent(),esm_exports.wd("Error setting last completed onboarding step to local storage",{level:"fatal"}),[3,3];case 3:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(onboarding_actions.CT.INITIALIZE_ONBOARDING,(function hydrateOnboarding(){var userInfo,address,connectedStores,defaultLabelFormat;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,stores_actions.hO)())];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.FETCH_LABEL_SETTINGS})];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,address_actions.ls)())];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.Q7)([(0,redux_saga_effects_npm_proxy_esm.O4)({address:(0,redux_saga_effects_npm_proxy_esm.s)(constants.t.ADDRESSES_FETCH_SUCCESS),addressError:(0,redux_saga_effects_npm_proxy_esm.s)(constants.t.ADDRESSES_FETCH_ERROR)}),(0,redux_saga_effects_npm_proxy_esm.s)(constants.t.FETCH_LABEL_SETTINGS_SUCCESS),(0,redux_saga_effects_npm_proxy_esm.O4)({address:(0,redux_saga_effects_npm_proxy_esm.s)(constants.t.STORES_FETCH_SUCCESS),addressError:(0,redux_saga_effects_npm_proxy_esm.s)(constants.t.STORES_FETCH_ERROR)})])];case 4:return _a.sent(),[4,selectState(getOnboardingUserInfo)];case 5:return userInfo=_a.sent(),[4,selectState(user_selectors.GA)];case 6:return address=_a.sent(),[4,selectState(stores_selectors.o$)];case 7:return connectedStores=_a.sent(),[4,selectState(label_settings_selectors_getDefaultLabelFormat)];case 8:return defaultLabelFormat=_a.sent(),[4,persistConnectedStore(connectedStores)];case 9:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,onboarding_actions.t2)((0,tslib_es6.Cl)((0,tslib_es6.Cl)({},userInfo),{address,defaultLabelFormat,connectedStores})))];case 10:return _a.sent(),[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(onboarding_actions.CT.NAVIGATE,(function persistCurrentStep(action){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,3]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)([localStorage,localStorage.setItem],onboarding_constants.kB.ONBOARDING_CURRENT_STEP,action.payload.index.toString())];case 1:return _a.sent(),[3,3];case 2:return _a.sent(),esm_exports.wd("Error setting current onboarding step to local storage",{level:"fatal"}),[3,3];case 3:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(onboarding_actions.CT.START_ONBOARDING,(function persistStatus(){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,6,,7]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)([localStorage,localStorage.setItem],onboarding_constants.kB.ONBOARDING_ACTIVE,"true")];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,onboarding_actions.Zw)("Onboarding - Started Onboarding"))];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.DISMISS_PROMO_APPLICATION_NOTICE})];case 3:return _a.sent(),window.location.pathname.match("^/onboarding")?[3,5]:[4,safeNavigate("/onboarding/welcome")];case 4:_a.sent(),_a.label=5;case 5:return[3,7];case 6:return _a.sent(),esm_exports.wd("Error setting onboarding status to local storage",{level:"fatal"}),[3,7];case 7:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(onboarding_actions.CT.SEND_ONBOARDING_TRACK_EVENT,(function sendOnboardingTrackEvent(action){var currentStep,currentStepName,lastCompletedStep,lastCompletedStepName,businessType,userOnboardingData,allUserProperties,error_5,_a,_b,_c,_d,_e;return(0,tslib_es6.YH)(this,(function(_f){switch(_f.label){case 0:return _f.trys.push([0,7,,9]),[4,selectState(getNavigationCurrentStep)];case 1:return currentStep=_f.sent(),[4,selectState(getNavigationCurrentStepName)];case 2:return currentStepName=_f.sent(),[4,selectState(getNavigationLastCompletedStep)];case 3:return lastCompletedStep=_f.sent(),[4,selectState(getNavigationLastCompletedStepName)];case 4:return lastCompletedStepName=_f.sent(),[4,selectState(getOnboardingBusinessType)];case 5:return businessType=_f.sent(),userOnboardingData={currentStepNumber:currentStep,currentStepName,lastCompletedStepNumber:lastCompletedStep,lastCompletedStepName,onboardingBusinessType:businessType},allUserProperties=(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},userOnboardingData),action.payload.properties),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)(action.payload.name,allUserProperties))];case 6:return _f.sent(),[3,9];case 7:return error_5=_f.sent(),_b=(_a=esm).captureException,_c=["Error sending onboarding track event"],_d={level:"fatal"},_e={error:error_5},[4,selectState(getOnboardingStore)];case 8:return _b.apply(_a,_c.concat([(_d.extra=(_e.onboardingStore=_f.sent(),_e),_d)])),[3,9];case 9:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(onboarding_actions.CT.UPDATE_ONBOARDING_STRUCTURE,(function persistBusinessTypeNeed(action){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,4]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)([localStorage,localStorage.setItem],onboarding_constants.kB.ONBOARDING_BUSINESS_TYPE,action.payload.businessType)];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)([localStorage,localStorage.setItem],onboarding_constants.kB.ONBOARDING_BUSINESS_NEED,action.payload.businessNeed)];case 2:return _a.sent(),[3,4];case 3:return _a.sent(),esm_exports.wd("Error setting onboarding business type and business need to localstorage",{level:"fatal"}),[3,4];case 4:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(onboarding_actions.CT.UPDATE_ONBOARDING_INFO,(function updateOnboardingInfo(action){var shippoUseCaseMap,useCase,sendAdditionalInformationPayload,error_6,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:useCase=(shippoUseCaseMap={business:"Business",personal:"Personal",partner:"Partner"}).hasOwnProperty(action.payload.values.businessType)?shippoUseCaseMap[action.payload.values.businessType]:void 0,_b.label=1;case 1:return _b.trys.push([1,8,,11]),sendAdditionalInformationPayload={company_name:action.payload.values.companyName||void 0,monthly_packages:action.payload.values.monthlyVolume||void 0,phone:action.payload.values.phone||void 0,what_type_of_business:action.payload.values.businessNeed||void 0,shippo_use_case:useCase},action.payload.token?[4,(0,redux_saga_effects_npm_proxy_esm.T1)(services_api.kM,action.payload.token)]:[3,3];case 2:_b.sent(),_b.label=3;case 3:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(sendAdditionalInformation,sendAdditionalInformationPayload)];case 4:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,onboarding_actions.Sg)(action.payload.values))];case 5:return _b.sent(),(null===(_a=action.payload.values.country)||void 0===_a?void 0:_a.name)?[4,(0,redux_saga_effects_npm_proxy_esm.T1)([localStorage,localStorage.setItem],onboarding_constants.kB.ONBOARDING_USER_COUNTRY,JSON.stringify(action.payload.values.country))]:[3,7];case 6:_b.sent(),_b.label=7;case 7:return[3,11];case 8:return error_6=_b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(handleError,"info",error_6)];case 9:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,onboarding_actions.bJ)(error_6))];case 10:return _b.sent(),[3,11];case 11:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(onboarding_actions.CT.UPDATE_ONBOARDING_INFO_SUCCESS,(function handleOnboardingInfoSuccess(){var storeName,businessType,businessNeed;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,selectState(getConnectedStoreName)];case 1:return storeName=_a.sent(),[4,selectState(getOnboardingBusinessType)];case 2:return businessType=_a.sent(),[4,selectState(getOnboardingBusinessNeed)];case 3:return businessNeed=_a.sent(),"true"===(0,onboarding.VK)()?[3,5]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,onboarding_actions.tb)("info","advance"))];case 4:_a.sent(),_a.label=5;case 5:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,onboarding_actions.A0)(businessType,businessNeed,storeName))];case 6:return _a.sent(),[4,navigateForward()];case 7:return _a.sent(),[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(onboarding_actions.CT.UPDATE_ONBOARDING_PREFERENCES,(function updateOnboardingPreferences(action){var hubspotPayload,onboardingDefaultLabelPayload,labelReqbody,addressObjectRes,userId,error_7;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,21,,24]),hubspotPayload={primary_carrier:action.payload.primaryCarrier,apply_insurance_on_all:action.payload.applyInsuranceOnAll},onboardingDefaultLabelPayload={defaultLabelFormat:{value:action.payload.labelSize,label:action.payload.labelSize},refText1:"",refText2:"",isMergeLabelsAndPackingSlips:!1,isUseOrderNumber:!1,isRequireSignatureConfirmation:!1,isAutoCreateReturnLabels:!1},labelReqbody=function toJSON(labelSettings){var _a,_b,_c,_d,_e,_f,_g;return{default_label_format:labelSettings.defaultLabelFormat?labelSettings.defaultLabelFormat.value:null,default_packing_slip_format:labelSettings.defaultPackingSlipFormat?labelSettings.defaultPackingSlipFormat.value:null,is_merged_labels_packing_slips:labelSettings.isMergeLabelsAndPackingSlips,default_shipment_reference_1:labelSettings.refText1,default_shipment_reference_2:labelSettings.refText2,default_outbound_account:(null===(_a=labelSettings.outboundServiceLevel)||void 0===_a?void 0:_a.value)?null===(_b=labelSettings.outboundCarrierServiceLevelAccount)||void 0===_b?void 0:_b.value.toString():null,default_provider:labelSettings.outboundCarrierServiceLevel?labelSettings.outboundCarrierServiceLevel.value.toString():null,default_outbound_service_level:null===(_c=labelSettings.outboundServiceLevel)||void 0===_c?void 0:_c.value.toString(),default_return_account:(null===(_d=labelSettings.returnLabelServiceLevel)||void 0===_d?void 0:_d.value)?null===(_e=labelSettings.returnLabelCarrierAccount)||void 0===_e?void 0:_e.value.toString():null,default_return_provider:labelSettings.returnLabelCarrier?null===(_f=labelSettings.returnLabelCarrier)||void 0===_f?void 0:_f.value.toString():null,default_return_service_level:labelSettings.returnLabelServiceLevel?null===(_g=labelSettings.returnLabelServiceLevel)||void 0===_g?void 0:_g.value.toString():null,is_signature_confirmation_selected:labelSettings.isRequireSignatureConfirmation,is_auto_create_return_label:labelSettings.isAutoCreateReturnLabels,is_use_order_number:labelSettings.isUseOrderNumber,label_logo_type:labelSettings.labelLogoType?labelSettings.labelLogoType.value:null,store_policy_text:labelSettings.storePolicyText||"",packing_slip_text:labelSettings.packingSlipText||"",is_packing_slip_hide_prices:!labelSettings.packingSlipShowPrices||!1}}(onboardingDefaultLabelPayload),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(settings_service.saveLabelSettings,labelReqbody)];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(sendAdditionalInformation,hubspotPayload)];case 2:return _a.sent(),action.payload.primaryCarrier?[4,(0,redux_saga_effects_npm_proxy_esm.T1)([localStorage,localStorage.setItem],"primary_carrier",action.payload.primaryCarrier)]:[3,5];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendGTMEvent({eventName:"SET_PRIMARY_CARRIER",data:{primaryCarrier:action.payload.primaryCarrier}}))];case 4:_a.sent(),_a.label=5;case 5:return action.payload.address?[4,selectState(getPreferencesAddressObject)]:[3,11];case 6:return[4,addOrUpdateAddress(_a.sent(),(0,tslib_es6.Cl)({},action.payload.address))];case 7:return addressObjectRes=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,onboarding_actions.sH)(action.payload.primaryCarrier,action.payload.labelSize,addressObjectRes))];case 8:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,onboarding_actions.tb)("preferences",action.payload.complete?"get_started":"advance"))];case 9:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,onboarding_actions.Zw)("Onboarding - Filled Sender Address"))];case 10:return _a.sent(),[3,14];case 11:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,onboarding_actions.sH)(action.payload.primaryCarrier,action.payload.labelSize))];case 12:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,onboarding_actions.tb)("preferences",action.payload.complete?"get_started":"advance"))];case 13:_a.sent(),_a.label=14;case 14:return action.payload.complete?[4,(0,redux_saga_effects_npm_proxy_esm.T1)(onboarding_sagas_updateUserPlan)]:[3,18];case 15:return _a.sent(),[4,persistOnboardingCompletion()];case 16:return _a.sent(),[4,safeNavigate("/orders")];case 17:_a.sent(),_a.label=18;case 18:return[4,selectState(user_selectors.F6)];case 19:return userId=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(segment.ls,userId,{preferred_carrier:action.payload.primaryCarrier})];case 20:return _a.sent(),[3,24];case 21:return error_7=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(handleError,"preferences",error_7)];case 22:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,onboarding_actions.Ze)(error_7))];case 23:return _a.sent(),esm_exports.wd("Error submitting Preference view information to Hubspot and DB",{level:"fatal",extra:{error:error_7}}),[3,24];case 24:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.jP)([onboarding_actions.CT.UPDATE_ONBOARDING_PREFERENCES_SUCCESS],navigateForward),(0,redux_saga_effects_npm_proxy_esm.jP)(onboarding_actions.CT.UPDATE_ONBOARDING_ORDERS,(function updateOnboardingOrders(action){var addressObject,currentStepName,isOrdersView,addressObjectRes,error_8;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,16,,19]),[4,selectState(getOrdersAddressObject)];case 1:return addressObject=_a.sent(),[4,selectState(getNavigationCurrentStepName)];case 2:return currentStepName=_a.sent(),isOrdersView="newOnboarding.nav.orders"===currentStepName,action.payload.address?[4,addOrUpdateAddress(addressObject,(0,tslib_es6.Cl)({},action.payload.address))]:[3,6];case 3:return addressObjectRes=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,onboarding_actions.B$)((0,tslib_es6.Cl)((0,tslib_es6.Cl)({},action.payload),{addressObject:addressObjectRes})))];case 4:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,onboarding_actions.Zw)("Onboarding - Filled Sender Address"))];case 5:return _a.sent(),[3,8];case 6:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,onboarding_actions.B$)((0,tslib_es6.Cl)((0,tslib_es6.Cl)({},action.payload),{addressObject})))];case 7:_a.sent(),_a.label=8;case 8:return"store"!==action.payload.orderMechanism?[3,11]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,onboarding_actions.tb)(isOrdersView?"orders":"sender_address","connect_store"))];case 9:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,onboarding_actions.Zw)("Onboarding - Completed Flow",{"Completed Flow Button":"Connect Store"}))];case 10:return _a.sent(),[3,14];case 11:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,onboarding_actions.tb)(isOrdersView?"orders":"sender_address","get_started"))];case 12:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,onboarding_actions.Zw)("Onboarding - Completed Flow",{"Completed Flow Button":"Get Started"}))];case 13:_a.sent(),_a.label=14;case 14:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,onboarding_actions.L8)("api"===getCookie("shippo_signup_cookie")?"/settings/api":""))];case 15:return _a.sent(),[3,19];case 16:return error_8=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(handleError,"orders",error_8)];case 17:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,onboarding_actions.kg)(error_8))];case 18:return _a.sent(),[3,19];case 19:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(onboarding_actions.CT.COMPLETE_ONBOARDING,(function onCompleteOnboarding(action){var connectedStore,ordersState,_a,_b,_c,_d;return(0,tslib_es6.YH)(this,(function(_e){switch(_e.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(onboarding_sagas_updateUserPlan)];case 1:return _e.sent(),[4,selectState(getConnectedStoreName)];case 2:return connectedStore=_e.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(segment.u4,segment.sV.onboarding_completed,{business_type:null!==(_a=localStorage.getItem(onboarding_constants.kB.ONBOARDING_BUSINESS_TYPE))&&void 0!==_a?_a:"",business_need:null!==(_b=localStorage.getItem(onboarding_constants.kB.ONBOARDING_BUSINESS_NEED))&&void 0!==_b?_b:""})];case 3:return _e.sent(),[4,persistOnboardingCompletion()];case 4:return _e.sent(),action.payload.url?[4,safeNavigate(action.payload.url)]:[3,6];case 5:return _e.sent(),[3,12];case 6:return[4,selectState(getOnboardingOrders)];case 7:return"store"!==(ordersState=_e.sent()).orderMechanism||!(null===(_c=ordersState.storeSelection)||void 0===_c?void 0:_c.connectLink)&&!(null===(_d=ordersState.storeSelection)||void 0===_d?void 0:_d.connectRoute)||connectedStore?[3,10]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,onboarding_actions.Zw)("Onboarding - Initial Connected Store",{store:ordersState.storeSelection.name}))];case 8:return _e.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,store_connect_actions.Iu)(ordersState.storeSelection,!1,"onboarding",getStoreConnectParams(ordersState)))];case 9:return _e.sent(),[3,12];case 10:return[4,safeNavigate("/orders")];case 11:_e.sent(),_e.label=12;case 12:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(onboarding_actions.CT.TRACK_STEP_COMPLETED,(function onTrackStepCompleted(action){var businessType,businessNeed,currentStepIndex,currentStepName,lastCompletedStepIndex,lastCompletedStepName,addedStepInformation,storeReferral,storeConnectionStarted,onboardingInfo,onboardingPreferences,packageTemplates,onboardingOrders,onboardingApi,_b,_c,_d;return(0,tslib_es6.YH)(this,(function(_e){switch(_e.label){case 0:return[4,selectState(getOnboardingBusinessType)];case 1:return businessType=_e.sent(),[4,selectState(getOnboardingBusinessNeed)];case 2:return businessNeed=_e.sent(),[4,selectState(getNavigationCurrentStep)];case 3:return currentStepIndex=_e.sent(),[4,selectState(getNavigationCurrentStepName)];case 4:return currentStepName=_e.sent(),[4,selectState(getNavigationLastCompletedStep)];case 5:return lastCompletedStepIndex=_e.sent(),[4,selectState(getNavigationLastCompletedStepName)];case 6:switch(lastCompletedStepName=_e.sent(),addedStepInformation={},storeReferral=null!==(_b=localStorage.getItem("registration_store"))&&void 0!==_b?_b:void 0,storeConnectionStarted="connect_store"===action.payload.action,currentStepName){case"newOnboarding.nav.info":return[3,7];case"newOnboarding.nav.preferences":return[3,9];case"newOnboarding.nav.orders":return[3,12];case"newOnboarding.nav.api":return[3,14]}return[3,16];case 7:return[4,selectState(getOnboardingInfo)];case 8:return onboardingInfo=_e.sent(),addedStepInformation.phone_number=onboardingInfo.phone,addedStepInformation.company_name=onboardingInfo.companyName,addedStepInformation.monthly_shipment_volume=onboardingInfo.monthlyVolume,[3,16];case 9:return[4,selectState(getOnboardingPreferences)];case 10:return onboardingPreferences=_e.sent(),[4,selectState(parcel_template_selectors_getParcelTemplates)];case 11:return packageTemplates=_e.sent(),addedStepInformation.label_size=onboardingPreferences.labelSize,addedStepInformation.added_package_templates=packageTemplates.length>0,addedStepInformation.preferred_carrier=onboardingPreferences.primaryCarrier,addedStepInformation.sender_address=APIAddress.U2(onboardingPreferences.addressObject),[3,16];case 12:return[4,selectState(getOnboardingOrders)];case 13:return onboardingOrders=_e.sent(),addedStepInformation.order_mechanism=onboardingOrders.orderMechanism,addedStepInformation.sender_address=APIAddress.U2(onboardingOrders.addressObject),addedStepInformation.store_platform=null===(_c=onboardingOrders.storeSelection)||void 0===_c?void 0:_c.name,storeConnectionStarted&&(addedStepInformation.store_connection_started=null===(_d=onboardingOrders.storeSelection)||void 0===_d?void 0:_d.name),[3,16];case 14:return[4,selectState(getOnboardingApi)];case 15:return onboardingApi=_e.sent(),addedStepInformation.help_form_submitted=onboardingApi.hasSubmittedHubspotForm,[3,16];case 16:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(segment.u4,segment.sV.onboarding_step_completed,(0,tslib_es6.Cl)((0,tslib_es6.Cl)({view:action.payload.view,action:action.payload.action,business_type:businessType,business_need:businessNeed,current_step_index:currentStepIndex,current_step_name:currentStepName,last_completed_step_index:lastCompletedStepIndex,last_completed_step_name:lastCompletedStepName,store_referral:storeReferral},addedStepInformation),action.payload.override))];case 17:return _e.sent(),[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(onboarding_actions.CT.UPDATE_ONBOARDING_PRO_PLAN,(function updateUserPlanOnboarding(action){var e_1;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,6,,10]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)([localStorage,localStorage.setItem],onboarding_constants.kB.ONBOARDING_PLAN,action.payload.plan)];case 1:return _a.sent(),action.payload.completeOnboarding?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,onboarding_actions.L8)("/orders"))]:[3,3];case 2:return _a.sent(),[3,5];case 3:return[4,navigateForward()];case 4:_a.sent(),_a.label=5;case 5:return[3,10];case 6:return e_1=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(handleError,"pro_plan",e_1)];case 7:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(onboarding_actions.XK(e_1))];case 8:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(updateUserPlanError(e_1.toString()))];case 9:return _a.sent(),[3,10];case 10:return[2]}}))}));function getStoreConnectUrl(store,params){return services_api.C4.request({method:"GET",params,url:"/".concat(store,"/setup"),withCredentials:!0})}var store_connect_reducers=__webpack_require__("./app/pages/StoreConnections/store/store-connect.reducers.ts"),getStoreConnectStore=function(state){return state.storeConnect},getStoreConnectSelection=(0,reselect_es.createSelector)(getStoreConnectStore,(function(storeConnectStore){return storeConnectStore.storeSelection}));(0,reselect_es.createSelector)(getStoreConnectStore,(function(storeConnectStore){return storeConnectStore.loading})),(0,reselect_es.createSelector)(getStoreConnectStore,(function(storeConnectStore){return storeConnectStore.error}));(0,redux_saga_effects_npm_proxy_esm.jP)(store_connect_actions.UK.START_STORE_CONNECT,(function startStoreConnection(action){var _b;return(0,tslib_es6.YH)(this,(function(_c){switch(_c.label){case 0:return function(name){return[Store.F8.Wix,Store.F8.Amazon,Store.F8.Etsy,Store.F8.Walmart].includes(name)}(action.payload.storeSelection.name)?action.payload.readyForUrl?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,store_connect_actions.Vd)((0,tslib_es6.Cl)((0,tslib_es6.Cl)({},action.payload.params),{shippo_location:action.payload.shippoLocation})))]:[3,2]:[3,5];case 1:return _c.sent(),[3,4];case 2:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,store_connect_actions._f)(null!==(_b=action.payload.storeSelection.connectRoute)&&void 0!==_b?_b:"","?shippo_location="+encodeURIComponent(action.payload.shippoLocation)))];case 3:_c.sent(),_c.label=4;case 4:return[3,7];case 5:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,store_connect_actions._f)(action.payload.storeSelection.connectLink,""))];case 6:_c.sent(),_c.label=7;case 7:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(store_connect_actions.UK.STORE_CONNECT_URL_FETCH,(function fetchUrlFromStoreConnect(action){var storeSelection,store,response,error_1,errorCode,errorMsgFunc,_a,_b;return(0,tslib_es6.YH)(this,(function(_c){switch(_c.label){case 0:return[4,selectState(getStoreConnectSelection)];case 1:storeSelection=_c.sent(),store=storeSelection?storeSelection.name:"error",_c.label=2;case 2:return _c.trys.push([2,5,,7]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getStoreConnectUrl,store.toLowerCase(),action.payload.params)];case 3:return response=_c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,store_connect_actions._f)(response.data.redirectUrl,""))];case 4:return _c.sent(),[3,7];case 5:return error_1=_c.sent(),errorCode=null===(_a=error_1.response)||void 0===_a?void 0:_a.data.error,errorMsgFunc=null!==(_b=store_connect_reducers.H[errorCode])&&void 0!==_b?_b:store_connect_reducers.H.CATCH_ALL,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,store_connect_actions.jW)(errorMsgFunc(store)))];case 6:return _c.sent(),[3,7];case 7:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(store_connect_actions.UK.STORE_CONNECT_URL_FETCH_ERROR,(function storeConnectRedirectError(){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return window.location.pathname.match("^/onboarding")?[4,safeNavigate("/orders")]:[3,2];case 1:_a.sent(),_a.label=2;case 2:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(store_connect_actions.UK.STORE_CONNECT_URL_FETCH_SUCCESS,(function storeConnectRedirectSuccess(action){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return 0!==action.payload.redirectUrl.indexOf("/")?[3,2]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,actions.VC)({pathname:action.payload.redirectUrl,search:action.payload.queryString}))];case 1:return _a.sent(),[3,3];case 2:window.location.href=action.payload.redirectUrl,_a.label=3;case 3:return[2]}}))}));var js_cookie=__webpack_require__("./node_modules/js-cookie/src/js.cookie.js"),cookies=js_cookie.withConverter({write:function(value){return'"'.concat(value,'"')}});(0,redux_saga_effects_npm_proxy_esm.jP)(constants.t.SET_AB_COOKIE,(function setABCookie(action){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,3]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(cookies.set,action.payload.name,action.payload.content,{domain:".shippodev.com"})];case 1:return _a.sent(),[3,3];case 2:return _a.sent(),[3,3];case 3:return[2]}}))}));function getAuthorizedApps(){return services_api.Ay.request({url:"/ui/oauth/authorized_client_apps",method:"GET"})}function deleteAuthorizedApps(id){return services_api.Ay.request({url:"/ui/oauth/authorized_client_apps/".concat(id),method:"DELETE"})}var humps=__webpack_require__("./app/utils/humps.ts");(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.FETCH_APPS,(function apps_saga_getAuthorizedApps(action){var response,err_1;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,3]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getAuthorizedApps)];case 1:return response=_a.sent(),action.callback((0,humps.b)(response.data)),[3,3];case 2:return err_1=_a.sent(),action.callback({err:err_1}),[3,3];case 3:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.DELETE_APP,(function apps_saga_deleteAuthorizedApps(action){var response,err_2;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,3]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(deleteAuthorizedApps,action.id)];case 1:return response=_a.sent(),action.callback((0,humps.b)(response.data)),[3,3];case 2:return err_2=_a.sent(),action.callback({err:err_2}),[3,3];case 3:return[2]}}))}));var auth_actions=__webpack_require__("./app/actions/auth.actions.ts"),QS_LOCAL_STORAGE_KEY="saved_qs",ADDITIONAL_INFORMATION_GTM_RESULTS="questionnaire_gtm_results",EmbeddableAuth=__webpack_require__("./app/pages/common/EmbeddableAuth/index.ts"),auth_selectors=__webpack_require__("./app/selectors/auth.selectors.ts");function register(payload){return services_api.Sg.request({url:"register/",method:"POST",headers:{},data:payload})}function resetPassword(payload){return services_api.Sg.request({url:"resetPassword/",method:"POST",headers:{},data:payload})}function resendVerification(){return services_api.YZ.request({url:"/verify/resend/",method:"GET"})}function sendQuestionnaire(payload,temporatyToken){return services_api.YZ.request({url:"setting/registration-info",method:"POST",headers:{Authorization:"JWT ".concat(temporatyToken)},data:payload})}function RegisterUser_toJSON(registerUser){var _a,_b,marketing={};registerUser.marketing&&(marketing={source:registerUser.marketing.source,campaign:registerUser.marketing.campaign,campaign_term:registerUser.marketing.campaignTerm,campaign_content:registerUser.marketing.campaignContent,medium:registerUser.marketing.medium,reg_method:registerUser.marketing.regMethod,attribution_snippet:registerUser.marketing.attributionSnippet,sh_device:registerUser.marketing.shDevice,sh_matchtype:registerUser.marketing.shMatchtype,sh_ad1:registerUser.marketing.shAd1,sh_ad2:registerUser.marketing.shAd2,sh_ad3:registerUser.marketing.shAd3,sh_ad4:registerUser.marketing.shAd4,usps_referral_key:registerUser.marketing.uspsReferralKey,http_referrer:registerUser.marketing.httpReferrer,raw_http_referrer:registerUser.marketing.rawHttpReferrer,raw_query_string:registerUser.marketing.rawQueryString});var userTracking={};registerUser.userTracking&&(userTracking={tracker_sessionid:registerUser.userTracking.tracker_sessionid});var context={};return registerUser.context&&(context={locale:registerUser.context.locale,lang:registerUser.context.lang,plan:registerUser.context.plan,tier:registerUser.context.tier,cycle:registerUser.context.cycle,next:registerUser.context.next,fixed_fee_waived_until:registerUser.context.fixedFeeWaivedUntil,feature_test_variant_name:registerUser.context.featureTestVariantName,pricing_test_variant:registerUser.context.pricingTestVariant}),{user:{first_name:registerUser.user.firstName,last_name:registerUser.user.lastName,company:registerUser.user.companyName,email:registerUser.user.email,password:registerUser.user.password,phone:registerUser.user.phone,terms:{shippo:null===(_a=registerUser.user.terms)||void 0===_a?void 0:_a.shippo,ups_technology:null===(_b=registerUser.user.terms)||void 0===_b?void 0:_b.upsTechnology},g_recaptcha_response:registerUser.user.gRecaptchaResponse},marketing:(0,tslib_es6.Cl)({},marketing),context:(0,tslib_es6.Cl)({},context),user_tracking:(0,tslib_es6.Cl)({},userTracking)}}var local_storage=__webpack_require__("./app/utils/local-storage.ts"),COOKIE_NAME="shippoUTM",COOKIE_EXPIRES_IN_DAYS=60,SUBDOMAIN_WHITELIST=["lets","get","track"];function setCookie(cookie,value,expires){var parsedCurrentURL=parseURL(window.location.href);void 0===expires&&(expires=new Date).setDate(expires.getDate()+COOKIE_EXPIRES_IN_DAYS);var cookieString=cookie+"="+value+"; domain="+parsedCurrentURL.domain+".com; path=/; expires="+expires.toUTCString();document.cookie=cookieString}function parseURL(url){var hostname="",parsedURL={};if(function isURLSupported(){try{var u=new __webpack_require__.g.URL("b","http://a");return u.pathname="c d","http://a/c%20d"===u.href&&u.searchParams}catch(e){return!1}}()){hostname=new URL(url).hostname}else{var a=document.createElement("a");a.href=url,hostname=a.hostname}var splitHostname=hostname.replace("www.","").split(".");return 3===splitHostname.length?(parsedURL.subdomain=splitHostname[0],parsedURL.domain=splitHostname[1]):(parsedURL.subdomain=null,parsedURL.domain=splitHostname[0]),parsedURL}function isOffDomain(domain){return domain!==parseURL(window.location.href).domain}function setAttributionCookie(){var results=function getUpdatedSourceAttributionObject(queryString,storedValues){var utmParameters=["utm_source","utm_medium","utm_campaign","utm_content","utm_term","sh_device","sh_matchtype"],newValues={},wasUpdated=!1,queryStringkeys=Object.keys(queryString);if(queryStringkeys.length>0){var URLHasUTMParameters=function arrayIntersects(firstArray,secondArray){return secondArray.some((function(v){return firstArray.indexOf(v)>=0}))}(queryStringkeys,utmParameters),referrerCode=function getReferrerCodeFromQS(QS){return QS.rsCode||QS.gclid||QS.msclkid||QS.sh_cl||null}(queryString);wasUpdated=!0,URLHasUTMParameters?utmParameters.forEach((function(tag){queryString[tag]&&(newValues[tag]=queryString[tag])})):utmParameters.forEach((function(tag){storedValues[tag]&&(newValues[tag]=storedValues[tag])})),["sh_ad1","sh_ad2","sh_ad3","sh_ad4"].forEach((function(tag){(queryString[tag]||storedValues[tag])&&(newValues[tag]=queryString[tag]||storedValues[tag])})),referrerCode?newValues.attribution_snippet=referrerCode:storedValues.attribution_snippet&&(newValues.attribution_snippet=storedValues.attribution_snippet)}else newValues=storedValues;if(storedValues.http_referrer)newValues.http_referrer=storedValues.http_referrer;else{var referrerURL=document.referrer;if(referrerURL){var parsedReferrerURL=parseURL(referrerURL);(isOffDomain(parsedReferrerURL.domain)||!isOffDomain(parsedReferrerURL.domain)&&SUBDOMAIN_WHITELIST.indexOf(parsedReferrerURL.subdomain)>-1)&&(newValues.http_referrer=referrerURL,wasUpdated=!0)}}return{newValues,wasUpdated}}(function getQueryString(){var keyValuePairs=window.location.search.slice(1).split("&"),queryString={};return keyValuePairs.forEach((function(pair){(pair=pair.split("=")).length&&2===pair.length&&(queryString[pair[0]]=decodeURIComponent(pair[1]||""))})),queryString}(),function marketing_source_attribution_getCookie(cookieName){var name=cookieName+"=",cookieArray=document.cookie.split(";"),cookieString=null;if(cookieArray.forEach((function(cookie){(cookie=cookie.replace(/^\s+|\s+$/g,"")).indexOf(name)>-1&&(cookieString=cookie.substring(name.length,cookie.length))})),null!==cookieString)try{return JSON.parse(decodeURIComponent(cookieString))}catch(e){return{}}return{}}(COOKIE_NAME));results.wasUpdated&&setCookie(COOKIE_NAME,encodeURIComponent(JSON.stringify(results.newValues)))}setAttributionCookie();__webpack_require__("./node_modules/querystring/index.js");function extractMarketingPayloadFromCookie(cookie){return{source:cookie.utm_source||"",campaign:cookie.utm_campaign||"",campaignTerm:cookie.utm_term||"",campaignContent:cookie.utm_content||"",medium:cookie.utm_medium||"",attributionSnippet:cookie.attribution_snippet||"",shDevice:cookie.sh_device||"",shMatchtype:cookie.sh_matchtype||"",shAd1:cookie.sh_ad1||"",shAd2:cookie.sh_ad2||"",shAd3:cookie.sh_ad3||"",shAd4:cookie.sh_ad4||"",httpReferrer:cookie.http_referrer||"",rawHttpReferrer:document.referrer,rawQueryString:document.location?document.location.search:void 0}}function withDefaultValue(value,defaultValue){return value&&""!==value?value:defaultValue}function marketoSubmit(user,marketingPayload){if(window.MktoForms2){var mktoForm=window.MktoForms2.getForm(1194);if(mktoForm){var email=user.email,firstName=user.firstName,lastName=user.lastName,campaign=withDefaultValue(marketingPayload.campaign,"none"),medium=withDefaultValue(marketingPayload.medium,"none"),source=withDefaultValue(marketingPayload.source,"none"),campaignTerm=withDefaultValue(marketingPayload.campaignTerm,"none");return mktoForm.addHiddenFields({Email:email,FirstName:firstName,LastName:lastName,utm_campaign:campaign,utm_content:"shippo_sign_up",utm_medium:medium,utm_source:source,utm_term:campaignTerm,ft_utm_campaign:campaign,fTutmcontent:"shippo_sign_up",ft_utm_medium:medium,ft_utm_source:source,fTutmterm:campaignTerm,eNV:"production"}),new Promise((function(resolve){var timeoutId=setTimeout(resolve,1e3);mktoForm.onSuccess((function(){clearTimeout(timeoutId),resolve()})).submit()}))}}}(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.REGISTER,(function auth_saga_register(action){var UTMCookies,QS,pricePlan,marketingPayload,embeddableUser,trackerSessionId,trackingPayload,newPayload,response,hasAuthenticatedBefore,err_1,nextUrl,absolute,hasPurchasedLabel,properties,err_2,error,errorMap,_a,_b,_c,_d;return(0,tslib_es6.YH)(this,(function(_e){switch(_e.label){case 0:return _e.trys.push([0,20,,25]),(UTMCookies=js_cookie.getJSON("shippoUTM"))||(setAttributionCookie(),UTMCookies=js_cookie.getJSON("shippoUTM")),UTMCookies=UTMCookies||{},[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(getParsedQS)];case 1:return QS=_e.sent(),pricePlan=function getStartingPricePlan(QS){var pricePlan={};return["plan","tier","cycle","variant"].forEach((function(tag){var qsValue=QS[tag];qsValue&&("variant"===tag?pricePlan.pricingTestVariant=qsValue:pricePlan[tag]=qsValue)})),pricePlan}(QS),marketingPayload=extractMarketingPayloadFromCookie(UTMCookies),embeddableUser=(0,EmbeddableAuth.jY)(),trackerSessionId=js_cookie.get("tracker_sessionid")||"",trackingPayload={tracker_sessionid:trackerSessionId},newPayload=(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},action.payload),{marketing:(0,tslib_es6.Cl)((0,tslib_es6.Cl)({regMethod:embeddableUser?"embeddable":"web-responsive-3",uspsReferralKey:QS.usps_referral_key||""},action.payload.marketing),marketingPayload),userTracking:(0,tslib_es6.Cl)({},trackingPayload),context:(0,tslib_es6.Cl)((0,tslib_es6.Cl)({locale:(0,locale.JK)(),lang:QS.lang,next:QS.next||"",fixedFeeWaivedUntil:QS.fixed_fee_waived_until},action.payload.context),pricePlan)}),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(register,RegisterUser_toJSON(newPayload))];case 2:return response=_e.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(js_cookie.set,"jwt",response.data.jwt,{domain:".shippodev.com"})];case 3:return _e.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(js_cookie.set,"is_logged_in","true",{domain:".shippodev.com"})];case 4:return _e.sent(),hasAuthenticatedBefore=!!getCookie("copy"),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(js_cookie.set,"copy",response.data.jwt,{domain:".shippodev.com"})];case 5:_e.sent(),_e.label=6;case 6:return _e.trys.push([6,9,,10]),function preventMarketoTracking(_a){return _a.user,!0}(action.payload)?[3,8]:[4,(0,redux_saga_effects_npm_proxy_esm.T1)(marketoSubmit,action.payload.user,marketingPayload)];case 7:_e.sent(),_e.label=8;case 8:return[3,10];case 9:return err_1=_e.sent(),esm_exports.wd("Marketo form submit failed",{level:"warning",extra:{error:err_1}}),[3,10];case 10:return nextUrl=void 0,!action.next||newPayload.context&&"professional"===newPayload.context.plan?nextUrl="/user/":(absolute=new RegExp(/^https?:\/\//i),nextUrl=absolute.test(action.next)?action.next:"https://dev-qa.shippodev.com"+action.next),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(auth_actions.Jj(response.data.session_token,nextUrl))];case 11:return _e.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(js_cookie.set,USER_REGISTER_SUCCESS_COOKIE_NAME,"true",{domain:".shippodev.com"})];case 12:return _e.sent(),embeddableUser?[3,14]:[4,(0,redux_saga_effects_npm_proxy_esm.T1)(local_storage.r,onboarding_constants.kB.ONBOARDING_COMPLETED,"false")];case 13:_e.sent(),_e.label=14;case 14:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(auth_actions.BP())];case 15:return _e.sent(),hasPurchasedLabel="true"===getCookie("customer"),properties={"Visit Type":"Registration","User Type":hasPurchasedLabel?"Sketchy Bad Agent?":hasAuthenticatedBefore?"Return Visitor":"First Time Visitor"},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.R)(properties))];case 16:return _e.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("Account Created"))];case 17:return _e.sent(),(null===(_b=null===(_a=action.payload)||void 0===_a?void 0:_a.context)||void 0===_b?void 0:_b.isOnboarding2024)?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,onboarding_actions.r1)({monthlyVolume:action.payload.context.monthlyShippingVolume||""},response.data.jwt))]:[3,19];case 18:_e.sent(),_e.label=19;case 19:return[3,25];case 20:return(err_2=_e.sent())?[4,(0,redux_saga_effects_npm_proxy_esm.T1)(onboarding.CR,!1)]:[3,24];case 21:return _e.sent(),error=null===(_c=null==err_2?void 0:err_2.response)||void 0===_c?void 0:_c.data,errorMap={firstName:null==error?void 0:error.first_name,lastName:null==error?void 0:error.last_name,email:null==error?void 0:error.email,password:null==error?void 0:error.password,errorMessage:error.error||err_2.toJSON&&(null===(_d=err_2.toJSON())||void 0===_d?void 0:_d.message)},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(auth_actions.MA(errorMap))];case 22:return _e.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.lM)("join",errorMap))];case 23:_e.sent(),_e.label=24;case 24:return[3,25];case 25:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.RESET_PASSWORD,(function auth_saga_resetPassword(action){var err_3,error,errorMap;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,7]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(resetPassword,action.payload)];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(auth_actions.g9())];case 2:return _a.sent(),[3,7];case 3:return(err_3=_a.sent())?(error=err_3.response.data,errorMap={email:error.email,errorMessage:error.error},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(auth_actions.vl(errorMap))]):[3,6];case 4:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.lM)("resetPassword",errorMap))];case 5:_a.sent(),_a.label=6;case 6:return[3,7];case 7:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.RESEND_VERIFICATION,(function auth_saga_resendVerification(action){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,5,,8]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(resendVerification)];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(auth_actions.oT())];case 2:return _a.sent(),action.payload.withRedirect?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,actions.VC)({pathname:"/resend_verification/success"}))]:[3,4];case 3:_a.sent(),_a.label=4;case 4:return[3,8];case 5:return _a.sent()?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(auth_actions.jb({errorMessage:"Unable to process your request. Please try again later."}))]:[3,7];case 6:_a.sent(),_a.label=7;case 7:return[3,8];case 8:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.SEND_REGISTER_QUESTIONNAIRE,(function sendRegisterQuestionnare(action){var payload,temporaryToken,GTMAdditionalInformation;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,6,,9]),payload={company_name:action.payload.companyURL||null,phone:action.payload.phoneNumber||null,monthly_packages:action.payload.packages?action.payload.packages.value:null,primary_carrier:action.payload.primaryCarrier||null,primary_ecommerce_channel:action.payload.primaryECommerce||null,is_unsupported_store:!(0,Store.AI)(action.payload.primaryECommerce||"")},[4,selectState(auth_selectors.Z)];case 1:return temporaryToken=_a.sent(),GTMAdditionalInformation=function formatGTMAdditionalInformation(volumeSegment,primaryCarrier){var _a=(0,tslib_es6.zs)(function getVolumeMinAndMax(volumeSegment){return volumeSegment.replace(/\s/g,"").split("-")}(volumeSegment||""),2);return{primaryCarrier,volumeSegment,volumeSegmentMin:_a[0],volumeSegmentMax:_a[1]}}(action.payload.packages?action.payload.packages.value.toString():void 0,action.payload.primaryCarrier),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(sendQuestionnaire,payload,temporaryToken)];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(js_cookie.set,ADDITIONAL_INFORMATION_GTM_RESULTS,GTMAdditionalInformation,{domain:".shippodev.com"})];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(auth_actions.ux())];case 4:case 7:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(auth_actions.BP())];case 5:case 8:return _a.sent(),[3,9];case 6:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(auth_actions.Zd())];case 9:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.REGISTER_ERROR,(function clearRegisterError(){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.cb)(2e3)];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(auth_actions.I0())];case 2:return _a.sent(),[2]}}))}));function fetchBusinessRules(){return{type:constants.t.FETCH_BUSINESS_RULES}}function fetchBusinessRulesSuccess(payload){return{payload,type:constants.t.FETCH_BUSINESS_RULES_SUCCESS}}function fetchBusinessRulesError(payload){return{payload,type:constants.t.FETCH_BUSINESS_RULES_ERROR}}function setRuleError(error){return{type:constants.t.AUTOMATIONS_SET_RULE_ERROR,payload:{error}}}function reorderRulesSuccess(rules){return{type:constants.t.AUTOMATIONS_REORDER_RULES_SUCCESS,payload:{rules}}}function startRuleReprocessStatusPolling(){return{type:constants.t.AUTOMATIONS_REPROCESS_RULES_POLL_START}}function stopRuleReprocessStatusPolling(){return{type:constants.t.AUTOMATIONS_REPROCESS_RULES_POLL_END}}function updateRuleReprocessStatus(status){return{type:constants.t.AUTOMATIONS_UPDATE_REPROCESS_STATUS,payload:{status}}}var rules=__webpack_require__("./app/constants/rules.ts");function getAllServiceLevels(){return services_api.Ay.request({url:"/api_account/service_levels",method:"GET",params:{use_database:!0}})}function providers_saga_fetchServiceLevelsByAccount(){var response,accounts,_a,_b;return(0,tslib_es6.YH)(this,(function(_c){switch(_c.label){case 0:return _c.trys.push([0,4,,6]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getAllServiceLevels)];case 1:return response=_c.sent(),accounts=function ProviderAccount_fromJSON(jsonProviderAccounts){return jsonProviderAccounts.sort((function(a,b){return(null==a?void 0:a.provider_name)&&(null==b?void 0:b.provider_name)?a.provider_name.localeCompare(b.provider_name):0})).map((function(jsonProviderAccount){var e_1,_a,serviceLevelsByToken={};try{for(var _b=(0,tslib_es6.Ju)(jsonProviderAccount.service_levels),_c=_b.next();!_c.done;_c=_b.next()){var serviceLevel=_c.value;serviceLevelsByToken[serviceLevel.token]=serviceLevel}}catch(e_1_1){e_1={error:e_1_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_1)throw e_1.error}}var allServiceLevels=jsonProviderAccount.service_levels.sort((function(a,b){return(null==a?void 0:a.name)&&(null==b?void 0:b.name)?a.name.localeCompare(b.name):0})).map((function(serviceLevel){return(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},serviceLevel),{provider_name:jsonProviderAccount.provider_name,provider_image_75:jsonProviderAccount.provider_image_75,provider_image_200:jsonProviderAccount.provider_image_200})})),serviceLevels=allServiceLevels.filter((function(serviceLevel){return!(null==serviceLevel?void 0:serviceLevel.parent_servicelevel)})),visibleServiceLevels=serviceLevels.filter((function(serviceLevel){return!(null==serviceLevel?void 0:serviceLevel.is_hidden)}));return{providerName:jsonProviderAccount.provider_name,providerToken:jsonProviderAccount.provider_token,objectId:jsonProviderAccount.object_id,isShippoAccount:jsonProviderAccount.is_shippo_account,isTest:jsonProviderAccount.is_test,nickname:jsonProviderAccount.nickname,providerImage75:jsonProviderAccount.provider_image_75,providerImage200:jsonProviderAccount.provider_image_200,isManifestable:jsonProviderAccount.is_manifestable,serviceLevels,visibleServiceLevels,allServiceLevels,serviceLevelsByToken}}))}(null!==(_b=null===(_a=response.data)||void 0===_a?void 0:_a.results)&&void 0!==_b?_b:[]),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((providerAccounts=accounts,{type:constants.t.FETCH_SERVICE_LEVELS_BY_ACCOUNT_SUCCESS,payload:{providerAccounts}}))];case 2:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.RETRY_AUTO_SELECT_RATES})];case 3:case 5:return _c.sent(),[3,6];case 4:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((errorMessage="settings:automations:serviceLevelRetrievalError",{type:constants.t.FETCH_SERVICE_LEVELS_BY_ACCOUNT_ERROR,payload:{errorMessage}}))];case 6:return[2]}var errorMessage,providerAccounts}))}(0,redux_saga_effects_npm_proxy_esm.jP)(constants.t.FETCH_SERVICE_LEVELS_BY_ACCOUNT,providers_saga_fetchServiceLevelsByAccount);function getBusinessRules(){return services_api.YZ.request({url:"setting/rules/",method:"GET"})}function automations_service_deleteRule(ruleId){return services_api.YZ.request({method:"DELETE",url:"setting/rules/".concat(ruleId,"/")})}function updateRule(payload){return services_api.YZ.request({method:"PUT",url:"setting/rules/",data:payload})}function automations_service_createRule(payload){return services_api.YZ.request({method:"POST",url:"setting/rules/",data:payload})}function automations_service_reorderRules(payload){return services_api.YZ.request({method:"PUT",url:"setting/rules/reorder/",data:payload})}function automations_service_reprocessRules(){return services_api.YZ.request({method:"POST",url:"setting/rules/reprocess/"})}function automations_service_getRuleReprocessStatus(){return services_api.YZ.request({method:"GET",url:"setting/rules/reprocess/"})}__webpack_require__("./app/constants/automationRuleForm.ts");function filterGroupToJSON(filterGroup){return{filter_criteria:filterCriteriaToJSON(filterGroup.filterCriteria)}}function filterCriteriaToJSON(filterCriteria){return filterCriteria.map((function(filterCriterion){return filterCriterion.operator?function filterClauseToJSON(filterClause){var operator=filterClause.operator,filterCriteria=filterClause.filterCriteria;return{operator,filter_criteria:filterCriteriaToJSON(filterCriteria)}}(filterCriterion):filterCriterion}))}var AutomationRuleError=__webpack_require__("./app/types/AutomationRuleError.ts");var worker=null;function ruleReprocessStatusWorker(){var result,status_2,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:0,_b.label=1;case 1:return _b.trys.push([1,10,,13]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(automations_service_getRuleReprocessStatus)];case 2:return result=_b.sent(),status_2=null===(_a=null==result?void 0:result.data)||void 0===_a?void 0:_a.status,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(updateRuleReprocessStatus(status_2||""))];case 3:return _b.sent(),status_2?[3,5]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stopRuleReprocessStatusPolling())];case 4:return _b.sent(),[3,9];case 5:return(0,businessRules.Sx)(status_2)?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stopRuleReprocessStatusPolling())]:[3,7];case 6:return _b.sent(),[3,9];case 7:return[4,(0,redux_saga_effects_npm_proxy_esm.cb)(rules.pr)];case 8:_b.sent(),_b.label=9;case 9:return[3,13];case 10:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(updateRuleReprocessStatus(rules.ri.error))];case 11:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stopRuleReprocessStatusPolling())];case 12:return _b.sent(),[3,13];case 13:return[3,0];case 14:return[2]}}))}function ruleReprocessStatusPollRace(){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.O4)({task:(0,redux_saga_effects_npm_proxy_esm.T1)(ruleReprocessStatusWorker),cancel:(0,redux_saga_effects_npm_proxy_esm.s)([constants.t.AUTOMATIONS_REPROCESS_RULES_POLL_END]),timeout:(0,redux_saga_effects_npm_proxy_esm.cb)(rules.Bz,!0)})];case 1:return _a.sent().timeout?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(updateRuleReprocessStatus(rules.ri.error))]:[3,4];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stopRuleReprocessStatusPolling())];case 3:_a.sent(),_a.label=4;case 4:return worker=null,[2]}}))}(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.FETCH_BUSINESS_RULES,(function automations_sagas_fetchBusinessRules(){var getResponse,err_1,payload;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getBusinessRules)];case 1:return getResponse=_a.sent(),payload=(0,businessRules.rJ)(getResponse.data),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchBusinessRulesSuccess(payload))];case 2:case 4:return _a.sent(),[3,5];case 3:return err_1=_a.sent(),payload={errorMessage:err_1.message},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchBusinessRulesError(payload))];case 5:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.AUTOMATIONS_DELETE_RULE,(function deleteBusinessRule(action){var err_4;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,4,,6]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(automations_service_deleteRule,action.payload.ruleId)];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.AUTOMATIONS_DELETE_RULE_SUCCESS})];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchBusinessRules())];case 3:case 5:return _a.sent(),[3,6];case 4:return err_4=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((errorMessage=err_4.message,{type:constants.t.AUTOMATIONS_DELETE_RULE_ERROR,payload:{errorMessage}}))];case 6:return[2]}var errorMessage}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.AUTOMATIONS_CREATE_RULE,(function createBusinessRule(action){var payload,err_5,response,error;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,13,,18]),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.De)(constants_form.XP))];case 1:return _a.sent(),(payload=function AutomationRule_toJSON(rule){if(!rule)return null;var description=rule.description,filterGroup=rule.filterGroup,name=rule.name,objectId=rule.objectId,parcelTemplateId=rule.parcelTemplateId,ruleType=rule.ruleType,serviceLevelToken=rule.serviceLevelToken,accountObjectId=rule.accountObjectId,senderAddressId=rule.senderAddressId;return{name,description:description||null,parcel_template_object_id:parcelTemplateId,object_id:objectId||null,rule_type:ruleType,filter_group:filterGroupToJSON(filterGroup),service_level_token:serviceLevelToken||null,account_object_id:accountObjectId||null,sender_address_id:senderAddressId||null}}(action.payload.ruleFormData))&&payload.object_id?[4,(0,redux_saga_effects_npm_proxy_esm.T1)(updateRule,payload)]:[3,3];case 2:return _a.sent(),[3,5];case 3:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(automations_service_createRule,payload)];case 4:_a.sent(),_a.label=5;case 5:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.lM)(constants_form.XP))];case 6:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.AUTOMATIONS_CREATE_RULE_SUCCESS})];case 7:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.Wv)(constants_form.XP))];case 8:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.AUTOMATIONS_CLOSE_ADD_RULE_MODAL})];case 9:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(setRuleError(AutomationRuleError.U))];case 10:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(providers_saga_fetchServiceLevelsByAccount)];case 11:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchBusinessRules())];case 12:return _a.sent(),[3,18];case 13:return err_5=_a.sent(),(response=err_5.response)?(error=AutomationRuleError.r(response),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(setRuleError(error))]):[3,17];case 14:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.lM)(constants_form.XP))];case 15:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.uj)(constants_form.XP))];case 16:_a.sent(),_a.label=17;case 17:return[3,18];case 18:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.AUTOMATIONS_REORDER_RULES,(function automations_sagas_reorderRules(action){var payload,err_6;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),payload={rules:(0,businessRules._h)(action.payload.rules)},[4,(0,redux_saga_effects_npm_proxy_esm.T1)(automations_service_reorderRules,payload)];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(reorderRulesSuccess(action.payload.rules))];case 2:case 4:return _a.sent(),[3,5];case 3:return err_6=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((errorMessage=err_6.message,{type:constants.t.AUTOMATIONS_REORDER_RULES_ERROR,payload:{errorMessage}}))];case 5:return[2]}var errorMessage}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.AUTOMATIONS_REPROCESS_RULES,(function startRuleReprocessing(){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,5,,6]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(automations_service_reprocessRules)];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.AUTOMATIONS_RESET_RULE_REPROCESS_PENDING_NOTIF})];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.AUTOMATIONS_RESET_RULE_REPROCESS_COMPLETE_NOTIF})];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(startRuleReprocessStatusPolling())];case 4:return _a.sent(),[3,6];case 5:return _a.sent(),[3,6];case 6:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.AUTOMATIONS_GET_REPROCESS_STATUS,(function getRuleReprocessingStatus(){var result,status_1,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return _b.trys.push([0,4,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(automations_service_getRuleReprocessStatus)];case 1:return result=_b.sent(),status_1=null===(_a=null==result?void 0:result.data)||void 0===_a?void 0:_a.status,(0,businessRules.Sx)(status_1)?[3,3]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(startRuleReprocessStatusPolling())];case 2:_b.sent(),_b.label=3;case 3:return[3,5];case 4:return _b.sent(),[3,5];case 5:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.AUTOMATIONS_UPDATE_REPROCESS_STATUS,(function autoCloseRuleReprocessingCompleteNotification(action){var newStatus;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,4,,5]),newStatus=action.payload.status,(0,businessRules.Sx)(newStatus)?[4,(0,redux_saga_effects_npm_proxy_esm.cb)(6e3)]:[3,3];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.AUTOMATIONS_CLOSE_RULE_REPROCESS_COMPLETE_NOTIF})];case 2:_a.sent(),_a.label=3;case 3:return[3,5];case 4:return _a.sent(),[3,5];case 5:return[2]}}))})),function ruleReprocessStatusPollWatcher(){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.s)([constants.t.AUTOMATIONS_REPROCESS_RULES_POLL_START])];case 1:return _a.sent(),worker?[3,3]:[4,(0,redux_saga_effects_npm_proxy_esm.Zy)(ruleReprocessStatusPollRace)];case 2:worker=_a.sent(),_a.label=3;case 3:return[3,0];case 4:return[2]}}))}();function fetchPaymentMethodsSuccess(payload){return{payload,type:constants.t.FETCH_PAYMENT_METHODS_SUCCESS}}function setPaymentProcessingError(paymentProcessingErrorMessage){return{type:constants.t.BILLING_SET_PAYMENT_PROCESSING_ERROR,paymentProcessingError:paymentProcessingErrorMessage}}var PaymentMethodType,getBillingStore=function(state){return state.billing},showCreditCardModal=(0,reselect_es.createSelector)(getBillingStore,(function(billingStore){return billingStore.showCreditCardModal})),billing_selectors_getPaymentMethods=((0,reselect_es.createSelector)(getBillingStore,(function(billingStore){return billingStore.isLoadingPaymentMethods})),(0,reselect_es.createSelector)(getBillingStore,(function(billingStore){return billingStore.paymentMethods}))),getNewPaymentType=((0,reselect_es.createSelector)(getBillingStore,(function(billingStore){return billingStore.paymentMethods.billingFrequency})),(0,reselect_es.createSelector)(getBillingStore,(function(billingStore){return billingStore.paymentMethods.paymentThreshold})),(0,reselect_es.createSelector)(getBillingStore,(function(billingStore){return billingStore.showChangePaymentModal})),(0,reselect_es.createSelector)(getBillingStore,(function(billingStore){return billingStore.newPaymentType})));(0,reselect_es.createSelector)(getBillingStore,(function(billingStore){return billingStore.ccUpdatedNotification})),(0,reselect_es.createSelector)(getBillingStore,(function(billingStore){return billingStore.changePaymentNotificationSuccess})),(0,reselect_es.createSelector)(getBillingStore,(function(billingStore){return billingStore.changePaymentNotificationError})),(0,reselect_es.createSelector)(getBillingStore,(function(billingStore){return billingStore.paymentProcessingError}));function apiFetchPaymentMethods(){return services_api.Ay.request({url:"v1/billing/",method:"GET"})}function apiChangePaymentMethod(payload){return services_api.Ay.request({url:"v1/billing/",method:"POST",data:payload})}!function(PaymentMethodType){PaymentMethodType.BankAccount="ACH",PaymentMethodType.CreditCard="STRIPE"}(PaymentMethodType||(PaymentMethodType={}));var PaymentMethods_fromJSON=function(data){return{achAccountNumberLast4:data.ach_account_number,achAuthorized:data.ach_authorized,blockedBilling:data.blocked_billing,billingFrequency:data.billing_frequency,paymentCurrency:data.payment_currency,paymentThreshold:data.payment_threshold,paymentType:data.payment_type,stripeAchSet:data.stripe_ach_set,stripeAuthorized:data.stripe_authorized,stripeCcBrand:data.stripe_cc_brand,stripeCcExpMonth:data.stripe_cc_exp_month,stripeCcExpYear:data.stripe_cc_exp_year,stripeCcLast4:data.stripe_cc_last4,stripeCreditCardSet:data.stripe_credit_card_set,stripePublishableKey:data.stripe_publishable_key,stripeToken:data.stripe_token}};(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.USER_FETCH_SUCCESS,(function billingCloseCreditCardModal(){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,selectState(showCreditCardModal)];case 1:return _a.sent()?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.BILLING_CC_UPDATED_NOTIFICATION_SUCCESS})]:[3,3];case 2:_a.sent(),_a.label=3;case 3:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.BILLING_CLOSE_CREDIT_CARD_MODAL})];case 4:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.FETCH_PAYMENT_METHODS})];case 5:return _a.sent(),[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.FETCH_PAYMENT_METHODS,(function billing_saga_fetchPaymentMethods(){var response;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(apiFetchPaymentMethods)];case 1:return response=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchPaymentMethodsSuccess(PaymentMethods_fromJSON(response.data)))];case 2:case 4:return _a.sent(),[3,5];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.FETCH_PAYMENT_METHODS_ERROR})];case 5:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.PAYMENT_METHOD_CHANGE,(function billing_saga_changePaymentMethod(){var trackerSessionId,isImpersonatingCookie,newPaymentType,payload,response;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,6,,9]),trackerSessionId=getCookie("tracker_sessionid")||"",isImpersonatingCookie=getCookie("is_impersonate")||"",[4,selectState(getNewPaymentType)];case 1:return newPaymentType=_a.sent(),payload={action:{type:"payment_method_change",payment_method:{type:newPaymentType},is_impersonate:"true"===isImpersonatingCookie,tracker_sessionid:trackerSessionId}},[4,(0,redux_saga_effects_npm_proxy_esm.T1)(apiChangePaymentMethod,payload)];case 2:return response=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchPaymentMethodsSuccess(PaymentMethods_fromJSON(response.data)))];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.PAYMENT_METHOD_CHANGE_SUCCESS})];case 4:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.BILLING_CHANGE_PAYMENT_NOTIFICATION_SUCCESS})];case 5:case 8:return _a.sent(),[3,9];case 6:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.PAYMENT_METHOD_CHANGE_ERROR})];case 7:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.BILLING_CHANGE_PAYMENT_NOTIFICATION_ERROR})];case 9:return[2]}}))}));var keyBy=__webpack_require__("./node_modules/lodash-es/keyBy.js");(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.FETCH_CARRIER_ACCOUNTS,(function carrier_accounts_saga_fetchCarrierAccounts(payload){var response,carrierAccountsResponse,accountCarriers,carrierProvidersResponse,carriersExtraFields,carriersMap_1,carrierAccounts,parsedCarrierAccounts,err_1;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,4,,6]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(carrier_accounts_service_getCarrierAccounts,payload.payload)];case 1:return response=_a.sent(),carrierAccountsResponse=response.data.results.map(CarrierAccount.rS),accountCarriers=carrierAccountsResponse.filter((function(account){return!!account.carrier})).map((function(account){var _a;return null===(_a=account.carrier)||void 0===_a?void 0:_a.providerToken})),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getCarrierProviders,accountCarriers)];case 2:return carrierProvidersResponse=_a.sent(),carriersExtraFields=carrierProvidersResponse.data.results.carriers.map(Carrier.O),carriersMap_1=(0,keyBy.A)(carriersExtraFields,"providerToken"),carrierAccounts=carrierAccountsResponse.filter((function(account){return account.carrier})).map((function(account){return(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},account),{carrier:(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},account.carrier),carriersMap_1[account.carrier.providerToken])})})),parsedCarrierAccounts={carrierAccounts},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchCarrierAccountsSuccess(parsedCarrierAccounts))];case 3:case 5:return _a.sent(),[3,6];case 4:return err_1=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchCarrierAccountsError({error:err_1.message}))];case 6:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.CONNECT_CARRIER_ACCOUNT,(function carrier_accounts_saga_connectCarrierAccount(action){var trackingReference,jsonCarrierAccount,carriers,response,carrierAccount,err_3,errorMessage,responseData,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:trackingReference=action.payload.trackingReference,_b.label=1;case 1:return _b.trys.push([1,9,,11]),jsonCarrierAccount=CarrierAccount.U2(action.payload.carrierAccount),[4,selectState(carrier_accounts_selectors.sp)];case 2:return carriers=_b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(connectCarrierAccount,jsonCarrierAccount)];case 3:return response=_b.sent(),(0,utils.A9)(trackingReference,response),carrierAccount=CarrierAccount.rS(response.data),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(connectCarrierAccountSuccess({carrierAccount}))];case 4:return _b.sent(),0!==carriers.length?[3,7]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendGTMEvent({eventName:"SET_FIRST_CARRIER"}))];case 5:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("First Carrier Connect"))];case 6:_b.sent(),_b.label=7;case 7:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("Carrier Connect Success",{Carrier:carrierAccount.carrier.name}))];case 8:return _b.sent(),[3,11];case 9:return err_3=_b.sent(),axios_default().isAxiosError(err_3)&&(0,utils.dj)(trackingReference,err_3),errorMessage=void 0,err_3.response?(responseData=null===(_a=err_3.response)||void 0===_a?void 0:_a.data,errorMessage="object"==typeof responseData?Object.values(responseData).join("\n"):Array.isArray(responseData)?responseData.join("\n"):responseData):errorMessage="An error occurred. Please contact support.",[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((payload={error:errorMessage},{payload,type:constants.t.CONNECT_CARRIER_ACCOUNT_ERROR}))];case 10:return _b.sent(),[3,11];case 11:return[2]}var payload}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.EDIT_CARRIER_ACCOUNT,(function carrier_accounts_saga_editCarrierAccount(action){var trackingReference,jsonCarrierAccount,response,carrierAccount,err_4,errorMessage,responseData,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:trackingReference=action.payload.trackingReference,_b.label=1;case 1:return _b.trys.push([1,4,,6]),jsonCarrierAccount=CarrierAccount.U2(action.payload.carrierAccount),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(editCarrierAccount,jsonCarrierAccount,action.payload.id)];case 2:return response=_b.sent(),carrierAccount=CarrierAccount.rS(response.data),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((payload={carrierAccount},{payload,type:constants.t.EDIT_CARRIER_ACCOUNT_SUCCESS}))];case 3:return _b.sent(),(0,utils.A9)(trackingReference,response),[3,6];case 4:return err_4=_b.sent(),axios_default().isAxiosError(err_4)&&(0,utils.dj)(trackingReference,err_4),errorMessage=void 0,err_4.response?(responseData=null===(_a=err_4.response)||void 0===_a?void 0:_a.data,errorMessage="object"==typeof responseData?Object.values(responseData).join("\n"):Array.isArray(responseData)?responseData.join("\n"):responseData):errorMessage="An error occurred. Please contact support.",[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(editCarrierAccountError({error:errorMessage}))];case 5:return _b.sent(),[3,6];case 6:return[2]}var payload}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.EDIT_CARRIER_ACCOUNT_SERVICE_LEVELS,(function carrier_accounts_saga_editCarrierAccountServiceLevels(action){var trackingReference,response,err_5,errors,responseData,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:trackingReference=action.payload.trackingReference,_b.label=1;case 1:return _b.trys.push([1,6,,8]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(editCarrierAccountServiceLevels,action.payload.serviceLevelsPayload,action.payload.id)];case 2:return response=_b.sent(),(0,utils.A9)(trackingReference,response),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(providers_saga_fetchServiceLevelsByAccount)];case 3:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((payload={status:response.status},{payload,type:constants.t.EDIT_CARRIER_ACCOUNT_SERVICE_LEVELS_SUCCESS}))];case 4:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(carrier_accounts_actions_editCarrierAccount({carrierAccount:action.payload.carrierAccount,id:action.payload.id,trackingReference}))];case 5:return _b.sent(),[3,8];case 6:return err_5=_b.sent(),axios_default().isAxiosError(err_5)&&(0,utils.dj)(trackingReference,err_5),errors=void 0,err_5.response&&(responseData=null===(_a=err_5.response)||void 0===_a?void 0:_a.data,errors=responseData.errors||[],responseData.error&&(errors=[responseData.error])),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(editCarrierAccountServiceLevelsError(errors))];case 7:return _b.sent(),[3,8];case 8:return[2]}var payload}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.CREATE_CARRIER_ACCOUNT,(function carrier_accounts_saga_createCarrierAccount(action){var trackingReference,response,jsonCreateCarrierAccount,jsonCarrierAccount,carrierAccount,err_2,errorMessage,responseData,_b,_c;return(0,tslib_es6.YH)(this,(function(_d){switch(_d.label){case 0:trackingReference=action.payload.trackingReference,_d.label=1;case 1:return _d.trys.push([1,16,,18]),response=void 0,carriers.L5.includes(action.payload.carrierAccount.carrier.id)||(null===(_b=action.payload.carrierAccount.parameters)||void 0===_b?void 0:_b.isMasterAccount)?(jsonCreateCarrierAccount=CarrierAccount.Ch(action.payload.carrierAccount),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(carrier_accounts_service_createCarrierAccount,jsonCreateCarrierAccount)]):[3,3];case 2:return response=_d.sent(),[3,5];case 3:return jsonCarrierAccount=CarrierAccount.U2(action.payload.carrierAccount),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(connectCarrierAccount,jsonCarrierAccount)];case 4:response=_d.sent(),_d.label=5;case 5:return(0,utils.A9)(trackingReference,response),carrierAccount=CarrierAccount.rS(response.data),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((payload={carrierAccount,trackingReference},{payload,type:constants.t.CREATE_CARRIER_ACCOUNT_SUCCESS}))];case 6:return _d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("CARRIER_REGISTRATION_SUCCESS",{Carrier:carrierAccount.carrier.name}))];case 7:if(_d.sent(),!carrierAccount.carrier||!carrierAccount.isShippoAccount)return[3,15];switch(carrierAccount.carrier){case carriers.$5:return[3,8];case carriers.i3:return[3,10];case carriers.y6:return[3,12]}return[3,14];case 8:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("UPS_MASTER_REGISTRATION_SUCCESS"))];case 9:return _d.sent(),[3,15];case 10:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("CANADA_POST_MASTER_REGISTRATION_SUCCESS"))];case 11:return _d.sent(),[3,15];case 12:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("DHL_EXPRESS_MASTER_REGISTRATION_SUCCESS"))];case 13:return _d.sent(),[3,15];case 14:return[3,15];case 15:return[3,18];case 16:return err_2=_d.sent(),axios_default().isAxiosError(err_2)&&(0,utils.dj)(trackingReference,err_2),errorMessage=void 0,err_2&&err_2.response?(responseData=null===(_c=err_2.response)||void 0===_c?void 0:_c.data,errorMessage="object"==typeof responseData?Object.values(responseData).join("\n"):Array.isArray(responseData)?responseData.join("\n"):responseData):errorMessage="An error occurred. Please contact support.",[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(createCarrierAccountError({error:errorMessage}))];case 17:return _d.sent(),[3,18];case 18:return[2]}var payload}))})),(0,redux_saga_effects_npm_proxy_esm.p8)([constants.t.FETCH_CARRIER_ACCOUNT_REG_STATUSES,constants.t.CREATE_CARRIER_ACCOUNT_SUCCESS,constants.t.CREATE_CARRIER_ACCOUNT_ERROR],(function carrier_accounts_saga_fetchCarrierAccountRegStatuses(){var response,carrierAccountRegStatuses,err_6;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(carrier_accounts_service_fetchCarrierAccountRegStatuses)];case 1:return response=_a.sent(),carrierAccountRegStatuses=response.data.results.map((function(regStatus){return CarrierAccountRegStatus.r(regStatus)})),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((payload={carrierAccountRegStatuses},{payload,type:constants.t.FETCH_CARRIER_ACCOUNT_REG_STATUSES_SUCCESS}))];case 2:case 4:return _a.sent(),[3,5];case 3:return err_6=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchCarrierAccountRegStatusesError({error:err_6.message}))];case 5:return[2]}var payload}))}));function carrier_form_fields_service_fetchCarrierFormFields(carrier,formType){return services_api.YZ.request({url:"/setting/carrier-params",method:"POST",data:{carrier:carrier.providerToken,form_type:formType}})}(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.FETCH_CARRIER_FORM_FIELDS,(function carrier_form_fields_saga_fetchCarrierFormFields(action){var setValidations,response,carrierFormFields,carrierFormFieldValidations,successPayload,err_1,errorMessage;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:setValidations=function(carrierFormFields){var e_1,_a,validations={},validateIsRequired=function(value){return value?void 0:"Required"},validateMaxLength=function(max){return function(value){return value&&value.length>max?"Maximum length is ".concat(max," characters (currently ").concat(value.length,")"):void 0}},validateMinLength=function(min){return function(value){return value&&value.length<min?"Minimum length is ".concat(min," characters (currently ").concat(value.length,")"):void 0}},validateIntegerType=function(value){return value&&isNaN(Number(value))?"Must be a number":void 0};try{for(var carrierFormFields_1=(0,tslib_es6.Ju)(carrierFormFields),carrierFormFields_1_1=carrierFormFields_1.next();!carrierFormFields_1_1.done;carrierFormFields_1_1=carrierFormFields_1.next()){var parameter=carrierFormFields_1_1.value,parameterValidations=[];"integer"===parameter.fieldType&&parameterValidations.push(validateIntegerType),parameter.isRequired&&parameterValidations.push(validateIsRequired),parameter.maxLength&&parameterValidations.push(validateMaxLength(parameter.maxLength)),parameter.minLength&&parameterValidations.push(validateMinLength(parameter.minLength)),validations[parameter.key]=parameterValidations}}catch(e_1_1){e_1={error:e_1_1}}finally{try{carrierFormFields_1_1&&!carrierFormFields_1_1.done&&(_a=carrierFormFields_1.return)&&_a.call(carrierFormFields_1)}finally{if(e_1)throw e_1.error}}return validations},_a.label=1;case 1:return _a.trys.push([1,4,,6]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(carrier_form_fields_service_fetchCarrierFormFields,action.payload.carrier,action.payload.formType)];case 2:if(response=_a.sent(),0===(carrierFormFields=response.data.params.reduce((function(results,param){var serialized=function CarrierFormField_fromJSON(jsonCarrierFormField){if(!jsonCarrierFormField)return null;var serialized={rank:jsonCarrierFormField.rank,key:jsonCarrierFormField.key,label:jsonCarrierFormField.label,placeholderText:jsonCarrierFormField.placeholder_text,fieldType:jsonCarrierFormField.field_type,displayType:jsonCarrierFormField.display_type,minLength:jsonCarrierFormField.min_length,maxLength:jsonCarrierFormField.max_length,isRequired:jsonCarrierFormField.is_required,helpUrl:jsonCarrierFormField.help_url,options:jsonCarrierFormField.options,defaultValue:jsonCarrierFormField.default_value,hiddenByKey:jsonCarrierFormField.hidden_by_key,hiddenByValue:jsonCarrierFormField.hidden_by_value};return serialized.rank&&serialized.label&&serialized.key?serialized:null}(param);return serialized&&results.push(serialized),results}),[])).length)throw{response:{data:"This carrier form is currently not supported."}};return carrierFormFieldValidations=setValidations(carrierFormFields),successPayload={carrierFormFields,carrierFormFieldValidations},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((payload=successPayload,{payload,type:constants.t.FETCH_CARRIER_FORM_FIELDS_SUCCESS}))];case 3:return _a.sent(),[3,6];case 4:return err_1=_a.sent(),errorMessage=err_1.response?err_1.response.data:"An error occurred while retrieving the form. Please contact support.",[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchCarrierFormFieldsError({error:errorMessage}))];case 5:return _a.sent(),[3,6];case 6:return[2]}var payload}))}));var getTrackEventName=function(formType,eventType,formName,isOnOrdersPage,isOnCarrierSettingsPage){var pageLocation="";if(isOnOrdersPage?pageLocation="Orders Page":isOnCarrierSettingsPage&&(pageLocation="Carrier Settings Page"),""===pageLocation)return"";var suffix=eventType===CarrierFormEventType.Click?"Tab":"Form",formTypeName="";formType&&""!==formType&&(formTypeName=formType.charAt(0).toUpperCase()+formType.slice(1));var trackEventString="".concat(formName," ").concat(pageLocation," - ").concat(eventType," ").concat(formTypeName," ").concat(suffix);return eventType===CarrierFormEventType.Close&&(suffix="Modal",trackEventString="".concat(formName," ").concat(pageLocation," - ").concat(eventType," ").concat(suffix)),trackEventString};(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.CARRIER_FORM_INPUT_EVENT,(function carrier_form_input_saga_trackCarrierFormEvent(action){var formType,eventType,formName,pathName,trackEventName;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return formType=action.formType||"",eventType=action.eventType,formName=action.formName,[4,selectState(getPathname)];case 1:return pathName=_a.sent(),""===(trackEventName=getTrackEventName(formType,eventType,formName,"/orders"===pathName,"/settings/carriers"===pathName))?[3,3]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)(trackEventName))];case 2:_a.sent(),_a.label=3;case 3:return"true"!==js_cookie.get("ebay_ca_connect_start")||formName!==TabbedCarrierFormName.EbayCanadaPost||eventType!==CarrierFormEventType.Close&&eventType!==CarrierFormEventType.Submit||eventType!==CarrierFormEventType.Close?[3,5]:[4,(0,redux_saga_effects_npm_proxy_esm.T1)(js_cookie.remove,"ebay_ca_connect_start",{domain:".shippodev.com"})];case 4:_a.sent(),_a.label=5;case 5:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)([constants.t.CREATE_CARRIER_ACCOUNT_SUCCESS,constants.t.CONNECT_CARRIER_ACCOUNT_SUCCESS,constants.t.CLEAR_EBAY_CANADA_CONNECT_START_COOKIE],(function removeEbayRegistrationCookie(){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return"true"!==js_cookie.get("ebay_ca_connect_start")?[3,2]:[4,(0,redux_saga_effects_npm_proxy_esm.T1)(js_cookie.remove,"ebay_ca_connect_start",{domain:".shippodev.com"})];case 1:_a.sent(),_a.label=2;case 2:return[2]}}))}));function uploadCSVSuccess(payload){return{payload,type:constants.t.CSV_IMPORT_FILE_UPLOAD_SUCCESS}}function uploadCSVError(errorMessage,errorTitle){return{type:constants.t.CSV_IMPORT_FILE_UPLOAD_ERROR,payload:{errorMessage,errorTitle}}}function fetchCSVTemplatesSuccess(payload){return{payload,type:constants.t.CSV_IMPORT_FETCH_TEMPLATES_SUCCESS}}function fetchCSVTemplatesError(errorMessage,errorTitle){return{type:constants.t.CSV_IMPORT_FETCH_TEMPLATES_ERROR,payload:{errorMessage,errorTitle}}}function deleteCSVTemplateSuccess(payload){return{type:constants.t.CSV_IMPORT_DELETE_TEMPLATE_SUCCESS,payload:{deletedTemplateId:payload.deletedTemplateId,templates:payload.templates}}}function deleteCSVTemplateError(errorMessage,errorTitle){return{type:constants.t.CSV_IMPORT_DELETE_TEMPLATE_ERROR,payload:{errorMessage,errorTitle}}}function saveCSVTemplateError(errorMessage,errorTitle){return{type:constants.t.CSV_IMPORT_SAVE_TEMPLATE_ERROR,payload:{errorMessage,errorTitle}}}function importCSVOrdersError(errorMessage,errorTitle){return{type:constants.t.CSV_IMPORT_ORDERS_ERROR,payload:{errorMessage,errorTitle}}}var baseURL="https://dev-qa.shippodev.com",deleteBaseURL="https://service-dev-qa.shippodev.com";function csv_import_service_uploadCSV(file){var formData=new FormData;return formData.append("file",file),services_api.Ay.request({baseURL,url:"user/orders/import/csv/v2/ajaxpreload/",method:"POST",headers:{"Content-Type":"multipart/form-data"},data:formData})}function getTemplates(){return services_api.Ay.request({baseURL,url:"user/orders/import/csv/v2/mapping/",method:"GET"})}function saveTemplate(payload){return services_api.Ay.request({baseURL,url:"user/orders/import/csv/v2/mapping/",method:"POST",data:payload})}function deleteTemplate(payload){return services_api.Ay.request({baseURL:deleteBaseURL,url:"user/orders/import/csv/v2/mapping/",method:"DELETE",data:payload})}function importCSVOrders(payload){return services_api.Ay.request({baseURL,url:"user/orders/import/csv/v2/",method:"POST",data:payload})}var Asset=__webpack_require__("./app/types/Asset.ts");function getCurrentUser(){return services_api.Ay.request({url:"v1/ui/account",method:"GET"})}function user_service_updateCompany(payload){return services_api.YZ.request({url:"/setting/company",method:"PUT",headers:{},data:payload})}function user_service_fetchCompany(){return services_api.YZ.request({url:"/setting/company/",method:"GET"})}function user_service_updateCreditCard(tokenId,billingAddress,trackerSessionId,isImpersonate){return services_api.Ay.request({url:"v1/billing/credit_card",method:"PUT",data:{stripe_token:tokenId,billing_address:billingAddress,tracker_sessionid:trackerSessionId,is_impersonate:isImpersonate}})}function user_service_fetchAssets(){return services_api.Ay.request({url:"/ui/assets",method:"GET"})}function user_service_uploadAssetDraft(assetObjectId,file){var formData=new FormData;return formData.append("file",file),services_api.Ay.request({url:"/ui/assets/".concat(assetObjectId,"/draft_image"),method:"POST",headers:{"Content-Type":"multipart/form-data"},data:formData})}function publishAssetDraft(assetObjectId){return services_api.Ay.request({url:"/ui/assets/".concat(assetObjectId,"/draft_image/publish"),method:"POST"})}function user_service_clearAssetDraft(assetObjectId){return services_api.Ay.request({url:"/ui/assets/".concat(assetObjectId,"/draft_image/clear"),method:"POST"})}function user_service_revertAssetDraft(assetObjectId){return services_api.Ay.request({url:"/ui/assets/".concat(assetObjectId,"/draft_image"),method:"DELETE"})}function uploadAndPublishAsset(assetType,file){var formData=new FormData;return formData.append("asset_type",assetType),formData.append("rank","1"),formData.append("file",file),services_api.Ay.request({url:"/ui/assets/upload_and_publish",method:"POST",data:formData})}function updateAsset(asset){return services_api.Ay.request({url:"/ui/assets/".concat(asset.objectId),method:"PUT",data:(0,Asset.U2)(asset)})}function createAsset(asset){return services_api.Ay.request({url:"/ui/assets",method:"POST",data:(0,Asset.U2)(asset)})}function createVerificationIntent(returnUrl){return services_api.YZ.request({url:"/id_verification",method:"POST",data:{return_url:returnUrl}})}function getVerificationStatus(){return services_api.YZ.request({url:"/id_verification",method:"GET"})}function user_service_updateUser(data,isImpersonate){return services_api.Ay.request({url:"ui/user/profile",method:"PUT",data:(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},(0,humps.I)(data)),{is_impersonate:isImpersonate})})}function user_service_addUser(email){return services_api.Ay.request({url:"/ui/account/login_users",method:"POST",data:{email}})}function sendInvite(id){return services_api.Ay.request({url:"/ui/account/login_users/".concat(id,"/send_invitation_email"),method:"POST"})}function user_service_deleteUser(id){return services_api.Ay.request({url:"/ui/account/login_users/".concat(id),method:"DELETE"})}function user_service_getLoginUsers(){return services_api.Ay.request({url:"/ui/account/login_users?results=200",method:"GET"})}function fieldMappingFromJSON(jsonFieldMapping){return{colName:jsonFieldMapping.col_name,colIdx:jsonFieldMapping.col_idx,field:(jsonField=jsonFieldMapping.field,{isRequired:jsonField.is_required,name:jsonField.name,id:jsonField.id})};var jsonField}function fieldMappingToJSON(fieldMapping){return{col_name:fieldMapping.colName,col_idx:fieldMapping.colIdx,field:(field=fieldMapping.field,{is_required:field.isRequired,name:field.name,id:field.id})};var field}function CSVMapping_fromJSON(jsonCSV){return{id:jsonCSV.id,name:jsonCSV.name,isActive:jsonCSV.is_active,fieldMappings:jsonCSV.field_mappings.map(fieldMappingFromJSON)}}function CSVValue_fromJSON(jsonCSV){return{colName:jsonCSV.col_name,value:jsonCSV.value}}(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.CSV_IMPORT_FILE_UPLOAD,(function uploadFile(action){var result,payload,err_1,idvResult,verification;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,4,,10]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(csv_import_service_uploadCSV,action.payload.file)];case 1:return result=_a.sent(),payload={fileUrl:result.data.file_url,userValues:result.data.user_values.map(CSVValue_fromJSON),mapping:CSVMapping_fromJSON(result.data.mapping)},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(uploadCSVSuccess(payload))];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,actions.VC)({pathname:"/orders/csv-import/step-two"}))];case 3:return _a.sent(),[3,10];case 4:return(err_1=_a.sent()).response&&403===err_1.response.status?[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getVerificationStatus)]:[3,7];case 5:return idvResult=_a.sent(),verification=IDVerification.r(idvResult.data),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(setIdVerificationStatus(verification))];case 6:return _a.sent(),[3,9];case 7:return"We were unable to upload your CSV file","uploadMessage",[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(uploadCSVError("uploadMessage","We were unable to upload your CSV file"))];case 8:_a.sent(),_a.label=9;case 9:return[3,10];case 10:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.CSV_IMPORT_FETCH_TEMPLATES,(function fetchTemplates(){var result,payload;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getTemplates)];case 1:return result=_a.sent(),payload={templates:result.data.map(CSVMapping_fromJSON)},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchCSVTemplatesSuccess(payload))];case 2:case 4:return _a.sent(),[3,5];case 3:return _a.sent(),"We were unable to fetch your CSV templates","refreshMessage",[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchCSVTemplatesError("refreshMessage","We were unable to fetch your CSV templates"))];case 5:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.CSV_IMPORT_SAVE_TEMPLATE,(function csv_import_saga_saveTemplate(action){var filteredMappings,payload,result;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),filteredMappings=action.payload.template.fieldMappings.filter((function(fieldMapping){return 0!==fieldMapping.field.id})),payload={field_mappings:filteredMappings.map(fieldMappingToJSON),name:action.payload.name,id:action.payload.template.id,is_active:action.payload.isActive},[4,(0,redux_saga_effects_npm_proxy_esm.T1)(saveTemplate,payload)];case 1:return result=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((fileUrl=action.payload.fileUrl,templateId=result.data.template_id,trackingReference=action.payload.trackingReference,{type:constants.t.CSV_IMPORT_SAVE_TEMPLATE_SUCCESS,payload:{fileUrl,templateId,trackingReference}}))];case 2:case 4:return _a.sent(),[3,5];case 3:return _a.sent(),"We are unable to save your CSV template","refreshMessage",[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(saveCSVTemplateError("refreshMessage","We are unable to save your CSV template"))];case 5:return[2]}var fileUrl,templateId,trackingReference}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.CSV_IMPORT_DELETE_TEMPLATE,(function csv_import_saga_deleteTemplate(action){var payload,result,successPayload;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,4,,6]),payload={template_id:action.payload.templateId},[4,(0,redux_saga_effects_npm_proxy_esm.T1)(deleteTemplate,payload)];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getTemplates)];case 2:return result=_a.sent(),successPayload={templates:result.data.map(CSVMapping_fromJSON),deletedTemplateId:action.payload.templateId},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(deleteCSVTemplateSuccess(successPayload))];case 3:case 5:return _a.sent(),[3,6];case 4:return _a.sent(),"Error occured deleting CSV template","deleteMessage",[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(deleteCSVTemplateError("deleteMessage","Error occured deleting CSV template"))];case 6:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.CSV_IMPORT_SAVE_TEMPLATE_SUCCESS,(function importOrders(action){var payload;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,5,,7]),payload={csv_url:action.payload.fileUrl,template_id:action.payload.templateId},[4,(0,redux_saga_effects_npm_proxy_esm.T1)(importCSVOrders,payload)];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.CSV_IMPORT_ORDERS_SUCCESS})];case 2:return _a.sent(),(0,utils.Ro)(action.payload.trackingReference,types.iB.operations.IMPORT_STARTED,{}),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("CSV Import"))];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendGTMEvent({eventName:"CSV_IMPORT_SUCCESS"}))];case 4:case 6:return _a.sent(),[3,7];case 5:return _a.sent(),"We can't read your CSV file","uploadMessage",[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(importCSVOrdersError("uploadMessage","We can't read your CSV file"))];case 7:return[2]}}))}));function getBatchEntriesIdsToUpdate(orderSelection){var _a,batchEntries,resetBatchEntries,newSelectedOrder;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(setupBatchEntries,orderSelection)];case 1:return _a=_b.sent(),batchEntries=_a.batchEntries,resetBatchEntries=_a.resetBatchEntries,newSelectedOrder=_a.newSelectedOrder,[2,{batchEntriesIdsToUpdate:(0,uniq.A)(batchEntries.map((function(be){return be.id}))),resetBatchEntries,newSelectedOrder}]}}))}function setupBatchEntries(orderSelection){var orderObjectIDs,batchEntryIDs,getOrCloneResult,batchEntries,orderObjectID,beId,pathname,qs_1,initialBatchEntries,resetBatchEntries,newSelectedOrder;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return orderObjectIDs=[],batchEntryIDs=[],Object.entries(orderSelection).forEach((function(_a){var _b=(0,tslib_es6.zs)(_a,2),orderObjectId=_b[0],orderBatchEntryIDs=_b[1];orderObjectIDs.push(orderObjectId),(null==orderBatchEntryIDs?void 0:orderBatchEntryIDs.length)>0&&batchEntryIDs.push.apply(batchEntryIDs,(0,tslib_es6.fX)([],(0,tslib_es6.zs)(orderBatchEntryIDs),!1))})),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getOrCloneBatchEntriesForOrders,orderObjectIDs,batchEntryIDs)];case 1:return getOrCloneResult=_a.sent(),batchEntries=(null==getOrCloneResult?void 0:getOrCloneResult.data.map(OrderBatchEntry.kc))||[],1!==orderObjectIDs.length||1!==batchEntries.length?[3,5]:(orderObjectID=orderObjectIDs[0],beId=batchEntries[0].id,[4,selectState(getPathname)]);case 2:return!(pathname=_a.sent()).includes(orderObjectID)||pathname.includes(beId.toString())?[3,5]:[4,selectState(getQS)];case 3:return qs_1=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,actions.HC)("/orders/".concat(orderObjectID,"/shipments/").concat(beId).concat(qs_1)))];case 4:_a.sent(),_a.label=5;case 5:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(orderSelectionToBatchEntries,orderSelection)];case 6:return initialBatchEntries=_a.sent(),resetBatchEntries=findResetBatchEntries(initialBatchEntries,batchEntries),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,orders_actions.iZ)(initialBatchEntries,resetBatchEntries))];case 7:return _a.sent(),newSelectedOrder=batchEntries.reduce((function(accum,entry){return accum[entry.orderObjectId]=accum[entry.orderObjectId]?(0,tslib_es6.fX)((0,tslib_es6.fX)([],(0,tslib_es6.zs)(accum[entry.orderObjectId]),!1),[entry.id],!1):[entry.id],accum}),{}),[2,{batchEntries,resetBatchEntries,newSelectedOrder}]}}))}function orderSelectionToBatchEntries(orderSelection){var _a,orderObjectIds,batchEntryIds,batchEntriesFromOrders,batchEntriesFromIds;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return _a=(0,tslib_es6.zs)(Object.entries(orderSelection).reduce((function(_a,_b){var _c=(0,tslib_es6.zs)(_a,2),os=_c[0],bes=_c[1],_d=(0,tslib_es6.zs)(_b,2),orderObjectId=_d[0],batchEntryIds=_d[1];return(null==batchEntryIds?void 0:batchEntryIds.length)?[os,bes.concat(batchEntryIds)]:[os.concat(orderObjectId),bes]}),[new Array,new Array]),2),orderObjectIds=_a[0],batchEntryIds=_a[1],[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(batch_entry_selectors.dM,{orderObjectIds})];case 1:return batchEntriesFromOrders=_b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(batch_entry_selectors.uq,{batchEntryIds})];case 2:return batchEntriesFromIds=_b.sent(),[2,batchEntriesFromOrders.concat(batchEntriesFromIds)]}}))}function findResetBatchEntries(initialBatchEntries,batchEntries){var batchEntryIdsSelected=new Set(initialBatchEntries.map((function(batchEntry){return batchEntry.id})));return batchEntries.filter((function(batchEntry){return!batchEntryIdsSelected.has(batchEntry.id)}))}function customs_service_createCustomsItem(batchEntryIds,customsItems){return services_api.YZ.request({url:"/batch_entry/customs_items",method:"POST",data:{batch_entries:batchEntryIds,customs_items:customsItems}})}function updateCustomsItem(batchEntryIds,customsItem){return services_api.YZ.request({url:"/batch_entry/customs_items",method:"PUT",data:{batch_entries:batchEntryIds,customs_items:[customsItem]}})}function deleteCustomsItems(batchEntryIds,customsItems){return services_api.YZ.request({url:"/batch_entry/customs_items/",method:"DELETE",data:{batch_entries:batchEntryIds,customs_items:customsItems}})}function updateCustomsDeclaration(batchEntryIds,customsDeclaration){return services_api.YZ.request({url:"/batch_entry/customs_declaration",method:"PUT",data:{batch_entries:batchEntryIds,customs_declaration:customsDeclaration}})}(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.CUSTOMS_ITEM_CREATE,(function customs_saga_createCustomsItem(action){var batchEntriesIdsToUpdate,ordersData,order,result,parsedBatchEntries,err_1;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,10,,13]),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.De)(constants_form.Y0))];case 1:return _a.sent(),[5,(0,tslib_es6.Ju)(getBatchEntriesIdsToUpdate(action.payload.orderSelection))];case 2:return batchEntriesIdsToUpdate=_a.sent().batchEntriesIdsToUpdate,[4,selectState(orders_selectors.Sv)];case 3:return ordersData=_a.sent(),order=ordersData[Object.keys(action.payload.orderSelection)[0]],[4,(0,redux_saga_effects_npm_proxy_esm.T1)(customs_service_createCustomsItem,(0,uniq.A)(batchEntriesIdsToUpdate),[CustomsItem.eL(action.payload.customsItemPayload)])];case 4:return result=_a.sent(),parsedBatchEntries=(null==result?void 0:result.data.map(OrderBatchEntry.kc))||[],[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.XD(order.objectId))];case 5:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.CK(parsedBatchEntries))];case 6:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Wj([order.objectId]))];case 7:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.CUSTOMS_ITEM_CREATE_SUCCESS})];case 8:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.Wv)(constants_form.Y0))];case 9:case 12:return _a.sent(),[3,13];case 10:return err_1=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.uj)(constants_form.Y0))];case 11:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((err=err_1,{type:constants.t.CUSTOMS_ITEM_CREATE_ERROR,payload:{err}}))];case 13:return[2]}var err}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.CUSTOMS_ITEM_UPDATE,(function customs_saga_editCustomsItem(action){var _a,batchEntriesIdsToUpdate,resetBatchEntries,initialCustomsItems,customsItemPayload,initialCustomsItems_1,initialCustomsItems_1_1,ci,ordersData,order,result,parsedBatchEntries,err_2,e_1,_b;return(0,tslib_es6.YH)(this,(function(_c){switch(_c.label){case 0:return _c.trys.push([0,11,,14]),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.De)(constants_form.Y0))];case 1:return _c.sent(),[5,(0,tslib_es6.Ju)(getBatchEntriesIdsToUpdate(action.payload.orderSelection))];case 2:if(_a=_c.sent(),batchEntriesIdsToUpdate=_a.batchEntriesIdsToUpdate,resetBatchEntries=_a.resetBatchEntries,initialCustomsItems=void 0,customsItemPayload=(0,tslib_es6.Cl)({},action.payload.customsItemPayload),resetBatchEntries.length>0){initialCustomsItems=resetBatchEntries.reduce((function(customsItems,batchEntry){return(0,tslib_es6.fX)((0,tslib_es6.fX)([],(0,tslib_es6.zs)(customsItems),!1),(0,tslib_es6.zs)(batchEntry.customsItems),!1)}),[]);try{for(initialCustomsItems_1=(0,tslib_es6.Ju)(initialCustomsItems),initialCustomsItems_1_1=initialCustomsItems_1.next();!initialCustomsItems_1_1.done;initialCustomsItems_1_1=initialCustomsItems_1.next())if(ci=initialCustomsItems_1_1.value,CustomsItem.Q5(ci,action.payload.initialValues)){customsItemPayload=(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},customsItemPayload),{id:ci.id});break}}catch(e_1_1){e_1={error:e_1_1}}finally{try{initialCustomsItems_1_1&&!initialCustomsItems_1_1.done&&(_b=initialCustomsItems_1.return)&&_b.call(initialCustomsItems_1)}finally{if(e_1)throw e_1.error}}}return[4,selectState(orders_selectors.Sv)];case 3:return ordersData=_c.sent(),order=ordersData[Object.keys(action.payload.orderSelection)[0]],[4,(0,redux_saga_effects_npm_proxy_esm.T1)(utils.f0,action.payload.appLocation,segment.sV.customs_items_form_submit,(0,tslib_es6.Cl)((0,tslib_es6.Cl)({order_id:order.objectId},action.payload.trackingData),CustomsItem.eL(customsItemPayload)))];case 4:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(updateCustomsItem,(0,uniq.A)(batchEntriesIdsToUpdate),CustomsItem.eL(customsItemPayload))];case 5:return result=_c.sent(),parsedBatchEntries=(null==result?void 0:result.data.map(OrderBatchEntry.kc))||[],[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.XD(order.objectId))];case 6:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.CK(parsedBatchEntries))];case 7:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Wj(Object.keys(action.payload.orderSelection)))];case 8:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.CUSTOMS_ITEM_UPDATE_SUCCESS})];case 9:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.Wv)(constants_form.Y0))];case 10:case 13:return _c.sent(),[3,14];case 11:return err_2=_c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.uj)(constants_form.Y0))];case 12:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((err=err_2,{type:constants.t.CUSTOMS_ITEM_UPDATE_ERROR,payload:{err}}))];case 14:return[2]}var err}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.CUSTOMS_ITEM_DELETE,(function customs_saga_deleteCustomsItem(action){var _a,initialValues,orderSelection,_b,batchEntriesIdsToUpdate,resetBatchEntries,initialCustomsItems_2,customsItemsPayload_1,batchEntry,result,parsedBatchEntries,_c;return(0,tslib_es6.YH)(this,(function(_d){switch(_d.label){case 0:return _d.trys.push([0,9,,11]),_a=action.payload,initialValues=_a.initialValues,orderSelection=_a.orderSelection,[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getBatchEntriesIdsToUpdate,orderSelection)];case 1:return _b=_d.sent(),batchEntriesIdsToUpdate=_b.batchEntriesIdsToUpdate,resetBatchEntries=_b.resetBatchEntries,customsItemsPayload_1=(0,tslib_es6.fX)([],(0,tslib_es6.zs)(initialValues),!1),(0,flatten.A)(Object.values(orderSelection)).length<1?[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(batch_entry_selectors.fu,{batchEntryId:batchEntriesIdsToUpdate[0]})]:[3,3];case 2:batchEntry=_d.sent(),customsItemsPayload_1=(null===(_c=null==batchEntry?void 0:batchEntry.customsItems)||void 0===_c?void 0:_c.map(CustomsItem.rx))||[],_d.label=3;case 3:return resetBatchEntries.length>0&&(initialCustomsItems_2=resetBatchEntries.reduce((function(customsItems,batchEntry){return(0,tslib_es6.fX)((0,tslib_es6.fX)([],(0,tslib_es6.zs)(customsItems),!1),(0,tslib_es6.zs)(batchEntry.customsItems),!1)}),[]),customsItemsPayload_1.forEach((function(payload,index){var e_2,_a;try{for(var initialCustomsItems_3=(0,tslib_es6.Ju)(initialCustomsItems_2),initialCustomsItems_3_1=initialCustomsItems_3.next();!initialCustomsItems_3_1.done;initialCustomsItems_3_1=initialCustomsItems_3.next()){var ci=initialCustomsItems_3_1.value;if(CustomsItem.Q5(ci,payload)){customsItemsPayload_1[index].id=ci.id;break}}}catch(e_2_1){e_2={error:e_2_1}}finally{try{initialCustomsItems_3_1&&!initialCustomsItems_3_1.done&&(_a=initialCustomsItems_3.return)&&_a.call(initialCustomsItems_3)}finally{if(e_2)throw e_2.error}}}))),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(deleteCustomsItems,(0,uniq.A)(batchEntriesIdsToUpdate),customsItemsPayload_1.map(CustomsItem.eL))];case 4:return result=_d.sent(),parsedBatchEntries=(null==result?void 0:result.data.map(OrderBatchEntry.kc))||[],[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.XD(Object.keys(action.payload.orderSelection)[0]))];case 5:return _d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.CK(parsedBatchEntries))];case 6:return _d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Wj(Object.keys(action.payload.orderSelection)))];case 7:return _d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.CUSTOMS_ITEM_DELETE_SUCCESS})];case 8:return _d.sent(),[3,11];case 9:return _d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((error="Something happened. Please try again",{type:constants.t.CUSTOMS_ITEM_DELETE_ERROR,payload:{error}}))];case 10:return _d.sent(),[3,11];case 11:return[2]}var error}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.CUSTOMS_DECLARATION_UPDATE,(function customs_saga_editCustomsDeclaration(action){var _a,batchEntriesIdsToUpdate,resetBatchEntries,initialCustomsDeclaration,customsDeclarationPayload,orderIDs,result,parsedBatchEntries,err_3,_b,_c,_d,_e,_f;return(0,tslib_es6.YH)(this,(function(_g){switch(_g.label){case 0:return _g.trys.push([0,9,,12]),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.De)(constants_form.ZP))];case 1:return _g.sent(),[5,(0,tslib_es6.Ju)(getBatchEntriesIdsToUpdate(action.payload.orderSelection))];case 2:return _a=_g.sent(),batchEntriesIdsToUpdate=_a.batchEntriesIdsToUpdate,resetBatchEntries=_a.resetBatchEntries,initialCustomsDeclaration=void 0,customsDeclarationPayload=(0,tslib_es6.Cl)({},action.payload.customsDeclarationPayload),(null===(_b=null==resetBatchEntries?void 0:resetBatchEntries[0])||void 0===_b?void 0:_b.customsDeclaration)&&(initialCustomsDeclaration=resetBatchEntries[0].customsDeclaration,(CustomsDeclaration.Lr(initialCustomsDeclaration,(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},action.payload.initialValues),{contentsType:action.payload.initialValues.contentsType.value.toString(),contentsExplanation:action.payload.initialValues.contentsExplanation,nonDeliveryOption:action.payload.initialValues.nonDeliveryOption.value.toString(),eelPfc:action.payload.initialValues.eelPfc?action.payload.initialValues.eelPfc.value.toString():"",incoterm:action.payload.initialValues.incoterm.value.toString(),b13aFilingOption:(null===(_d=null===(_c=action.payload.initialValues.b13aFilingOption)||void 0===_c?void 0:_c.value)||void 0===_d?void 0:_d.toString())||"",taxIdType:(null===(_f=null===(_e=action.payload.initialValues.taxIdType)||void 0===_e?void 0:_e.value)||void 0===_f?void 0:_f.toString())||""}))||initialCustomsDeclaration.id!==action.payload.customsDeclarationPayload.id)&&(customsDeclarationPayload=(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},customsDeclarationPayload),{id:initialCustomsDeclaration.id}))),orderIDs=Object.keys(action.payload.orderSelection),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(utils.f0,action.payload.appLocation,segment.sV.customs_options_form_submit,(0,tslib_es6.Cl)((0,tslib_es6.Cl)({order_id:orderIDs.length?orderIDs[0]:""},action.payload.trackingData),CustomsDeclaration.Fk(CustomsDeclaration.QX(customsDeclarationPayload))))];case 3:return _g.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(updateCustomsDeclaration,(0,uniq.A)(batchEntriesIdsToUpdate),CustomsDeclaration.QX(customsDeclarationPayload))];case 4:return result=_g.sent(),parsedBatchEntries=(null==result?void 0:result.data.map(OrderBatchEntry.kc))||[],[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.CK(parsedBatchEntries))];case 5:return _g.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Wj(parsedBatchEntries.map((function(batchEntry){return batchEntry.orderObjectId}))))];case 6:return _g.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.CUSTOMS_DECLARATION_UPDATE_SUCCESS})];case 7:return _g.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.Wv)(constants_form.ZP))];case 8:case 11:return _g.sent(),[3,12];case 9:return err_3=_g.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.uj)(constants_form.ZP))];case 10:return _g.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((err=err_3,{type:constants.t.CUSTOMS_DECLARATION_UPDATE_ERROR,payload:{err}}))];case 12:return[2]}var err}))}));function assignFeatureTestVariantSuccess(featureTestUserVariant){return{type:constants.t.FEATURE_TEST_ASSIGN_SUCCESS,payload:{featureTestUserVariant}}}function feature_tests_service_fetchFeatureTests(){return services_api.Ay.request({url:"/ui/features",method:"GET"})}function assignTestVariant(featureTestName,variantName){return services_api.YZ.request({url:"/feature_tests/reassign/",method:"POST",data:{test_name:featureTestName,variant_name:variantName}})}function featureTestUserVariantFromJSON(variant){return{featureTest:{name:variant.feature_test.name},featureTestVariant:{name:variant.feature_test_variant.name}}}(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.FETCH_AB_TEST_FEATURES,(function feature_tests_saga_fetchFeatureTests(){var response;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,4]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(feature_tests_service_fetchFeatureTests)];case 1:return response=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((featureTestUserVariants=response.data.results.map(featureTestUserVariantFromJSON),{type:constants.t.FETCH_AB_TEST_FEATURES_SUCCESS,payload:{featureTestUserVariants}}))];case 2:return _a.sent(),[3,4];case 3:return _a.sent(),[3,4];case 4:return[2]}var featureTestUserVariants}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.FETCH_AB_TEST_FEATURES_SUCCESS,(function postFeatureTestFetchSuccessHook(){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.INITIALIZE_FEATURE_TEST_VARIANT_NAMES})];case 1:return _a.sent(),[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.INITIALIZE_FEATURE_TEST_VARIANT_NAMES,(function feature_tests_saga_initializeFeatureTestVariantNames(){var names,gtmEvent;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,selectState(getAllFeatureTestVariantNames)];case 1:return(names=_a.sent())?(gtmEvent={eventName:"FEATURE_TESTS_PUSHED_EVENT",data:{featureTestVariants:names.join(", ")}},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendGTMEvent(gtmEvent))]):[3,3];case 2:_a.sent(),_a.label=3;case 3:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.FEATURE_TEST_ASSIGN,(function feature_tests_saga_assignFeatureTestVariant(action){var _a,featureTestName,variantName,response,featureTestUserVariant;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return _b.trys.push([0,3,,5]),_a=action.payload,featureTestName=_a.featureTestName,variantName=_a.variantName,[4,(0,redux_saga_effects_npm_proxy_esm.T1)(assignTestVariant,featureTestName,variantName)];case 1:return response=_b.sent(),featureTestUserVariant={featureTest:{name:featureTestName},featureTestVariant:(0,tslib_es6.Cl)({},(variant=response.data,{name:variant.name}))},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(assignFeatureTestVariantSuccess(featureTestUserVariant))];case 2:case 4:return _b.sent(),[3,5];case 3:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.FEATURE_TEST_ASSIGN_ERROR})];case 5:return[2]}var variant}))}));function saveFilterGroupError(errorMessage){return{type:constants.t.FILTER_SAVE_FILTER_GROUP_ERROR,payload:{errorMessage}}}function getFilterGroupsError(errorMessage){return{type:constants.t.FILTER_GET_FILTER_GROUPS_ERROR,payload:{errorMessage}}}function deleteFilterGroupError(errorMessage){return{type:constants.t.FILTER_DELETE_FILTER_GROUP_ERROR,payload:{errorMessage}}}function changeTabShown(tabName){return{type:constants.t.FILTER_CHANGE_TAB,payload:{tabName}}}function saveTempFilterGroup(filters){return{type:constants.t.FILTER_SAVE_TEMP_GROUP,payload:{filters}}}var isEqual=__webpack_require__("./node_modules/lodash-es/isEqual.js");function parseFilterGroups(show,filterGroups){if(!filterGroups)return{};var newFilters={},filterGroup=filterGroups.find((function(filterGroup){return filterGroup.name===show}));return filterGroup&&filterGroup.filter_criteria&&filterGroup.filter_criteria.forEach((function(filterCriteria){var _a,_b,filter=filterCriteria.filter;if("ORDER_BY"===filter.field&&(newFilters.order_by=filter.value.text),"SORT_BY"===filter.field&&(newFilters.sort_by=filter.value.text),"WEIGHT"===filter.field){var comparator="less_than"===filter.comparator?"lt":"gt";newFilters["weight_".concat(comparator)]=filter.value.value,newFilters.weight_unit=filter.value.enum}"STORE_PLATFORM"===filter.field&&filter.value.set&&filter.value.set.length>0&&(newFilters.shop_app=filter.value.set[0]),"IS_INTERNATIONAL"===filter.field&&(newFilters.is_international=null===(_a=filter.value.boolean)||void 0===_a?void 0:_a.toString()),"DATE_CREATED"===filter.field&&("greater_than_or_equal_to"===filter.comparator?newFilters.start_date=moment_moment(filter.value.date).format():"less_than_or_equal_to"===filter.comparator&&(newFilters.end_date=moment_moment(filter.value.date).format())),"SHIPPING_METHOD"===filter.field&&(newFilters.shipping_method=filter.value.set),"ITEM"===filter.field&&(newFilters.item=null===(_b=filter.value.set)||void 0===_b?void 0:_b.sort()),"ORDER_STATUS"===filter.field&&filter.value.set&&filter.value.set.length>0&&(newFilters.order_status=filter.value.set.length>1?"pending":"fulfilled"),"SEARCH_TEXT"===filter.field&&(newFilters.q=filter.value.text)})),newFilters}function parseFilters(filters){var filterCriteria=[];if("weight_unit"in filters){var weightFilter={filter:{field:"weight",value:{enum:filters.weight_unit}}};"weight_lt"in filters&&filterCriteria.push({filter:(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},weightFilter.filter),{value:(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},weightFilter.filter.value),{value:filters.weight_lt}),comparator:"less_than"})}),"weight_gt"in filters&&filterCriteria.push({filter:(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},weightFilter.filter),{value:(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},weightFilter.filter.value),{value:filters.weight_gt}),comparator:"greater_than"})})}return"shop_app"in filters&&filterCriteria.push({filter:{field:"store_platform",comparator:"in",value:{set:[filters.shop_app]}}}),"is_international"in filters&&filterCriteria.push({filter:{field:"is_international",comparator:"equal_to",value:{boolean:"true"===filters.is_international}}}),"start_date"in filters&&filterCriteria.push({filter:{field:"date_created",comparator:"greater_than_or_equal_to",value:{date:filters.start_date}}}),"end_date"in filters&&filterCriteria.push({filter:{field:"date_created",comparator:"less_than_or_equal_to",value:{date:filters.end_date}}}),"shipping_method"in filters&&filterCriteria.push({filter:{field:"shipping_method",comparator:"in",value:{set:filters.shipping_method}}}),"item"in filters&&filterCriteria.push({filter:{field:"item",comparator:"in",value:{set:filters.item}}}),"order_status"in filters&&filterCriteria.push({filter:{value:{set:"pending"===filters.order_status?[Order.Re.PAID,Order.Re.UNKNOWN,Order.Re.AWAITPAY,Order.Re.PARTIALLY_FULFILLED]:[Order.Re.SHIPPED]},field:"ORDER_STATUS",comparator:"in"}}),"q"in filters&&filterCriteria.push({filter:{field:"search_text",comparator:"equal_to",value:{text:filters.q}}}),"sort_by"in filters&&filterCriteria.push({filter:{field:"sort_by",comparator:"equal_to",value:{text:filters.sort_by}}}),"order_by"in filters&&filterCriteria.push({filter:{field:"order_by",comparator:"equal_to",value:{text:filters.order_by}}}),filterCriteria}function getTabName(nonEmptyFilterValues,filters,savedTabName,filterGroups){var savedFilterGroup=filterGroups.find((function(filterGroup){return filterGroup.name===savedTabName}))||{},parsedFilters=parseFilterGroups(savedTabName,[savedFilterGroup]),cleanedFilters=Object.keys(filters).reduce((function(cleanFilters,filterName){var _a;return filters[filterName]?(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},cleanFilters),((_a={})[filterName]=filters[filterName],_a)):cleanFilters}),{});return 0===nonEmptyFilterValues.length||(0,isEqual.A)(cleanedFilters,parsedFilters)||2===nonEmptyFilterValues.length&&"desc"===filters.order_by&&"_score"===filters.sort_by?savedTabName:"new"}var getFiltersStore=function(state){return state.filters},getCurrentFilterGroups=((0,reselect_es.createSelector)(getFiltersStore,(function(filtersStore){return filtersStore.saveOrderViewModalIsOpen})),(0,reselect_es.createSelector)(getFiltersStore,(function(filtersStore){return filtersStore.deleteOrderViewModalIsOpen})),(0,reselect_es.createSelector)(getFiltersStore,(function(filtersStore){return filtersStore.showNewTab})),(0,reselect_es.createSelector)(getFiltersStore,(function(filtersStore){return filtersStore.filterGroups}))),getSelectedTab=((0,reselect_es.createSelector)(getFiltersStore,(function(filterStore){return filterStore.filterGroupsIsLoading})),(0,reselect_es.createSelector)(getQSSaved,getNotEmptyOrdersFilters,getOrderFiltersValues,getCurrentFilterGroups,(function(savedTabName,notEmptyOrdersFilters,orderFiltersValues,currentFilterGroups){return getTabName(notEmptyOrdersFilters,orderFiltersValues,savedTabName,currentFilterGroups)}))),getTempFilters=((0,reselect_es.createSelector)(getSelectedTab,(function(selectedTab){return"new"===selectedTab})),(0,reselect_es.createSelector)(getFiltersStore,(function(filtersStore){return filtersStore.tempFilterGroup})));function createFilterGroup(payload){return services_api.YZ.request({url:"orderviews/",method:"POST",headers:{"Content-Type":"application/json"},data:payload})}function filters_service_getFilterGroups(){return services_api.YZ.request({url:"orderviews/",method:"GET"})}function filters_service_deleteFilterGroup(filterGroupObjectID){return services_api.YZ.request({method:"DELETE",url:"orderviews/".concat(filterGroupObjectID,"/")})}function filters_saga_getFilterGroups(){var result,cleanedFilters,savedTabName_1,nonEmptyFilterValues,filters,parsedFilters_1,tabName;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,7,,9]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(filters_service_getFilterGroups)];case 1:return result=_a.sent(),cleanedFilters=function cleanFilterCriteria(filters){return filters.map((function(filter){var removeEmptySearchText=filter.filter_criteria.filter((function(criteria){return"SEARCH_TEXT"!==criteria.filter.field||"SEARCH_TEXT"===criteria.filter.field&&criteria.filter.value.text}));return(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},filter),{filter_criteria:removeEmptySearchText})}))}(result.data.results),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((data=cleanedFilters,{type:constants.t.FILTER_GET_FILTER_GROUPS_SUCCESS,payload:{data}}))];case 2:return _a.sent(),[4,selectState(getQSSaved)];case 3:return savedTabName_1=_a.sent(),[4,selectState(getNotEmptyOrdersFilters)];case 4:return nonEmptyFilterValues=_a.sent(),[4,selectState(getOrderFiltersValues)];case 5:return filters=_a.sent(),parsedFilters_1={},cleanedFilters.forEach((function(filterGroup){filterGroup.name===savedTabName_1&&(parsedFilters_1=parseFilterGroups(savedTabName_1,[filterGroup]))})),tabName=getTabName(nonEmptyFilterValues,filters,savedTabName_1,parsedFilters_1),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(changeTabShown(tabName))];case 6:case 8:return _a.sent(),[3,9];case 7:return _a.sent(),"There is an error that requires investigation. Please contact support.",[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(getFilterGroupsError("There is an error that requires investigation. Please contact support."))];case 9:return[2]}var data}))}(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.FILTER_SAVE_FILTER_GROUP,(function filters_saga_saveFilterGroup(action){var result,err_1,errorMessage,payload,_a,_b,_c;return(0,tslib_es6.YH)(this,(function(_d){switch(_d.label){case 0:return _d.trys.push([0,4,,7]),payload={name:action.payload.filterGroupName,filter_criteria:parseFilters(action.payload.filters)},[4,(0,redux_saga_effects_npm_proxy_esm.T1)(createFilterGroup,payload)];case 1:return result=_d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((data=result.data,{type:constants.t.FILTER_SAVE_FILTER_GROUP_SUCCESS,payload:{data}}))];case 2:return _d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,routing_actions.bJ)("saved",action.payload.filterGroupName))];case 3:case 6:return _d.sent(),[3,7];case 4:return err_1=_d.sent(),errorMessage="There is an error that requires investigation. Please contact support.",err_1.response&&(null===(_a=err_1.response)||void 0===_a?void 0:_a.data)&&(null===(_b=err_1.response)||void 0===_b?void 0:_b.data.detail)&&(errorMessage=null===(_c=err_1.response)||void 0===_c?void 0:_c.data.detail),payload={messages:[errorMessage],closeButtonText:"Close"},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(saveFilterGroupError(errorMessage))];case 5:return _d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(showDialog(payload,"error"))];case 7:return[2]}var data}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.FILTER_GET_FILTER_GROUPS,filters_saga_getFilterGroups),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.FILTER_DELETE_FILTER_GROUP,(function filters_saga_deleteFilterGroup(action){var errorMessage,payload;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,6,,9]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(filters_service_deleteFilterGroup,action.payload.filterGroupObjectID)];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(filters_saga_getFilterGroups)];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.FILTER_DELETE_FILTER_GROUP_SUCCESS})];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,routing_actions.UQ)({}))];case 4:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(changeTabShown(""))];case 5:case 8:return _a.sent(),[3,9];case 6:return _a.sent(),payload={messages:[errorMessage="There is an error that requires investigation. Please contact support."],closeButtonText:"Close"},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(deleteFilterGroupError(errorMessage))];case 7:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(showDialog(payload,"error"))];case 9:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.FILTER_CHANGE_TAB,(function filters_saga_changeTabShown(action){var filterGroups,currentFilters,filters,currentTabName,tempFilters;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,selectState(getCurrentFilterGroups)];case 1:return filterGroups=_a.sent(),[4,selectState(getOrderFiltersValues)];case 2:return currentFilters=_a.sent(),filters={},[4,selectState(getSelectedTab)];case 3:return(currentTabName=_a.sent())===action.payload.tabName?[2]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,routing_actions.UQ)({}))];case 4:return _a.sent(),["","pending","fulfilled","new"].includes(action.payload.tabName)?["pending","fulfilled"].includes(action.payload.tabName)?filters.order_status=action.payload.tabName:filters.order_status=void 0:(filters=parseFilterGroups(action.payload.tabName,filterGroups)).saved=action.payload.tabName,"new"!==action.payload.tabName?[3,7]:[4,selectState(getTempFilters)];case 5:return tempFilters=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,routing_actions.UQ)(tempFilters))];case 6:return _a.sent(),[3,14];case 7:return"new"!==currentTabName?[3,12]:Object.keys(filters).length<=1&&!filters.order_status?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.FILTER_HIDE_NEW_TAB})]:[3,9];case 8:return _a.sent(),[3,12];case 9:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(saveTempFilterGroup(currentFilters))];case 10:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.FILTER_SHOW_NEW_TAB})];case 11:_a.sent(),_a.label=12;case 12:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,routing_actions.UQ)(filters))];case 13:_a.sent(),_a.label=14;case 14:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((tabName=action.payload.tabName,{type:constants.t.FILTER_CHANGE_TAB_SUCCESS,payload:{tabName}}))];case 15:return _a.sent(),[2]}var tabName}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.FILTER_DETERMINE_TAB_NAME,(function filters_saga_determineTabName(){var savedTabName,nonEmptyFilterValues,filters,filterGroups,tabName;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,selectState(getQSSaved)];case 1:return savedTabName=_a.sent(),[4,selectState(getNotEmptyOrdersFilters)];case 2:return nonEmptyFilterValues=_a.sent(),[4,selectState(getOrderFiltersValues)];case 3:return filters=_a.sent(),[4,selectState(getCurrentFilterGroups)];case 4:return filterGroups=_a.sent(),tabName=getTabName(nonEmptyFilterValues,filters,savedTabName,filterGroups),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(changeTabShown(tabName))];case 5:return _a.sent(),[2]}}))}));function getDataLayer(){return window.dataLayer||[]}function gtm_service_sendGTMEvent(payload){getDataLayer().push((0,tslib_es6.Cl)({event:payload.eventName},payload.data))}function gtm_service_pushToGTMDataLayer(payload){getDataLayer().push(payload)}(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.SEND_GTM_EVENT,(function gtm_saga_sendGTMEvent(action){var userId,firedTime,eventName,payload,e_1,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return[4,selectState(user_selectors.F6)||-1];case 1:userId=_b.sent(),firedTime=(new Date).toISOString(),eventName=action.payload.eventName,payload={eventName:action.payload.eventName,data:(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},action.payload.data),(_a={},_a[eventName]=(0,tslib_es6.Cl)({userId,firedTime},action.payload.data),_a))},_b.label=2;case 2:return _b.trys.push([2,5,,7]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(gtm_service_sendGTMEvent,payload)];case 3:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendGTMEventSuccess(action.payload.eventName))];case 4:return _b.sent(),[3,7];case 5:return e_1=_b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendGTMEventError(action.payload.eventName,e_1.toString()))];case 6:return _b.sent(),[3,7];case 7:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.PUSH_TO_GTM_DATA_LAYER,(function gtm_saga_pushToGTMDataLayer(action){var e_2;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(gtm_service_pushToGTMDataLayer,action.payload)];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.PUSH_TO_GTM_DATA_LAYER_SUCCESS})];case 2:case 4:return _a.sent(),[3,5];case 3:return e_2=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((errorMessage=e_2.toString(),{errorMessage,type:constants.t.PUSH_TO_GTM_DATA_LAYER_ERROR}))];case 5:return[2]}var errorMessage}))}));var react_gtm_module_dist=__webpack_require__("./node_modules/react-gtm-module/dist/index.js"),User=__webpack_require__("./app/types/User.ts");function getIsImpersonateCookie(){return js_cookie.get("is_impersonate")||"false"}function isImpersonating(){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getIsImpersonateCookie)];case 1:return[2,"true"===_a.sent()]}}))}function createDataLayer(currentUser){var storedAdditionalInformation,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return storedAdditionalInformation=js_cookie.getJSON(ADDITIONAL_INFORMATION_GTM_RESULTS)||{},_a={userId:currentUser.id,userEmail:currentUser.email,userFullName:(0,User.dS)(currentUser)},[4,(0,redux_saga_effects_npm_proxy_esm.T1)(isImpersonating)];case 1:return[2,tslib_es6.Cl.apply(void 0,[tslib_es6.Cl.apply(void 0,[(_a.isImpersonating=_b.sent(),_a.revenueTierName=currentUser.revenueTierName||"5",_a.storesEnabled=[],_a.availableCarriers=[],_a.dateJoined=currentUser.dateJoined.toISOString(),_a.lifetimeVolSegmentMin=currentUser.lifetimeVolSegmentMin||0,_a.lifetimeVolSegmentMax=currentUser.lifetimeVolSegmentMax||0,_a.groupName=currentUser.groupName||"0",_a.loginUserId=currentUser.loginUserId,_a),storedAdditionalInformation]),{event:"USER_DATA_POPULATED"}])]}}))}function getGTMConfig(){var _a={id:"GTM-544FF49",dataLayer:"dataLayer",enabled:!0};return{gtmId:_a.id,dataLayerName:_a.dataLayer,auth:_a.auth,preview:_a.preview,enabled:_a.enabled}}(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.INITIALIZE_ANONYMOUS_TAG_MANAGER,(function initializeAnonymousGTM(){var anonymousGTMTriggered,gtmConfig,tagManagerArgs;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return anonymousGTMTriggered=!0,[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getGTMConfig)];case 1:if(!(gtmConfig=_a.sent()).enabled)return[2];_a.label=2;case 2:return anonymousGTMTriggered?(tagManagerArgs=(0,tslib_es6.Cl)({},gtmConfig),[4,(0,redux_saga_effects_npm_proxy_esm.T1)([react_gtm_module_dist,react_gtm_module_dist.initialize],tagManagerArgs)]):[3,4];case 3:return _a.sent(),anonymousGTMTriggered=!1,[3,2];case 4:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.USER_DID_AUTHENTICATE,(function initializeGTM(action){var currentUser,today,gtmConfig,dataLayer,tagManagerArgs;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return currentUser=action.payload.currentUser,[4,(0,redux_saga_effects_npm_proxy_esm.T1)(isImpersonating)];case 1:return _a.sent()?[3,3]:(today=new Date,[4,(0,redux_saga_effects_npm_proxy_esm.T1)(js_cookie.set,"shippo_last_seen",JSON.stringify({id:currentUser.id,lastSeen:today.toISOString().substring(0,10),revenueTierName:currentUser.revenueTierName||"5",storesEnabled:[],availableCarriers:[],dateJoined:currentUser.dateJoined.toISOString().substring(0,10),lifetimeVolSegmentMin:currentUser.lifetimeVolSegmentMin||0,lifetimeVolSegmentMax:currentUser.lifetimeVolSegmentMax||0}),{domain:".shippodev.com",expires:365})]);case 2:_a.sent(),_a.label=3;case 3:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getGTMConfig)];case 4:return(gtmConfig=_a.sent()).enabled?[4,(0,redux_saga_effects_npm_proxy_esm.T1)(createDataLayer,currentUser)]:[2];case 5:return dataLayer=_a.sent(),tagManagerArgs=(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},gtmConfig),{dataLayer}),[4,(0,redux_saga_effects_npm_proxy_esm.T1)([react_gtm_module_dist,react_gtm_module_dist.initialize],tagManagerArgs)];case 6:return _a.sent(),[2]}}))}));function buildInvoiceItemsQueryString(namespace,queryObject){return Object.entries(queryObject).reduce((function(qs,_a){var _b=(0,tslib_es6.zs)(_a,2),key=_b[0],val=_b[1];return val?"".concat(qs,"&").concat(namespace,"[").concat(key,"]=").concat(val):qs}),"")}function exportInvoiceItems(filter){return services_api.Ay.request({url:"/billing/invoicing/export",method:"POST",data:{filter:{start_date:filter.startDate,end_date:filter.endDate,is_paid:filter.isPaid,invoice_item_type:filter.invoiceItemType,shop_app:filter.shopApp,carrier_account_id:filter.carrierAccountId}}})}function searchInvoiceItems(pageNumber,pageSize,searchQuery,startDate,endDate,paymentStatus,invoiceItemType,shopApp,carrierAccountId){void 0===pageNumber&&(pageNumber=1),void 0===pageSize&&(pageSize=25),void 0===searchQuery&&(searchQuery="");var page={number:pageNumber,limit:pageSize},filtersQueryString=buildInvoiceItemsQueryString("filter",{start_date:startDate,end_date:endDate,is_paid:paymentStatus,invoice_item_type:invoiceItemType,shop_app:shopApp,carrier_account_id:carrierAccountId}),pageQueryString=buildInvoiceItemsQueryString("page",page),searchQueryString="&q=".concat(searchQuery);return services_api.Ay.request({url:"/v1/invoice_items/search?expand[]=transaction&expand[]=order&expand[]=invoice".concat(filtersQueryString).concat(pageQueryString).concat(searchQueryString),method:"GET"})}function charge(objectId){return services_api.kC.request({url:"/invoices/".concat(objectId,"/charge"),method:"PUT"})}function invoices_service_get(page,count){return services_api.kC.request({url:"/v1/invoices/",method:"GET",params:{page,results:count}})}function invoices_service_getById(invoiceId){return services_api.kC.request({url:"/v1/invoices/".concat(invoiceId),method:"GET"})}function getInvoiceItemsOfInvoice(invoiceId){return services_api.kC.request({url:"/v1/invoices/".concat(invoiceId,"/items?results=200"),method:"GET"})}var InvoiceItemType;!function(InvoiceItemType){InvoiceItemType.LABEL_PAYMENT="Label Payment",InvoiceItemType.LABEL_FAILURE="Label Failure",InvoiceItemType.LABEL_SURCHARGE="Label Surcharge",InvoiceItemType.LABEL_REFUND="Label Refund",InvoiceItemType.REBATE="Rebate",InvoiceItemType.ONE_OFF_CREDIT="One Off Credit",InvoiceItemType.LEGACY_CHARGE="Legacy Charge",InvoiceItemType.LEGACY_REFUND="Legacy Refund",InvoiceItemType.TRACK_FEE="Track Fee",InvoiceItemType.ADDRESS_VALIDATION_FEE="Address Validation Fee",InvoiceItemType.BRANDING="Branding",InvoiceItemType.MULTI_USER_LOGIN="Multi User Login",InvoiceItemType.INSURANCE_FEE="Insurance Fee",InvoiceItemType.LABEL_FEE="Label Fee",InvoiceItemType.SUBSCRIPTION_PLAN_FEE="Subscription Plan Fee",InvoiceItemType.POSTAGE_PRICE="Postage Price",InvoiceItemType.PROMO_CODE_CREDIT="Promo Code Credit",InvoiceItemType.LABEL_PRICE_TRUE_UP_CHARGE="Label Price True Up Charge",InvoiceItemType.LABEL_PRICE_TRUE_UP_REFUND="Label Price True Up Refund",InvoiceItemType.PREAUTH_CAPTURE="Preauth Capture",InvoiceItemType.LABEL_PAYMENT_ADJUSTMENT="Label payment adjustment",InvoiceItemType.LABEL_REFUND_ADJUSTMENT="Label refund adjustment"}(InvoiceItemType||(InvoiceItemType={}));var InvoiceItemTypeMap={LABEL_PAYMENT:InvoiceItemType.LABEL_PAYMENT,LABEL_FAILURE:InvoiceItemType.LABEL_FAILURE,LABEL_SURCHARGE:InvoiceItemType.LABEL_SURCHARGE,LABEL_REFUND:InvoiceItemType.LABEL_REFUND,REBATE:InvoiceItemType.REBATE,ONE_OFF_CREDIT:InvoiceItemType.ONE_OFF_CREDIT,LEGACY_CHARGE:InvoiceItemType.LEGACY_CHARGE,LEGACY_REFUND:InvoiceItemType.LEGACY_REFUND,TRACK_FEE:InvoiceItemType.TRACK_FEE,ADDRESS_VALIDATION_FEE:InvoiceItemType.ADDRESS_VALIDATION_FEE,BRANDING:InvoiceItemType.BRANDING,MULTI_USER_LOGIN:InvoiceItemType.MULTI_USER_LOGIN,INSURANCE_FEE:InvoiceItemType.INSURANCE_FEE,LABEL_FEE:InvoiceItemType.LABEL_FEE,SUBSCRIPTION_PLAN_FEE:InvoiceItemType.SUBSCRIPTION_PLAN_FEE,POSTAGE_PRICE:InvoiceItemType.POSTAGE_PRICE,PROMO_CODE_CREDIT:InvoiceItemType.PROMO_CODE_CREDIT,LABEL_PRICE_TRUE_UP_CHARGE:InvoiceItemType.LABEL_PRICE_TRUE_UP_CHARGE,LABEL_PRICE_TRUE_UP_REFUND:InvoiceItemType.LABEL_PRICE_TRUE_UP_REFUND,PREAUTH_CAPTURE:InvoiceItemType.PREAUTH_CAPTURE,LABEL_PAYMENT_ADJUSTMENT:InvoiceItemType.LABEL_PAYMENT_ADJUSTMENT,LABEL_REFUND_ADJUSTMENT:InvoiceItemType.LABEL_REFUND_ADJUSTMENT};function InvoiceItem_fromJSON(jsonInvoiceItem){var _a,_b,_c,_d,_e,_f;return{id:jsonInvoiceItem.id,objectCreated:moment_moment(jsonInvoiceItem.object_created),invoiceItemType:jsonInvoiceItem.invoice_item_type,description:jsonInvoiceItem.description,shopApp:null===(_a=jsonInvoiceItem.order)||void 0===_a?void 0:_a.shop_app,orderNumber:null===(_b=jsonInvoiceItem.order)||void 0===_b?void 0:_b.order_number,carrier:(null===(_c=jsonInvoiceItem.transaction)||void 0===_c?void 0:_c.carrier)||jsonInvoiceItem.provider_name,trackingNumber:(null===(_d=jsonInvoiceItem.transaction)||void 0===_d?void 0:_d.tracking_number)||jsonInvoiceItem.tracking_number,invoiceObjectId:null===(_e=jsonInvoiceItem.invoice)||void 0===_e?void 0:_e.object_id,invoiceNumber:null===(_f=jsonInvoiceItem.invoice)||void 0===_f?void 0:_f.number,isCredit:jsonInvoiceItem.is_credit,isPaid:jsonInvoiceItem.is_paid,amount:jsonInvoiceItem.amount,currency:jsonInvoiceItem.currency,objectPurpose:jsonInvoiceItem.object_purpose}}(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.TRANSACTIONS_INVOICE_ITEMS_EXPORT,(function invoice_items_saga_exportInvoiceItems(action){var _a,startDate,endDate,invoiceStatus,invoiceItemType,storeName,carrierAccount,csv_export,e_1;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return _b.trys.push([0,3,,5]),_a=action.payload.filter,startDate=_a.startDate,endDate=_a.endDate,invoiceStatus=_a.invoiceStatus,invoiceItemType=_a.invoiceItemType,storeName=_a.storeName,carrierAccount=_a.carrierAccount,[4,(0,redux_saga_effects_npm_proxy_esm.T1)(exportInvoiceItems,{startDate:null==startDate?void 0:startDate.toISOString(),endDate:null==endDate?void 0:endDate.toISOString(),isPaid:invoiceStatus?"PAID"===invoiceStatus.value:void 0,invoiceItemType:null==invoiceItemType?void 0:invoiceItemType.value.toString(),shopApp:null==storeName?void 0:storeName.value.toString(),carrierAccountId:null==carrierAccount?void 0:carrierAccount.value.toString()})];case 1:return csv_export=_b.sent().data.links.csv_export,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((exportURL=csv_export,{type:constants.t.TRANSACTIONS_INVOICE_ITEMS_EXPORT_SUCCESS,payload:{exportURL}}))];case 2:case 4:return _b.sent(),[3,5];case 3:return e_1=_b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((err=e_1,{type:constants.t.TRANSACTIONS_INVOICE_ITEMS_EXPORT_ERROR,payload:{err}}))];case 5:return[2]}var err,exportURL}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.TRANSACTIONS_INVOICE_ITEMS_FETCH,(function invoice_items_saga_searchInvoiceItems(action){var _a,results,count,e_2;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return _b.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(searchInvoiceItems,action.payload.pageNumber,action.payload.pageSize,action.payload.searchQuery,action.payload.startDate,action.payload.endDate,action.payload.paymentStatus,action.payload.invoiceItemType,action.payload.shopApp,action.payload.carrierAccountId)];case 1:return _a=_b.sent().data,results=_a.results,count=_a.count,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((invoiceItems=results.map(InvoiceItem_fromJSON),page=action.payload.pageNumber||1,pageCount=Math.ceil(count/(action.payload.pageSize||25)),{type:constants.t.TRANSACTIONS_INVOICE_ITEMS_FETCH_SUCCESS,payload:{invoiceItems,page,pageCount}}))];case 2:return _b.sent(),[3,5];case 3:return e_2=_b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((err=e_2,{type:constants.t.TRANSACTIONS_INVOICE_ITEMS_FETCH_ERROR,payload:{err}}))];case 4:return _b.sent(),esm_exports.Cp(e_2),[3,5];case 5:return[2]}var err,invoiceItems,page,pageCount}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.DISPLAY_INVOICE_INVOICE_ITEMS_FETCH,(function invoice_items_saga_fetchInvoiceItemsOfInvoice(action){var results,e_3;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getInvoiceItemsOfInvoice,action.payload.invoiceId)];case 1:return results=_a.sent().data.results,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((invoiceItems=results.map(InvoiceItem_fromJSON),{type:constants.t.DISPLAY_INVOICE_INVOICE_ITEMS_FETCH_SUCCESS,payload:{invoiceItems}}))];case 2:case 4:return _a.sent(),[3,5];case 3:return e_3=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((err=e_3,{type:constants.t.DISPLAY_INVOICE_INVOICE_ITEMS_FETCH_ERROR,payload:{err}}))];case 5:return[2]}var err,invoiceItems}))}));function chargeInvoiceSuccess(invoice){return{type:constants.t.INVOICE_CHARGE_SUCCESS,payload:{invoice}}}function fetchInvoiceSuccess(invoice){return{type:constants.t.INVOICE_FETCH_SUCCESS,payload:{invoice}}}function fetchInvoicesSuccess(invoices,page,numPages){return{type:constants.t.INVOICES_FETCH_SUCCESS,payload:{invoices,page,numPages}}}var Invoice=__webpack_require__("./app/types/Invoice.ts");(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.INVOICE_CHARGE,(function invoices_saga_chargeInvoice(action){var result,invoice,err_1;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,4,,6]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(charge,action.payload.objectId)];case 1:return result=_a.sent(),invoice=(0,Invoice.rS)(result.data),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(chargeInvoiceSuccess(invoice))];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.USER_UPDATE_HAS_FAILED_PAYMENT})];case 3:case 5:return _a.sent(),[3,6];case 4:return err_1=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((objectId=action.payload.objectId,err=err_1,{type:constants.t.INVOICE_CHARGE_ERROR,payload:{objectId,err}}))];case 6:return[2]}var objectId,err}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.INVOICES_FETCH,(function invoices_saga_fetchInvoices(action){var _a,page,count,result,_b,totalCount,results,parsedInvoices,numPages,err_2;return(0,tslib_es6.YH)(this,(function(_c){switch(_c.label){case 0:return _c.trys.push([0,3,,5]),_a=action.payload,page=_a.page,count=_a.count,[4,(0,redux_saga_effects_npm_proxy_esm.T1)(invoices_service_get,page,count)];case 1:return result=_c.sent(),_b=result.data,totalCount=_b.count,results=_b.results,parsedInvoices=results.map(Invoice.rS),numPages=Math.ceil(totalCount/count),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchInvoicesSuccess(parsedInvoices,page,numPages))];case 2:case 4:return _c.sent(),[3,5];case 3:return err_2=_c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((err=err_2,{type:constants.t.INVOICES_FETCH_ERROR,payload:{err}}))];case 5:return[2]}var err}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.INVOICE_FETCH,(function invoices_saga_fetchInvoice(action){var result,invoice,err_3;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(invoices_service_getById,action.payload.invoiceId)];case 1:return result=_a.sent(),invoice=(0,Invoice.rS)(result.data),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchInvoiceSuccess(invoice))];case 2:case 4:return _a.sent(),[3,5];case 3:return err_3=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((err=err_3,{type:constants.t.INVOICE_FETCH_ERROR,payload:{err}}))];case 5:return[2]}var err}))}));function fetchItem(query,page){return services_api.YZ.request({url:"/order_items",method:"GET",params:{offset:10*page,q:query,limit:10}})}(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.FETCH_ITEMS,(function getItem(action){var response,err_1;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,3]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(fetchItem,action.payload.query,action.payload.page)];case 1:return response=_a.sent(),action.callback(response.data),[3,3];case 2:return err_1=_a.sent(),action.callback(err_1),[3,3];case 3:return[2]}}))}));(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.SAVE_LABEL_SETTINGS,(function labels_settings_saga_saveLabelSettings(action){var formPayload,response,serviceLevelResponse,responsePayload;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,11,,13]),formPayload=function toJSONv2(labelSettings){var _a,_b,_c,_d,_e,_f;return{default_label_format:labelSettings.defaultLabelFormat||null,default_packing_slip_format:labelSettings.defaultPackingSlipFormat||null,is_merged_labels_packing_slips:labelSettings.isMergeLabelsAndPackingSlips,default_shipment_reference_1:labelSettings.refText1||"",default_shipment_reference_2:labelSettings.refText2||"",default_outbound_account:labelSettings.outboundServiceLevel?null===(_a=labelSettings.outboundCarrierServiceLevelAccount)||void 0===_a?void 0:_a.toString():null,default_provider:(null===(_b=labelSettings.outboundCarrierServiceLevel)||void 0===_b?void 0:_b.toString())||null,default_outbound_service_level:(null===(_c=labelSettings.outboundServiceLevel)||void 0===_c?void 0:_c.toString())||null,default_return_account:labelSettings.returnLabelServiceLevel?null===(_d=labelSettings.returnLabelCarrierAccount)||void 0===_d?void 0:_d.toString():null,default_return_provider:(null===(_e=labelSettings.returnLabelCarrier)||void 0===_e?void 0:_e.toString())||null,default_return_service_level:(null===(_f=labelSettings.returnLabelServiceLevel)||void 0===_f?void 0:_f.toString())||null,is_signature_confirmation_selected:labelSettings.isRequireSignatureConfirmation||!1,is_auto_create_return_label:labelSettings.isAutoCreateReturnLabels,is_use_order_number:labelSettings.isUseOrderNumber,label_logo_type:labelSettings.labelLogoType||null,store_policy_text:labelSettings.storePolicyText||"",packing_slip_text:labelSettings.packingSlipText||"",is_packing_slip_hide_prices:!labelSettings.packingSlipShowPrices||!1}}(action.payload.formData),[4,(0,redux_saga_effects_npm_proxy_esm.T1)([settings_service,settings_service.saveLabelSettings],formPayload)];case 1:return response=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(settings_service.saveDefaultServiceLevel,formPayload.default_outbound_service_level,formPayload.default_return_service_level)];case 2:return serviceLevelResponse=_a.sent(),formPayload.default_provider&&formPayload.default_outbound_service_level?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((defaultProvider=formPayload.default_provider,defaultServiceLevel=formPayload.default_outbound_service_level,{defaultProvider,defaultServiceLevel,type:constants.t.UPDATE_USER_DEFAULT_SERVICE_LEVEL}))]:[3,4];case 3:_a.sent(),_a.label=4;case 4:return formPayload.default_return_provider&&formPayload.default_return_service_level?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((defaultReturnProvider=formPayload.default_return_provider,defaultReturnServiceLevel=formPayload.default_return_service_level,{defaultReturnProvider,defaultReturnServiceLevel,type:constants.t.UPDATE_USER_DEFAULT_RETURN_SERVICE_LEVEL}))]:[3,6];case 5:_a.sent(),_a.label=6;case 6:return formPayload.default_outbound_service_level||formPayload.default_return_service_level?[4,(0,redux_saga_effects_npm_proxy_esm.T1)(fetchServiceLevelsByAccount)]:[3,8];case 7:_a.sent(),_a.label=8;case 8:return response.data.default_provider=serviceLevelResponse.data.default_provider,response.data.default_service_level=serviceLevelResponse.data.default_service_level,responsePayload=LabelSettings_fromJSON(response.data),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(didSaveLabel(responsePayload))];case 9:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(refreshUser())];case 10:return _a.sent(),[3,13];case 11:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(refreshUser())];case 12:return _a.sent(),[3,13];case 13:return[2]}var defaultReturnProvider,defaultReturnServiceLevel,defaultProvider,defaultServiceLevel}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.FETCH_LABEL_SETTINGS,(function labels_settings_saga_fetchLabelSettings(){var response,responsePayload;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,4]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)([settings_service,settings_service.fetchLabelSettings])];case 1:return response=_a.sent(),responsePayload=LabelSettings_fromJSON(response.data),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchLabelSettingsSuccess(responsePayload))];case 2:return _a.sent(),[3,4];case 3:return _a.sent(),[3,4];case 4:return[2]}}))}));function line_item_service_deleteLineItem(id,orderId){return services_api.YZ.request({url:"/orders/".concat(orderId,"/line_items/").concat(id),method:"DELETE"})}function line_item_service_editLineItem(id,orderId,lineItem){return services_api.YZ.request({url:"/orders/".concat(orderId,"/line_items/").concat(id),method:"PUT",data:(0,tslib_es6.Cl)({},lineItem)})}function line_item_service_createLineItem(orderObjectId,lineItemPayload){return services_api.YZ.request({url:"/orders/".concat(orderObjectId,"/line_items"),method:"POST",data:(0,tslib_es6.Cl)({},lineItemPayload)})}(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.LINE_ITEMS_DELETE,(function line_item_saga_deleteLineItem(action){var trackingReference,updatedBatchEntries,parsedBatchEntries,e_1;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:trackingReference=action.payload.trackingReference,_a.label=1;case 1:return _a.trys.push([1,11,,14]),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.De)(constants_form.aF))];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(createBatchEntriesForOrders,[action.payload.orderObjectId])];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(line_item_service_deleteLineItem,action.payload.id,action.payload.orderObjectId)];case 4:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.XD(action.payload.orderObjectId))];case 5:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(createBatchEntriesForOrders,[action.payload.orderObjectId])];case 6:return updatedBatchEntries=_a.sent(),(0,utils.A9)(trackingReference,updatedBatchEntries),parsedBatchEntries=updatedBatchEntries.data.map(OrderBatchEntry.kc),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.CK(parsedBatchEntries))];case 7:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Wj([action.payload.orderObjectId]))];case 8:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.LINE_ITEMS_DELETE_SUCCESS})];case 9:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.Wv)(constants_form.aF))];case 10:return _a.sent(),[3,14];case 11:return e_1=_a.sent(),(0,utils.dj)(trackingReference,e_1),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.uj)(constants_form.aF))];case 12:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.LINE_ITEMS_DELETE_ERROR})];case 13:return _a.sent(),[3,14];case 14:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.LINE_ITEM_CREATE,(function line_item_saga_createLineItem(action){var trackingReference,updatedBatchEntries,parsedBatchEntries,err_1;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:trackingReference=action.payload.trackingReference,_a.label=1;case 1:return _a.trys.push([1,11,,14]),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.De)(constants_form.aF))];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(createBatchEntriesForOrders,[action.payload.orderObjectId])];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(line_item_service_createLineItem,action.payload.orderObjectId,(0,LineItem.eL)(action.payload.lineItemPayload))];case 4:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.XD(action.payload.orderObjectId))];case 5:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(createBatchEntriesForOrders,[action.payload.orderObjectId])];case 6:return updatedBatchEntries=_a.sent(),(0,utils.A9)(trackingReference,updatedBatchEntries),parsedBatchEntries=updatedBatchEntries.data.map(OrderBatchEntry.kc),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.CK(parsedBatchEntries))];case 7:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Wj([action.payload.orderObjectId]))];case 8:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.Wv)(constants_form.aF))];case 9:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.LINE_ITEM_CREATE_SUCCESS})];case 10:return _a.sent(),[3,14];case 11:return err_1=_a.sent(),(0,utils.dj)(trackingReference,err_1),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.uj)(constants_form.aF))];case 12:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.LINE_ITEM_CREATE_ERROR})];case 13:return _a.sent(),[3,14];case 14:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.LINE_ITEM_EDIT,(function line_item_saga_editLineItem(action){var trackingReference,updatedBatchEntries,parsedBatchEntries,err_2;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:trackingReference=action.payload.trackingReference,_a.label=1;case 1:return _a.trys.push([1,11,,14]),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.De)(constants_form.aF))];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(createBatchEntriesForOrders,[action.payload.orderObjectId])];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(line_item_service_editLineItem,action.payload.lineItemObjectId,action.payload.orderObjectId,(0,LineItem.eL)(action.payload.lineItemPayload))];case 4:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.XD(action.payload.orderObjectId))];case 5:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(createBatchEntriesForOrders,[action.payload.orderObjectId])];case 6:return updatedBatchEntries=_a.sent(),(0,utils.A9)(trackingReference,updatedBatchEntries),parsedBatchEntries=updatedBatchEntries.data.map(OrderBatchEntry.kc),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.CK(parsedBatchEntries))];case 7:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Wj([action.payload.orderObjectId]))];case 8:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.LINE_ITEM_EDIT_SUCCESS})];case 9:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.Wv)(constants_form.aF))];case 10:return _a.sent(),[3,14];case 11:return err_2=_a.sent(),(0,utils.dj)(trackingReference,err_2),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.uj)(constants_form.aF))];case 12:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.LINE_ITEM_EDIT_ERROR})];case 13:return _a.sent(),[3,14];case 14:return[2]}}))}));function loginSuccess(next){return{type:constants.t.LOGIN_SUCCESS,payload:{next}}}function loginError(error){return{type:constants.t.LOGIN_ERROR,payload:{error}}}function resetPasswordError(error){return{type:constants.t.RESET_PASSWORD_ERROR,payload:{error}}}function verify2FAError(error){return{type:constants.t.VERIFY_2FA_ERROR,payload:{error}}}function resend2FAError(error){return{type:constants.t.RESEND_2FA_ERROR,payload:{error}}}var LoginFailures,TwoFactorMessages,djangoApi=axios_default().create({baseURL:"https://dev-qa.shippodev.com",headers:function setupBaseHeaders(envId){var baseHeaders={};return"production"===envId||(baseHeaders["X-HTTP-Request-Source"]="React-".concat(envId)),baseHeaders}("dynamic"),withCredentials:!0});function login(email,password,gRecaptchaResponse,challengeCode){return djangoApi.request({url:"/api/auth/login/",method:"POST",data:{email,password,gRecaptchaResponse,challengeCode}}).then((function(response){var _a=response.data;return{reason:_a.reason,success:_a.success}})).catch((function(error){var response=error.response;if(!response)return{};var status=response.status,_a=response.data;return{reason:_a.reason,status,success:_a.success}}))}function forgotPassword(email,gRecaptchaResponse){return djangoApi.request({url:"/api/auth/forgotpassword/",method:"POST",data:{email,gRecaptchaResponse}}).then((function(response){var status=response.status,_a=response.data;return{reason:_a.reason,status,success:_a.success}})).catch((function(error){var response=error.response;if(!response)return{};var status=response.status,_a=response.data;return{reason:_a.reason,status,success:_a.success}}))}function generate2FA(email){return djangoApi.request({url:"/api/auth/generate2fa/",method:"POST",data:{email}}).then((function(response){return{success:response.data.success}})).catch((function(error){var response=error.response;return response?{success:response.data.success}:{}}))}!function(LoginFailures){LoginFailures.INVALID_CREDS="invalid_credentials",LoginFailures.INVALID_CAPTCHA="invalid_captcha",LoginFailures.EXCESSIVE_LOGINS="login_max_attempts_exceeded",LoginFailures.EXPIRED_CODE="2fa_code_expired",LoginFailures.INVALID_CODE="2fa_invalid_code",LoginFailures.EXCESSIVE_2FA="2fa_max_attempts_exceeded",LoginFailures.CHALLENGE_2FA="requires_2fa",LoginFailures.LOGIN_FAILED="login_failed",LoginFailures.SSO_AUTHENTICATION_FAILED="unauthenticated"}(LoginFailures||(LoginFailures={})),function(TwoFactorMessages){TwoFactorMessages.RESEND_2FA_SUCCESS="resend_2FA_success"}(TwoFactorMessages||(TwoFactorMessages={}));var url=__webpack_require__("./app/utils/url.ts");(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.LOGIN_SUBMIT,(function login_saga_login(action){var _a,email,gRecaptchaResponse,next,password,response,status_1,success,reason,challengeUrl,loginUrl,error_1;return(0,tslib_es6.YH)(this,(function(_c){switch(_c.label){case 0:_a=action.payload,email=_a.email,gRecaptchaResponse=_a.gRecaptchaResponse,next=_a.next,password=_a.password,_c.label=1;case 1:return _c.trys.push([1,17,,20]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(login,email,password,gRecaptchaResponse)];case 2:return response=_c.sent(),status_1=response.status,success=response.success,reason=response.reason,success&&"success"===reason?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(loginSuccess(next))]:[3,4];case 3:return _c.sent(),[3,16];case 4:if(success||401!==status_1)return[3,14];switch(reason){case LoginFailures.CHALLENGE_2FA:return[3,5];case LoginFailures.LOGIN_FAILED:return[3,8];case LoginFailures.EXCESSIVE_LOGINS:case LoginFailures.INVALID_CAPTCHA:case LoginFailures.INVALID_CREDS:return[3,10]}return[3,13];case 5:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.VERIFY_2FA_START})];case 6:return _c.sent(),challengeUrl=next?"/challenge?next=".concat(encodeURIComponent(next)):"/challenge",[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,actions.VC)(challengeUrl))];case 7:return _c.sent(),[3,13];case 8:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(loginError(reason))];case 9:return _c.sent(),[3,13];case 10:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(loginError(reason))];case 11:return _c.sent(),loginUrl=next?"/login?next=".concat(encodeURIComponent(next)):"/login",[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,actions.VC)(loginUrl))];case 12:return _c.sent(),[3,13];case 13:return[3,16];case 14:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(loginError("Login Unsuccessful"))];case 15:_c.sent(),_c.label=16;case 16:return[3,20];case 17:return error_1=_c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(loginError(error_1))];case 18:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(esm_exports.Cp,error_1)];case 19:return _c.sent(),[3,20];case 20:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.LOGIN_SUCCESS,(function loginSuccessful(action){var next,cookieDomain;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return next=action.payload.next,cookieDomain=(0,url.K)(window.location.href),new Date<new Date("11/08/2023")?[4,(0,redux_saga_effects_npm_proxy_esm.T1)(js_cookie.set,"is_existing_user","true",{expires:90,domain:".".concat(cookieDomain)})]:[3,2];case 1:_a.sent(),_a.label=2;case 2:return next?new RegExp(/^https?:\/\//i).test(next)?(window.location.href=next,[3,5]):[3,3]:[3,6];case 3:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,actions.VC)(next))];case 4:_a.sent(),_a.label=5;case 5:return[3,8];case 6:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,actions.VC)("/"))];case 7:_a.sent(),_a.label=8;case 8:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.RESET_PASSWORD_SUBMIT,(function login_saga_resetPassword(action){var _a,email,gRecaptchaResponse,_b,reason,success,status_3,error_3;return(0,tslib_es6.YH)(this,(function(_c){switch(_c.label){case 0:_a=action.payload,email=_a.email,gRecaptchaResponse=_a.gRecaptchaResponse,_c.label=1;case 1:return _c.trys.push([1,10,,13]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(forgotPassword,email,gRecaptchaResponse)];case 2:return _b=_c.sent(),reason=_b.reason,success=_b.success,status_3=_b.status,success?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.RESET_PASSWORD_SUCCESS})]:[3,5];case 3:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,actions.VC)("/sent"))];case 4:return _c.sent(),[3,9];case 5:return success||401!==status_3?[3,7]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(resetPasswordError(reason))];case 6:return _c.sent(),[3,9];case 7:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(resetPasswordError("Error submitting reset password action"))];case 8:_c.sent(),_c.label=9;case 9:return[3,13];case 10:return error_3=_c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(resetPasswordError(error_3))];case 11:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(esm_exports.Cp,error_3)];case 12:return _c.sent(),[3,13];case 13:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.VERIFY_2FA_SUBMIT,(function loginWith2FA(action){var _a,email,challengeCode,gRecaptchaResponse,next,password,_b,reason,success,status_2,loginUrl,error_2;return(0,tslib_es6.YH)(this,(function(_d){switch(_d.label){case 0:_a=action.payload,email=_a.email,challengeCode=_a.challengeCode,gRecaptchaResponse=_a.gRecaptchaResponse,next=_a.next,password=_a.password,_d.label=1;case 1:return _d.trys.push([1,15,,18]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(login,email,password,gRecaptchaResponse,challengeCode)];case 2:return _b=_d.sent(),reason=_b.reason,success=_b.success,status_2=_b.status,success?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.VERIFY_2FA_SUCCESS})]:[3,5];case 3:return _d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(loginSuccess(next))];case 4:return _d.sent(),[3,14];case 5:if(success||401!==status_2)return[3,12];switch(reason){case LoginFailures.INVALID_CREDS:case LoginFailures.EXCESSIVE_LOGINS:return[3,6];case LoginFailures.CHALLENGE_2FA:case LoginFailures.EXCESSIVE_2FA:case LoginFailures.EXPIRED_CODE:case LoginFailures.INVALID_CAPTCHA:case LoginFailures.INVALID_CODE:return[3,9]}return[3,11];case 6:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(loginError(reason))];case 7:return _d.sent(),loginUrl=next?"/login?next=".concat(encodeURIComponent(next)):"/login",[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,actions.VC)(loginUrl))];case 8:return _d.sent(),[3,11];case 9:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(verify2FAError(reason))];case 10:return _d.sent(),[3,11];case 11:return[3,14];case 12:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(verify2FAError("Verification Unsuccessful"))];case 13:_d.sent(),_d.label=14;case 14:return[3,18];case 15:return error_2=_d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(verify2FAError(error_2))];case 16:return _d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(esm_exports.Cp,error_2)];case 17:return _d.sent(),[3,18];case 18:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.RESEND_2FA_SUBMIT,(function login_saga_generate2FA(action){var email,error_4;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,6,,9]),email=action.payload.email,[4,(0,redux_saga_effects_npm_proxy_esm.T1)(generate2FA,email)];case 1:return _a.sent().success?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((successMessage=TwoFactorMessages.RESEND_2FA_SUCCESS,{type:constants.t.RESEND_2FA_SUCCESS,payload:{successMessage}}))]:[3,3];case 2:return _a.sent(),[3,5];case 3:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(resend2FAError("Error requesting two-factor token"))];case 4:_a.sent(),_a.label=5;case 5:return[3,9];case 6:return error_4=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(resend2FAError(error_4))];case 7:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(esm_exports.Cp,error_4)];case 8:return _a.sent(),[3,9];case 9:return[2]}var successMessage}))}));function fetchManifestsGroupsError(payload){return{payload,type:constants.t.MANIFESTS_GROUPS_FETCH_ERROR}}function fetchManifestsError(payload){return{payload,type:constants.t.MANIFESTS_FETCH_ERROR}}function startManifestsPolling(manifestsToPoll){return{payload:{manifestsToPoll},type:constants.t.MANIFESTS_POLL_START}}function stopManifestsPolling(){return{type:constants.t.MANIFESTS_POLL_END}}var startOfDay=__webpack_require__("./node_modules/date-fns/esm/startOfDay/index.js"),formatRFC3339=__webpack_require__("./node_modules/date-fns/esm/formatRFC3339/index.js"),subBusinessDays=__webpack_require__("./node_modules/date-fns/esm/subBusinessDays/index.js"),endOfDay=__webpack_require__("./node_modules/date-fns/esm/endOfDay/index.js"),addBusinessDays=__webpack_require__("./node_modules/date-fns/esm/addBusinessDays/index.js"),FileSaver_min=__webpack_require__("./node_modules/file-saver/dist/FileSaver.min.js"),FileSaver_min_default=__webpack_require__.n(FileSaver_min);function getManifestGroups(dateRangeStart,dateRangeEnd,carrierObjectId){return services_api.YZ.request({method:"GET",url:"/manifests/groups/",params:{date_range_start:dateRangeStart,date_range_end:dateRangeEnd,carrier_account_object_id:carrierObjectId,is_test:!1}})}function manifests_service_generateManifest(params){var _a,_b;return services_api.kC.request({url:"v1/manifests",method:"POST",data:(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},params),{address_from:(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},params.address_from),{country:null===(_b=null===(_a=params.address_from)||void 0===_a?void 0:_a.country)||void 0===_b?void 0:_b.iso2})})})}function downloadManifestDocumentsZip(manifestID){return services_api.YZ.request({url:"/manifests/documents/".concat(manifestID),method:"GET",responseType:"arraybuffer"})}function getManifestsByObjectIds(manifestObjectIds){return services_api.YZ.request({url:"/manifests",method:"GET",params:{manifests:manifestObjectIds}})}function getManifestsByDateRange(dateRangeStart,dateRangeEnd){return services_api.YZ.request({url:"/manifests",method:"GET",params:{date_range_start:dateRangeStart,date_range_end:dateRangeEnd}})}var ManifestStatus;function ManifestFromJSON(manifestJSON){return{objectId:manifestJSON.object_id,id:manifestJSON.id,objectStatus:manifestJSON.object_status,providerToken:manifestJSON.provider,carrier:manifestJSON.carrier,documents:manifestJSON.documents,errors:manifestJSON.errors,submissionDate:new Date(manifestJSON.shipment_date),addressFrom:manifestJSON.address_from}}function ManifestServiceLevelCountsFromJSON(jsonManifestServiceLevelCounts){return{dateRangeStart:jsonManifestServiceLevelCounts.date_range_start,dateRangeEnd:jsonManifestServiceLevelCounts.date_range_end,submissionDate:jsonManifestServiceLevelCounts.submission_date,manifestableTransactionCount:jsonManifestServiceLevelCounts.manifestable_transaction_count.map((function(entry){return{count:entry.count,servicelevelName:entry.servicelevel_name}}))}}!function(ManifestStatus){ManifestStatus.QUEUED="QUEUED",ManifestStatus.SUCCESS="SUCCESS",ManifestStatus.ERROR="ERROR"}(ManifestStatus||(ManifestStatus={}));var manifests_saga_worker=null,manifestsToPoll=[];function manifestsPollWorker(manifestsToPoll){var MANIFEST_POLL_WAIT_TIME,results,manifests,manifestsInTerminalState,manifests_1,manifests_1_1,manifest,e_1,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:MANIFEST_POLL_WAIT_TIME=1e3,_b.label=1;case 1:if(!manifestsToPoll.length)return[3,11];_b.label=2;case 2:return _b.trys.push([2,8,,10]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getManifestsByObjectIds,manifestsToPoll)];case 3:if(!(results=_b.sent().data.results)||!results.length)return[3,7];manifests=results.map(ManifestFromJSON),manifestsInTerminalState=[];try{for(e_1=void 0,manifests_1=(0,tslib_es6.Ju)(manifests),manifests_1_1=manifests_1.next();!manifests_1_1.done;manifests_1_1=manifests_1.next())manifest=manifests_1_1.value,[ManifestStatus.SUCCESS,ManifestStatus.ERROR].includes(manifest.objectStatus)&&manifestsInTerminalState.push(manifest)}catch(e_1_1){e_1={error:e_1_1}}finally{try{manifests_1_1&&!manifests_1_1.done&&(_a=manifests_1.return)&&_a.call(manifests_1)}finally{if(e_1)throw e_1.error}}return manifestsInTerminalState.length?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((payload=manifestsInTerminalState,{payload,type:constants.t.MANIFESTS_FETCH_SUCCESS_TERMINAL_STATE}))]:[3,5];case 4:_b.sent(),_b.label=5;case 5:return manifestsInTerminalState.length!==manifestsToPoll.length?[3,7]:(manifestsToPoll=[],[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stopManifestsPolling())]);case 6:_b.sent(),_b.label=7;case 7:return[3,10];case 8:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stopManifestsPolling())];case 9:return _b.sent(),[3,10];case 10:return[3,13];case 11:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stopManifestsPolling())];case 12:_b.sent(),_b.label=13;case 13:return[4,(0,redux_saga_effects_npm_proxy_esm.cb)(MANIFEST_POLL_WAIT_TIME)];case 14:return _b.sent(),[3,1];case 15:return[2]}var payload}))}function manifestsPollRace(){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return 25e3,[4,(0,redux_saga_effects_npm_proxy_esm.O4)({task:(0,redux_saga_effects_npm_proxy_esm.T1)(manifestsPollWorker,manifestsToPoll),cancel:(0,redux_saga_effects_npm_proxy_esm.s)(constants.t.MANIFESTS_POLL_END),timeout:(0,redux_saga_effects_npm_proxy_esm.cb)(25e3,!0)})];case 1:return _a.sent().timeout?(manifestsToPoll=[],[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stopManifestsPolling())]):[3,3];case 2:_a.sent(),_a.label=3;case 3:return manifests_saga_worker=null,[2]}}))}(function manifestsPollWatcher(){var action;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.s)(constants.t.MANIFESTS_POLL_START)];case 1:return action=_a.sent(),manifestsToPoll=action.payload.manifestsToPoll,manifests_saga_worker?[3,3]:[4,(0,redux_saga_effects_npm_proxy_esm.Zy)(manifestsPollRace)];case 2:manifests_saga_worker=_a.sent(),_a.label=3;case 3:return[3,0];case 4:return[2]}}))})(),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.MANIFESTS_GROUPS_FETCH,(function getManifestsGroups(action){var _a,dateRangeStart,dateRangeEnd,carrierObjectId,results,err_1;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return _b.trys.push([0,3,,6]),_a=action.payload,dateRangeStart=_a.dateRangeStart,dateRangeEnd=_a.dateRangeEnd,carrierObjectId=_a.carrierObjectId,[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getManifestGroups,dateRangeStart,dateRangeEnd,carrierObjectId)];case 1:return results=_b.sent().data.results,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((jsonManifestGroups=results,payload={carrierAccount:jsonManifestGroups.carrier_account,addresses:jsonManifestGroups.addresses.map((function(jsonAddress){return(0,Address.rS)(jsonAddress)})),ranges:Object.entries(jsonManifestGroups.ranges).reduce((function(rangesMap,_a){var _b=(0,tslib_es6.zs)(_a,2),key=_b[0],jsonServiceLevelCountsList=_b[1];return rangesMap[key]=jsonServiceLevelCountsList.map(ManifestServiceLevelCountsFromJSON),rangesMap}),{})},{payload,type:constants.t.MANIFESTS_GROUPS_FETCH_SUCCESS}))];case 2:case 5:return _b.sent(),[3,6];case 3:return err_1=_b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchManifestsGroupsError(err_1))];case 4:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(esm_exports.Cp,err_1)];case 6:return[2]}var payload,jsonManifestGroups}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.MANIFESTS_FETCH,(function getRecentManifests(){var today,dateRangeStart,dateRangeEnd,results,manifests,manifestsToPoll_1,err_2;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,5,,8]),today=(0,startOfDay.default)(Date.now()),dateRangeStart=(0,formatRFC3339.A)((0,subBusinessDays.A)(today,5)),dateRangeEnd=(0,formatRFC3339.A)((0,endOfDay.default)((0,addBusinessDays.A)(today,5))),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getManifestsByDateRange,dateRangeStart,dateRangeEnd)];case 1:return results=_a.sent().data.results,manifests=results.map(ManifestFromJSON),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((payload=manifests,{payload,type:constants.t.MANIFESTS_FETCH_SUCCESS}))];case 2:return _a.sent(),(manifestsToPoll_1=manifests.filter((function(manifest){return manifest.objectStatus===ManifestStatus.QUEUED})).map((function(manifest){return manifest.objectId}))).length?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(startManifestsPolling(manifestsToPoll_1))]:[3,4];case 3:_a.sent(),_a.label=4;case 4:return[3,8];case 5:return err_2=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchManifestsError(err_2))];case 6:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(esm_exports.Cp,err_2)];case 7:return _a.sent(),[3,8];case 8:return[2]}var payload}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.MANIFESTS_DOWNLOAD_ZIP,(function downloadManifestZip(action){var response,blob,err_3;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,6]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(downloadManifestDocumentsZip,action.payload)];case 1:return response=_a.sent(),blob=new Blob([response.data],{type:"application/zip"}),FileSaver_min_default().saveAs(blob,"manifest_".concat(action.payload.toString(),".zip")),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.MANIFESTS_DOWNLOAD_ZIP_SUCCESS})];case 2:case 5:return _a.sent(),[3,6];case 3:return err_3=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.MANIFESTS_DOWNLOAD_ZIP_ERROR})];case 4:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(esm_exports.Cp,err_3)];case 6:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.MANIFESTS_GENERATE,(function manifests_saga_generateManifest(action){var trackingReference,response,err_4,errorMessage,_a,_b,_c;return(0,tslib_es6.YH)(this,(function(_d){switch(_d.label){case 0:trackingReference=action.payload.trackingReference,_d.label=1;case 1:return _d.trys.push([1,6,,8]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(manifests_service_generateManifest,action.payload)];case 2:return response=_d.sent(),(0,utils.A9)(trackingReference,response),(null===(_a=null==response?void 0:response.data)||void 0===_a?void 0:_a.object_id)?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(startManifestsPolling([response.data.object_id]))]:[3,4];case 3:_d.sent(),_d.label=4;case 4:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.MANIFESTS_GENERATE_SUCCESS})];case 5:return _d.sent(),[3,8];case 6:return err_4=_d.sent(),(0,utils.dj)(trackingReference,err_4),errorMessage="Something unexpected happened on our end.",(null===(_c=null===(_b=null==err_4?void 0:err_4.response)||void 0===_b?void 0:_b.data)||void 0===_c?void 0:_c.detail)&&(errorMessage=err_4.response.data.detail),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((payload=new Error(errorMessage),{payload,type:constants.t.MANIFESTS_GENERATE_ERROR}))];case 7:return _d.sent(),[3,8];case 8:return[2]}var payload}))}));var has=__webpack_require__("./node_modules/lodash-es/has.js");function createOrderSuccess(objectId){return{type:constants.t.MANUALORDER_SAVE_ORDER_SUCCESS,payload:{objectId}}}function manualOrderReset(){return{type:constants.t.MANUALORDER_RESET}}(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.MANUALORDER_SAVE_ORDER,(function manual_order_saga_createOrder(action){var errorMessage,objectId,trackingReference,conditionals,addresses,savedAddresses,senderAddress,returnAddress,senderAPIAddress,userReturnAddress,senderAPIAddressJSON,_a,returnAPIAddress,userAddress,returnAPIAddressJSON,response,_b,savedAddressesCount,i,address,isDefaultSender,isDefaultReturn,fromAddress,toAddress,order,savedOrder,object_id,batchEntryResponse,batchEntry,batchEntryId,returnAddressToUse,sanitizedReturnAddress,location_1,addressUpdateResponse,error_1,err,_c,_d;return(0,tslib_es6.YH)(this,(function(_e){switch(_e.label){case 0:errorMessage="",objectId="",trackingReference=action.payload.trackingReference,_e.label=1;case 1:return _e.trys.push([1,43,,49]),conditionals=action.payload.manualOrder.conditionals,addresses=action.payload.manualOrder.addresses,savedAddresses=[],senderAddress=(0,has.A)(addresses,addressBook.y9)?addresses.sender:null,returnAddress=(0,has.A)(addresses,addressBook.lj)?addresses.return:null,conditionals.saveAsDefaultSenderAddress?(errorMessage="Unable to save default sender address",senderAPIAddress=APIAddress.ZC(senderAddress),[4,selectState(user_selectors.kQ)]):[3,7];case 2:return userReturnAddress=_e.sent(),senderAPIAddress.isDefaultSender=conditionals.saveAsDefaultSenderAddress,senderAPIAddress.isDefaultReturn=conditionals.useSenderAddressAsReturn,!senderAPIAddress.isDefaultReturn&&userReturnAddress&&senderAddress&&userReturnAddress.id===senderAddress.id&&(senderAPIAddress.isDefaultReturn=userReturnAddress.isDefaultReturn),senderAPIAddressJSON=APIAddress.U2((0,Address.ko)(senderAPIAddress)),senderAddress&&void 0!==senderAddress.id?[4,(0,redux_saga_effects_npm_proxy_esm.T1)(editApiAddress,senderAddress.id,senderAPIAddressJSON)]:[3,4];case 3:return _a=_e.sent(),[3,6];case 4:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(createApiAddress,senderAPIAddressJSON)];case 5:_a=_e.sent(),_e.label=6;case 6:response=_a,address=APIAddress.rS(response.data),savedAddresses.push(address),_e.label=7;case 7:return!conditionals.saveAsDefaultReturnAddress||conditionals.useSenderAddressAsReturn?[3,15]:(errorMessage="Unable to save default return address",returnAPIAddress=APIAddress.ZC(returnAddress),conditionals.saveAsDefaultSenderAddress?(senderAddress&&returnAddress&&returnAddress.id===senderAddress.id&&(returnAPIAddress.isDefaultSender=senderAddress.isDefaultSender),[3,10]):[3,8]);case 8:return[4,selectState(user_selectors.GA)];case 9:userAddress=_e.sent(),returnAddress&&returnAddress.id===(null==userAddress?void 0:userAddress.id)&&(returnAPIAddress.isDefaultSender=null==userAddress?void 0:userAddress.isDefaultSender),_e.label=10;case 10:return returnAPIAddress.isDefaultReturn=conditionals.saveAsDefaultReturnAddress,returnAPIAddressJSON=APIAddress.U2((0,Address.ko)(returnAPIAddress)),returnAddress&&void 0!==returnAddress.id?[4,(0,redux_saga_effects_npm_proxy_esm.T1)(editApiAddress,returnAddress.id,returnAPIAddressJSON)]:[3,12];case 11:return _b=_e.sent(),[3,14];case 12:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(createApiAddress,returnAPIAddressJSON)];case 13:_b=_e.sent(),_e.label=14;case 14:response=_b,address=APIAddress.rS(response.data),savedAddresses.push(address),_e.label=15;case 15:savedAddressesCount=savedAddresses.length,i=0,_e.label=16;case 16:return i<savedAddressesCount?(address=savedAddresses[i],isDefaultSender=address.isDefaultSender,isDefaultReturn=address.isDefaultReturn,isDefaultSender?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(updateUserDefaultAddress({address}))]:[3,19]):[3,27];case 17:return _e.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("Manual Label - Saved Sender Address as Default"))];case 18:_e.sent(),_e.label=19;case 19:return isDefaultReturn?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(updateUserDefaultReturnAddress({address}))]:[3,22];case 20:return _e.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("Manual Label - Saved Return Address as Default"))];case 21:_e.sent(),_e.label=22;case 22:return senderAddress&&address.id===senderAddress.id||returnAddress&&address.id===returnAddress.id?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(address_actions.Yl({address,id:address.id,trackingReference}))]:[3,24];case 23:return _e.sent(),[3,26];case 24:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(address_actions._M({address,trackingReference}))];case 25:_e.sent(),_e.label=26;case 26:return i+=1,[3,16];case 27:return errorMessage="Unable to create order",fromAddress=(0,Address.U2)(action.payload.manualOrder.addresses.sender),toAddress=(0,Address.U2)(action.payload.manualOrder.addresses.recipient),order=(0,Order.X0)(fromAddress,toAddress),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(createOrder,order)];case 28:return savedOrder=_e.sent(),(0,utils.mq)(trackingReference,{url:savedOrder.config.url||"",isError:savedOrder.status>=300,status:savedOrder.status,message:void 0}),errorMessage="Unable to set return address of new order",object_id=savedOrder.data.object_id,[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getOrCloneBatchEntriesForOrders,[object_id],[])];case 29:return batchEntryResponse=_e.sent(),(0,utils.mq)(trackingReference,{url:batchEntryResponse.config.url||"",isError:batchEntryResponse.status>=300,status:batchEntryResponse.status,message:void 0}),batchEntry=batchEntryResponse.data,batchEntryId=batchEntry[0].id,returnAddressToUse=conditionals.useSenderAddressAsReturn?addresses.sender:addresses.return,sanitizedReturnAddress=(0,Address.ko)(returnAddressToUse),[4,selectState(getLocation)];case 30:return location_1=_e.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(updateBatchEntryAddress,sanitizedReturnAddress,addressBook.lj,[batchEntryId])];case 31:return addressUpdateResponse=_e.sent(),(0,utils.mq)(trackingReference,{url:addressUpdateResponse.config.url||"",isError:addressUpdateResponse.status>=300,status:addressUpdateResponse.status,message:void 0}),objectId=object_id,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(createOrderSuccess(objectId))];case 32:return _e.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("Manual Label - Created Manual Label"))];case 33:return _e.sent(),(null===(_c=location_1.search)||void 0===_c?void 0:_c.includes("progressMeter"))?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("Progress Meter - Create Order Completed - (Manual Label)"))]:[3,35];case 34:_e.sent(),_e.label=35;case 35:return conditionals.useSenderAddressAsReturn?[3,37]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("Manual Label - Separate Return Address"))];case 36:_e.sent(),_e.label=37;case 37:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(manualOrderReset())];case 38:return _e.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,actions.VC)("/orders/".concat(objectId)))];case 39:return _e.sent(),[4,selectState(orders_selectors.Oz)];case 40:return 0!==_e.sent()?[3,42]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendGTMEvent({eventName:"FIRST_ORDER_ADDED"}))];case 41:_e.sent(),_e.label=42;case 42:return[3,49];case 43:return error_1=_e.sent(),err=error_1,axios_default().isAxiosError(error_1)&&(0,utils.mq)(trackingReference,{url:error_1.config.url||"",isError:!0,status:(null===(_d=error_1.response)||void 0===_d?void 0:_d.status)||-1,message:error_1.message}),objectId.length>0?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(manualOrderReset())]:[3,46];case 44:return _e.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,actions.VC)("/orders/".concat(objectId)))];case 45:return _e.sent(),[3,48];case 46:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((message=errorMessage,error=err,{type:constants.t.MANUALORDER_SAVE_ORDER_FAILURE,payload:{message,error}}))];case 47:_e.sent(),"Unable to save default sender address"===errorMessage&&esm_exports.wd("Manual Label Address Error",{level:"fatal",extra:{response:err.response.data}}),_e.label=48;case 48:return[3,49];case 49:return[2]}var message,error}))}));function fetchNotificationsSuccess(payload){return{payload,type:constants.t.FETCH_NOTIFICATIONS_SUCCESS}}function updateOrderShippedEmailSettingsSuccess(orderShippedFormFields){return{type:constants.t.UPDATE_ORDER_SHIPPED_EMAIL_SETTINGS_SUCCESS,payload:{orderShippedFormFields}}}function updateOrderArrivedEmailSettingsSuccess(orderArrivedFormFields){return{type:constants.t.UPDATE_ORDER_ARRIVED_EMAIL_SETTINGS_SUCCESS,payload:{orderArrivedFormFields}}}function notifications_service_get(){return services_api.YZ.request({url:"/setting/notifications",method:"GET"})}function notifications_service_put(data){return services_api.YZ.request({data,url:"/setting/notifications",method:"PUT"})}var EmailNotifications=__webpack_require__("./app/types/EmailNotifications.ts");(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.FETCH_NOTIFICATIONS,(function fetchNotificationSetting(){var response,payload,errorData_1,error,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return _b.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(notifications_service_get)];case 1:return response=_b.sent(),payload={autoEmailNotifications:response.data.notification_configs.UNKNOWN.is_auto_email_enabled,autoDeliveredEmailNotifications:response.data.notification_configs.DELIVERED.is_auto_email_enabled,autoOrderEmailDelayMinutes:response.data.notification_configs.UNKNOWN.auto_email_delay_minutes,autoOrderEmailCustomText:response.data.notification_configs.UNKNOWN.custom_text,autoDeliveredEmailCustomText:response.data.notification_configs.DELIVERED.custom_text},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchNotificationsSuccess(payload))];case 2:case 4:return _b.sent(),[3,5];case 3:return errorData_1=_b.sent(),error=errorData_1,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((errorMessage=null===(_a=error.response)||void 0===_a?void 0:_a.data,{type:constants.t.FETCH_NOTIFICATIONS_ERROR,payload:{errorMessage}}))];case 5:return[2]}var errorMessage}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.SEND_SAMPLE_EMAIL,(function notifications_saga_sendSampleEmail(action){var sendSampleEmailByType,sendSampleEmailSuccessByType,sendSampleEmailErrorByType;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),sendSampleEmailByType=function(){return function notifications_service_sendSampleEmail(notificationType){return services_api.YZ.request({data:{notification_type:notificationType},url:"/order-notifications/send-sample",method:"POST"})}(action.notificationType)},sendSampleEmailSuccessByType=function(){return function sendSampleEmailSuccess(notificationType){return{notificationType,type:constants.t.SEND_SAMPLE_EMAIL_SUCCESS}}(action.notificationType)},[4,(0,redux_saga_effects_npm_proxy_esm.T1)(sendSampleEmailByType)];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendSampleEmailSuccessByType())];case 2:case 4:return _a.sent(),[3,5];case 3:return _a.sent(),sendSampleEmailErrorByType=function(){return function sendSampleEmailError(notificationType){return{notificationType,type:constants.t.SEND_SAMPLE_EMAIL_ERROR}}(action.notificationType)},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendSampleEmailErrorByType())];case 5:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.UPDATE_ORDER_SHIPPED_EMAIL_SETTINGS,(function notifications_saga_updateOrderShippedEmailSettings(action){var orderShippedFormFields,servicePayload,data,updatedFormFields,err_1,axiosError,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:orderShippedFormFields=action.payload.orderShippedFormFields,servicePayload={notification_configs:(0,EmailNotifications.MJ)(orderShippedFormFields)},_b.label=1;case 1:return _b.trys.push([1,5,,7]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(notifications_service_put,servicePayload)];case 2:return data=_b.sent().data,updatedFormFields=(0,EmailNotifications.$7)(data),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(updateOrderShippedEmailSettingsSuccess(updatedFormFields))];case 3:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(segment.u4,segment.sV.email_notification_changed,{email_type:"order_shipped",has_custom_text:updatedFormFields.orderShippingEmailContent.length>0,is_enabled:updatedFormFields.orderShippingEmailEnabled})];case 4:return _b.sent(),[3,7];case 5:return err_1=_b.sent(),axiosError=err_1,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((errorData=null===(_a=axiosError.response)||void 0===_a?void 0:_a.data,{type:constants.t.UPDATE_ORDER_SHIPPED_EMAIL_SETTINGS_ERROR,payload:{errorData}}))];case 6:return _b.sent(),[3,7];case 7:return[2]}var errorData}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.UPDATE_ORDER_ARRIVED_EMAIL_SETTINGS,(function notifications_saga_updateOrderArrivedEmailSettings(action){var orderArrivedFormFields,servicePayload,data,updatedFormFields,err_2,axiosError,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:orderArrivedFormFields=action.payload.orderArrivedFormFields,servicePayload={notification_configs:(0,EmailNotifications.en)(orderArrivedFormFields)},_b.label=1;case 1:return _b.trys.push([1,5,,7]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(notifications_service_put,servicePayload)];case 2:return data=_b.sent().data,updatedFormFields=(0,EmailNotifications.PW)(data),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(updateOrderArrivedEmailSettingsSuccess(updatedFormFields))];case 3:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(segment.u4,segment.sV.email_notification_changed,{email_type:"order_delivered",has_custom_text:updatedFormFields.orderArrivedEmailContent.length>0,is_enabled:updatedFormFields.orderArrivedEmailEnabled})];case 4:return _b.sent(),[3,7];case 5:return err_2=_b.sent(),axiosError=err_2,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((errorData=null===(_a=axiosError.response)||void 0===_a?void 0:_a.data,{type:constants.t.UPDATE_ORDER_ARRIVED_EMAIL_SETTINGS_ERROR,payload:{errorData}}))];case 6:return _b.sent(),[3,7];case 7:return[2]}var errorData}))}));var orders_batch_actions=__webpack_require__("./app/actions/orders-batch.actions.ts"),getNotificationsStore=function(state){return state.notifications},isAutoOrderEmailEnabled=(0,reselect_es.createSelector)(getNotificationsStore,(function(notificationsStore){return notificationsStore.isAutoOrderEmailEnabled})),rates_selectors=((0,reselect_es.createSelector)(getNotificationsStore,(function(notificationsStore){return notificationsStore.isAutoDeliveredEmailEnabled})),(0,reselect_es.createSelector)(getNotificationsStore,(function(notificationsStore){return notificationsStore.orderShippedEmailSettingSubmitSuccess})),(0,reselect_es.createSelector)(getNotificationsStore,(function(notificationsStore){return notificationsStore.orderShippedEmailSettingSubmitFailed})),(0,reselect_es.createSelector)(getNotificationsStore,(function(notificationsStore){return notificationsStore.orderArrivedEmailSettingSubmitSuccess})),(0,reselect_es.createSelector)(getNotificationsStore,(function(notificationsStore){return notificationsStore.orderArrivedEmailSettingSubmitFailed})),(0,reselect_es.createSelector)(getNotificationsStore,(function(notificationsStore){return notificationsStore.autoOrderEmailDelayMinutes})),(0,reselect_es.createSelector)(getNotificationsStore,(function(notificationsStore){return notificationsStore.isLoadingNotifications})),(0,reselect_es.createSelector)(getNotificationsStore,(function(notificationsStore){return notificationsStore.autoOrderEmailCustomText})),(0,reselect_es.createSelector)(getNotificationsStore,(function(notificationsStore){return notificationsStore.autoDeliveredEmailCustomText})),(0,reselect_es.createSelector)(getNotificationsStore,(function(notificationsStore){return notificationsStore.sendingSampleShippedEmail})),(0,reselect_es.createSelector)(getNotificationsStore,(function(notificationsStore){return notificationsStore.sampleShippedEmailSent})),(0,reselect_es.createSelector)(getNotificationsStore,(function(notificationsStore){return notificationsStore.sampleShippedEmailFailed})),(0,reselect_es.createSelector)(getNotificationsStore,(function(notificationsStore){return notificationsStore.sendingSampleDeliveredEmail})),(0,reselect_es.createSelector)(getNotificationsStore,(function(notificationsStore){return notificationsStore.sampleDeliveredEmailSent})),(0,reselect_es.createSelector)(getNotificationsStore,(function(notificationsStore){return notificationsStore.sampleDeliveredEmailFailed})),__webpack_require__("./app/selectors/rates.selectors.ts")),transactions_selectors=__webpack_require__("./app/selectors/transactions.selectors.ts");function batchWorker(batchId,trackingReference){var batchShipments,batchEntries,batchTransactionsData,response,payload;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,selectState(orders_batch_selectors.mK)];case 1:return batchShipments=_a.sent(),[4,selectState(orders_batch_selectors.tF)];case 2:return batchEntries=_a.sent(),[4,selectState(orders_batch_selectors.EL)];case 3:batchTransactionsData=_a.sent(),_a.label=4;case 4:return _a.trys.push([4,8,,10]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getBatch,batchId)];case 5:return response=_a.sent(),payload={batch:OrdersBatch.rS(response.data),currentShipments:batchShipments.data,currentBatchEntries:batchEntries.data,currentTransactions:batchTransactionsData,trackingReference},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.nv(payload))];case 6:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.cb)(500)];case 7:return _a.sent(),[3,10];case 8:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.s5())];case 9:return _a.sent(),[3,10];case 10:return[3,0];case 11:return[2]}}))}(function batchWatcher(){var action;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.s)(constants.t.ORDERS_BATCH_POLL_START)];case 1:return action=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.O4)({task:(0,redux_saga_effects_npm_proxy_esm.T1)(batchWorker,action.payload.batchId,action.payload.trackingReference),cancel:(0,redux_saga_effects_npm_proxy_esm.s)([constants.t.ORDERS_BATCH_POLL_END,constants.t.ORDERS_BATCH_CLEAN_UP]),timeout:(0,redux_saga_effects_npm_proxy_esm.cb)(12e4,!0)})];case 2:return _a.sent().timeout?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.cJ())]:[3,4];case 3:_a.sent(),_a.label=4;case 4:return[3,0];case 5:return[2]}}))})(),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_BATCH_FETCH_SUCCESS,(function fetchBatchOrdersData(action){var wasOrdersFetchTriggered,ordersFetched,batchOrders,storedOrders,batchEntriesByOrderObjectId,batchOrders_1,batchOrders_1_1,batchOrder,batchEntry,e_1_1,e_1,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return[4,selectState(orders_batch_selectors.qe)];case 1:return wasOrdersFetchTriggered=_b.sent(),ordersFetched=[],wasOrdersFetchTriggered?[2]:(batchOrders=action.payload.batch.orders,[4,selectState(orders_selectors.Sv)]);case 2:storedOrders=_b.sent(),batchEntriesByOrderObjectId=action.payload.batch.batchEntries.reduce((function(hashMap,batchEntry){var _a;return(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},hashMap),((_a={})[batchEntry.orderObjectId]=batchEntry,_a))}),{}),_b.label=3;case 3:_b.trys.push([3,8,9,10]),batchOrders_1=(0,tslib_es6.Ju)(batchOrders),batchOrders_1_1=batchOrders_1.next(),_b.label=4;case 4:return batchOrders_1_1.done?[3,7]:(batchOrder=batchOrders_1_1.value,batchEntry=batchEntriesByOrderObjectId[batchOrder.objectId],storedOrders[batchOrder.objectId]||batchEntry.objectStatus===OrdersBatch.DO.EXCLUDED_ORDER?[3,6]:(ordersFetched.push(batchOrder.objectId),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.XD(batchOrder.objectId))]));case 5:_b.sent(),_b.label=6;case 6:return batchOrders_1_1=batchOrders_1.next(),[3,4];case 7:return[3,10];case 8:return e_1_1=_b.sent(),e_1={error:e_1_1},[3,10];case 9:try{batchOrders_1_1&&!batchOrders_1_1.done&&(_a=batchOrders_1.return)&&_a.call(batchOrders_1)}finally{if(e_1)throw e_1.error}return[7];case 10:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.$z(ordersFetched))];case 11:return _b.sent(),[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_BATCH_FETCH_SUCCESS,(function fetchBatchOrderLabels(action){var _a,currentTransactions,trackingReference,batch,currentBatchStep,allTransactionsNew,transactionsToFetch,_b,_c,transaction,orderObjectId,e_4_1,hasSingleTransactionError,outboundGroupIsCompleted,returnGroupIsCompleted,isOldExpChosen,isSidePanelCheckout,batchEntryData,transactionObjects,anyQueuedReturnLabelTransaction,hasAutomatedEmailNotifications,hasMergedDocuments,status_1,transactionIds,successFullTransactionCount,isFirstLabelPurchase,selectedRates,rateIds,e_4,_d;return(0,tslib_es6.YH)(this,(function(_e){switch(_e.label){case 0:return _a=action.payload,currentTransactions=_a.currentTransactions,trackingReference=_a.trackingReference,batch=_a.batch,[4,selectState(orders_batch_selectors.eS)];case 1:if((currentBatchStep=_e.sent())!==OrdersBatch.kG.ORDERS_PAGE&&currentBatchStep!==OrdersBatch.kG.LABELS)return[2];allTransactionsNew=(0,list.fL)(batch.transactions),transactionsToFetch=function(_a){var currentTransactions=_a.currentTransactions,allTransactionsNew=_a.allTransactionsNew;return Object.keys(allTransactionsNew).reduce((function(list,objectId){var newTransaction=allTransactionsNew[objectId],currentTransaction=currentTransactions[objectId];return currentTransaction&&currentTransaction.objectStatus===newTransaction.objectStatus&&newTransaction.objectStatus!==Transaction.x8.ERROR&&newTransaction.objectStatus!==Transaction.x8.QUEUED||list.push(newTransaction),list}),[])}({currentTransactions,allTransactionsNew}),_e.label=2;case 2:_e.trys.push([2,10,11,12]),_b=(0,tslib_es6.Ju)(transactionsToFetch),_c=_b.next(),_e.label=3;case 3:return _c.done?[3,9]:(transaction=_c.value,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((transactionId=transaction.objectId,{type:constants.t.FETCH_TRANSACTION,payload:{transactionId}}))]);case 4:return _e.sent(),currentBatchStep!==OrdersBatch.kG.ORDERS_PAGE||transaction.objectStatus===Transaction.x8.QUEUED?[3,8]:[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(batch_entry_selectors.EG,{batchEntryId:transaction.batchEntryId})];case 5:return(orderObjectId=_e.sent())?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.XD(orderObjectId))]:[3,8];case 6:return _e.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.NS(orderObjectId))];case 7:_e.sent(),_e.label=8;case 8:return _c=_b.next(),[3,3];case 9:return[3,12];case 10:return e_4_1=_e.sent(),e_4={error:e_4_1},[3,12];case 11:try{_c&&!_c.done&&(_d=_b.return)&&_d.call(_b)}finally{if(e_4)throw e_4.error}return[7];case 12:return hasSingleTransactionError=1===transactionsToFetch.length&&transactionsToFetch[0].objectStatus===Transaction.x8.ERROR,outboundGroupIsCompleted=batch.transactionGroupStatus===OrdersBatch.ag.COMPLETE,returnGroupIsCompleted=batch.returnTransactionGroupStatus===OrdersBatch.ag.NOT_APPLICABLE||batch.returnTransactionGroupStatus===OrdersBatch.ag.COMPLETE,[4,selectState(getIsOldExpChosen)];case 13:return isOldExpChosen=_e.sent(),[4,selectState(orders_selectors.kA)];case 14:return isSidePanelCheckout=_e.sent(),[4,selectState(batch_entry_selectors.zo)];case 15:return batchEntryData=_e.sent(),[4,selectState(transactions_selectors.M_)];case 16:return transactionObjects=_e.sent(),anyQueuedReturnLabelTransaction=function(transactions,batchEntries){var batchEntriesMap=(0,list.eZ)(batchEntries);return transactions.some((function(transaction){var batchEntry=batchEntriesMap[null==transaction?void 0:transaction.batchEntryId];return batchEntry&&(null==batchEntry?void 0:batchEntry.isReturn)&&(null==transaction?void 0:transaction.objectStatus)===Transaction.x8.QUEUED}))}(transactionsToFetch,null==batch?void 0:batch.batchEntries),outboundGroupIsCompleted&&returnGroupIsCompleted&&!anyQueuedReturnLabelTransaction?isOldExpChosen||hasSingleTransactionError?[3,29]:[4,selectState(isAutoOrderEmailEnabled)]:[3,35];case 17:return hasAutomatedEmailNotifications=_e.sent(),[4,selectState(user_selectors.DJ)];case 18:return hasMergedDocuments=_e.sent(),trackingReference&&transactionsToFetch.length>0?(status_1=function(transactions){return transactions.length?transactions.every((function(t){return t.objectStatus===transactions[0].objectStatus}))?transactions[0].objectStatus:"mixed":"none"}(transactionsToFetch),transactionIds=transactionsToFetch.map((function(t){return t.objectId})),rateIds=transactionIds?function(transactionObjects,transactionIds){return transactionIds.reduce((function(rateIds,transactionId){return transactionObjects[transactionId]?(0,tslib_es6.fX)([transactionObjects[transactionId].rate],(0,tslib_es6.zs)(rateIds),!1):rateIds}),[])}(transactionObjects,transactionIds):[],[4,selectState(transactions_selectors.B3)]):[3,27];case 19:return successFullTransactionCount=_e.sent(),(isFirstLabelPurchase=0===successFullTransactionCount)?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((count=1,{type:constants.t.UPDATE_SUCCESSFUL_TRANSACTIONS_COUNT,payload:{count}}))]:[3,21];case 20:_e.sent(),_e.label=21;case 21:return transactionIds.length>0&&(0,utils.TO)(trackingReference,types.MX.operations.TRANSACTION_COMPLETED,{transactionIds,rateIds,status:status_1,isFirstLabelPurchase}),function(transactions){return!!transactions.length&&transactions.some((function(t){return Transaction.x8.ERROR===t.objectStatus}))}(transactionsToFetch)?isSidePanelCheckout?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Ep(hasAutomatedEmailNotifications,hasMergedDocuments))]:[3,23]:[3,24];case 22:_e.sent(),_e.label=23;case 23:return[3,26];case 24:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.BX(hasAutomatedEmailNotifications,hasMergedDocuments))];case 25:_e.sent(),_e.label=26;case 26:return[3,29];case 27:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.BX(hasAutomatedEmailNotifications,hasMergedDocuments))];case 28:_e.sent(),_e.label=29;case 29:return isOldExpChosen||!hasSingleTransactionError?[3,33]:isSidePanelCheckout?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Ep())]:[3,31];case 30:_e.sent(),_e.label=31;case 31:return trackingReference?[4,selectState(rates_selectors.rD)]:[3,33];case 32:selectedRates=_e.sent(),rateIds=function(trackingReference,selectedRates,batchEntryData){if(!trackingReference.trackedOrderDetailsByShipment)return[];var batchEntryIds=Object.keys(trackingReference.trackedOrderDetailsByShipment);return batchEntryIds?batchEntryIds.map((function(id){return selectedRates[batchEntryData[id].shipmentObjectId]})):[]}(trackingReference,selectedRates,batchEntryData),(0,utils.TO)(trackingReference,types.MX.operations.SAVE_ATTEMPTED,{rateIds}),_e.label=33;case 33:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.K9())];case 34:_e.sent(),_e.label=35;case 35:return[2]}var count,transactionId}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_BATCH_FETCH_SUCCESS,(function fetchOrderShipmentRates(action){var currentBatchStep,newBatch,currentShipments,allShipmentsNew,shipmentsToFetch,_a,_b,e_2_1,shipmentsToFetch_1,shipmentsToFetch_1_1,objectId,trackingReference,e_3_1,e_2,_c,e_3,_d;return(0,tslib_es6.YH)(this,(function(_e){switch(_e.label){case 0:return[4,selectState(orders_batch_selectors.eS)];case 1:if(currentBatchStep=_e.sent(),newBatch=action.payload.batch,currentShipments=action.payload.currentShipments,allShipmentsNew=(0,list.fL)(newBatch.shipments),shipmentsToFetch=[],currentBatchStep!==OrdersBatch.kG.LABELS||0!==Object.keys(currentShipments).length||newBatch.shipmentGroupStatus!==OrdersBatch.ag.COMPLETE)return[3,9];_e.label=2;case 2:_e.trys.push([2,7,8,9]),_a=(0,tslib_es6.Ju)(Object.keys(allShipmentsNew)),_b=_a.next(),_e.label=3;case 3:return _b.done?[3,6]:(objectId=_b.value,trackingReference=TrackingHelper.U.getTrackingReference(types.Fd.name,"other",{rateIds:void 0}),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchShipment(objectId,trackingReference))]);case 4:_e.sent(),_e.label=5;case 5:return _b=_a.next(),[3,3];case 6:return[3,9];case 7:return e_2_1=_e.sent(),e_2={error:e_2_1},[3,9];case 8:try{_b&&!_b.done&&(_c=_a.return)&&_c.call(_a)}finally{if(e_2)throw e_2.error}return[7];case 9:if(currentBatchStep!==OrdersBatch.kG.RATES)return[2];shipmentsToFetch=0===Object.keys(currentShipments).length||newBatch.shipmentGroupStatus===OrdersBatch.ag.COMPLETE?Object.keys(allShipmentsNew):Object.keys(currentShipments).reduce((function(shipmentsList,currentShipmentKey){var shipment=currentShipments[currentShipmentKey],newShipment=allShipmentsNew[currentShipmentKey];return newShipment&&shipment.numRates!==newShipment.numRates?(0,tslib_es6.fX)((0,tslib_es6.fX)([],(0,tslib_es6.zs)(shipmentsList),!1),[newShipment.objectId],!1):shipmentsList}),[]),_e.label=10;case 10:_e.trys.push([10,15,16,17]),shipmentsToFetch_1=(0,tslib_es6.Ju)(shipmentsToFetch),shipmentsToFetch_1_1=shipmentsToFetch_1.next(),_e.label=11;case 11:return shipmentsToFetch_1_1.done?[3,14]:(objectId=shipmentsToFetch_1_1.value,trackingReference=TrackingHelper.U.getTrackingReference(types.Fd.name,"other",{rateIds:void 0}),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchShipment(objectId,trackingReference))]);case 12:_e.sent(),_e.label=13;case 13:return shipmentsToFetch_1_1=shipmentsToFetch_1.next(),[3,11];case 14:return[3,17];case 15:return e_3_1=_e.sent(),e_3={error:e_3_1},[3,17];case 16:try{shipmentsToFetch_1_1&&!shipmentsToFetch_1_1.done&&(_d=shipmentsToFetch_1.return)&&_d.call(shipmentsToFetch_1)}finally{if(e_3)throw e_3.error}return[7];case 17:return newBatch.shipmentGroupStatus!==OrdersBatch.ag.COMPLETE?[3,19]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.K9())];case 18:_e.sent(),_e.label=19;case 19:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_BATCH_FETCH_SUCCESS,(function fetchOrdersErrors(action){var currentBatchEntriesList,newBatchEntries,batchEntriesToFetch,batchEntriesToFetch_1,batchEntriesToFetch_1_1,batchEntry,e_5_1,e_5,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:currentBatchEntriesList=Object.values(action.payload.currentBatchEntries||{}),newBatchEntries=(0,list.eZ)(action.payload.batch.batchEntries),batchEntriesToFetch=[],batchEntriesToFetch=0===currentBatchEntriesList.length?Object.values(newBatchEntries).filter(OrdersBatch.Wq):currentBatchEntriesList.reduce((function(list,batchEntry){var newBatchEntry=newBatchEntries[batchEntry.id];return batchEntry.objectStatus!==newBatchEntry.objectStatus&&OrdersBatch.Wq(newBatchEntry)?(0,tslib_es6.fX)((0,tslib_es6.fX)([],(0,tslib_es6.zs)(list),!1),[newBatchEntry],!1):list}),[]),_b.label=1;case 1:_b.trys.push([1,6,7,8]),batchEntriesToFetch_1=(0,tslib_es6.Ju)(batchEntriesToFetch),batchEntriesToFetch_1_1=batchEntriesToFetch_1.next(),_b.label=2;case 2:return batchEntriesToFetch_1_1.done?[3,5]:(batchEntry=batchEntriesToFetch_1_1.value,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.XD(batchEntry.orderObjectId))]);case 3:_b.sent(),_b.label=4;case 4:return batchEntriesToFetch_1_1=batchEntriesToFetch_1.next(),[3,2];case 5:return[3,8];case 6:return e_5_1=_b.sent(),e_5={error:e_5_1},[3,8];case 7:try{batchEntriesToFetch_1_1&&!batchEntriesToFetch_1_1.done&&(_a=batchEntriesToFetch_1.return)&&_a.call(batchEntriesToFetch_1)}finally{if(e_5)throw e_5.error}return[7];case 8:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_BATCH_FETCH,(function fetchBatch(action){var batchId,response,payload;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),batchId=action.batchId,[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getBatch,batchId)];case 1:return response=_a.sent(),payload={batch:OrdersBatch.rS(response.data),currentBatchEntries:{}},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.nv(payload))];case 2:case 4:return _a.sent(),[3,5];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.s5())];case 5:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_BATCH_SAVE_PACKAGE_INFORMATION,(function savePackageInformation(action){var packageInformation,path_1,pathWithoutTrailingSlashes;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,5,,7]),packageInformation=OrdersBatch.$N(action.payload.shipmentGenerationRequest),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(saveBatchPackageInformation,action.payload.batchId,packageInformation)];case 1:return _a.sent(),[4,selectState(getPathname)];case 2:return path_1=_a.sent(),pathWithoutTrailingSlashes=path_1.split("").filter((function(char,index){return!("/"===char&&index===path_1.length-1)})).join(""),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.rJ())];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,actions.VC)({pathname:"".concat(pathWithoutTrailingSlashes,"/rates")}))];case 4:case 6:return _a.sent(),[3,7];case 5:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.iu())];case 7:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_BATCH_ENTRY_REGENERATE,(function orders_batch_saga_regenerateBatchEntry(action){var currentBatchStep,packageInformation;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,8,,10]),[4,selectState(orders_batch_selectors.eS)];case 1:return currentBatchStep=_a.sent(),packageInformation=OrdersBatch.$N(action.payload.shipmentGenerationRequest),currentBatchStep!==OrdersBatch.kG.RATES?[2]:[4,(0,redux_saga_effects_npm_proxy_esm.T1)(regenerateBatchEntry,action.payload.batchId,action.payload.batchEntryId,packageInformation)];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.ns(action.payload.batchId))];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.so(action.payload.batchEntryId))];case 4:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.XD(action.payload.orderObjectId))];case 5:return _a.sent(),action.payload.shipmentId?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.os(action.payload.shipmentId))]:[3,7];case 6:_a.sent(),_a.label=7;case 7:return[3,10];case 8:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.bk())];case 9:return _a.sent(),[3,10];case 10:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_BATCH_CREATE_TRANSACTIONS,(function createTransactions(action){var trackingReference,excludedOrders,ignoredOrders,currentBatchStep,isOldX,excludedAndIgnoredOrders,result,fullpath,splitpath,path,batchId,err_5,errorMessage,isOldExpChosen;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:trackingReference=action.payload.trackingReference,_a.label=1;case 1:return _a.trys.push([1,15,,28]),[4,selectState(orders_batch_selectors.HJ)];case 2:return excludedOrders=_a.sent(),[4,selectState(orders_batch_selectors.e4)];case 3:return ignoredOrders=_a.sent(),[4,selectState(getIsOldExpChosen)];case 4:return isOldExpChosen=_a.sent(),[4,selectState(orders_batch_selectors.eS)];case 5:return currentBatchStep=_a.sent(),isOldX=isOldExpChosen||!isOldExpChosen&&currentBatchStep!==OrdersBatch.kG.ORDERS_PAGE,excludedAndIgnoredOrders=isOldX?(0,tslib_es6.fX)((0,tslib_es6.fX)([],(0,tslib_es6.zs)(excludedOrders),!1),(0,tslib_es6.zs)(ignoredOrders),!1):[],[4,(0,redux_saga_effects_npm_proxy_esm.T1)(createBatchTransactions,action.payload.batchId,action.payload.rates,excludedAndIgnoredOrders)];case 6:return result=_a.sent(),(0,utils.A9)(trackingReference,result),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.BM(null==result?void 0:result.data.remaining_labels_until_limit,null==result?void 0:result.data.label_limit_renewal_date))];case 7:return _a.sent(),[4,selectState(getPathname)];case 8:return fullpath=_a.sent(),splitpath=fullpath.split("/"),path=splitpath.splice(0,splitpath.length-1).join("/"),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.ZA(action.payload.rates.length))];case 9:return _a.sent(),isOldX?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,actions.VC)({pathname:"".concat(path,"/labels")}))]:[3,11];case 10:return _a.sent(),[3,14];case 11:return[4,selectState(orders_batch_selectors.M1)];case 12:return batchId=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.ns(batchId,trackingReference))];case 13:_a.sent(),_a.label=14;case 14:return[3,28];case 15:return(err_5=_a.sent()).response&&err_5.response.data&&err_5.response.data.remaining_labels_until_limit?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.BM(err_5.response.data.remaining_labels_until_limit,err_5.response.data.label_limit_renewal_date))]:[3,17];case 16:_a.sent(),_a.label=17;case 17:return axios_default().isAxiosError(err_5)&&err_5.response&&(0,utils.mq)(trackingReference,{url:err_5.config.url||"",isError:err_5.response.status>300,status:err_5.response.status,message:(0,utils.w$)(err_5)||void 0}),err_5.response&&err_5.response.data&&err_5.response.data.detail?(errorMessage=err_5.response.data.detail,[4,selectState(getIsOldExpChosen)]):[3,23];case 18:return(isOldExpChosen=_a.sent())?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(showDialog({messages:[errorMessage],title:"Something went wrong",closeButtonText:"Close"},"error"))]:[3,20];case 19:return _a.sent(),[3,22];case 20:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions._S(errorMessage))];case 21:_a.sent(),_a.label=22;case 22:return[3,27];case 23:return err_5.response&&err_5.response.data&&err_5.response.data.remaining_labels_until_limit&&!err_5.response.data.detail?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions._S("You have exceeded the monthly label limit for your plan."))]:[3,25];case 24:return _a.sent(),[3,27];case 25:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions._S("We hit an unexpected error. Please try again."))];case 26:_a.sent(),_a.label=27;case 27:return[3,28];case 28:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_BATCH_POLL_END,(function generatePackingSlips(){var currentBatchStep,batchStore,batchOrders,remainingOrders,allOrders_1,orderObjectIDs,batchEntryIDs,orderObjectIDsForLabels,response,_a,_b;return(0,tslib_es6.YH)(this,(function(_c){switch(_c.label){case 0:return _c.trys.push([0,7,,9]),[4,selectState(orders_batch_selectors.eS)];case 1:return(currentBatchStep=_c.sent())!==OrdersBatch.kG.ORDERS_PAGE&&currentBatchStep!==OrdersBatch.kG.LABELS?[2]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.E3())];case 2:return _c.sent(),[4,selectState(orders_batch_selectors._J)];case 3:return batchStore=_c.sent(),batchOrders=null===(_a=null==batchStore?void 0:batchStore.batchEntries)||void 0===_a?void 0:_a.byOrderObjectId,[4,selectState(orders_selectors.Z)];case 4:return remainingOrders=_c.sent(),allOrders_1=Object.keys(remainingOrders).length?(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},remainingOrders),batchOrders):batchOrders,orderObjectIDs=Object.keys(allOrders_1),batchEntryIDs=orderObjectIDs.reduce((function(accum,orderObjectID){return(0,tslib_es6.fX)((0,tslib_es6.fX)([],(0,tslib_es6.zs)(accum),!1),(0,tslib_es6.zs)(allOrders_1[orderObjectID]),!1)}),[]),orderObjectIDsForLabels=orderObjectIDs.filter((function(orderObjectID){return!allOrders_1[orderObjectID]||0===allOrders_1[orderObjectID].length})),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getOrderPackingSlip,orderObjectIDsForLabels,batchEntryIDs)];case 5:return response=_c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.HW({slipUrl:null===(_b=null==response?void 0:response.data)||void 0===_b?void 0:_b.slip_url}))];case 6:case 8:return _c.sent(),[3,9];case 7:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.Uk("We hit an unexpected error. Please try again."))];case 9:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_BATCH_POLL_END,(function generateAllLabels(){var currentBatchStep,batchStore,batchOrders,remainingOrders,allOrders_2,orderObjectIDs,batchEntryIDs,response,err_7,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return _b.trys.push([0,7,,12]),[4,selectState(orders_batch_selectors.eS)];case 1:return(currentBatchStep=_b.sent())!==OrdersBatch.kG.ORDERS_PAGE&&currentBatchStep!==OrdersBatch.kG.LABELS?[2]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.YG())];case 2:return _b.sent(),[4,selectState(orders_batch_selectors._J)];case 3:return batchStore=_b.sent(),batchOrders=null===(_a=null==batchStore?void 0:batchStore.batchEntries)||void 0===_a?void 0:_a.byOrderObjectId,[4,selectState(orders_selectors.Z)];case 4:return remainingOrders=_b.sent(),allOrders_2=Object.keys(remainingOrders).length?(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},remainingOrders),batchOrders):batchOrders,orderObjectIDs=Object.keys(allOrders_2),batchEntryIDs=orderObjectIDs.reduce((function(accum,orderObjectID){return(0,tslib_es6.fX)((0,tslib_es6.fX)([],(0,tslib_es6.zs)(accum),!1),(0,tslib_es6.zs)(allOrders_2[orderObjectID]),!1)}),[]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getAllLabels,orderObjectIDs,batchEntryIDs)];case 5:return response=_b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.J({labelsUrl:response.data.url}))];case 6:return _b.sent(),[3,12];case 7:return(err_7=_b.sent()).response&&err_7.response.data?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.Ud(err_7.response.data))]:[3,9];case 8:return _b.sent(),[3,11];case 9:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.Ud("We hit an unexpected error. Please try again."))];case 10:_b.sent(),_b.label=11;case 11:return[3,12];case 12:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_BATCH_CHANGE_ALL_RATES,(function changeAllRates(action){var rates,ratesWithSelectedServiceLevel,excludedOrdersIds,excludedOrdersIdsMap,ratesWithSelectedServiceLevel_1,ratesWithSelectedServiceLevel_1_1,rate,batchEntry,orderSelection,trackingReference,e_7_1,e_7,_a,_b;return(0,tslib_es6.YH)(this,(function(_c){switch(_c.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(rates_selectors.aT)];case 1:return rates=_c.sent(),ratesWithSelectedServiceLevel=Object.values(rates).filter((function(rate){return rate.servicelevel.token===action.payload.serviceLevelToken})),[4,selectState(orders_batch_selectors.HJ)];case 2:excludedOrdersIds=_c.sent(),excludedOrdersIdsMap=excludedOrdersIds.reduce((function(hashMap,orderId){var _a;return(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},hashMap),((_a={})[orderId]=!0,_a))}),{}),_c.label=3;case 3:_c.trys.push([3,9,10,11]),ratesWithSelectedServiceLevel_1=(0,tslib_es6.Ju)(ratesWithSelectedServiceLevel),ratesWithSelectedServiceLevel_1_1=ratesWithSelectedServiceLevel_1.next(),_c.label=4;case 4:return ratesWithSelectedServiceLevel_1_1.done?[3,8]:(rate=ratesWithSelectedServiceLevel_1_1.value,[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(orders_batch_selectors.d,{shipmentObjectId:rate.shipment})]);case 5:return batchEntry=_c.sent(),excludedOrdersIdsMap[batchEntry.orderObjectId]?[3,7]:((_b={})[batchEntry.orderObjectId]=[batchEntry.id],orderSelection=_b,trackingReference=TrackingHelper.U.getTrackingReference(types.Fd.name,"order_table",{rateIds:[rate.objectId]}),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(selectRate(rate.shipment,rate.objectId,!0,trackingReference,orderSelection,action.payload.serviceLevelToken))]);case 6:_c.sent(),_c.label=7;case 7:return ratesWithSelectedServiceLevel_1_1=ratesWithSelectedServiceLevel_1.next(),[3,4];case 8:return[3,11];case 9:return e_7_1=_c.sent(),e_7={error:e_7_1},[3,11];case 10:try{ratesWithSelectedServiceLevel_1_1&&!ratesWithSelectedServiceLevel_1_1.done&&(_a=ratesWithSelectedServiceLevel_1.return)&&_a.call(ratesWithSelectedServiceLevel_1)}finally{if(e_7)throw e_7.error}return[7];case 11:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_BATCH_FETCH_INVALID_ORDERS,(function fetchInvalidBatchEntries(){var invalidOrders,invalidOrders_1,invalidOrders_1_1,order,e_6_1,e_6,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return[4,selectState(orders_batch_selectors.HL)];case 1:invalidOrders=_b.sent(),_b.label=2;case 2:_b.trys.push([2,7,8,9]),invalidOrders_1=(0,tslib_es6.Ju)(invalidOrders),invalidOrders_1_1=invalidOrders_1.next(),_b.label=3;case 3:return invalidOrders_1_1.done?[3,6]:(order=invalidOrders_1_1.value,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.XD(order.objectId))]);case 4:_b.sent(),_b.label=5;case 5:return invalidOrders_1_1=invalidOrders_1.next(),[3,3];case 6:return[3,9];case 7:return e_6_1=_b.sent(),e_6={error:e_6_1},[3,9];case 8:try{invalidOrders_1_1&&!invalidOrders_1_1.done&&(_a=invalidOrders_1.return)&&_a.call(invalidOrders_1)}finally{if(e_6)throw e_6.error}return[7];case 9:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_BATCH_UPDATE_ORDER,(function updateBatchOrder(action){var order,jsonOrder,response,updatedOrder,shipment,selectorProps,outboundBatchEntry,previousUserBatchInput,outboundShipment,updatedUserBatchInput,batchId;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,18,,19]),order=action.payload.order,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.De)(action.formName))];case 1:return _a.sent(),!action.isUpdatingAddress&&action.useImportedWeight?[3,4]:(jsonOrder=(0,Order.U2)(order),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(updateOrder,jsonOrder)]);case 2:return response=_a.sent(),updatedOrder=(0,Order.rS)(response.data),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Du(updatedOrder))];case 3:_a.sent(),_a.label=4;case 4:return action.isUpdatingAddress?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.CG())]:[3,6];case 5:return _a.sent(),[3,15];case 6:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.M9())];case 7:return _a.sent(),shipment=null,selectorProps={orderId:order.objectId},[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(orders_batch_selectors.uU,selectorProps)];case 8:return outboundBatchEntry=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(orders_batch_selectors.Re,{batchEntryId:outboundBatchEntry.id})];case 9:return previousUserBatchInput=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(orders_batch_selectors.fh,selectorProps)];case 10:return(outboundShipment=_a.sent())?[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(shipments_selectors.Zb,{shipmentId:outboundShipment.objectId})]:[3,12];case 11:shipment=_a.sent(),_a.label=12;case 12:return updatedUserBatchInput=previousUserBatchInput,action.isUpdatingAddress||(updatedUserBatchInput=(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},previousUserBatchInput),{parcel:(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},action.payload.parcel),{useImportedOrderWeight:action.useImportedWeight||!1})})),[4,selectState(orders_batch_selectors.M1)];case 13:return batchId=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.zo(batchId,outboundBatchEntry.id,updatedUserBatchInput,shipment?shipment.objectId:"",order.objectId))];case 14:_a.sent(),_a.label=15;case 15:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.lM)(action.formName))];case 16:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.cL)(action.formName))];case 17:return _a.sent(),[3,19];case 18:return _a.sent(),[3,19];case 19:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_BATCH_FETCH_USER_INPUT,(function fetchUserBatchInput(action){var batchEntryId,batchId,response,err_8;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:batchEntryId=action.batchEntryId,_a.label=1;case 1:return _a.trys.push([1,5,,7]),[4,selectState(orders_batch_selectors.M1)];case 2:return batchId=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getUserBatchInput,batchId,batchEntryId)];case 3:return response=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.bE(batchEntryId,OrdersBatch.QP(response.data)))];case 4:return _a.sent(),[3,7];case 5:return err_8=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.mR(batchEntryId,err_8.toString()))];case 6:return _a.sent(),[3,7];case 7:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_BATCH_CREATE_AND_BUY,(function createAndBuyBatch(action){var trackingReference,batchEntryIds,response,parsedBatch,rates_1,transactedRates,transactionAmount,serviceLevels,isSplitOrder,err_9,errorMessage;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:trackingReference=action.payload.trackingReference,_a.label=1;case 1:return _a.trys.push([1,8,,10]),batchEntryIds=(0,flatten.A)(Object.values(action.payload.orderSelection)),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(createBatch,[],batchEntryIds)];case 2:return response=_a.sent(),parsedBatch=OrdersBatch.rS(response.data),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.WV(parsedBatch))];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_batch_actions.kc(parsedBatch.id,action.payload.rateObjectIds,trackingReference))];case 4:return _a.sent(),[4,selectState(rates_selectors.aT)];case 5:return rates_1=_a.sent(),transactedRates=action.payload.rateObjectIds.map((function(x){return rates_1[x]})),transactionAmount=transactedRates.reduce((function(total,_a){var amountLocal=_a.amountLocal;return total+Number(amountLocal)}),0),serviceLevels=transactedRates.reduce((function(serviceLevels,_a){var servicelevel=_a.servicelevel;return(0,uniq.A)((0,tslib_es6.fX)((0,tslib_es6.fX)([],(0,tslib_es6.zs)(serviceLevels),!1),[servicelevel.name],!1))}),[]).join(", "),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(batch_entry_selectors.id,{batchEntryIds})];case 6:return isSplitOrder=_a.sent(),utils_observability.O.successEvent("RETURN_WORKFLOW_CREATE_LABEL"),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("Purchase",{"Transaction Amount":transactionAmount,"Service Level":serviceLevels,"Is Split Order":isSplitOrder}))];case 7:return _a.sent(),[3,10];case 8:return err_9=_a.sent(),axios_default().isAxiosError(err_9)&&err_9.response&&(0,utils.mq)(trackingReference,{url:err_9.response.config.url||"",isError:err_9.response.status>300,status:err_9.response.status,message:(0,utils.w$)(err_9.response.data)||void 0}),errorMessage="We were not able to process your request. Please try again.",utils_observability.O.errorEvent("RETURN_WORKFLOW_CREATE_LABEL",{errorMessage}),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.nM(errorMessage))];case 9:return _a.sent(),[3,10];case 10:return[2]}}))}));function fetchDefaultPackageUnitsSuccess(payload){return{payload,type:constants.t.FETCH_PACKAGE_DEFAULT_UNITS_SUCCESS}}function fetchDefaultPackageUnitsError(payload){return{payload,type:constants.t.FETCH_PACKAGE_DEFAULT_UNITS_ERROR}}function savePackageTemplateSuccess(parcelTemplate,trackingReference,applyNewParcelTemplateOnParcelForm){return{payload:{parcelTemplate,trackingReference,applyNewParcelTemplateOnParcelForm},type:constants.t.SAVE_PACKAGE_TEMPLATE_SUCCESS}}const common_PackageTemplateChooser=PackageTemplateChooser_PackageTemplateChooser;var getAutomationsStore=function(state){return state.automations},getPackageTemplateIdsWithRules=(0,reselect_es.createSelector)(getAutomationsStore,(function(automationsStore){return automationsStore.associatedPackageTemplateIds})),getPackagesStore=((0,reselect_es.createSelector)(getAutomationsStore,(function(automationsStore){return automationsStore.businessRules.filter((function(rule){return 0!==rule.rankDesc}))})),(0,reselect_es.createSelector)(getAutomationsStore,(function(automationsStore){return automationsStore.deleteRuleModalIsOpen})),(0,reselect_es.createSelector)(getAutomationsStore,(function(automationsStore){return automationsStore.addRuleModalIsOpen})),(0,reselect_es.createSelector)(getAutomationsStore,(function(_a){return _a.error})),(0,reselect_es.createSelector)(getAutomationsStore,(function(automationsStore){return automationsStore.reprocessRuleStatus})),(0,reselect_es.createSelector)(getAutomationsStore,(function(automationsStore){return automationsStore.reprocessRuleStatus===rules.ri.pending})),(0,reselect_es.createSelector)(getAutomationsStore,(function(automationsStore){return automationsStore.closedReprocessingPendingNotification})),(0,reselect_es.createSelector)(getAutomationsStore,(function(automationsStore){return automationsStore.closedReprocessingCompleteNotification})),function(state){return state.packages}),getDefaultWeightUnit=(0,reselect_es.createSelector)(getPackagesStore,(function(packagesStore){return packagesStore.defaultWeightUnit})),packages_selectors_getDefaultDistanceUnit=(0,reselect_es.createSelector)(getPackagesStore,(function(packagesStore){return packagesStore.defaultDistanceUnit})),getActiveParcelTemplate=(0,reselect_es.createSelector)(getPackagesStore,(function(packageStore){return packageStore.parcelTemplate}));const SavePackageTemplateModal_validate=function(values){var errors=PackageTemplateChooser_validate(values);return values.parcelTemplateName&&values.parcelTemplateName.length>50&&(errors.parcelTemplateName="The package template name cannot be longer than 50 characters."),values.extras&&values.extras.isUsingCustomDimensions&&!values.parcelTemplateName&&(errors.parcelTemplateName="Please enter a package name"),errors};var SavePackageTemplateModal_ModalBody=(0,emotion_styled_browser_esm.A)(Modal.A.Body)(SavePackageTemplateModal_templateObject_1||(SavePackageTemplateModal_templateObject_1=(0,tslib_es6.ue)(["\n  position: absolute;\n  bottom: 66px;\n  left: 0px;\n  right: 0px;\n  overflow: auto;\n  top: 65px;\n  @media screen and (min-width: ","px) {\n    top: 71px;\n  }\n  @media screen and (min-width: ","px) {\n    position: initial;\n  }\n"],["\n  position: absolute;\n  bottom: 66px;\n  left: 0px;\n  right: 0px;\n  overflow: auto;\n  top: 65px;\n  @media screen and (min-width: ","px) {\n    top: 71px;\n  }\n  @media screen and (min-width: ","px) {\n    position: initial;\n  }\n"])),responsive.P.SmallMobile,responsive.P.Mobile),SavePackageTemplateModal_ModalFooter=(0,emotion_styled_browser_esm.A)(Modal.A.Footer)(SavePackageTemplateModal_templateObject_2||(SavePackageTemplateModal_templateObject_2=(0,tslib_es6.ue)(["\n  display: flex;\n  justify-content: space-between;\n  position: absolute;\n  bottom: 0px;\n  left: 0px;\n  right: 0px;\n  overflow: hidden;\n  @media screen and (min-width: ","px) {\n    position: initial;\n  }\n"],["\n  display: flex;\n  justify-content: space-between;\n  position: absolute;\n  bottom: 0px;\n  left: 0px;\n  right: 0px;\n  overflow: hidden;\n  @media screen and (min-width: ","px) {\n    position: initial;\n  }\n"])),responsive.P.Mobile),SavePackageTemplateModal_FooterButtons=(0,emotion_styled_browser_esm.A)("div")(SavePackageTemplateModal_templateObject_3||(SavePackageTemplateModal_templateObject_3=(0,tslib_es6.ue)(["\n  :only-of-type {\n    margin-left: auto;\n  }\n  width: 100%;\n"],["\n  :only-of-type {\n    margin-left: auto;\n  }\n  width: 100%;\n"]))),SavePackageTemplateModal_CancelButton=(0,emotion_styled_browser_esm.A)(components_Button.vM)(SavePackageTemplateModal_templateObject_4||(SavePackageTemplateModal_templateObject_4=(0,tslib_es6.ue)(["\n  display: none;\n  @media screen and (min-width: ","px) {\n    display: initial;\n  }\n"],["\n  display: none;\n  @media screen and (min-width: ","px) {\n    display: initial;\n  }\n"])),responsive.P.Mobile),SavePackageTemplateModal_ApplyButton=(0,emotion_styled_browser_esm.A)(components_Button.jn)(SavePackageTemplateModal_templateObject_5||(SavePackageTemplateModal_templateObject_5=(0,tslib_es6.ue)(["\n  margin-left: 0px !important;\n  @media screen and (min-width: ","px) {\n    width: auto;\n    margin-left: 10px !important;\n  }\n"],["\n  margin-left: 0px !important;\n  @media screen and (min-width: ","px) {\n    width: auto;\n    margin-left: 10px !important;\n  }\n"])),responsive.P.Mobile),SavePackageTemplateModal_Divider=(0,emotion_styled_browser_esm.A)("div")(SavePackageTemplateModal_templateObject_6||(SavePackageTemplateModal_templateObject_6=(0,tslib_es6.ue)(["\n  border-bottom: 1px solid ",";\n  padding: 12px;\n  margin: 10px 30px 30px 0;\n"],["\n  border-bottom: 1px solid ",";\n  padding: 12px;\n  margin: 10px 30px 30px 0;\n"])),styles_constants.Tj.greyBorder),SavePackageTemplateModal_CheckboxContainer=(0,emotion_styled_browser_esm.A)("div")(SavePackageTemplateModal_templateObject_7||(SavePackageTemplateModal_templateObject_7=(0,tslib_es6.ue)(["\n  margin-bottom: 30px;\n"],["\n  margin-bottom: 30px;\n"]))),InputFieldContainer=(0,emotion_styled_browser_esm.A)("div")(SavePackageTemplateModal_templateObject_8||(SavePackageTemplateModal_templateObject_8=(0,tslib_es6.ue)(["\n  margin-bottom: 20px;\n"],["\n  margin-bottom: 20px;\n"]))),SavePackageTemplateModal=function(_super){function SavePackageTemplateModal(props){var _this=_super.call(this,props)||this;return _this.onClose=function(e){e.preventDefault(),e.stopPropagation(),_this.props.onCancel(),_this.props.resetForm(),_this.props.onboarding&&_this.props.onboardingTrackEvent("Onboarding - Cancelled Package Template Modal")},_this.onDelete=function(objectId){return function(){_this.setState({packageTemplateObjectIdToDelete:objectId})}},_this.hideDeleteConfirm=function(){_this.setState({packageTemplateObjectIdToDelete:null})},_this.onDeleteConfirm=function(){if(_this.state.packageTemplateObjectIdToDelete){var trackingReference=TrackingHelper.U.getTrackingReference(types.wK.name,_this.props.appLocation,{parcelId:_this.state.packageTemplateObjectIdToDelete,isAutoSave:!1,isQuickSelect:!1});(0,utils.bT)(trackingReference,types.wK.operations.SAVE_ATTEMPTED,{parcelId:_this.state.packageTemplateObjectIdToDelete}),(0,utils.bT)(trackingReference,types.wK.operations.DELETED,{parcelId:_this.state.packageTemplateObjectIdToDelete}),_this.props.delete(_this.state.packageTemplateObjectIdToDelete,trackingReference),_this.setState({packageTemplateObjectIdToDelete:null})}},_this.handleSubmit=function(formValues){var customDimensions=formValues.customDimensions,parcelTemplate=formValues.parcelTemplate,template=parcelTemplate&&(0,ParcelTemplate.MS)(parcelTemplate)?parcelTemplate.carrierTemplate:parcelTemplate,packageTemplate={objectId:_this.props.parcelTemplate?_this.props.parcelTemplate.objectId:void 0,carrierTemplate:template,isDefault:formValues.isDefault,name:formValues.parcelTemplateName||"",distanceUnit:customDimensions?customDimensions.distanceUnit.value:distance.k.IN,height:customDimensions?Number(customDimensions.height):0,length:customDimensions?Number(customDimensions.length):0,width:customDimensions?Number(customDimensions.width):0,weightUnit:formValues.weightUnit?formValues.weightUnit.value:weight.VV.LB,weight:Number(formValues.weight)},packageName=template?template.name:packageTemplate.name,eventProperties={"Package Name":packageName,"Is Custom Template":!template,"Is Set as Default":formValues.isDefault};_this.props.sendTrackEvent("Saved Package Template",eventProperties),(0,segment.u4)(segment.sV.package_template_created,{package_name:packageName,is_default:formValues.isDefault});var trackingReference=TrackingHelper.U.getTrackingReference(types.wK.name,_this.props.appLocation,{parcelId:packageTemplate.objectId,isAutoSave:!1,isQuickSelect:!1});(0,utils.bT)(trackingReference,types.wK.operations.SAVE_ATTEMPTED,{parcelId:packageTemplate.objectId}),packageTemplate.objectId?(0,utils.bT)(trackingReference,types.wK.operations.UPDATED,{parcelId:packageTemplate.objectId}):(0,utils.bT)(trackingReference,types.wK.operations.CREATED,{parcelId:packageTemplate.objectId}),_this.props.savePackageTemplate(packageTemplate,trackingReference)},_this.state={packageTemplateObjectIdToDelete:null},_this}return(0,tslib_es6.C6)(SavePackageTemplateModal,_super),SavePackageTemplateModal.prototype.componentDidUpdate=function(){var _a=this.props,isInitialized=_a.isInitialized,initialValues=_a.initialValues,initialize=_a.initialize;!isInitialized&&initialValues&&initialize(initialValues)},SavePackageTemplateModal.prototype.renderDeleteConfirmation=function(){var _a=this.props,t=_a.t,packageTemplateIdsWithRules=_a.packageTemplateIdsWithRules,packageTemplateObjectIdToDelete=this.state.packageTemplateObjectIdToDelete,isOpen=null!==packageTemplateObjectIdToDelete||this.props.isDeleting,hasAssociatedRule=packageTemplateIdsWithRules.includes(packageTemplateObjectIdToDelete),deleteMessage=(0,emotion_react_jsx_runtime_browser_esm.Y)(utils_translate.x6,(0,tslib_es6.Cl)({i18nKey:hasAssociatedRule?"packages.deleteModalTextAutomations":"packages.deleteModalText"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)("br",{})}));return isOpen&&(0,emotion_react_jsx_runtime_browser_esm.Y)(ErrorDialog.A,{onClose:this.hideDeleteConfirm,isOpen,onConfirm:this.onDeleteConfirm,closeButtonText:t("packages.cancelButton"),confirmButtonText:t("packages.removeButton"),message:deleteMessage,title:t("packages.deleteModalTitle")})},SavePackageTemplateModal.prototype.renderEditTemplateModal=function(){var isNew=!this.props.parcelTemplate||!this.props.parcelTemplate.objectId,title=isNew?"New Package Template":"Edit Package Template",isOpen=!this.state.packageTemplateObjectIdToDelete&&!this.props.isDeleting,templateNameField=this.props.isUsingCustomDimensions?(0,emotion_react_jsx_runtime_browser_esm.Y)(InputFieldContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{name:"parcelTemplateName",component:Input.FO,placeholder:"Large box with sticker",size:constants_form.YI.large,labelPosition:"top",label:"Your Package Name",tabIndex:1,responsive:!0})}):null;return isOpen&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Modal.A.Container,(0,tslib_es6.Cl)({closeOnClickOutside:!1,onClose:this.onClose,isOpen:this.props.isOpen,size:"md"},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)("form",(0,tslib_es6.Cl)({onSubmit:this.props.handleSubmit(this.handleSubmit)},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Modal.A.Header,{children:title}),(0,emotion_react_jsx_runtime_browser_esm.FD)(SavePackageTemplateModal_ModalBody,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(common_PackageTemplateChooser,{formName:PACKAGE_TEMPLATE_MODAL,editingCustomTemplate:!0,disableDropdown:null!==this.props.parcelTemplate,startingTabIndex:1,someOrderHasImportedWeight:!1,shouldShowPolymailer:!0}),(0,emotion_react_jsx_runtime_browser_esm.Y)(SavePackageTemplateModal_Divider,{}),templateNameField,(0,emotion_react_jsx_runtime_browser_esm.Y)(SavePackageTemplateModal_CheckboxContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{component:Checkbox.Yh,label:"Set as default package template for label purchase",name:"isDefault",tabIndex:1})})]}),(0,emotion_react_jsx_runtime_browser_esm.FD)(SavePackageTemplateModal_ModalFooter,{children:[isNew?null:(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Button.tA,(0,tslib_es6.Cl)({onClick:this.onDelete(this.props.parcelTemplate.objectId),isLoading:this.props.isDeleting,disabled:this.props.isDeleting,useGreenSpinner:!0,tabIndex:1},{children:"Delete Template"})),(0,emotion_react_jsx_runtime_browser_esm.FD)(SavePackageTemplateModal_FooterButtons,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(SavePackageTemplateModal_CancelButton,(0,tslib_es6.Cl)({onClick:this.onClose,disabled:this.props.isDeleting,tabIndex:1},{children:"Cancel"})),(0,emotion_react_jsx_runtime_browser_esm.Y)(SavePackageTemplateModal_ApplyButton,(0,tslib_es6.Cl)({isLoading:this.props.submitting,disabled:this.props.submitting||this.props.isDeleting,type:"submit",tabIndex:1,fullWidth:!0},{children:"Save Template"}))]})]})]}))}))},SavePackageTemplateModal.prototype.render=function(){return(0,emotion_react_jsx_runtime_browser_esm.FD)(react.Fragment,{children:[this.renderDeleteConfirmation(),this.renderEditTemplateModal()]})},SavePackageTemplateModal}(react.Component),PACKAGE_TEMPLATE_MODAL="PACKAGE_TEMPLATE_MODAL";(0,redux.Zz)((0,utils_translate.Tl)("settings"),(0,es.Ng)((function(state){var formValues=(0,getFormValues.A)(PACKAGE_TEMPLATE_MODAL)(state),userConfigDefaults=(0,user_selectors.Og)(state),parcelTemplate=getActiveParcelTemplate(state);return{parcelTemplate,isInitialized:!!formValues,isOpen:state.packages.savePackageTemplateModalIsOpen,isDeleting:isDeleting(state),isUsingCustomDimensions:formValues&&formValues.extras.isUsingCustomDimensions,initialValues:(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},getInitialFormValues(parcelTemplate,userConfigDefaults,null)),{isDefault:!!parcelTemplate&&parcelTemplate.isDefault,parcelTemplateName:parcelTemplate?parcelTemplate.name:""}),packageTemplateIdsWithRules:getPackageTemplateIdsWithRules(state)}}),(function(dispatch,ownProps){return{initialize:function(initialValues){dispatch((0,redux_form_es.n_)(PACKAGE_TEMPLATE_MODAL,initialValues))},onCancel:function(){return dispatch(closeModal())},resetForm:function(){return dispatch((0,redux_form_es.cL)(PACKAGE_TEMPLATE_MODAL))},delete:function(objectId,trackingReference){return dispatch(function deletePackageTemplate(objectId,trackingReference){return{type:constants.t.DELETE_PACKAGE_TEMPLATE,payload:{objectId,trackingReference}}}(objectId,trackingReference))},savePackageTemplate:function(formData,trackingReference){return dispatch(function packages_actions_savePackageTemplate(formData,applyNewParcelTemplateOnParcelForm,trackingReference){return{payload:{formData,applyNewParcelTemplateOnParcelForm,trackingReference},type:constants.t.SAVE_PACKAGE_TEMPLATE}}(formData,!!ownProps.applyNewParcelTemplateOnParcelForm,trackingReference))},sendTrackEvent:function(event,properties){void 0===properties&&(properties={});var eventName=event;ownProps.dataAnalyticsContext&&ownProps.dataAnalyticsContext.prefix&&(eventName="".concat(ownProps.dataAnalyticsContext.prefix," - ").concat(eventName)),ownProps.dataAnalyticsContext&&ownProps.dataAnalyticsContext.sendTrackEvent?dispatch(ownProps.dataAnalyticsContext.sendTrackEvent(eventName,properties)):dispatch((0,prod_analytics_actions.o)(eventName,properties))},onboardingTrackEvent:function(eventString){return dispatch((0,onboarding_actions.Zw)(eventString))}}})),(0,reduxForm.A)({validate:SavePackageTemplateModal_validate,form:PACKAGE_TEMPLATE_MODAL,destroyOnUnmount:!0,enableReinitialize:!0,touchOnChange:!0}))(SavePackageTemplateModal);var SavePackageTemplateModal_templateObject_1,SavePackageTemplateModal_templateObject_2,SavePackageTemplateModal_templateObject_3,SavePackageTemplateModal_templateObject_4,SavePackageTemplateModal_templateObject_5,SavePackageTemplateModal_templateObject_6,SavePackageTemplateModal_templateObject_7,SavePackageTemplateModal_templateObject_8;function packages_service_get(){return services_api.YZ.request({url:"/setting/package-units",method:"GET"})}function packages_service_put(data){return services_api.YZ.request({data,url:"/setting/package-units",method:"PUT"})}function updateOldExperience(data,objectId){return services_api.Ay.request({data,url:"/ui/account/parcel_templates/".concat(objectId),method:"PUT"})}function update(data,objectId){return services_api.YZ.request({data,url:"/setting/parcel_templates/".concat(objectId),method:"PUT"})}function createOldExperience(data){return services_api.Ay.request({data,url:"/ui/account/parcel_templates",method:"POST"})}function create(data){return services_api.YZ.request({data,url:"/setting/parcel_templates",method:"POST"})}function delOldExperience(objectId){return services_api.Ay.request({url:"/ui/account/parcel_templates/".concat(objectId),method:"DELETE"})}function del(objectId){return services_api.YZ.request({url:"/setting/parcel_templates/".concat(objectId),method:"DELETE"})}var Section=(0,emotion_styled_browser_esm.A)("section")(FormSection_templateObject_1||(FormSection_templateObject_1=(0,tslib_es6.ue)(["\n  border: 1px solid ",";\n  border-radius: 5px;\n  margin-bottom: 20px;\n"],["\n  border: 1px solid ",";\n  border-radius: 5px;\n  margin-bottom: 20px;\n"])),styles_constants.Tj.greyBorder),FormSection_Header=(0,emotion_styled_browser_esm.A)("header")(FormSection_templateObject_2||(FormSection_templateObject_2=(0,tslib_es6.ue)(["\n  background-color: #fbfbfb;\n  border-bottom: 1px solid ",";\n  padding: 15px 16px;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  -webkit-border-top-left-radius: 5px;\n  -webkit-border-top-right-radius: 5px;\n  -moz-border-radius-topleft: 5px;\n  -moz-border-radius-topright: 5px;\n  border-top-left-radius: 5px;\n  border-top-right-radius: 5px;\n"],["\n  background-color: #fbfbfb;\n  border-bottom: 1px solid ",";\n  padding: 15px 16px;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  -webkit-border-top-left-radius: 5px;\n  -webkit-border-top-right-radius: 5px;\n  -moz-border-radius-topleft: 5px;\n  -moz-border-radius-topright: 5px;\n  border-top-left-radius: 5px;\n  border-top-right-radius: 5px;\n"])),styles_constants.Tj.greyBorder),FormSection_Title=(0,emotion_styled_browser_esm.A)("h4")(FormSection_templateObject_3||(FormSection_templateObject_3=(0,tslib_es6.ue)(["\n  font-size: 16px;\n  color: ",";\n  padding: 0;\n  margin: 0;\n  flex-grow: 1;\n  font-weight: 400;\n"],["\n  font-size: 16px;\n  color: ",";\n  padding: 0;\n  margin: 0;\n  flex-grow: 1;\n  font-weight: 400;\n"])),styles_constants.Tj.gray1000),Addons=(0,emotion_styled_browser_esm.A)("div")(FormSection_templateObject_4||(FormSection_templateObject_4=(0,tslib_es6.ue)(["\n  flex-shrink: 1;\n"],["\n  flex-shrink: 1;\n"]))),FormSection_Description=(0,emotion_styled_browser_esm.A)("span")(FormSection_templateObject_5||(FormSection_templateObject_5=(0,tslib_es6.ue)(["\n  display: block;\n  font-size: 14px;\n  color: ",";\n  margin-bottom: 20px;\n  padding: 0;\n  line-height: 1em;\n"],["\n  display: block;\n  font-size: 14px;\n  color: ",";\n  margin-bottom: 20px;\n  padding: 0;\n  line-height: 1em;\n"])),styles_constants.Tj.gray1000),FormSection_Body=(0,emotion_styled_browser_esm.A)("div")(FormSection_templateObject_6||(FormSection_templateObject_6=(0,tslib_es6.ue)(["\n  "," box-sizing: border-box;\n  display: block;\n  height: 100%;\n  color: ",";\n\n  ",";\n"],["\n  "," box-sizing: border-box;\n  display: block;\n  height: 100%;\n  color: ",";\n\n  ",";\n"])),(function(_a){return _a.noPadding?"padding: 0;":"padding: 16px;"}),styles_constants.Tj.gray1000,(function(_a){var collapsible=_a.collapsible,isCollapsed=_a.isCollapsed;return"never"===collapsible?"display: block;":"always"===collapsible?"display: ".concat(isCollapsed?"none":"block",";"):"@media only screen and (max-width: ".concat(collapsible,"px) {\n  display: ").concat(isCollapsed?"none":"block",";\n}")})),FormSection_Row=(0,emotion_styled_browser_esm.A)(Grid.f)(FormSection_templateObject_7||(FormSection_templateObject_7=(0,tslib_es6.ue)(["\n  ","\n  ","\n  margin-bottom: 30px;\n\n  &:last-of-type {\n    margin-bottom: 0px;\n  }\n"],["\n  ","\n  ","\n  margin-bottom: 30px;\n\n  &:last-of-type {\n    margin-bottom: 0px;\n  }\n"])),(function(_a){var wrappable=_a.wrappable;return wrappable?!0===wrappable?"\n        flex-wrap: wrap;\n      ":"\n        @media only screen and (max-width: ".concat(wrappable,"px) {\n          flex-direction: column;\n        }\n      "):null}),(function(_a){return _a.wrappable?"\n    margin-top: -20px;\n\n    & > * {\n      margin-top: 20px;\n      max-width: 100%;\n    }":null})),Column=(0,emotion_styled_browser_esm.A)(Grid.V)(FormSection_templateObject_8||(FormSection_templateObject_8=(0,tslib_es6.ue)(["\n  ","\n  ","\n"],["\n  ","\n  ","\n"])),(function(_a){return _a.noPadding?null:"\n    &:last-of-type {\n      padding-left: 8px;\n    }\n\n    &:first-of-type {\n      padding-left: 0px;\n    }"}),(function(_a){var width=_a.width;return width?"width: ".concat(width):""})),InputContainer=(0,emotion_styled_browser_esm.A)("div")(FormSection_templateObject_9||(FormSection_templateObject_9=(0,tslib_es6.ue)(["\n  margin-bottom: 20px;\n\n  &:last-of-type {\n    margin-bottom: 0px;\n  }\n"],["\n  margin-bottom: 20px;\n\n  &:last-of-type {\n    margin-bottom: 0px;\n  }\n"]))),CollapseIcon=((0,emotion_styled_browser_esm.A)("div")(FormSection_templateObject_10||(FormSection_templateObject_10=(0,tslib_es6.ue)(["\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  margin: 20px 0;\n"],["\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  margin: 20px 0;\n"]))),(0,emotion_styled_browser_esm.A)("i")(FormSection_templateObject_11||(FormSection_templateObject_11=(0,tslib_es6.ue)(["\n  margin-left: 10px;\n  font-size: 18px;\n  display: none;\n\n  ",";\n"],["\n  margin-left: 10px;\n  font-size: 18px;\n  display: none;\n\n  ",";\n"])),(function(_a){var collapsible=_a.collapsible;return"never"===collapsible?"display: none;":"always"===collapsible?"display: block;":"@media only screen and (max-width: ".concat(collapsible,"px) {\n    display: block;\n  }")})));const components_FormSection_FormSection=function(props){var collapsible=props.collapsible,description=props.description,noPadding=props.noPadding,title=props.title,bodyClassName=props.bodyClassName,AddonComponents=props.addons,_a=(0,tslib_es6.zs)(react.useState(!0),2),isCollapsed=_a[0],setIsCollapsed=_a[1],onCollapseChange=react.useCallback((function(){return setIsCollapsed(!isCollapsed)}),[isCollapsed]),isActuallyCollapsed=!!collapsible&&"never"!==collapsible&&isCollapsed;return(0,emotion_react_jsx_runtime_browser_esm.FD)(Section,(0,tslib_es6.Cl)({className:props.className},{children:[title&&(0,emotion_react_jsx_runtime_browser_esm.FD)(FormSection_Header,(0,tslib_es6.Cl)({onClick:onCollapseChange},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(FormSection_Title,{children:title}),(0,emotion_react_jsx_runtime_browser_esm.Y)(Addons,{children:AddonComponents&&(0,emotion_react_jsx_runtime_browser_esm.Y)(AddonComponents,{})}),(0,emotion_react_jsx_runtime_browser_esm.Y)(CollapseIcon,{collapsible:collapsible||"never",className:"fa fa-caret-".concat(isCollapsed?"down":"up")})]})),(0,emotion_react_jsx_runtime_browser_esm.FD)(FormSection_Body,(0,tslib_es6.Cl)({collapsible:collapsible||"never",isCollapsed:isActuallyCollapsed,noPadding:!!noPadding,className:bodyClassName},{children:[description&&(0,emotion_react_jsx_runtime_browser_esm.Y)(FormSection_Description,{children:description}),props.children]}))]}))};var FormSection_templateObject_1,FormSection_templateObject_2,FormSection_templateObject_3,FormSection_templateObject_4,FormSection_templateObject_5,FormSection_templateObject_6,FormSection_templateObject_7,FormSection_templateObject_8,FormSection_templateObject_9,FormSection_templateObject_10,FormSection_templateObject_11,submitButtonStyle=(0,emotion_react_browser_esm.AH)(SubmitButton_templateObject_1||(SubmitButton_templateObject_1=(0,tslib_es6.ue)(["\n  min-width: 100px;\n"],["\n  min-width: 100px;\n"])));const SubmitButton_SubmitButton=function(props){var submitting=props.submitting,submittedSuccess=props.submittedSuccess,preSubmitText=props.preSubmitText,successSubmitText=props.successSubmitText,buttonType=props.buttonType,autoWidth=props.autoWidth,fullWidth=props.fullWidth,buttonProps=(0,tslib_es6.Tt)(props,["submitting","submittedSuccess","preSubmitText","successSubmitText","buttonType","autoWidth","fullWidth"]),Button=components_Button.Uo[buttonType],text=submittedSuccess?successSubmitText:preSubmitText,css=autoWidth||fullWidth?void 0:submitButtonStyle;return(0,emotion_react_jsx_runtime_browser_esm.Y)(Button,(0,tslib_es6.Cl)({isLoading:submitting,css,fullWidth},buttonProps,{children:text}))};var SubmitButton_templateObject_1;var DefaultPackageUnitsForm=function(_super){function DefaultPackageUnitsForm(){return null!==_super&&_super.apply(this,arguments)||this}return(0,tslib_es6.C6)(DefaultPackageUnitsForm,_super),DefaultPackageUnitsForm.prototype.componentDidUpdate=function(prevProps){this.props.anyTouched||(prevProps.defaultWeightUnit!==this.props.defaultWeightUnit&&this.props.change("defaultWeightUnit",options.Ay.commonWeightOptions[this.props.defaultWeightUnit]),prevProps.defaultDistanceUnit!==this.props.defaultDistanceUnit&&this.props.change("defaultDistanceUnit",options.Ay.commonDistanceOptions[this.props.defaultDistanceUnit]))},DefaultPackageUnitsForm.prototype.render=function(){return(0,emotion_react_jsx_runtime_browser_esm.Y)("form",(0,tslib_es6.Cl)({onSubmit:this.props.handleSubmit},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(components_FormSection_FormSection,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(FormSection_Row,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(Column,(0,tslib_es6.Cl)({width:"100%"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(InputContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{name:"defaultWeightUnit",component:SelectField,size:"100%",label:"Default weight unit",options:Object.keys(weight.bm).map((function(weightunit){return{label:weightunit,value:weightunit}}))})}),(0,emotion_react_jsx_runtime_browser_esm.Y)(InputContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Field.A,{style:{minWidth:"100%"},name:"defaultDistanceUnit",component:SelectField,size:"100%",label:"Default dimension unit",options:Object.keys(distance.S).map((function(distanceUnit){return{label:distanceUnit,value:distanceUnit}}))})}),(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(SubmitButton_SubmitButton,{type:"submit",buttonType:components_Button.EY.Primary,submittedSuccess:this.props.submitSucceeded,submitting:this.props.submitting,preSubmitText:"Save",successSubmitText:"Saved"})})]}))})})}))},DefaultPackageUnitsForm}(react.Component);(0,redux.Zz)((0,reduxForm.A)({form:"DEFAULT_PACKAGE_UNITS_FORM"}),(0,es.Ng)((function(state){return{defaultWeightUnit:getDefaultWeightUnit(state),defaultDistanceUnit:packages_selectors_getDefaultDistanceUnit(state)}})))(DefaultPackageUnitsForm);(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.FETCH_PACKAGE_DEFAULT_UNITS,(function packages_sagas_fetchDefaultPackageUnits(){var response,payload,err_1;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(packages_service_get)];case 1:return response=_a.sent(),payload={defaultWeightUnit:response.data.weight_unit,defaultDistanceUnit:response.data.dimension_unit},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchDefaultPackageUnitsSuccess(payload))];case 2:case 4:return _a.sent(),[3,5];case 3:return err_1=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchDefaultPackageUnitsError(err_1.message))];case 5:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.UPDATE_PACKAGE_DEFAULT_UNITS,(function packages_sagas_updateDefaultPackageUnits(action){var servicePayload,err_2;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,7,,11]),servicePayload={weight_unit:action.payload.defaultWeightUnit,dimension_unit:action.payload.defaultDistanceUnit},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.De)("DEFAULT_PACKAGE_UNITS_FORM"))];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(packages_service_put,servicePayload)];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((payload=action.payload,{payload,type:constants.t.UPDATE_PACKAGE_DEFAULT_UNITS_SUCCESS}))];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(segment.u4,segment.sV.save_default_package_units)];case 4:case 8:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.lM)("DEFAULT_PACKAGE_UNITS_FORM"))];case 5:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.Wv)("DEFAULT_PACKAGE_UNITS_FORM"))];case 6:case 10:return _a.sent(),[3,11];case 7:return err_2=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchDefaultPackageUnitsError(err_2.message))];case 9:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.uj)("DEFAULT_PACKAGE_UNITS_FORM"))];case 11:return[2]}var payload}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.SAVE_PACKAGE_TEMPLATE,(function packages_sagas_savePackageTemplate(action){var isOldExpChosen,useNewExperienceEndpoints,parcelTemplate,applyNewParcelTemplateOnParcelForm,response,_a,_b,newParcelTemplate,err_3,_c;return(0,tslib_es6.YH)(this,(function(_d){switch(_d.label){case 0:return _d.trys.push([0,22,,24]),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.De)(PACKAGE_TEMPLATE_MODAL))];case 1:return _d.sent(),[4,selectState(getIsOldExpChosen)];case 2:return isOldExpChosen=_d.sent(),useNewExperienceEndpoints=!isOldExpChosen,parcelTemplate=action.payload.formData,applyNewParcelTemplateOnParcelForm=action.payload.applyNewParcelTemplateOnParcelForm,response=void 0,parcelTemplate.objectId?useNewExperienceEndpoints?[4,(0,redux_saga_effects_npm_proxy_esm.T1)([packages_service_namespaceObject,update],(0,ParcelTemplate.U2)(action.payload.formData),parcelTemplate.objectId)]:[3,4]:[3,7];case 3:return _a=_d.sent(),[3,6];case 4:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)([packages_service_namespaceObject,updateOldExperience],(0,ParcelTemplate.U2)(action.payload.formData),parcelTemplate.objectId)];case 5:_a=_d.sent(),_d.label=6;case 6:return response=_a,[3,12];case 7:return useNewExperienceEndpoints?[4,(0,redux_saga_effects_npm_proxy_esm.T1)([packages_service_namespaceObject,create],(0,ParcelTemplate.U2)(action.payload.formData))]:[3,9];case 8:return _b=_d.sent(),[3,11];case 9:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)([packages_service_namespaceObject,createOldExperience],(0,ParcelTemplate.U2)(action.payload.formData))];case 10:_b=_d.sent(),_d.label=11;case 11:response=_b,_d.label=12;case 12:return(0,utils.mq)(action.payload.trackingReference,{url:response.config.url||"",isError:!1,status:response.status,message:void 0}),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(parcel_template_actions_fetchParcelTemplates())];case 13:return _d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(closeModal())];case 14:return _d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.lM)(PACKAGE_TEMPLATE_MODAL))];case 15:return _d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.cL)(PACKAGE_TEMPLATE_MODAL))];case 16:return _d.sent(),newParcelTemplate=(0,ParcelTemplate.rS)(response.data),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(savePackageTemplateSuccess(newParcelTemplate,action.payload.trackingReference,applyNewParcelTemplateOnParcelForm))];case 17:return _d.sent(),[4,selectState(parcel_template_selectors_getParcelTemplates)];case 18:return 0!==_d.sent().length?[3,21]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendGTMEvent({eventName:"SET_FIRST_PACKAGE_TEMPLATE"}))];case 19:return _d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("Set First Package Template"))];case 20:_d.sent(),_d.label=21;case 21:return[3,24];case 22:return err_3=_d.sent(),axios_default().isAxiosError(err_3)&&(0,utils.mq)(action.payload.trackingReference,{url:err_3.config.url||"",isError:!0,status:(null===(_c=err_3.response)||void 0===_c?void 0:_c.status)||-1,message:err_3.message}),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.lM)(PACKAGE_TEMPLATE_MODAL))];case 23:return _d.sent(),[3,24];case 24:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.DELETE_PACKAGE_TEMPLATE,(function packages_sagas_deletePackageTemplate(action){var isOldExpChosen,response,err_5,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return _b.trys.push([0,8,,10]),[4,selectState(getIsOldExpChosen)];case 1:return isOldExpChosen=_b.sent(),response=void 0,!isOldExpChosen?[4,(0,redux_saga_effects_npm_proxy_esm.T1)([packages_service_namespaceObject,del],action.payload.objectId)]:[3,3];case 2:return response=_b.sent(),[3,5];case 3:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)([packages_service_namespaceObject,delOldExperience],action.payload.objectId)];case 4:response=_b.sent(),_b.label=5;case 5:return(0,utils.mq)(action.payload.trackingReference,{url:response.config.url||"",isError:!1,status:response.status,message:void 0}),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((objectId=action.payload.objectId,{type:constants.t.DELETE_PACKAGE_TEMPLATE_SUCCESS,payload:{objectId}}))];case 6:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(closeModal())];case 7:return _b.sent(),[3,10];case 8:return err_5=_b.sent(),axios_default().isAxiosError(err_5)&&(0,utils.mq)(action.payload.trackingReference,{url:err_5.config.url||"",isError:!0,status:(null===(_a=err_5.response)||void 0===_a?void 0:_a.status)||-1,message:err_5.message}),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.DELETE_PACKAGE_TEMPLATE_ERROR,payload:{errorMessage}})];case 9:return _b.sent(),[3,10];case 10:return[2]}var errorMessage,objectId}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.SAVE_PACKAGE_TEMPLATE_SUCCESS,(function packages_sagas_savePackageTemplateSuccess(action){var _a,applyNewParcelTemplateOnParcelForm,parcelTemplate,formValues,parcel,orderAction,workingOrders,err_4;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return _b.trys.push([0,8,,9]),_a=action.payload,applyNewParcelTemplateOnParcelForm=_a.applyNewParcelTemplateOnParcelForm,parcelTemplate=_a.parcelTemplate,applyNewParcelTemplateOnParcelForm?[4,(0,redux_saga_effects_npm_proxy_esm.Lt)((0,getFormValues.A)(constants_form.n6))]:[3,7];case 1:return formValues=_b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,orders_actions.QT)(parcelTemplate))];case 2:return _b.sent(),parcel=(0,Parcel.uN)(parcelTemplate),[4,selectState(orders_selectors.f6)];case 3:return orderAction=_b.sent(),workingOrders={},!parcel.weight||"0"===parcel.weight||(null==formValues?void 0:formValues.useImportedOrderWeight)?[3,7]:("order-edit"===orderAction.kind&&(workingOrders=orderAction.orderSelection),Object.keys(workingOrders).length<1?[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(orders_selectors.Li)]:[3,5]);case 4:workingOrders=_b.sent(),_b.label=5;case 5:return workingOrders?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,orders_actions.$h)(workingOrders,parcel,action.payload.trackingReference))]:[3,7];case 6:_b.sent(),_b.label=7;case 7:return[3,9];case 8:return err_4=_b.sent(),esm_exports.Cp(err_4),[3,9];case 9:return[2]}}))}));function parcel_template_service_getParcelTemplates(){return services_api.YZ.request({url:"setting/parcel_templates",method:"GET"})}function parcel_template_service_getCarrierParcelTemplates(limit){return void 0===limit&&(limit=250),services_api.Ay.request({url:"parcel_templates?results=".concat(limit),method:"GET"})}var CarrierParcelTemplate=__webpack_require__("./app/types/CarrierParcelTemplate.ts");(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.PARCEL_TEMPLATE_FETCH,(function parcel_template_saga_fetchParcelTemplates(){var response,parcelTemplates,payload;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(parcel_template_service_getParcelTemplates)];case 1:return response=_a.sent(),parcelTemplates=response.data.results.map((function(jsonParcelTemplate){return ParcelTemplate.rS(jsonParcelTemplate)})),payload={parcelTemplates},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchParcelTemplatesSuccess(payload))];case 2:case 4:return _a.sent(),[3,5];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.PARCEL_TEMPLATE_FETCH_ERROR})];case 5:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.CARRIER_PARCEL_TEMPLATE_FETCH,(function parcel_template_saga_fetchCarrierParcelTemplates(){var response,carrierParcelTemplates,carrierParcelTemplatesByCarrier,payload;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(parcel_template_service_getCarrierParcelTemplates)];case 1:return response=_a.sent(),carrierParcelTemplates=response.data.results.map((function(jsonCarrierParcelTemplate){return CarrierParcelTemplate.rS(jsonCarrierParcelTemplate)})),carrierParcelTemplatesByCarrier=carrierParcelTemplates.reduce((function(hash,parcelTemplate){var _a;return(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},hash),((_a={})[(0,Carrier.Z)(parcelTemplate.provider)]=(0,tslib_es6.fX)((0,tslib_es6.fX)([],(0,tslib_es6.zs)(hash[(0,Carrier.Z)(parcelTemplate.provider)]||[]),!1),[parcelTemplate],!1),_a))}),{}),payload={carrierParcelTemplates:carrierParcelTemplatesByCarrier},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchCarrierParcelTemplatesSuccess(payload))];case 2:case 4:return _a.sent(),[3,5];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.CARRIER_PARCEL_TEMPLATE_FETCH_ERROR})];case 5:return[2]}}))}));function pending_invoice_transactions_service_fetchPendingInvoiceTransactions(pageNumber,pageSize){return void 0===pageNumber&&(pageNumber=1),void 0===pageSize&&(pageSize=25),services_api.kC.request({url:"/v1/invoice_items?unbilled=True&page=".concat(pageNumber,"&results=").concat(pageSize),method:"GET"})}function PendingInvoiceItem_fromJSON(jsonPendingInvoiceItem){return{amount:jsonPendingInvoiceItem.amount,currency:jsonPendingInvoiceItem.currency,carrierAccount:jsonPendingInvoiceItem.carrier_account,description:jsonPendingInvoiceItem.description,invoiceItemType:InvoiceItemTypeMap[jsonPendingInvoiceItem.invoice_item_type],objectCreated:moment_moment(jsonPendingInvoiceItem.object_created),objectPurpose:jsonPendingInvoiceItem.object_purpose,providerName:jsonPendingInvoiceItem.provider_name,servicelevelName:jsonPendingInvoiceItem.servicelevel_name,trackingNumber:jsonPendingInvoiceItem.tracking_number||null,transaction:jsonPendingInvoiceItem.transaction||null}}(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.INVOICE_TRANSACTIONS_PENDING_FETCH,(function pending_invoice_transactions_saga_fetchPendingInvoiceTransactions(action){var _a,pageNumber,pageSize,_b,results,count,e_1;return(0,tslib_es6.YH)(this,(function(_c){switch(_c.label){case 0:return _c.trys.push([0,3,,5]),_a=action.payload,pageNumber=_a.pageNumber,pageSize=_a.pageSize,[4,(0,redux_saga_effects_npm_proxy_esm.T1)(pending_invoice_transactions_service_fetchPendingInvoiceTransactions,pageNumber,pageSize)];case 1:return _b=_c.sent().data,results=_b.results,count=_b.count,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((transactionList=results.map(PendingInvoiceItem_fromJSON),pageCount=Math.ceil(count/(pageSize||25)),{type:constants.t.INVOICE_TRANSACTIONS_PENDING_FETCH_SUCCESS,payload:{transactionList,pageCount}}))];case 2:return _c.sent(),[3,5];case 3:return e_1=_c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((error=e_1,{type:constants.t.INVOICE_TRANSACTIONS_PENDING_FETCH_ERROR,payload:{error}}))];case 4:return _c.sent(),esm_exports.Cp(e_1),[3,5];case 5:return[2]}var error,transactionList,pageCount}))}));function getTransactionsForCarrierSuccess(payload){return{payload,type:constants.t.PICKUPS_FETCH_TRANSACTIONS_SUCCESS}}function getTransactionsForCarrierError(errorMessage){return{type:constants.t.PICKUPS_FETCH_TRANSACTIONS_ERROR,payload:{errorMessage}}}function getCarrierAccountIdSuccess(payload){return{payload,type:constants.t.PICKUPS_FETCH_CARRIER_ACCOUNT_ID_SUCCESS}}function getCarrierAccountIdError(errorMessage){return{type:constants.t.PICKUPS_FETCH_CARRIER_ACCOUNT_ID_ERROR,payload:{errorMessage}}}function getCarrierBuildingLocationTypesSuccess(payload){return{payload,type:constants.t.PICKUPS_FETCH_CARRIER_BUILDING_LOCATION_TYPES_SUCCESS}}function getCarrierBuildingLocationTypesError(errorMessage){return{type:constants.t.PICKUPS_FETCH_CARRIER_BUILDING_LOCATION_TYPES_ERROR,payload:{errorMessage}}}function sendPickupsRequestSuccess(payload){return{payload,type:constants.t.PICKUPS_SEND_PICKUPS_REQUEST_SUCCESS}}function sendPickupsRequestError(errorMessage){return{type:constants.t.PICKUPS_SEND_PICKUPS_REQUEST_ERROR,payload:{errorMessage}}}var pickups_service_baseURL="https://service-dev-qa.shippodev.com",transactionLimit="1000";function getTransactions(carrier,startDate,endDate,limit){void 0===limit&&(limit=transactionLimit);var params={filter:{carrier,start_date:startDate,end_date:endDate,status:"success"},expand:["rate","parcel"],page:{limit,number:"1"}};return services_api.Ay.request({baseURL:pickups_service_baseURL,params,url:"transactions/pickups/search",method:"GET",paramsSerializer:function(params){return lib.stringify(params,{arrayFormat:"brackets"})}})}function pickups_service_getCarrierAccounts(carrier){return services_api.Ay.request({baseURL:pickups_service_baseURL,url:"carrier_accounts",params:{carrier},method:"GET"})}function pickups_service_getCarrierBuildingLocationTypes(carrierId){return services_api.Ay.request({baseURL:pickups_service_baseURL,url:"transactions/pickups/building_location_types/".concat(carrierId),params:{},method:"GET"})}function pickups_service_sendPickupsRequest(payload){return services_api.YZ.request({url:"pickups/",method:"POST",headers:{"Content-Type":"application/json"},data:payload})}(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.PICKUPS_FETCH_TRANSACTIONS,(function pickups_saga_getTransactions(action){var result,totalTransactions,transactionObjectIds,serviceLevelInfo,errorMessage,payload;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,6]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getTransactions,action.payload.carrier,action.payload.startDate,action.payload.endDate)];case 1:return result=_a.sent(),totalTransactions=result.data.count,transactionObjectIds=result.data.results.map((function(transaction){return transaction.object_id})),serviceLevelInfo=result.data.results.reduce((function(obj,transaction){var _a,_b,serviceLevelName=transaction.rate.servicelevel_name;return obj[serviceLevelName]?(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},obj),((_a={})[serviceLevelName]=obj[serviceLevelName]+1,_a)):(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},obj),((_b={})[serviceLevelName]=1,_b))}),{}),payload={totalTransactions,transactionObjectIds,serviceLevelInfo,totalWeight:Math.round(100*Number(result.data.totals.total_weight))/100},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(getTransactionsForCarrierSuccess(payload))];case 2:case 5:return _a.sent(),[3,6];case 3:return _a.sent(),payload={messages:[errorMessage="There is an error from the carrier that requires investigation. Please contact support."],closeButtonText:"Close"},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(getTransactionsForCarrierError(errorMessage))];case 4:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(showDialog(payload,"error"))];case 6:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.PICKUPS_FETCH_CARRIER_ACCOUNT_ID,(function pickups_saga_getCarrierAccountId(action){var result,carrierAccountId,_a,_b,carrier,errorMessage,payload,e_1,_c;return(0,tslib_es6.YH)(this,(function(_d){switch(_d.label){case 0:return _d.trys.push([0,3,,6]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(pickups_service_getCarrierAccounts,action.payload.carrier)];case 1:result=_d.sent(),carrierAccountId=null;try{for(_a=(0,tslib_es6.Ju)(result.data.results),_b=_a.next();!_b.done;_b=_a.next())(carrier=_b.value).is_shippo_account&&(carrierAccountId=carrier.object_id)}catch(e_1_1){e_1={error:e_1_1}}finally{try{_b&&!_b.done&&(_c=_a.return)&&_c.call(_a)}finally{if(e_1)throw e_1.error}}return payload={carrierAccountId},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(getCarrierAccountIdSuccess(payload))];case 2:case 5:return _d.sent(),[3,6];case 3:return _d.sent(),payload={messages:[errorMessage="There is an error from the carrier that requires investigation. Please contact support."],closeButtonText:"Close"},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(getCarrierAccountIdError(errorMessage))];case 4:return _d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(showDialog(payload,"error"))];case 6:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.PICKUPS_FETCH_CARRIER_BUILDING_LOCATION_TYPES,(function pickups_saga_getCarrierBuildingLocationTypes(action){var result,errorMessage,payload;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,6]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(pickups_service_getCarrierBuildingLocationTypes,action.payload.carrier)];case 1:return result=_a.sent(),payload=result.data,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(getCarrierBuildingLocationTypesSuccess(payload))];case 2:case 5:return _a.sent(),[3,6];case 3:return _a.sent(),payload={messages:[errorMessage="There is an error from the carrier that requires investigation. Please contact support."],closeButtonText:"Close"},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(getCarrierBuildingLocationTypesError(errorMessage))];case 4:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(showDialog(payload,"error"))];case 6:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.PICKUPS_SEND_PICKUPS_REQUEST,(function pickups_saga_sendPickupsRequest(action){var country,requestPayload,result,err_4,errorMessage,payload;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,6]),country=action.payload.address.country?action.payload.address.country.iso2:"US",requestPayload={carrier_account:action.payload.carrierAccountId,location:{instructions:action.payload.buildingLocationType.label,building_type:"",address:{country,name:action.payload.address.name,company:action.payload.address.company,street1:action.payload.address.street1,street2:action.payload.address.street2,city:action.payload.address.city,state:action.payload.address.state,zip:action.payload.address.zip,phone:action.payload.address.phone,email:action.payload.address.email},building_location_type:action.payload.buildingLocationType.label},transactions:action.payload.transactionObjectIds,requested_start_time:action.payload.startTime,requested_end_time:action.payload.endTime,metadata:"",timezone:action.payload.timeZone,is_test:!0},[4,(0,redux_saga_effects_npm_proxy_esm.T1)(pickups_service_sendPickupsRequest,requestPayload)];case 1:return result=_a.sent(),payload={confirmationCode:result.data.confirmation_code,pickupDate:new Date(result.data.confirmed_end_time).toJSON().slice(0,10),carrier:result.data.carrier,pickupReadyByTime:result.data.confirmed_start_time,timeZone:result.data.timezone},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendPickupsRequestSuccess(payload))];case 2:case 5:return _a.sent(),[3,6];case 3:return err_4=_a.sent(),errorMessage="There is an error from the carrier that requires investigation. Please contact support.",err_4.response&&err_4.response.data&&err_4.response.data.messages&&err_4.response.data.messages.length>0&&(errorMessage=err_4.response.data.messages[0]),payload={messages:[errorMessage],closeButtonText:"Close"},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendPickupsRequestError(errorMessage))];case 4:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(showDialog(payload,"error"))];case 6:return[2]}}))}));function plans_saga_fetchUserPlans(){var response,userPlans,e_1;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getUserPlans)];case 1:return response=_a.sent(),userPlans=response.data.results.map(userPlanFromJSON),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchUserPlansSuccess(userPlans))];case 2:case 4:return _a.sent(),[3,5];case 3:return e_1=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((errorMessage=e_1.toString(),{type:constants.t.FETCH_USER_PLANS_ERROR,payload:{errorMessage}}))];case 5:return[2]}var errorMessage}))}(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.FETCH_USER_PLANS,plans_saga_fetchUserPlans),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.UPDATE_USER_PLAN_SUCCESS,plans_saga_fetchUserPlans),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.FETCH_USER_PLANS_SUCCESS,(function pushPlanToGTM(){var currentPlan,payload,gtmEvent;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(plans_selectors.P8)];case 1:return currentPlan=_a.sent(),payload={userIsPro:!1},currentPlan&&(payload.userIsPro=currentPlan.plan.isPro||currentPlan.plan.isFullAccess),gtmEvent={eventName:"USER_PLAN_PUSHED_EVENT",data:payload},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendGTMEvent(gtmEvent))];case 2:return _a.sent(),[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.FETCH_PRICING_PLANS,(function plans_saga_fetchPricingPlans(){var response,pricingPlans,e_2;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getPricingPlans)];case 1:return response=_a.sent(),pricingPlans=response.data.results.map(Plan_fromJSON),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchPricingPlansSuccess(pricingPlans))];case 2:case 4:return _a.sent(),[3,5];case 3:return e_2=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((errorMessage=e_2.toString(),{type:constants.t.FETCH_PRICING_PLANS_ERROR,payload:{errorMessage}}))];case 5:return[2]}var errorMessage}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.UPDATE_USER_PLAN,(function plans_saga_updateUserPlan(action){var currentPlan,response,userPlan,e_3,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return _b.trys.push([0,5,,7]),[4,selectState((function(state){return(0,plans_selectors.P8)(state)}))];case 1:return currentPlan=_b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(setUserPlan,action.payload.planName)];case 2:return response=_b.sent(),userPlan=userPlanFromJSON(response.data),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(segment.u4,segment.sV.plan_updated,(0,tslib_es6.Cl)((0,tslib_es6.Cl)({operation:"started"},planToTrackingDetails(userPlan)),{previous_plan_name:null===(_a=null==currentPlan?void 0:currentPlan.plan)||void 0===_a?void 0:_a.displayName,entry_point:action.payload.entryPoint}))];case 3:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(updateUserPlanSuccess(userPlan))];case 4:case 6:return _b.sent(),[3,7];case 5:return e_3=_b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(updateUserPlanError(e_3.toString()))];case 7:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.CLOSE_WIX_PRO_PLAN_NOTIFICATION,(function plans_saga_closeWixProPlanNotification(){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(local_storage.r,"wix_pro_plan_notification_dismissed","true")];case 1:return _a.sent(),[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.SUBMIT_CLOSE_ACCOUNT_FORM,(function plans_saga_submitCloseAccountForm(action){var _a,reason,tellUsMore,payload,response,_b;return(0,tslib_es6.YH)(this,(function(_c){switch(_c.label){case 0:_a=action.payload,reason=_a.reason,tellUsMore=_a.tellUsMore,payload={churn_reason:reason},""!==tellUsMore&&(payload.extra_info=tellUsMore),_c.label=1;case 1:return _c.trys.push([1,11,,13]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)([settings_service_namespaceObject,closeAccount],payload)];case 2:return 200!==(null==(response=_c.sent())?void 0:response.status)?[3,4]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(closeAccountSuccess("full"))];case 3:return _c.sent(),[3,10];case 4:return 201!==(null==response?void 0:response.status)?[3,6]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(closeAccountSuccess("partial"))];case 5:return _c.sent(),[3,10];case 6:return"UNPAID_INVOICE"!==(null===(_b=null==response?void 0:response.data)||void 0===_b?void 0:_b.error_type)?[3,8]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(closeAccountError("account.plan.closeAccount.modal.unpaidInvoice"))];case 7:return _c.sent(),[3,10];case 8:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(closeAccountError("account.plan.closeAccount.form.apiError"))];case 9:_c.sent(),_c.label=10;case 10:return[3,13];case 11:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(closeAccountError("account.plan.closeAccount.form.apiError"))];case 12:return _c.sent(),[3,13];case 13:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.CLOSE_ACCOUNT_SUCCESS,(function plans_saga_closeAccountSuccess(action){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,4]),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,actions.VC)("/close?closeStatus=".concat(action.payload.closeStatus)))];case 1:case 3:return _a.sent(),[3,4];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(closeAccountError("account.plan.closeAccount.form.apiError"))];case 4:return[2]}}))}));const prod_analytics_service={heap:{sendTrackEvent:function heap_service_sendTrackEvent(name,properties){var heap=window.heap;heap&&heap.track(name,properties)},addEventProperties:function addEventProperties(properties){var heap=window.heap;heap&&heap.addEventProperties(properties)}}};(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.PROD_ANALYTICS_TRACK,(function prod_analytics_saga_sendTrackEvent(action){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,3]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(prod_analytics_service.heap.sendTrackEvent,action.name,action.properties)];case 1:return _a.sent(),[3,3];case 2:return _a.sent(),[3,3];case 3:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.PROD_ANALYTICS_ADD_EVENT_PROPERTIES,(function prod_analytics_saga_addEventProperties(action){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,3]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(prod_analytics_service.heap.addEventProperties,action.properties)];case 1:return _a.sent(),[3,3];case 2:return _a.sent(),[3,3];case 3:return[2]}}))}));function applyOrReplacePromoCode(code,isReplacement){return{code,isReplacement,type:constants.t.PROMO_CODE_APPLY_OR_REPLACE}}function applyPromoCode(code){return services_api.Ay.request({url:"/apply_promo_code/",method:"POST",data:{code}})}function replacePromoCode(code){return services_api.Ay.request({url:"/replace_promo_code/",method:"POST",data:{code}})}var Promo=__webpack_require__("./app/types/Promo.ts");(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.PROMO_CODE_APPLY_OR_REPLACE,(function promos_saga_applyOrReplacePromoCode(action){var promoCode,response,_a,err_1,errorMessage,_b,_c;return(0,tslib_es6.YH)(this,(function(_d){switch(_d.label){case 0:return _d.trys.push([0,9,,11]),promoCode=action.code.toUpperCase(),action.isReplacement?[4,(0,redux_saga_effects_npm_proxy_esm.T1)(replacePromoCode,promoCode)]:[3,2];case 1:return _a=_d.sent(),[3,4];case 2:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(applyPromoCode,promoCode)];case 3:_a=_d.sent(),_d.label=4;case 4:return response=_a,(0,Promo.yD)(response.data)?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.PROMO_CODE_APPLY_OR_REPLACE_SUCCESS})]:[3,8];case 5:return _d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(refreshUser())];case 6:return _d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(segment.u4,segment.sV.promo_code_add_replace)];case 7:_d.sent(),_d.label=8;case 8:return[3,11];case 9:return err_1=_d.sent(),errorMessage=(null===(_c=null===(_b=null==err_1?void 0:err_1.response)||void 0===_b?void 0:_b.data)||void 0===_c?void 0:_c.errors)?err_1.response.data.errors[0].code:"UNKNOWN",[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((error=new Error(errorMessage),{error,type:constants.t.PROMO_CODE_APPLY_OR_REPLACE_ERROR}))];case 10:return _d.sent(),[3,11];case 11:return[2]}var error}))}));var rates_at_checkout_actions=__webpack_require__("./app/actions/rates-at-checkout.actions.ts");function fetchShippingOptions(){return services_api.YZ.request({method:"GET",url:"service-groups"})}function updateShippingOption(payload){return services_api.YZ.request({method:"PUT",url:"service-groups",data:payload})}function createShippingOption(payload){return services_api.YZ.request({method:"POST",url:"service-groups",data:payload})}function deleteShippingOption(id){return services_api.YZ.request({method:"DELETE",url:"service-groups/".concat(id,"/")})}function getliveRatePackage(){return services_api.YZ.request({method:"GET",url:"live-rates/settings/parcel-template"})}function updateLiveRatePackage(payload){return services_api.YZ.request({method:"PUT",url:"live-rates/settings/parcel-template",data:payload})}function fetchLiveRateSenderAddress(){return services_api.YZ.request({method:"GET",url:"live-rates/settings/address"})}function updateLiveRateSenderAddress(liveRateAddressId){var payload={live_rates_address_id:liveRateAddressId};return services_api.YZ.request({method:"PUT",url:"live-rates/settings/address",data:payload})}var TypeId,INTEGRATED_STORES=["wix"];function RatesAtCheckout_fromJSON(parcelTemplate){return{objectId:parcelTemplate.object_id,height:Number(parcelTemplate.height),length:Number(parcelTemplate.length),width:Number(parcelTemplate.width),isDefault:parcelTemplate.is_default,name:parcelTemplate.name,distanceUnit:parcelTemplate.distance_unit,weightUnit:parcelTemplate.weight_unit,weight:Number(parcelTemplate.weight),carrierTemplate:(template=parcelTemplate.template,template?(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},template),{providerId:template.provider_id,apiToken:template.api_token,isVariableDimensions:template.is_variable_dimensions,distanceUnit:template.distance_unit}):null)};var template}function parseErrorObject(errorObj){var e_1,_a,errors=[];try{for(var _b=(0,tslib_es6.Ju)(Object.entries(errorObj)),_c=_b.next();!_c.done;_c=_b.next()){var _d=(0,tslib_es6.zs)(_c.value,2),errorKey=_d[0],errorMessage=_d[1];errorKey&&errorMessage&&errors.push("".concat(errorKey,": ").concat(errorMessage))}}catch(e_1_1){e_1={error:e_1_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_1)throw e_1.error}}return errors}function errorDetail(err){var _a,_b,_c;return null!==(_c=null===(_b=null===(_a=null==err?void 0:err.response)||void 0===_a?void 0:_a.data)||void 0===_b?void 0:_b.detail)&&void 0!==_c?_c:"An error occurred. Please try again later."}!function(TypeId){TypeId.LIVE_RATE="LIVE_RATE",TypeId.FLAT_RATE="FLAT_RATE",TypeId.FREE_SHIPPING="FREE_SHIPPING"}(TypeId||(TypeId={}));(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.RATES_AT_CHECKOUT_FETCH_SHIPPING_OPTIONS,(function rates_at_checkout_sagas_fetchShippingOptions(){var response,err_1;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(fetchShippingOptions)];case 1:return response=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(rates_at_checkout_actions.ii(response))];case 2:case 4:return _a.sent(),[3,5];case 3:return err_1=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(rates_at_checkout_actions.zt(err_1.message))];case 5:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.RATES_AT_CHECKOUT_CREATE_SHIPPING_OPTION,(function rates_at_checkout_sagas_createShippingOption(action){var response,updatedResp,err_2,errorArray;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,6,,8]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(createShippingOption,action.payload)];case 1:return response=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(rates_at_checkout_actions.XR(response))];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(fetchShippingOptions)];case 3:return updatedResp=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(rates_at_checkout_actions.ii(updatedResp))];case 4:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(rates_at_checkout_actions.MI())];case 5:case 7:return _a.sent(),[3,8];case 6:return err_2=_a.sent(),errorArray=parseErrorObject(err_2.response.data),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(rates_at_checkout_actions.UZ(errorArray))];case 8:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.RATES_AT_CHECKOUT_UPDATE_SHIPPING_OPTION,(function rates_at_checkout_sagas_updateShippingOption(action){var response,updatedResp,err_3,errorArray;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,6,,8]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(updateShippingOption,action.payload)];case 1:return response=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(rates_at_checkout_actions.UU(response))];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(fetchShippingOptions)];case 3:return updatedResp=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(rates_at_checkout_actions.ii(updatedResp))];case 4:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(rates_at_checkout_actions.MI())];case 5:case 7:return _a.sent(),[3,8];case 6:return err_3=_a.sent(),errorArray=parseErrorObject(err_3.response.data),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(rates_at_checkout_actions.Tk(errorArray))];case 8:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.RATES_AT_CHECKOUT_DELETE_SHIPPING_OPTION,(function rates_at_checkout_sagas_deleteShippingOption(action){var response,updatedResp,err_4;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,6,,8]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(deleteShippingOption,action.payload)];case 1:return response=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(rates_at_checkout_actions.At(response))];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(fetchShippingOptions)];case 3:return updatedResp=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(rates_at_checkout_actions.ii(updatedResp))];case 4:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(rates_at_checkout_actions.MI())];case 5:case 7:return _a.sent(),[3,8];case 6:return err_4=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(rates_at_checkout_actions.Xn(errorDetail(err_4)))];case 8:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.RATES_AT_CHECKOUT_FETCH_LIVE_RATE_PACKAGE,(function fetchLiveRatePackage(){var response,formattedParcelTemplates,err_5;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getliveRatePackage)];case 1:return response=_a.sent(),formattedParcelTemplates=response,response.data.result&&(formattedParcelTemplates=(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},response),{data:{result:RatesAtCheckout_fromJSON(response.data.result)}})),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(rates_at_checkout_actions.aY(formattedParcelTemplates))];case 2:case 4:return _a.sent(),[3,5];case 3:return err_5=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(rates_at_checkout_actions.NK(errorDetail(err_5)))];case 5:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.RATES_AT_CHECKOUT_UPDATE_LIVE_RATE_PACKAGE,(function rates_at_checkout_sagas_updateLiveRatePackage(action){var updateResp,response,formattedParcelTemplates,err_6;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,5,,7]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(updateLiveRatePackage,{object_id:action.payload})];case 1:return updateResp=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getliveRatePackage)];case 2:return response=_a.sent(),formattedParcelTemplates=response,response.data.result&&(formattedParcelTemplates=(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},response),{data:{result:RatesAtCheckout_fromJSON(response.data.result)}})),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(rates_at_checkout_actions.aY(formattedParcelTemplates))];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(rates_at_checkout_actions.zU(updateResp))];case 4:case 6:return _a.sent(),[3,7];case 5:return err_6=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(rates_at_checkout_actions.Qk(errorDetail(err_6)))];case 7:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.RATES_AT_CHECKOUT_FETCH_LIVE_RATE_SENDER_ADDRESS,(function rates_at_checkout_sagas_fetchLiveRateSenderAddress(){var response,parsedResponseData,err_7;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(fetchLiveRateSenderAddress)];case 1:return response=_a.sent(),parsedResponseData=function fromJSONsenderAddress(jsonAddress){return{objectOwnerID:jsonAddress.object_owner_id,id:jsonAddress.id,name:jsonAddress.name,email:jsonAddress.email,phone:jsonAddress.phone,company:jsonAddress.company,addressId:jsonAddress.address_id,street1:jsonAddress.street1,street2:jsonAddress.street2,state:jsonAddress.state,city:jsonAddress.city,zip:jsonAddress.zip,country:constants_countries.Xr[jsonAddress.country],streetNumber:jsonAddress.street_no,isDefaultReturn:jsonAddress.is_default_return,isDefaultSender:jsonAddress.is_default_sender}}(null==response?void 0:response.data),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(rates_at_checkout_actions.Fs(parsedResponseData))];case 2:case 4:return _a.sent(),[3,5];case 3:return err_7=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(rates_at_checkout_actions.wR(errorDetail(err_7)))];case 5:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.RATES_AT_CHECKOUT_UPDATE_LIVE_RATE_SENDER_ADDRESS,(function rates_at_checkout_sagas_updateLiveRateSenderAddress(action){var response,err_8;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(updateLiveRateSenderAddress,action.payload.liveRatesAddressId)];case 1:return response=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(rates_at_checkout_actions.A(response.data))];case 2:case 4:return _a.sent(),[3,5];case 3:return err_8=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(rates_at_checkout_actions.Rj(errorDetail(err_8)))];case 5:return[2]}}))}));function storeCurrentQueryParams(){var currentQS;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(getParsedQS)];case 1:return currentQS=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(local_storage.r,QS_LOCAL_STORAGE_KEY,JSON.stringify(currentQS))];case 2:return _a.sent(),[2]}}))}(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.CHANGE_QUERY_PARAMS,(function changeQueryParams(action){var location,newQueryParams,queryString;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.Lt)((function(state){return state.router.location}))];case 1:return location=_a.sent(),newQueryParams=(0,tslib_es6.Cl)({},action.payload),queryString=lib.stringify(newQueryParams),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,actions.VC)("".concat(location.pathname,"?").concat(queryString)))];case 2:return _a.sent(),[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.UPDATE_QUERY_PARAM,(function updateQueryParam(action){var location,currentQueryParams,newQueryParams,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.Lt)((function(state){return state.router.location}))];case 1:return location=_b.sent(),currentQueryParams=lib.parse(location.search.substring(1)),newQueryParams=(0,tslib_es6.Cl)((0,tslib_es6.Cl)({sort_by:"_score",order_by:"desc"},currentQueryParams),((_a={})[action.payload.name]=action.payload.value,_a)),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,actions.VC)("".concat(location.pathname,"?").concat(lib.stringify(newQueryParams))))];case 2:return _b.sent(),[4,storeCurrentQueryParams()];case 3:return _b.sent(),[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.UPDATE_QUERY_PARAMS,(function updateQueryParams(action){var location,currentQueryParams,newQueryParams,queryString;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.Lt)((function(state){return state.router.location}))];case 1:return location=_a.sent(),currentQueryParams=lib.parse(location.search.substring(1)),newQueryParams=(0,tslib_es6.Cl)((0,tslib_es6.Cl)({sort_by:"_score",order_by:"desc"},currentQueryParams),action.payload),queryString=lib.stringify(newQueryParams),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,actions.VC)("".concat(location.pathname,"?").concat(queryString)))];case 2:return _a.sent(),[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.STORE_CURRENT_QUERY_PARAMS,storeCurrentQueryParams),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.RESTORE_QUERY_PARAMS,(function restoreQueryParams(){var storedQSString,storedQS,location_1,queryString;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return(storedQSString=(0,local_storage.X)(QS_LOCAL_STORAGE_KEY))?(storedQS=JSON.parse(storedQSString),Object.keys(storedQS).length>0?[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(getLocation)]:[3,3]):[3,3];case 1:return location_1=_a.sent(),queryString=lib.stringify(storedQS),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,actions.HC)("".concat(location_1.pathname,"?").concat(queryString)))];case 2:_a.sent(),_a.label=3;case 3:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.REMOVE_QUERY_PARAM,(function removeQueryParam(action){var location,currentQueryParams,newQueryParams;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.Lt)((function(state){return state.router.location}))];case 1:return location=_a.sent(),delete(currentQueryParams=lib.parse(location.search.substring(1)))[action.payload.name],newQueryParams=(0,tslib_es6.Cl)({},currentQueryParams),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,actions.VC)("".concat(location.pathname,"?").concat(lib.stringify(newQueryParams))))];case 2:return _a.sent(),[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.REMOVE_QUERY_PARAMS,(function removeQueryParams(action){var location,currentQueryParams,newQueryParams;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.Lt)((function(state){return state.router.location}))];case 1:return location=_a.sent(),currentQueryParams=lib.parse(location.search.substring(1)),action.payload.name.forEach((function(param){return delete currentQueryParams[param]})),newQueryParams=(0,tslib_es6.Cl)({},currentQueryParams),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,actions.VC)("".concat(location.pathname,"?").concat(lib.stringify(newQueryParams))))];case 2:return _a.sent(),[2]}}))}));(0,redux_saga_effects_npm_proxy_esm.p8)([constants.t.ORDERS_GET_ALL_LABELS_SUCCESS,constants.t.ORDERS_GET_LABEL_SUCCESS],(function ordersDownloadLabel(){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(utils.f0,"other",segment.sV.label_downloaded)];case 1:return _a.sent(),[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_GET_PACKING_SLIP,(function ordersDownloadPackingSlip(){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(segment.u4,segment.sV.packing_slip_downloaded)];case 1:return _a.sent(),[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)([constants.t.FETCH_CARRIER_ACCOUNTS_SUCCESS,constants.t.CREATE_CARRIER_ACCOUNT_SUCCESS],(function userCarrierAccountTraits(){var userId,userCarrierAccounts,localTraits,personalCarrierNames;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,selectState(user_selectors.F6)];case 1:return userId=_a.sent(),[4,selectState(carrier_accounts_selectors.sp)];case 2:return(userCarrierAccounts=_a.sent()).length?(localTraits=(0,segment.P0)(),personalCarrierNames=(0,uniq.A)(userCarrierAccounts.map((function(carrier){return carrier.carrier.name}))),localTraits&&!localTraits.personal_carriers||localTraits&&localTraits.personal_carriers&&Array.isArray(localTraits.personal_carriers)&&!(0,isEqual.A)(personalCarrierNames,localTraits.personal_carriers)?[4,(0,redux_saga_effects_npm_proxy_esm.T1)(segment.ls,userId||void 0,{personal_carriers:personalCarrierNames})]:[3,4]):[3,4];case 3:_a.sent(),_a.label=4;case 4:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)([constants.t.ADDRESSES_FETCH_SUCCESS,constants.t.APIADDRESS_CREATE,constants.t.APIADDRESS_EDIT,constants.t.APIADDRESS_DELETE],(function userAddressTraits(){var defaultSenderAddress,userId,_a,_b;return(0,tslib_es6.YH)(this,(function(_c){switch(_c.label){case 0:return[4,selectState(address_selectors.dR)];case 1:return(defaultSenderAddress=_c.sent())?[4,selectState(user_selectors.F6)]:[2];case 2:return userId=_c.sent(),defaultSenderAddress.country&&((0,segment.Ok)("sender_address_city",defaultSenderAddress.city)||(0,segment.Ok)("sender_address_phone",defaultSenderAddress.phone)||(0,segment.Ok)("sender_address_state",defaultSenderAddress.state)||(0,segment.Ok)("sender_address_country_name",null===(_a=defaultSenderAddress.country)||void 0===_a?void 0:_a.name)||(0,segment.Ok)("email",defaultSenderAddress.email))?[4,(0,redux_saga_effects_npm_proxy_esm.T1)(segment.ls,userId||void 0,{sender_address_company:defaultSenderAddress.company,sender_address_city:defaultSenderAddress.city,sender_address_state:defaultSenderAddress.state,sender_address_country_name:null===(_b=defaultSenderAddress.country)||void 0===_b?void 0:_b.name,sender_address_name:defaultSenderAddress.name,sender_address_phone:defaultSenderAddress.phone,sender_address_email:defaultSenderAddress.email,master_account_available:(0,onboarding_constants.At)(defaultSenderAddress.country)})]:[3,4];case 3:_c.sent(),_c.label=4;case 4:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)([onboarding_actions.CT.UPDATE_ONBOARDING_INFO_SUCCESS],(function updateCountryHasMasterAccountOnboarding(action){var userId;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,selectState(user_selectors.F6)];case 1:return userId=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(segment.ls,userId||void 0,{master_account_available:action.payload.values.country?(0,onboarding_constants.At)(action.payload.values.country):void 0})];case 2:return _a.sent(),[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_BATCH_CREATE_TRANSACTIONS_ERROR,(function sendLabelPurchaseFailedEvent(action){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(segment.u4,segment.sV.label_purchase_failed,{error:action.payload.error})];case 1:return _a.sent(),[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.DISCONNECT_STORE_SUCCESS,(function sendStoreDisconnectedEvent(action){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(segment.u4,segment.sV.store_disconnected,{store:action.storeName})];case 1:return _a.sent(),[2]}}))}));var getRatesAtCheckoutStore=function(state){return state.ratesAtCheckout},getShippingOptions=((0,reselect_es.createSelector)(getRatesAtCheckoutStore,(function(ratesAtCheckoutStore){return ratesAtCheckoutStore.addShippingOptionModalIsOpen})),(0,reselect_es.createSelector)(getRatesAtCheckoutStore,(function(ratesAtCheckoutStore){return(0,fetchable.Vn)(ratesAtCheckoutStore.shippingOptions)||[]}))),getIsShippingOptionsRequestInitiated=((0,reselect_es.createSelector)(getRatesAtCheckoutStore,(function(ratesAtCheckoutStore){return(0,fetchable.Vn)(ratesAtCheckoutStore.liveRatePackage)})),(0,reselect_es.createSelector)(getRatesAtCheckoutStore,(function(ratesAtCheckoutStore){var e_1,_a,requestTypes=[ratesAtCheckoutStore.createShippingOptionStatus,ratesAtCheckoutStore.updateShippingOptionStatus,ratesAtCheckoutStore.deleteShippngOptionStatus],errors=[];try{for(var requestTypes_1=(0,tslib_es6.Ju)(requestTypes),requestTypes_1_1=requestTypes_1.next();!requestTypes_1_1.done;requestTypes_1_1=requestTypes_1.next()){var type=requestTypes_1_1.value;"failed"===type.kind&&errors.push.apply(errors,(0,tslib_es6.fX)([],(0,tslib_es6.zs)(type.error),!1))}}catch(e_1_1){e_1={error:e_1_1}}finally{try{requestTypes_1_1&&!requestTypes_1_1.done&&(_a=requestTypes_1.return)&&_a.call(requestTypes_1)}finally{if(e_1)throw e_1.error}}return errors})),(0,reselect_es.createSelector)(getRatesAtCheckoutStore,(function(providersStore){return(0,fetchable.ST)(providersStore.liveRatePackage)})),(0,reselect_es.createSelector)(getRatesAtCheckoutStore,(function(providersStore){var request=providersStore.shippingOptions;return(0,fetchable.ST)(request)||(0,fetchable.Fd)(request)}))),getIsShippingOptionsRequestComplete=(0,reselect_es.createSelector)(getRatesAtCheckoutStore,(function(providersStore){var request=providersStore.shippingOptions;return(0,fetchable.Zd)(request)||(0,fetchable.Fd)(request)}));(0,reselect_es.createSelector)(getRatesAtCheckoutStore,(function(providersStore){return(0,fetchable.Vn)(providersStore.liveRateSenderAddress)})),(0,reselect_es.createSelector)(getRatesAtCheckoutStore,(function(providersStore){var request=providersStore.liveRateSenderAddress;return(0,fetchable.Zd)(request)||(0,fetchable.Fd)(request)}));function getRates(shipmentId){return services_api.Ay.request({url:"/shipments/".concat(shipmentId),method:"GET"})}var Shipment=__webpack_require__("./app/types/Shipment.ts"),redux_batched_subscribe_lib=__webpack_require__("./node_modules/redux-batched-subscribe/lib/index.js");const batch_state={notify:null};(0,redux_batched_subscribe_lib.a)((function(freshNotify){batch_state.notify=freshNotify}));function batchAction(action){return(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},action),{meta:(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},action.meta||{}),{batch:!0})})}function autoSelectRateHelper(shipment,trackingReference){var userTouchedRates,checkoutRateAfterPoll,autoCheckoutRateFound,userDefaultServiceLevel,rates,allServiceLevels,autoSelectedRate,currentBatchStep,serviceLevelForAllOrders,batchEntries,batchEntryWithPreferredServiceLevelToken,token,ratesForServiceLevelToken,shipmentDatasets,shipmentDataset,isIntegratedStoreOrder,shippingOptions,isShippingOptionsInitiated,isShippingOptionsRequestComplete,response,err_2,matchedShippingOption,cheapestMatchedRate,_a,cheapestRates,bestOption,_b,_c;return(0,tslib_es6.YH)(this,(function(_d){switch(_d.label){case 0:return[4,selectState(rates_selectors.l0)];case 1:return userTouchedRates=_d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(orders_selectors.qy)];case 2:return checkoutRateAfterPoll=_d.sent(),autoCheckoutRateFound=!1,userTouchedRates[shipment.objectId]?[2]:[4,selectState(user_selectors.Ye)];case 3:return userDefaultServiceLevel=_d.sent(),rates=shipment.rates,[4,selectState(providers_selectors.ig)];case 4:return allServiceLevels=_d.sent(),Object.keys(allServiceLevels).length>0&&(rates=rates.filter((function(rate){var _a,_b,_c,_d;return!(null==rate?void 0:rate.carrierAccount)||!(null===(_a=null==rate?void 0:rate.servicelevel)||void 0===_a?void 0:_a.token)||!(null===(_d=null===(_b=allServiceLevels[rate.carrierAccount])||void 0===_b?void 0:_b.serviceLevelsByToken[null!==(_c=rate.servicelevel.extended_token)&&void 0!==_c?_c:rate.servicelevel.token])||void 0===_d?void 0:_d.is_hidden)}))),0===rates.length?[2]:[4,selectState(orders_batch_selectors.eS)];case 5:return currentBatchStep=_d.sent(),[4,selectState(orders_batch_selectors.s_)];case 6:return serviceLevelForAllOrders=_d.sent(),checkoutRateAfterPoll&&(null===(_c=checkoutRateAfterPoll.currBatchEntry)||void 0===_c?void 0:_c.shipmentObjectId)===shipment.objectId&&(autoSelectedRate=rates.find((function(rate){return rate.servicelevel.token===checkoutRateAfterPoll.serviceLevelToken&&checkoutRateAfterPoll.carrierAccount===rate.carrierAccount})))&&(autoCheckoutRateFound=!0),currentBatchStep!==OrdersBatch.kG.NONE&&serviceLevelForAllOrders&&!autoSelectedRate&&(autoSelectedRate=rates.find((function(rate){return rate.servicelevel.token===serviceLevelForAllOrders}))),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(batch_entry_selectors.zo)];case 7:return batchEntries=_d.sent(),batchEntryWithPreferredServiceLevelToken=Object.values(batchEntries).find((function(batchEntry){return batchEntry.shipmentObjectId===shipment.objectId&&batchEntry.preferredServiceLevelToken})),(token=null==batchEntryWithPreferredServiceLevelToken?void 0:batchEntryWithPreferredServiceLevelToken.preferredServiceLevelToken)&&(ratesForServiceLevelToken=(0,Rate.RH)(rates,token,null==batchEntryWithPreferredServiceLevelToken?void 0:batchEntryWithPreferredServiceLevelToken.preferredAccountObjectID)).length>0&&(autoSelectedRate=ratesForServiceLevelToken[0]),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(batch_entry_composite_selectors.mh)];case 8:return shipmentDatasets=_d.sent(),shipmentDataset=function getShipmentDatasetById(shipmentId,shipmentDatasets){if(shipmentDatasets&&shipmentId)return shipmentDatasets.find((function(dataset){var _a;if((null===(_a=dataset.batchEntry)||void 0===_a?void 0:_a.shipmentObjectId)===shipmentId)return dataset}))}(null==shipment?void 0:shipment.objectId,shipmentDatasets),isIntegratedStoreOrder=function isIntegratedStore(dataset){var _a,_b;if(dataset){var storeName=null===(_b=null===(_a=dataset.order)||void 0===_a?void 0:_a.shopApp)||void 0===_b?void 0:_b.toLowerCase().trim();return INTEGRATED_STORES.includes(storeName)}}(shipmentDataset),isIntegratedStoreOrder?[4,selectState(getShippingOptions)]:[3,19];case 9:return shippingOptions=_d.sent(),[4,selectState(getIsShippingOptionsRequestInitiated)];case 10:return isShippingOptionsInitiated=_d.sent(),[4,selectState(getIsShippingOptionsRequestComplete)];case 11:if(isShippingOptionsRequestComplete=_d.sent(),(0!==shippingOptions.length||isShippingOptionsInitiated)&&isShippingOptionsRequestComplete)return[3,18];_d.label=12;case 12:return _d.trys.push([12,16,,18]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(fetchShippingOptions)];case 13:return response=_d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(rates_at_checkout_actions.ii(response))];case 14:return _d.sent(),[4,selectState(getShippingOptions)];case 15:return shippingOptions=_d.sent(),[3,18];case 16:return err_2=_d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(rates_at_checkout_actions.zt(err_2.message))];case 17:return _d.sent(),[3,18];case 18:matchedShippingOption=function getMatchedShippingOption(shippingOptions,dataset){var _a,_b,shippingMethodName=null===(_b=null===(_a=null==dataset?void 0:dataset.order)||void 0===_a?void 0:_a.shippingMethod)||void 0===_b?void 0:_b.toLowerCase().trim();if(shippingMethodName&&0!==shippingOptions.length)return shippingOptions.find((function(option){var _a;return(null===(_a=null==option?void 0:option.name)||void 0===_a?void 0:_a.toLowerCase().trim())===shippingMethodName}))}(shippingOptions,shipmentDataset),cheapestMatchedRate=function findCheapestMatchedServiceLevelRate(matchedOptionServiceLevels,rates){var e_2,_a;if(matchedOptionServiceLevels&&0!==rates.length){var cheapestMatchedRate,_loop_1=function(serviceLevel){var matchedRate=rates.find((function(rate){var _a,_b,optionAccountId=null===(_a=serviceLevel.account_object_id)||void 0===_a?void 0:_a.replace(/-/g,""),optionToken=serviceLevel.service_level_token,isMatchedAccount=rate.carrierAccount===optionAccountId;return(null===(_b=rate.servicelevel)||void 0===_b?void 0:_b.token)===optionToken&&isMatchedAccount}));if(matchedRate)if(cheapestMatchedRate){var matchedRateAmount=parseFloat(matchedRate.amount),cheapestRateAmount=parseFloat(cheapestMatchedRate.amount);cheapestMatchedRate=matchedRateAmount<cheapestRateAmount?matchedRate:cheapestMatchedRate}else cheapestMatchedRate=matchedRate};try{for(var matchedOptionServiceLevels_1=(0,tslib_es6.Ju)(matchedOptionServiceLevels),matchedOptionServiceLevels_1_1=matchedOptionServiceLevels_1.next();!matchedOptionServiceLevels_1_1.done;matchedOptionServiceLevels_1_1=matchedOptionServiceLevels_1.next())_loop_1(matchedOptionServiceLevels_1_1.value)}catch(e_2_1){e_2={error:e_2_1}}finally{try{matchedOptionServiceLevels_1_1&&!matchedOptionServiceLevels_1_1.done&&(_a=matchedOptionServiceLevels_1.return)&&_a.call(matchedOptionServiceLevels_1)}finally{if(e_2)throw e_2.error}}return cheapestMatchedRate}}(null==matchedShippingOption?void 0:matchedShippingOption.service_levels,rates),cheapestMatchedRate&&!autoSelectedRate&&(autoSelectedRate=cheapestMatchedRate),_d.label=19;case 19:return _a=(0,Rate.jt)(rates),cheapestRates=_a.cheapestRates,bestOption=_a.bestOption,userDefaultServiceLevel&&!autoSelectedRate&&(autoSelectedRate=rates.find((function(rate){return rate.servicelevel.token===userDefaultServiceLevel.token}))),!autoSelectedRate&&bestOption&&(autoSelectedRate=bestOption[0]),!autoSelectedRate&&cheapestRates.length>0&&(autoSelectedRate=cheapestRates[0]),autoSelectedRate||(autoSelectedRate=rates[0]),autoSelectedRate?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(batchAction(selectRate(shipment.objectId,autoSelectedRate.objectId,!1,trackingReference)))]:[3,21];case 20:_d.sent(),_d.label=21;case 21:return checkoutRateAfterPoll&&checkoutRateAfterPoll.currBatchEntry&&autoCheckoutRateFound?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,orders_actions.dT)((_b={},_b[checkoutRateAfterPoll.currBatchEntry.orderObjectId]=[checkoutRateAfterPoll.currBatchEntry.id],_b)))]:[3,23];case 22:_d.sent(),_d.label=23;case 23:return[2]}}))}(0,redux_saga_effects_npm_proxy_esm.jP)(constants.t.SHIPMENT_FETCH,(function shipments_saga_fetchShipment(action){var shipmentId,trackingReference,response,shipment,ratesBestOptionFlag,isRatesBestOptionEnabled,payload,_a,_b,_c,_d;return(0,tslib_es6.YH)(this,(function(_e){switch(_e.label){case 0:return _e.trys.push([0,4,,6]),shipmentId=action.shipmentId,trackingReference=action.trackingReference,[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getRates,shipmentId)];case 1:return response=_e.sent(),shipment=Shipment.rS(response.data),ratesBestOptionFlag=null===(_a=window._optimizelyClient)||void 0===_a?void 0:_a.decide("rates_best_option"),isRatesBestOptionEnabled="variant"===(null==ratesBestOptionFlag?void 0:ratesBestOptionFlag.variationKey),shipment.rates=isRatesBestOptionEnabled?getBestRate(shipment.rates):shipment.rates,payload={shipment},[4,(0,redux_saga_effects_npm_proxy_esm.T1)(utils.Rx,trackingReference,types.Fd.operations.GENERATED,{rateIds:null===(_c=null===(_b=payload.shipment)||void 0===_b?void 0:_b.rates)||void 0===_c?void 0:_c.map((function(rate){return rate.objectId})),shipmentId:null===(_d=payload.shipment)||void 0===_d?void 0:_d.objectId})];case 2:return _e.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(batchAction(fetchShipmentRatesSuccess(shipmentId,payload,trackingReference)))];case 3:case 5:return _e.sent(),[3,6];case 4:return _e.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((shipmentObjectId=action.shipmentId,{type:constants.t.SHIPMENT_FETCH_ERROR,payload:{shipmentObjectId}}))];case 6:return[2]}var shipmentObjectId}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(constants.t.SHIPMENT_FETCH_SUCCESS,(function autoSelectRate(action){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,autoSelectRateHelper(action.payload.shipment,action.trackingReference)];case 1:return _a.sent(),[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.SHIPMENT_FETCH_SUCCESS,(function trackRateDisplayed(action){var shipment,trackingReference,isBulk,orderQuantity,rates,attributedRates,sortedRates,carrierAccounts,attributedRates_1,attributedRates_1_1,rate,eventData,e_1_1,e_1,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return shipment=action.payload.shipment,trackingReference=action.trackingReference,isBulk=trackingReference.isBulk,orderQuantity=trackingReference.orderQuantity,shipment.status!==Shipment.PH.SUCCESS||isBulk||!orderQuantity?[2]:(rates=shipment.rates,attributedRates=(0,Rate.yF)(rates),sortedRates=(0,Rate.P2)(attributedRates),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(carrier_accounts_selectors.Pr)]);case 1:carrierAccounts=_b.sent(),_b.label=2;case 2:_b.trys.push([2,7,8,9]),attributedRates_1=(0,tslib_es6.Ju)(attributedRates),attributedRates_1_1=attributedRates_1.next(),_b.label=3;case 3:return attributedRates_1_1.done?[3,6]:(rate=attributedRates_1_1.value,eventData=(0,utils.Mz)(rate,sortedRates,carrierAccounts),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(utils.me,trackingReference,types.N6.operations.DISPLAYED,eventData)]);case 4:_b.sent(),_b.label=5;case 5:return attributedRates_1_1=attributedRates_1.next(),[3,3];case 6:return[3,9];case 7:return e_1_1=_b.sent(),e_1={error:e_1_1},[3,9];case 8:try{attributedRates_1_1&&!attributedRates_1_1.done&&(_a=attributedRates_1.return)&&_a.call(attributedRates_1)}finally{if(e_1)throw e_1.error}return[7];case 9:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(constants.t.RETRY_AUTO_SELECT_RATES,(function shipments_saga_retryAutoSelectRates(){var shipmentsData,trackingReference;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(shipments_selectors.Q6)];case 1:return shipmentsData=_a.sent(),trackingReference=TrackingHelper.U.getTrackingReference(types.Fd.name,"order_table",{rateIds:void 0}),[4,(0,redux_saga_effects_npm_proxy_esm.Q7)(Object.values(shipmentsData).map((function(shipment){return autoSelectRateHelper(shipment,trackingReference)})))];case 2:return _a.sent(),[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.RATE_SELECT,(function shipments_saga_selectRate(action){var _a,orderSelection,serviceLevelToken,userTriggered,accountObjectId,trackingReference,rateObjectId;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return _a=action.payload,orderSelection=_a.orderSelection,serviceLevelToken=_a.serviceLevelToken,userTriggered=_a.userTriggered,accountObjectId=_a.accountObjectId,trackingReference=_a.trackingReference,rateObjectId=_a.rateObjectId,(0,utils.Rx)(trackingReference,types.Fd.operations.SELECTED,{isAutoSelection:!userTriggered,rateId:rateObjectId}),userTriggered&&orderSelection&&serviceLevelToken?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,orders_actions.eW)(orderSelection,serviceLevelToken,accountObjectId))]:[3,2];case 1:_b.sent(),_b.label=2;case 2:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.MULTIPLE_RATE_SELECT,(function shipments_saga_selectRates(action){var _a,orderSelection,serviceLevelToken,accountObjectId,trackingReference;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return _a=action.payload,orderSelection=_a.orderSelection,serviceLevelToken=_a.serviceLevelToken,accountObjectId=_a.accountObjectId,trackingReference=_a.trackingReference,orderSelection&&serviceLevelToken?((0,utils.Rx)(trackingReference,types.Fd.operations.SELECTED,{isAutoSelection:!1}),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,orders_actions.eW)(orderSelection,serviceLevelToken,accountObjectId))]):[3,2];case 1:_b.sent(),_b.label=2;case 2:return[2]}}))}));function fetchShippingMethodsSuccess(shippingMethods){return{type:constants.t.FETCH_SHIPPING_METHODS_SUCCESS,payload:{shippingMethods}}}function shipping_methods_service_fetchShippingMethods(){return services_api.YZ.request({url:"/user/orders/shipping_methods",method:"GET"})}(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.FETCH_SHIPPING_METHODS,(function getShippingMethods(){var response,shippingMethods;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(shipping_methods_service_fetchShippingMethods)];case 1:return response=_a.sent(),shippingMethods=response.data.results.shipping_methods,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchShippingMethodsSuccess(shippingMethods))];case 2:case 4:return _a.sent(),[3,5];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.FETCH_SHIPPING_METHODS_ERROR})];case 5:return[2]}}))}));var difference=__webpack_require__("./node_modules/lodash-es/difference.js"),stores_service=__webpack_require__("./app/services/stores.service.ts");function checkAndTrackStoreConnectionBehavior(){var connectedStores,currentlyConnectedStoreNames,persistedStores,updateStoresCookie,parsedPersistedStores,storeName;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(stores_selectors.o$)];case 1:return connectedStores=_a.sent(),currentlyConnectedStoreNames=connectedStores.map((function(x){return x.storePlatform.name})),persistedStores=(0,local_storage.X)("stores"),updateStoresCookie=function(){return(0,local_storage.r)("stores",JSON.stringify(currentlyConnectedStoreNames))},persistedStores?(parsedPersistedStores=JSON.parse(persistedStores)).length===connectedStores.length?[3,7]:(storeName=(0,difference.A)(parsedPersistedStores,currentlyConnectedStoreNames),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("Store Connect Success",{Store:storeName}))]):[3,8];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendGTMEvent({eventName:CONNECTED_STORE_SUCCESS,data:{store:storeName}}))];case 3:return _a.sent(),0!==parsedPersistedStores.length||1!==connectedStores.length?[3,6]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendGTMEvent({eventName:FIRST_STORE_CONNECTED,data:{store:storeName}}))];case 4:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("First Store Connected",{Store:storeName}))];case 5:_a.sent(),_a.label=6;case 6:updateStoresCookie(),_a.label=7;case 7:return[3,9];case 8:updateStoresCookie(),_a.label=9;case 9:return[2]}}))}(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.STORES_FETCH,(function fetchStores(){var response,stores,err_1;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,5,,7]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(stores_service.hO)];case 1:return response=_a.sent(),stores=response.data.results.map(Store.rS),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stores_actions.eo(stores))];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stores_actions.CF())];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(checkAndTrackStoreConnectionBehavior)];case 4:case 6:return _a.sent(),[3,7];case 5:return err_1=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stores_actions.de(err_1.toString()))];case 7:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.LEGACY_STORES_FETCH,(function fetchLegacyStores(){var connectedStores_1,response,stores,err_2;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,4,,6]),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(stores_selectors.o$)];case 1:return connectedStores_1=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(stores_service.CF)];case 2:return response=_a.sent(),stores=response.data.shops.map(Store.nJ).filter((function(store){return store})).filter((function(store){return!connectedStores_1.find((function(connectedStore){return connectedStore.storePlatform.name===store.storePlatform.name}))})),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stores_actions.pO(stores))];case 3:case 5:return _a.sent(),[3,6];case 4:return err_2=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stores_actions.QZ(err_2.toString()))];case 6:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.DISCONNECT_STORE,(function disconnectStore(action){var storeToDisconnect,storeIdToDisconnect,e_1;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:storeToDisconnect=action.payload.storeName,storeIdToDisconnect=action.payload.objectId,_a.label=1;case 1:return _a.trys.push([1,6,,8]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(stores_service.yw,storeToDisconnect,storeIdToDisconnect)];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stores_actions.HI(storeToDisconnect))];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stores_actions.hO())];case 4:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stores_actions.CF())];case 5:return _a.sent(),[3,8];case 6:return e_1=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stores_actions.OD(storeToDisconnect,e_1.toString()))];case 7:return _a.sent(),[3,8];case 8:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.STORE_EDIT,(function editStore(action){var response,store,err_3;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(stores_service.UW,action.payload.store)];case 1:return response=_a.sent(),store=(0,Store.rS)(response.data),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stores_actions.Hr(store))];case 2:case 4:return _a.sent(),[3,5];case 3:return err_3=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stores_actions.de(err_3.toString()))];case 5:return[2]}}))}));var stripe_actions=__webpack_require__("./app/actions/stripe.actions.ts"),redux_saga_core_npm_proxy_esm=__webpack_require__("./node_modules/redux-saga/dist/redux-saga-core-npm-proxy.esm.js"),stripeClient=null,stripeElements={},getStripeClient=function(){return stripeClient},getStripeElements=function(){return stripeElements},stripeChannel=(0,redux_saga_core_npm_proxy_esm.Ix)();(function watchStripeChannel(){var action;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.s)(stripeChannel)];case 1:return action=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(action)];case 2:return _a.sent(),[3,0];case 3:return[2]}}))})(),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.STRIPE_LOAD,(function loadStripe(action){var stripeJs,e_1;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,1,,3]),(stripeJs=document.createElement("script")).src="https://js.stripe.com/v3/",stripeJs.async=!0,stripeJs.onload=function(){stripeClient=window.Stripe(action.stripePublishableKey),stripeChannel.put(stripe_actions.Pi())},document.body.appendChild(stripeJs),[3,3];case 1:return e_1=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stripe_actions.Cb(e_1.toString()))];case 2:return _a.sent(),[3,3];case 3:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.STRIPE_CREATE_ELEMENT,(function createElement(action){var stripeClient,_a,numberElementId_1,expElementId_1,cvcElementId_1,elements,numberElem,expElem,cvcElem,e_2;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getStripeClient)];case 1:stripeClient=_b.sent(),_b.label=2;case 2:return _b.trys.push([2,9,,11]),stripeClient?(_a=action.payload,numberElementId_1=_a.numberElementId,expElementId_1=_a.expElementId,cvcElementId_1=_a.cvcElementId,elements=stripeClient.elements(),numberElem=elements.create("cardNumber",action.payload.cardNumberOptions),expElem=elements.create("cardExpiry",action.payload.cardExpOptions),cvcElem=elements.create("cardCvc",action.payload.cardCvcOptions),numberElem.mount("#".concat(numberElementId_1)),numberElem.addEventListener("change",(function(event){stripeChannel.put(stripe_actions.F1(numberElementId_1,event)),event.error?stripeChannel.put(stripe_actions.oy(numberElementId_1,event.error.message)):event.empty?stripeChannel.put(stripe_actions.h9(numberElementId_1,!0)):(stripeChannel.put(stripe_actions.nN(numberElementId_1)),stripeChannel.put(stripe_actions.h9(numberElementId_1,!1)))})),expElem.mount("#".concat(expElementId_1)),expElem.addEventListener("change",(function(event){stripeChannel.put(stripe_actions.F1(expElementId_1,event)),event.error?stripeChannel.put(stripe_actions.oy(expElementId_1,event.error.message)):event.empty?stripeChannel.put(stripe_actions.h9(expElementId_1,!0)):(stripeChannel.put(stripe_actions.nN(expElementId_1)),stripeChannel.put(stripe_actions.h9(expElementId_1,!1)))})),cvcElem.mount("#".concat(cvcElementId_1)),cvcElem.addEventListener("change",(function(event){stripeChannel.put(stripe_actions.F1(cvcElementId_1,event)),event.error?stripeChannel.put(stripe_actions.oy(cvcElementId_1,event.error.message)):event.empty?stripeChannel.put(stripe_actions.h9(cvcElementId_1,!0)):(stripeChannel.put(stripe_actions.nN(cvcElementId_1)),stripeChannel.put(stripe_actions.h9(cvcElementId_1,!1)))})),stripeElements[numberElementId_1]=numberElem,stripeElements[expElementId_1]=expElem,stripeElements[cvcElementId_1]=cvcElem,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stripe_actions.mh(numberElementId_1))]):[3,6];case 3:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stripe_actions.mh(expElementId_1))];case 4:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stripe_actions.mh(cvcElementId_1))];case 5:return _b.sent(),[3,8];case 6:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stripe_actions.D(action.payload.numberElementId,"Trying to create an element when stripe is not loaded"))];case 7:_b.sent(),_b.label=8;case 8:return[3,11];case 9:return e_2=_b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stripe_actions.D(action.payload.numberElementId,e_2.toString()))];case 10:return _b.sent(),[3,11];case 11:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.STRIPE_CREATE_TOKEN,(function createToken(action){var _a,analyticsContext,elementId,billingAddress,updatePrimaryAddress,trackingReference,creditDebitSelectionValue,stripeClient,stripeElements_1,element,location_1,billingAPIAddressJSON,userAddress,address,formattedBillingAddressJSON,result,e_3,response,responseData,errorMessage,_b,_c,_d,_e,_f;return(0,tslib_es6.YH)(this,(function(_g){switch(_g.label){case 0:return _a=action.payload,analyticsContext=_a.analyticsContext,elementId=_a.elementId,billingAddress=_a.billingAddress,updatePrimaryAddress=_a.updatePrimaryAddress,trackingReference=_a.trackingReference,creditDebitSelectionValue=_a.creditDebitSelectionValue,[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getStripeClient)];case 1:stripeClient=_g.sent(),(0,utils.kO)(trackingReference,types.es.operations.SAVE_ATTEMPTED,{}),_g.label=2;case 2:return _g.trys.push([2,36,,41]),stripeClient?[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getStripeElements)]:[3,33];case 3:return stripeElements_1=_g.sent(),element=stripeElements_1[action.payload.elementId],[4,selectState(getLocation)];case 4:return location_1=_g.sent(),element?updatePrimaryAddress?((billingAPIAddressJSON=(0,APIAddress.U2)((0,Address.ko)(billingAddress))).is_default_sender=!0,[4,selectState(user_selectors.GA)]):[3,15]:[3,30];case 5:return(userAddress=_g.sent())?userAddress.id!==billingAPIAddressJSON.id?[3,8]:[4,(0,redux_saga_effects_npm_proxy_esm.T1)(editApiAddress,billingAPIAddressJSON.id,billingAPIAddressJSON)]:[3,12];case 6:return response=_g.sent(),address=(0,APIAddress.rS)(response.data),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(updateUserDefaultAddress({address}))];case 7:return _g.sent(),[3,11];case 8:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(createApiAddress,billingAPIAddressJSON)];case 9:return response=_g.sent(),address=(0,APIAddress.rS)(response.data),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(updateUserDefaultAddress({address}))];case 10:_g.sent(),_g.label=11;case 11:return[3,15];case 12:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(createApiAddress,billingAPIAddressJSON)];case 13:return response=_g.sent(),address=(0,APIAddress.rS)(response.data),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(updateUserDefaultAddress({address}))];case 14:_g.sent(),_g.label=15;case 15:return formattedBillingAddressJSON={name:billingAddress.name,address_line1:billingAddress.street1,address_city:billingAddress.city,address_zip:billingAddress.zip},billingAddress.state&&(formattedBillingAddressJSON.state=billingAddress.state),billingAddress.street2&&(formattedBillingAddressJSON.address_line2=billingAddress.street2),billingAddress.country&&(formattedBillingAddressJSON.address_country=billingAddress.country.iso2),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(stripeClient.createToken,element,formattedBillingAddressJSON)];case 16:return(result=_g.sent()).error?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stripe_actions.Rw(elementId,result.error.message))]:[3,18];case 17:_g.sent(),(0,redux_saga_effects_npm_proxy_esm.yJ)(stripe_actions.oy(elementId,result.error.message)),_g.label=18;case 18:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stripe_actions.Ke(elementId,result.token))];case 19:return _g.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(updateCreditCard(elementId,result.token.id,JSON.stringify(billingAddress)))];case 20:return _g.sent(),[4,selectState(user_selectors.Jy)];case 21:return _g.sent()?[3,26]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendGTMEvent({eventName:"SET_FIRST_CREDIT_CARD"}))];case 22:return _g.sent(),(null===(_b=location_1.search)||void 0===_b?void 0:_b.includes("progressMeter"))?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("Progress Meter - Add Payment Info Completed"))]:[3,24];case 23:_g.sent(),_g.label=24;case 24:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("First Set Credit Card Information"))];case 25:return _g.sent(),(0,utils.kO)(trackingReference,types.es.operations.ADDED,{stripeCardFingerprint:null===(_c=result.token.card)||void 0===_c?void 0:_c.fingerprint,fundingMethod:null===(_d=result.token.card)||void 0===_d?void 0:_d.funding,creditDebitSelectionValue}),[3,27];case 26:(0,utils.kO)(trackingReference,types.es.operations.UPDATED,{stripeCardFingerprint:null===(_e=result.token.card)||void 0===_e?void 0:_e.fingerprint,fundingMethod:null===(_f=result.token.card)||void 0===_f?void 0:_f.funding,creditDebitSelectionValue}),_g.label=27;case 27:return analyticsContext?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("".concat(analyticsContext,"-succeed-save")))]:[3,29];case 28:_g.sent(),_g.label=29;case 29:return[3,32];case 30:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stripe_actions.Rw(action.payload.elementId,"Trying to create a token for a non-existing element"))];case 31:_g.sent(),_g.label=32;case 32:return[3,35];case 33:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stripe_actions.Rw(action.payload.elementId,"Trying to create a token when stripe is not loaded"))];case 34:_g.sent(),_g.label=35;case 35:return[3,41];case 36:return e_3=_g.sent(),axios_default().isAxiosError(e_3)&&e_3.response&&(response=e_3.response,(0,utils.mq)(trackingReference,{url:response.config.url||"",isError:response.status>=300,status:response.status,message:e_3.message})),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stripe_actions.Rw(elementId,e_3.toString()))];case 37:return _g.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(stripe_actions.OL(elementId))];case 38:return _g.sent(),e_3.response?(responseData=e_3.response.data,errorMessage="object"==typeof responseData?Object.values(responseData).join("\n"):Array.isArray(responseData)?responseData.join("\n"):responseData,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(setPaymentProcessingError(errorMessage))]):[3,40];case 39:_g.sent(),_g.label=40;case 40:return[3,41];case 41:return[2]}}))}));function generateToken(isTest){return services_api.kC.request({url:"/authentication_tokens",method:"POST",data:{created:null,test:isTest,token:null}})}function getToken(){return services_api.kC.request({url:"/authentication_tokens"})}function deleteToken(token){return services_api.kC.request({method:"DELETE",url:"/authentication_tokens/".concat(token)})}(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.GENERATE_TOKEN,(function token_saga_generateToken(action){var response,err_1;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,3]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(generateToken,action.payload.isTest)];case 1:return response=_a.sent(),action.callback(response.data),[3,3];case 2:return err_1=_a.sent(),action.callback(err_1),[3,3];case 3:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.FETCH_TOKEN,(function token_saga_getToken(action){var response,err_2;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,3]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getToken)];case 1:return response=_a.sent(),action.callback(response.data.results),[3,3];case 2:return err_2=_a.sent(),action.callback(err_2),[3,3];case 3:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.DELETE_TOKEN,(function token_saga_deleteToken(action){var response,err_3;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,3]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(deleteToken,action.payload.token)];case 1:return response=_a.sent(),action.callback(response.data.results),[3,3];case 2:return err_3=_a.sent(),action.callback(err_3),[3,3];case 3:return[2]}}))}));function fetchTrackingConfigSuccess(data){return{type:constants.t.FETCH_TRACKING_CONFIG_SUCCESS,payload:data}}function fetchTrackingConfigError(error){return{type:constants.t.FETCH_TRACKING_CONFIG_ERROR,payload:{error}}}var ReturnPolicys,getTrackingSettingsStore=function(state){return state.trackingSettings},getTrackingConfig=(0,reselect_es.createSelector)(getTrackingSettingsStore,(function(store){return(0,fetchable.Vn)(store.trackingConfig)||{returnPolicySource:null,returnPolicyUrl:null,spotlightTitle:null,recommendationTitle:null,recommendationTitleTracking:null}}));(0,reselect_es.createSelector)(getTrackingSettingsStore,(function(store){return"requesting"===store.trackingConfig.kind})),(0,reselect_es.createSelector)(getTrackingSettingsStore,(function(store){return store.trackingConfigUpdateRequest})),(0,reselect_es.createSelector)(getTrackingSettingsStore,(function(store){return store.brandAndFooterUpdateRequest.kind}));function tracking_settings_service_fetchTrackingConfig(){return services_api.YZ.request({url:"setting/tracking",method:"GET"})}function tracking_settings_service_updateTrackingConfig(payload){return services_api.YZ.request({url:"/setting/tracking",method:"POST",headers:{},data:payload})}function Company_toJSON(company){var _a,_b,_c;return{company_name:company.companyName?company.companyName:"",website:company.website?company.website:"",email:company.email?company.email:"",twitter:company.twitter?extractHandler(company.twitter):"",facebook:company.facebook?extractHandler(company.facebook):"",instagram:company.instagram?extractHandler(company.instagram):"",brand_primary_color:null!==(_a=company.brandPrimaryColor)&&void 0!==_a?_a:"",brand_secondary_color:null!==(_b=company.brandSecondaryColor)&&void 0!==_b?_b:"",reply_to_email:null!==(_c=company.replyToEmail)&&void 0!==_c?_c:""}}function Company_fromJSON(data){return{companyName:data.company_name,website:data.website,email:data.email,twitter:data.twitter,facebook:data.facebook,instagram:data.instagram,unsupportedStore:data.unsupported_store,brandPrimaryColor:data.brand_primary_color,brandSecondaryColor:data.brand_secondary_color,replyToEmail:data.reply_to_email}}function extractHandler(url){var splitted=url.split("/");return splitted.pop()||splitted.pop()}function TrackingSettings_fromJSON(jsonTrack){return{returnPolicySource:jsonTrack.return_policy_source,returnPolicyUrl:jsonTrack.return_policy_url,spotlightTitle:jsonTrack.spotlight_title,recommendationTitle:jsonTrack.recommendation_title,recommendationTitleTracking:jsonTrack.recommendation_title_tracking}}function TrackingSettings_toJSON(jsonTrack){return{return_policy_source:jsonTrack.returnPolicySource||ReturnPolicys.None,return_policy_url:jsonTrack.returnPolicySource===ReturnPolicys.External?jsonTrack.returnPolicyUrl:null,spotlight_title:jsonTrack.spotlightTitle||null,recommendation_title:jsonTrack.recommendationTitle||null,recommendation_title_tracking:jsonTrack.recommendationTitleTracking||null}}!function(ReturnPolicys){ReturnPolicys.StorePolicy="STORE_POLICY",ReturnPolicys.External="EXTERNAL",ReturnPolicys.None="NONE"}(ReturnPolicys||(ReturnPolicys={}));(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.FETCH_TRACKING_CONFIG,(function tracking_settings_sagas_fetchTrackingConfig(){var data,err_1,axiosError,_a,_b;return(0,tslib_es6.YH)(this,(function(_c){switch(_c.label){case 0:return _c.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(tracking_settings_service_fetchTrackingConfig)];case 1:return data=_c.sent().data,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchTrackingConfigSuccess(TrackingSettings_fromJSON(data)))];case 2:case 4:return _c.sent(),[3,5];case 3:return err_1=_c.sent(),axiosError=err_1,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchTrackingConfigError(null===(_b=null===(_a=null==axiosError?void 0:axiosError.response)||void 0===_a?void 0:_a.data)||void 0===_b?void 0:_b.detail))];case 5:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.UPDATE_TRACKING_CONFIG,(function tracking_settings_sagas_updateTrackingConfig(action){var data,parsedData,err_2,axiosError,_a,_b;return(0,tslib_es6.YH)(this,(function(_c){switch(_c.label){case 0:return _c.trys.push([0,4,,6]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(tracking_settings_service_updateTrackingConfig,TrackingSettings_toJSON(action.payload))];case 1:return data=_c.sent().data,parsedData=TrackingSettings_fromJSON(data),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchTrackingConfigSuccess(parsedData))];case 2:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((payload=parsedData,{type:constants.t.UPDATE_TRACKING_CONFIG_SUCCESS,payload}))];case 3:case 5:return _c.sent(),[3,6];case 4:return err_2=_c.sent(),axiosError=err_2,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchTrackingConfigError(null===(_b=null===(_a=null==axiosError?void 0:axiosError.response)||void 0===_a?void 0:_a.data)||void 0===_b?void 0:_b.detail))];case 6:return[2]}var payload}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.UPDATE_BRAND_AND_FOOTER_SETTINGS,(function tracking_settings_sagas_updateBrandAndFooter(action){var company,companyJSON,companyRespData,parsedCompanyData,trackingConfig,trackingConfigPayload,trackingConfigJSON,trackingConfigRespData,parsedTrackingConfigData,err_3,axiosError,_a,_b;return(0,tslib_es6.YH)(this,(function(_c){switch(_c.label){case 0:return _c.trys.push([0,8,,10]),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(user_selectors.t1)];case 1:return(company=_c.sent()).replyToEmail=action.payload.replyToEmail,companyJSON=Company_toJSON(company),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(user_service_updateCompany,companyJSON)];case 2:return companyRespData=_c.sent().data,parsedCompanyData=Company_fromJSON(companyRespData),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(updateCompanySuccess(parsedCompanyData))];case 3:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(getTrackingConfig)];case 4:return trackingConfig=_c.sent(),trackingConfigPayload=function setTrackingConfigPayload(trackingConfig,payload){return{returnPolicySource:payload.returnPolicySource,returnPolicyUrl:payload.returnPolicyUrl,spotlightTitle:payload.spotlightTitle,recommendationTitle:payload.recommendationTitle,recommendationTitleTracking:trackingConfig.recommendationTitleTracking}}(trackingConfig,action.payload),trackingConfigJSON=TrackingSettings_toJSON(trackingConfigPayload),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(tracking_settings_service_updateTrackingConfig,trackingConfigJSON)];case 5:return trackingConfigRespData=_c.sent().data,parsedTrackingConfigData=TrackingSettings_fromJSON(trackingConfigRespData),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchTrackingConfigSuccess(parsedTrackingConfigData))];case 6:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((payload=(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},parsedTrackingConfigData),{replyToEmail:parsedCompanyData.replyToEmail}),{type:constants.t.UPDATE_BRAND_AND_FOOTER_SETTINGS_SUCCESS,payload}))];case 7:case 9:return _c.sent(),[3,10];case 8:return err_3=_c.sent(),axiosError=err_3,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((error=null===(_b=null===(_a=null==axiosError?void 0:axiosError.response)||void 0===_a?void 0:_a.data)||void 0===_b?void 0:_b.detail,{type:constants.t.UPDATE_BRAND_AND_FOOTER_SETTINGS_ERROR,payload:{error}}))];case 10:return[2]}var error,payload}))}));(0,redux_saga_effects_npm_proxy_esm.jP)(constants.t.FETCH_TRANSACTION,(function transactions_saga_fetchTransaction(action){var result,parsedTransaction;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(transactions_service_get,action.payload.transactionId)];case 1:return result=_a.sent(),parsedTransaction=(0,Transaction.rS)(result.data),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((transaction=parsedTransaction,{type:constants.t.FETCH_TRANSACTION_SUCCESS,payload:{transaction}}))];case 2:case 4:return _a.sent(),[3,5];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.FETCH_TRANSACTION_ERROR})];case 5:return[2]}var transaction}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(constants.t.SEND_EMAIL_NOTIFICATION,(function transactions_saga_sendEmailNotification(action){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(transactions_service_emailNotify,[action.payload.transactionId])];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.SEND_EMAIL_NOTIFICATION_SUCCESS})];case 2:case 4:return _a.sent(),[3,5];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.SEND_EMAIL_NOTIFICATION_ERROR})];case 5:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(constants.t.REFUND_TRANSACTION,(function transactions_saga_refundTransaction(action){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(refund,action.payload.transactionId)];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.REFUND_TRANSACTION_SUCCESS})];case 2:case 4:return _a.sent(),[3,5];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.REFUND_TRANSACTION_ERROR})];case 5:return[2]}}))}));function getUserJWT(){return getCookie("jwt")}function shouldAuthenticate(state){return!state.user.isAuthenticated}function user_saga_refreshUser(){var response,payload;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getCurrentUser)];case 1:return response=_a.sent(),payload={user:(0,User.rS)(response.data)},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchUserSuccess(payload))];case 2:case 4:return _a.sent(),[3,5];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchUserError())];case 5:return[2]}}))}(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.USER_FETCH,(function user_saga_fetchUser(){var jwt,response,payload,properties,promocodeCookieValue,decodedCookieValue,cookieDomain;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,21,,23]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getUserJWT)];case 1:return jwt=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(services_api.kM,jwt)];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getCurrentUser)];case 3:return response=_a.sent(),payload={user:(0,User.rS)(response.data)},[4,selectState(shouldAuthenticate)];case 4:return _a.sent()?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,auth_actions.Sz)(payload))]:[3,6];case 5:_a.sent(),_a.label=6;case 6:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(pushToGTMDataLayer({group_jwt:response.data.group_jwt}))];case 7:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchUserSuccess(payload))];case 8:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.FETCH_AB_TEST_FEATURES})];case 9:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.FETCH_USER_PLANS})];case 10:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,orders_actions.vs)())];case 11:return _a.sent(),function isSameSession(){var jwt=getUserJWT(),copy=getCookie("spare");if(!copy||jwt!==copy)return setCookie("spare",jwt),!1;return!0}()?[3,13]:(properties={"Visit Type":"Login","User Type":payload.user.hasPurchasedLabel?"Return Customer":"Return Visitor"},"customer",setCookie("customer","true"),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.R)(properties))]);case 12:_a.sent(),_a.label=13;case 13:return(promocodeCookieValue=js_cookie.get("shippo_apply_promo"))?(decodedCookieValue=decodeURIComponent(promocodeCookieValue),cookieDomain=(0,url.K)(window.location.href),payload.user.currentPromo&&payload.user.currentPromo.code!==decodedCookieValue?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(applyOrReplacePromoCode(decodedCookieValue,!0))]:[3,15]):[3,20];case 14:return _a.sent(),[3,17];case 15:return payload.user.currentPromo?[3,17]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(applyOrReplacePromoCode(decodedCookieValue,!1))];case 16:_a.sent(),_a.label=17;case 17:return js_cookie.remove("shippo_apply_promo",{domain:".".concat(cookieDomain)}),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.SHOW_PROMO_APPLICATION_NOTICE})];case 18:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(refreshUser())];case 19:_a.sent(),_a.label=20;case 20:return[3,23];case 21:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchUserError())];case 22:return _a.sent(),[3,23];case 23:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.USER_ADD,(function user_saga_addUser(action){var response,e_11,err,_a,_b;return(0,tslib_es6.YH)(this,(function(_c){switch(_c.label){case 0:return _c.trys.push([0,2,,3]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(user_service_addUser,action.payload.email)];case 1:return response=_c.sent(),action.callback((0,humps.b)(response.data)),[3,3];case 2:return e_11=_c.sent(),err=e_11,action.callback({err:null!==(_b=null===(_a=null==err?void 0:err.response)||void 0===_a?void 0:_a.data)&&void 0!==_b?_b:"unknown_error"}),[3,3];case 3:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.COMPANY_UPDATE,(function user_saga_updateCompany(action){var response;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,6,,9]),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.De)(constants_form.$o))];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(user_service_updateCompany,Company_toJSON(action.payload))];case 2:return response=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(updateCompanySuccess(Company_fromJSON(response.data)))];case 3:case 7:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.lM)(constants_form.$o))];case 4:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.Wv)(constants_form.$o))];case 5:case 8:return _a.sent(),[3,9];case 6:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.COMPANY_UPDATE_ERROR})];case 9:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.COMPANY_FETCH,(function user_saga_fetchCompany(){var response;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(user_service_fetchCompany)];case 1:return response=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((payload=Company_fromJSON(response.data),{payload,type:constants.t.COMPANY_FETCH_SUCCESS}))];case 2:case 4:return _a.sent(),[3,5];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.COMPANY_FETCH_ERROR})];case 5:return[2]}var payload}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.USER_REFRESH,user_saga_refreshUser),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.REVOKE_AUTH,(function user_saga_revokeAuth(){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(js_cookie.remove,"jwt",{domain:".shippodev.com",path:"/"})];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(js_cookie.remove,"is_logged_in",{domain:".shippodev.com",path:"/"})];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.USER_SET_UNAUTHENTICATED})];case 3:return _a.sent(),[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.USER_UPDATE_CREDIT_CARD,(function user_saga_updateCreditCard(action){var trackerSessionId,isImpersonatingCookie,e_2,err,error,_a,_b;return(0,tslib_es6.YH)(this,(function(_c){switch(_c.label){case 0:return _c.trys.push([0,4,,7]),trackerSessionId=getCookie("tracker_sessionid")||"",isImpersonatingCookie=getCookie("is_impersonate")||"",[4,(0,redux_saga_effects_npm_proxy_esm.T1)(user_service_updateCreditCard,action.payload.tokenId,action.payload.billingAddress,trackerSessionId,isImpersonatingCookie)];case 1:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(refreshUser())];case 2:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.USER_UPDATE_CREDIT_CARD_SUCCESS})];case 3:case 6:return _c.sent(),[3,7];case 4:return e_2=_c.sent(),error=(null===(_b=null===(_a=null==(err=e_2)?void 0:err.response)||void 0===_a?void 0:_a.data)||void 0===_b?void 0:_b.error)||"We couldn't save your billing information. Please try again or contact us, we're happy to help you!",[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(setPaymentProcessingError(error||err.toString()))];case 5:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((errorMessage=error,{errorMessage,type:constants.t.USER_UPDATE_CREDIT_CARD_ERROR}))];case 7:return[2]}var errorMessage}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.USER_ASSETS_FETCH,(function user_saga_fetchAssets(){var response,assets;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(user_service_fetchAssets)];case 1:return response=_a.sent(),assets=response.data.results.map(Asset.rS),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchAssetsSuccess(assets))];case 2:case 4:return _a.sent(),[3,5];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((errorCode="unknown_error",{type:constants.t.USER_ASSETS_FETCH_ERROR,payload:{errorCode}}))];case 5:return[2]}var errorCode}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(constants.t.USER_ASSET_UPLOAD_DRAFT,(function user_saga_uploadAssetDraft(action){var _a,assetType,rank,_b,asset,file,fullAsset,result,e_4,errCode;return(0,tslib_es6.YH)(this,(function(_c){switch(_c.label){case 0:_a=action.payload,assetType=_a.assetType,rank=_a.rank,_c.label=1;case 1:return _c.trys.push([1,7,,9]),_b=action.payload,asset=_b.asset,file=_b.file,fullAsset=asset,asset?[3,3]:[4,(0,redux_saga_effects_npm_proxy_esm.T1)(createAsset,{type:assetType,rank,imageUrl:"",draftImageUrl:"",title:null,linkUrl:null})];case 2:result=_c.sent(),fullAsset=Asset.rS(result.data),_c.label=3;case 3:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(user_service_uploadAssetDraft,null==fullAsset?void 0:fullAsset.objectId,file)];case 4:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchAssets())];case 5:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(uploadAssetDraftSuccess(assetType,rank))];case 6:return _c.sent(),[3,9];case 7:return e_4=_c.sent(),errCode=415===e_4.response.status?"invalid_file_type":"unknown_error",[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(uploadAssetDraftError(assetType,rank,errCode))];case 8:return _c.sent(),[3,9];case 9:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(constants.t.USER_ASSET_CLEAR_DRAFT,(function user_saga_clearAssetDraft(action){var _a,assetType,asset,rank,fullAsset,result,e_5,err,errCode,_b;return(0,tslib_es6.YH)(this,(function(_c){switch(_c.label){case 0:_a=action.payload,assetType=_a.assetType,asset=_a.asset,rank=_a.rank,_c.label=1;case 1:return _c.trys.push([1,8,,10]),fullAsset=void 0,asset.objectId?[3,3]:[4,(0,redux_saga_effects_npm_proxy_esm.T1)(createAsset,(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},asset),{type:assetType,rank}))];case 2:return result=_c.sent(),fullAsset=Asset.rS(result.data),[3,4];case 3:fullAsset=asset,_c.label=4;case 4:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(user_service_clearAssetDraft,fullAsset.objectId)];case 5:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchAssets())];case 6:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(clearAssetDraftSuccess(assetType,rank))];case 7:return _c.sent(),[3,10];case 8:return e_5=_c.sent(),errCode=415===(null===(_b=null==(err=e_5)?void 0:err.response)||void 0===_b?void 0:_b.status)?"invalid_file_type":"unknown_error",[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(clearAssetDraftError(assetType,rank,errCode))];case 9:return _c.sent(),[3,10];case 10:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(constants.t.USER_ASSET_REVERT_DRAFT,(function user_saga_revertAssetDraft(action){var _a,assetType,asset,rank,fullAsset,result,e_6,err,errCode,_b;return(0,tslib_es6.YH)(this,(function(_c){switch(_c.label){case 0:_a=action.payload,assetType=_a.assetType,asset=_a.asset,rank=_a.rank,_c.label=1;case 1:return _c.trys.push([1,8,,10]),fullAsset=void 0,asset.objectId?[3,3]:[4,(0,redux_saga_effects_npm_proxy_esm.T1)(createAsset,(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},asset),{type:assetType,rank}))];case 2:return result=_c.sent(),fullAsset=Asset.rS(result.data),[3,4];case 3:fullAsset=asset,_c.label=4;case 4:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(user_service_revertAssetDraft,fullAsset.objectId)];case 5:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchAssets())];case 6:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(revertAssetDraftSuccess(assetType,rank))];case 7:return _c.sent(),[3,10];case 8:return e_6=_c.sent(),errCode=415===(null===(_b=null==(err=e_6)?void 0:err.response)||void 0===_b?void 0:_b.status)?"invalid_file_type":"unknown_error",[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(revertAssetDraftError(assetType,rank,errCode))];case 9:return _c.sent(),[3,10];case 10:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(constants.t.USER_ASSET_PUBLISH,(function user_saga_publishAsset(action){var _a,assetType,rank,asset,fullAsset,result,e_7,err,errCode,_b,_c,_d,_e;return(0,tslib_es6.YH)(this,(function(_f){switch(_f.label){case 0:_a=action.payload,assetType=_a.assetType,rank=_a.rank,_f.label=1;case 1:return _f.trys.push([1,10,,12]),asset=action.payload.asset,fullAsset=void 0,asset.objectId?[3,3]:[4,(0,redux_saga_effects_npm_proxy_esm.T1)(createAsset,asset)];case 2:return result=_f.sent(),fullAsset=Asset.rS(result.data),[3,4];case 3:fullAsset=asset,_f.label=4;case 4:return fullAsset.draftImageUrl===fullAsset.imageUrl?[3,6]:[4,(0,redux_saga_effects_npm_proxy_esm.T1)(publishAssetDraft,fullAsset.objectId)];case 5:_f.sent(),_f.label=6;case 6:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(updateAsset,fullAsset)];case 7:return _f.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(publishAssetSuccess(assetType,rank))];case 8:return _f.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchAssets())];case 9:return _f.sent(),[3,12];case 10:return e_7=_f.sent(),errCode=void 0,errCode=400===(null===(_b=null==(err=e_7)?void 0:err.response)||void 0===_b?void 0:_b.status)&&(null===(_d=null===(_c=null==err?void 0:err.response)||void 0===_c?void 0:_c.data)||void 0===_d?void 0:_d.link_url)?"invalid_link":415===(null===(_e=null==err?void 0:err.response)||void 0===_e?void 0:_e.status)?"invalid_file_type":"unknown_error",[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(publishAssetError(assetType,rank,errCode))];case 11:return _f.sent(),[3,12];case 12:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.USER_INITIATE_ID_VERIFICATION,(function initiateIdVerification(){var currentPathname,url,returnUrl,result;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,4,,6]),[4,selectState(getPathname)];case 1:return currentPathname=_a.sent(),url=new URL("".concat(currentPathname,"?").concat("id_verifying","=true"),"https://WEB-1816.ui.shippodev.com/"),returnUrl=url.toString(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(createVerificationIntent,returnUrl)];case 2:return result=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)([window.location,window.location.assign],result.data.redirect_url)];case 3:case 5:return _a.sent(),[3,6];case 4:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(setIdVerificationStatus({state:IDVerification.p.VERIFICATION_FAILED_ALLOW_RETRY,errors:["error_processing_request"]}))];case 6:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.USER_ASSET_UPLOAD_AND_PUBLISH_LOGO,(function user_saga_uploadAndPublishLogo(action){var file,e_8,err,errCode,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return _b.trys.push([0,5,,7]),file=action.payload.file,[4,(0,redux_saga_effects_npm_proxy_esm.T1)(uploadAndPublishAsset,Asset.PW.LOGO,file)];case 1:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.USER_ASSET_UPLOAD_AND_PUBLISH_LOGO_SUCCESS})];case 2:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("UPLOAD_BRAND_LOGO_SUCCESS"))];case 3:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchAssets())];case 4:case 6:return _b.sent(),[3,7];case 5:return e_8=_b.sent(),errCode="unknown_error",(err=e_8).response&&400===err.response.status&&(null===(_a=err.response)||void 0===_a?void 0:_a.data.errors)&&(errCode=err.response.data.errors.reduce((function(acc,cur){return acc?[acc,cur.code].join(";"):cur.code}),"")),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((errorCode=errCode,{type:constants.t.USER_ASSET_UPLOAD_AND_PUBLISH_LOGO_ERROR,payload:{errorCode}}))];case 7:return[2]}var errorCode}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.USER_BRAND_UPDATE_COLORS,(function user_saga_updateBrandColors(action){var updatedCompanySettings;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,6,,8]),[4,selectState(user_selectors.t1)];case 1:return(updatedCompanySettings=_a.sent()).brandPrimaryColor=action.payload.brandPrimaryColor,updatedCompanySettings.brandSecondaryColor=action.payload.brandSecondaryColor,[4,(0,redux_saga_effects_npm_proxy_esm.T1)(user_service_updateCompany,Company_toJSON(updatedCompanySettings))];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.USER_BRAND_UPDATE_COLORS_SUCCESS})];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("SAVE_BRAND_COLOR_SUCCESS"))];case 4:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchCompany())];case 5:case 7:return _a.sent(),[3,8];case 6:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.USER_BRAND_UPDATE_COLORS_ERROR})];case 8:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.USER_UPDATE,(function user_saga_updateUser(action){var isImpersonatingCookie,response,e_10,err,userError,_a,_b,_c,_d,_e;return(0,tslib_es6.YH)(this,(function(_f){switch(_f.label){case 0:return _f.trys.push([0,5,,7]),isImpersonatingCookie=getCookie("is_impersonate")||"",[4,(0,redux_saga_effects_npm_proxy_esm.T1)(user_service_updateUser,action.payload.user,isImpersonatingCookie)];case 1:return response=_f.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(updateUserSuccess((0,humps.b)(response.data)))];case 2:return _f.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(updateUserError("success"))];case 3:return _f.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(segment.u4,segment.sV.update_user_information)];case 4:case 6:return _f.sent(),[3,7];case 5:return e_10=_f.sent(),userError=(null===(_b=null===(_a=(err=e_10).response)||void 0===_a?void 0:_a.data)||void 0===_b?void 0:_b.errors)?null===(_e=null===(_d=null===(_c=err.response)||void 0===_c?void 0:_c.data)||void 0===_d?void 0:_d.errors)||void 0===_e?void 0:_e.join(". "):"An error occurred while updating your profile. Please try again later.",[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(updateUserError(userError))];case 7:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.USER_ALL_FETCH,(function user_saga_getLoginUsers(action){var response,err_6;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,3]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(user_service_getLoginUsers)];case 1:return response=_a.sent(),action.callback((0,humps.b)(response.data)),[3,3];case 2:return err_6=_a.sent(),action.callback({err:err_6}),[3,3];case 3:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.USER_RESEND_INVITE,(function user_saga_sendInvite(action){var response,e_12,err,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return _b.trys.push([0,2,,3]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(sendInvite,action.payload.userId)];case 1:return response=_b.sent(),action.callback((0,humps.b)(response.data)),[3,3];case 2:return e_12=_b.sent(),err=e_12,action.callback({err:(null===(_a=null==err?void 0:err.response)||void 0===_a?void 0:_a.data)||"unknown_error"}),[3,3];case 3:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.USER_DELETE,(function user_saga_deleteUser(action){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,3]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(user_service_deleteUser,action.payload.userId)];case 1:return _a.sent(),action.callback({success:!0}),[3,3];case 2:return _a.sent(),action.callback({success:!1}),[3,3];case 3:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.MAYBE_SHOW_EMAIL_VERIFICATION_MODAL,(function user_saga_maybeShowEmailVerificationModal(action){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,selectState(user_selectors.ux)];case 1:return _a.sent()?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((nextModalAction=action.payload.nextModalAction,{type:constants.t.SHOW_EMAIL_VERIFICATION_MODAL,payload:{nextModalAction}}))]:[3,3];case 2:return _a.sent(),[3,5];case 3:return action.payload.nextModalAction?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(action.payload.nextModalAction)]:[3,5];case 4:_a.sent(),_a.label=5;case 5:return[2]}var nextModalAction}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.CHECK_REQUIRES_EMAIL_VERIFICATION,(function user_saga_checkRequiresEmailVerification(action){var nextModalAction;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(refreshUser())];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.s)([constants.t.FETCH_PAYMENT_METHODS_SUCCESS,constants.t.FETCH_PAYMENT_METHODS_ERROR,constants.t.USER_FETCH_ERROR])];case 2:return _a.sent(),[4,selectState(user_selectors.ux)];case 3:return _a.sent()?[3,8]:[4,selectState(user_selectors.lc)];case 4:return nextModalAction=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.USER_EMAIL_VERIFICATION_SUCCESS})];case 5:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(action.payload.verifySuccessCallback)];case 6:return _a.sent(),nextModalAction?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(nextModalAction)]:[3,8];case 7:_a.sent(),_a.label=8;case 8:return[2]}}))}));var LabelPurchaseDrawer_utils=__webpack_require__("./app/pages/Orders/Blackbeard/Drawers/LabelPurchaseDrawer/utils.ts");function trackedOrderDetails_getTrackedOrderDetailsByShipmentFromOrders(_a){var selectedOrders=_a.selectedOrders,ordersData=_a.ordersData,batchEntries=_a.batchEntries,ratesForOrders=_a.ratesForOrders,defaultSenderAddress=_a.defaultSenderAddress,defaultReturnAddress=_a.defaultReturnAddress,defaultParcelTemplate=_a.defaultParcelTemplate,paymentType=_a.paymentType,stripeToken=_a.stripeToken,insuranceSettings=_a.insuranceSettings,labelSettings=_a.labelSettings,orderIds=Object.keys(selectedOrders),hasReturnOption=calculateHasReturnOption(selectedOrders,ordersData,batchEntries,defaultSenderAddress);return orderIds.reduce((function(acc,orderId){var trackedOrderDetailsByShipment=function getTrackedOrderDetailsByShipment(_a){var batchEntryIds=_a.batchEntryIds,batchEntries=_a.batchEntries,ratesForOrders=_a.ratesForOrders,defaultSenderAddress=_a.defaultSenderAddress,defaultReturnAddress=_a.defaultReturnAddress,defaultParcelTemplate=_a.defaultParcelTemplate,paymentType=_a.paymentType,stripeToken=_a.stripeToken,insuranceSettings=_a.insuranceSettings,hasReturnOption=_a.hasReturnOption,labelSettings=_a.labelSettings,hasInsuranceOption=calculateHasInsuranceOption(batchEntryIds,batchEntries);return batchEntryIds.reduce((function(acc,batchEntryId){var _a,trackedOrderDetails=function getTrackedOrderDetails(_a){var _b,_c,_d,_e,_f,_g,_h,_j,_k,_l,batchEntryId=_a.batchEntryId,batchEntries=_a.batchEntries,ratesForOrders=_a.ratesForOrders,defaultSenderAddress=_a.defaultSenderAddress,defaultReturnAddress=_a.defaultReturnAddress,defaultParcelTemplate=_a.defaultParcelTemplate,paymentType=_a.paymentType,stripeToken=_a.stripeToken,insuranceSettings=_a.insuranceSettings,hasInsuranceOption=_a.hasInsuranceOption,hasReturnOption=_a.hasReturnOption,labelSettings=_a.labelSettings;if(!batchEntries)return;var be=batchEntries[batchEntryId];if(!be)return;var parcelDefaultSet=!!(null===(_b=be.parcel)||void 0===_b?void 0:_b.userParcelTemplate)&&be.parcel.userParcelTemplate.objectId===(null==defaultParcelTemplate?void 0:defaultParcelTemplate.objectId),rate=ratesForOrders.find((function(r){return r.shipment===be.shipmentObjectId})),paymentMethodDefaultSet=paymentType===PaymentMethodType.CreditCard,returnDefaultSet=null==labelSettings?void 0:labelSettings.isAutoCreateReturnLabels,serviceLevelDefault=null==labelSettings?void 0:labelSettings.outboundServiceLevel;return{addressSender:null===(_c=be.addressFrom)||void 0===_c?void 0:_c.objectId,addressSenderDefaultSet:isAddressSame(be.addressFrom,defaultSenderAddress),addressReturn:null===(_d=be.addressReturn)||void 0===_d?void 0:_d.objectId,addressReturnDefaultSet:isAddressSame(be.addressReturn,defaultReturnAddress),addressRecipient:null===(_e=be.addressTo)||void 0===_e?void 0:_e.objectId,parcel:serializeParcel(be.parcel),parcelDefaultSet,parcelUserTemplate:(null===(_f=be.parcel)||void 0===_f?void 0:_f.userParcelTemplate)?null===(_g=be.parcel)||void 0===_g?void 0:_g.userParcelTemplate.objectId:void 0,parcelCarrierTemplate:(null===(_h=be.parcel)||void 0===_h?void 0:_h.carrierParcelTemplate)?null===(_j=be.parcel)||void 0===_j?void 0:_j.carrierParcelTemplate.token:void 0,hasReturnOption,hasInsuranceOption,signature:null===(_l=null===(_k=be.extras)||void 0===_k?void 0:_k.signatureConfirmation)||void 0===_l?void 0:_l.hasSignatureConfirmation,hasSignatureOption:!0,carrier:null==rate?void 0:rate.provider,serviceLevel:null==rate?void 0:rate.servicelevelName,paymentMethodDefaultSet,paymentMethod:stripeToken,insuranceDefaultSet:null==insuranceSettings?void 0:insuranceSettings.is_auto_apply,returnDefaultSet,serviceLevelDefault}}({batchEntryId,batchEntries,ratesForOrders,defaultSenderAddress,defaultReturnAddress,defaultParcelTemplate,paymentType,stripeToken,hasInsuranceOption,hasReturnOption,insuranceSettings:insuranceSettings||void 0,labelSettings});return trackedOrderDetails?(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},acc),((_a={})[batchEntryId]=trackedOrderDetails,_a)):acc}),{})}({batchEntryIds:selectedOrders[orderId],batchEntries,ratesForOrders,defaultSenderAddress,defaultReturnAddress,defaultParcelTemplate,paymentType,stripeToken,hasReturnOption,insuranceSettings:insuranceSettings||void 0,labelSettings});return(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},acc),trackedOrderDetailsByShipment)}),{})}function trackedOrderDetails_getBatchEntryIds(ordersSelected){return Object.keys(ordersSelected).reduce((function(acc,orderId){return(0,tslib_es6.fX)((0,tslib_es6.fX)([],(0,tslib_es6.zs)(acc),!1),(0,tslib_es6.zs)(ordersSelected[orderId]),!1)}),[])}function isAddressSame(address1,address2){return(null==address1?void 0:address1.zip)===(null==address2?void 0:address2.zip)&&(null==address1?void 0:address1.state)===(null==address2?void 0:address2.state)&&(null==address1?void 0:address1.city)===(null==address2?void 0:address2.city)&&(null==address1?void 0:address1.street1)===(null==address2?void 0:address2.street1)&&(null==address1?void 0:address1.street2)===(null==address2?void 0:address2.street2)&&(null==address1?void 0:address1.streetNumber)===(null==address2?void 0:address2.streetNumber)&&(null==address1?void 0:address1.company)===(null==address2?void 0:address2.company)&&(null==address1?void 0:address1.phone)===(null==address2?void 0:address2.phone)&&(null==address1?void 0:address1.name)===(null==address2?void 0:address2.name)}function serializeParcel(parcel){if(parcel){if(parcel.userParcelTemplate){var weight=(template=parcel.userParcelTemplate).weight||parcel.weight,weightUnit=template.weightUnit||parcel.weightUnit;return"".concat(template.length,"x").concat(template.width,"x").concat(template.height," ").concat(template.distanceUnit,", ").concat(weight," ").concat(weightUnit)}if(parcel.carrierParcelTemplate){var template=parcel.carrierParcelTemplate;weight=parcel.weight,weightUnit=parcel.weightUnit;return"".concat(template.length,"x").concat(template.width,"x").concat(template.height," ").concat(template.distanceUnit,", ").concat(weight," ").concat(weightUnit)}return"".concat(parcel.length,"x").concat(parcel.width,"x").concat(parcel.height," ").concat(parcel.distanceUnit,", ").concat(parcel.weight," ").concat(parcel.weightUnit)}}var calculateHasReturnOption=function(selectedOrders,ordersData,batchEntries,defaultSenderAddress){if(!ordersData||!batchEntries)return!1;var hasMultipleCountries=Array.from(new Set(Object.keys(selectedOrders).map((function(orderId){var _a,_b,_c;return null===(_c=null===(_b=null===(_a=ordersData[orderId])||void 0===_a?void 0:_a.toAddress)||void 0===_b?void 0:_b.country)||void 0===_c?void 0:_c.iso2})).filter((function(countryCode){return!!countryCode})))).length>1,selBatchEntries=trackedOrderDetails_getBatchEntryIds(selectedOrders).map((function(beId){return batchEntries[beId]})).filter((function(be){return!!be})),orderRequiresCustoms=(0,LabelPurchaseDrawer_utils.Bc)(selBatchEntries,ordersData,selectedOrders,defaultSenderAddress||void 0);return!hasMultipleCountries&&!orderRequiresCustoms},calculateHasInsuranceOption=function(batchEntryIds,batchEntries){if(!batchEntries)return!1;var countries=batchEntryIds.map((function(beId){var _a,_b,_c;return null===(_c=null===(_b=null===(_a=batchEntries[beId])||void 0===_a?void 0:_a.addressFrom)||void 0===_b?void 0:_b.country)||void 0===_c?void 0:_c.iso2})).filter((function(country){return!!country}));return function insurance_isInsuranceAvailableForCountries(countries){return!!countries.length&&countries.every((function(country){return INSURANCE_AVAILABLE_IN_COUNTRIES[country]}))}(countries)};function registerSuccessCookie(){return js_cookie.get(USER_REGISTER_SUCCESS_COOKIE_NAME)||"false"}function getStoreConnectionSuccessCookie(){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,js_cookie.get(STORE_CONNECTION_SUCCESS_COOKIE_NAME)||""];case 1:return _a.sent(),[2]}}))}(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.USER_DID_AUTHENTICATE,(function sendRegisterSuccessEvent(){var userResponse,UTMCookies,marketingPayload,storeReferral,onboardingMonthlyVolume,isOnboardingFlagOn,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(registerSuccessCookie)];case 1:return"true"!==_b.sent()?[3,8]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendGTMEvent({eventName:"USER_REGISTER_EVENT"}))];case 2:return _b.sent(),localStorage.setItem("show_progress_meter","true"),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getCurrentUser)];case 3:return userResponse=_b.sent(),UTMCookies=js_cookie.getJSON("shippoUTM"),marketingPayload=UTMCookies?extractMarketingPayloadFromCookie(UTMCookies):void 0,storeReferral=null!==(_a=localStorage.getItem("registration_store"))&&void 0!==_a?_a:void 0,[4,(0,redux_saga_effects_npm_proxy_esm.T1)(onboarding.lg)];case 4:return onboardingMonthlyVolume=_b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(onboarding.VK)];case 5:return isOnboardingFlagOn=_b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(segment.u4,segment.sV.registered,{first_name:null==userResponse?void 0:userResponse.data.first_name,last_name:null==userResponse?void 0:userResponse.data.last_name,email:null==userResponse?void 0:userResponse.data.email,userId:null==userResponse?void 0:userResponse.data.id.toString(),userId_integer:null==userResponse?void 0:userResponse.data.id,registration_date:null==userResponse?void 0:userResponse.data.date_joined,registration_source:null==marketingPayload?void 0:marketingPayload.source,registration_method:null==marketingPayload?void 0:marketingPayload.regMethod,registration_ad_param1:null==marketingPayload?void 0:marketingPayload.shAd1,registration_ad_param2:null==marketingPayload?void 0:marketingPayload.shAd2,registration_ad_param3:null==marketingPayload?void 0:marketingPayload.shAd3,registration_ad_param4:null==marketingPayload?void 0:marketingPayload.shAd4,registration_campaign:null==marketingPayload?void 0:marketingPayload.campaign,registration_click_identifier:null==marketingPayload?void 0:marketingPayload.attributionSnippet,registration_medium:null==marketingPayload?void 0:marketingPayload.medium,store_referral:storeReferral,monthly_shipment_volume:onboardingMonthlyVolume,is2024_signup_flow:"true"===isOnboardingFlagOn})];case 6:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(js_cookie.remove,USER_REGISTER_SUCCESS_COOKIE_NAME,{domain:".shippodev.com"})];case 7:_b.sent(),_b.label=8;case 8:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.USER_DID_AUTHENTICATE,(function sendStoreConnectionSuccessEvent(){var storeConnectionSuccessCookieValue,payload;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getStoreConnectionSuccessCookie)];case 1:return(storeConnectionSuccessCookieValue=_a.sent())?(payload={eventName:"STORE_CONNECTION_SUCCESS_EVENT",data:{storeName:storeConnectionSuccessCookieValue}},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendGTMEvent(payload))]):[3,5];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(segment.u4,segment.sV.store_connected,{store_name:storeConnectionSuccessCookieValue})];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(js_cookie.remove,STORE_CONNECTION_SUCCESS_COOKIE_NAME,{domain:".shippodev.com"})];case 4:_a.sent(),_a.label=5;case 5:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.BATCH_CREATE_SUCCESS,(function sendInitiateBatchCreateFlowEvent(action){var payload;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return payload={eventName:"BATCH_INITIATE_FLOW_EVENT",data:{batchId:action.payload.batch.id}},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendGTMEvent(payload))];case 1:return _a.sent(),[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_BATCH_SAVE_PACKAGE_INFORMATION_SUCCESS,(function sendShowBatchRatesEvent(){var payload;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return payload={eventName:"BATCH_SHOW_RATES_EVENT"},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendGTMEvent(payload))];case 1:return _a.sent(),[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_BATCH_CREATE_TRANSACTIONS_SUCCESS,(function sendBatchPurchasedEvent(){var getUserData,payload;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,selectState(user_selectors.cv)];case 1:return getUserData=_a.sent(),payload={eventName:"BATCH_PURCHASED_EVENT"},!getUserData||getUserData.hasPurchasedLabel?[3,7]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)({type:constants.t.USER_FIRST_LABEL_PURCHASED})];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendGTMEvent({eventName:"FIRST_LABEL_PURCHASED"}))];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("First Label Purchased",{timestamp:getUserData.dateJoined}))];case 4:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)([localStorage,localStorage.setItem],"has_purchased_first_label","true")];case 5:return _a.sent(),moment_moment().isBefore(moment_moment(getUserData.dateJoined).add(7,"d"))?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendGTMEvent({eventName:"7DFLR"}))]:[3,7];case 6:_a.sent(),_a.label=7;case 7:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendGTMEvent(payload))];case 8:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("Purchase Success"))];case 9:return _a.sent(),[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.APIADDRESS_CREATE_SUCCESS,(function sendAddressEvent(action){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendGTMEvent({eventName:"USER_ADDED_ADDRESS",data:{isDefaultSender:action.payload.address.isDefaultSender,isDefaultReturn:action.payload.address.isDefaultReturn}}))];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(segment.u4,segment.sV.address_created,{is_default_sender:action.payload.address.isDefaultSender,is_default_return:action.payload.address.isDefaultReturn})];case 2:return _a.sent(),(0,utils.Rk)(action.payload.trackingReference,types.eJ.operations.CREATED,{addressId:action.payload.address.id}),[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.USER_UPDATE_CREDIT_CARD_SUCCESS,(function sendCreditCardEvent(){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendGTMEvent({eventName:"USER_ADDED_CREDITCARD"}))];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(segment.u4,segment.sV.credit_card_added)];case 2:return _a.sent(),[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.CREATE_CARRIER_ACCOUNT_SUCCESS,(function sendCreateCarrierAccountEvent(action){var carrierAccount;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return carrierAccount=action.payload.carrierAccount,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendGTMEvent({eventName:"CARRIER_REGISTRATION_SUCCESS",data:{carrierName:carrierAccount.carrier.name}}))];case 1:return _a.sent(),carrierAccount.carrier&&carrierAccount.carrier===carriers.$5&&carrierAccount.isShippoAccount?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendGTMEvent({eventName:"UPS_MASTER_REGISTRATION_SUCCESS"}))]:[3,3];case 2:_a.sent(),_a.label=3;case 3:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.CONNECT_CARRIER_ACCOUNT_SUCCESS,(function sendConnectCarrierAccountEvent(action){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendGTMEvent({eventName:"CARRIER_CONNECT_SUCCESS",data:{carrierName:action.payload.carrierAccount.carrier.name}}))];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(segment.u4,segment.sV.carrier_connected,{carrier_name:action.payload.carrierAccount.carrier.name})];case 2:return _a.sent(),[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)([constants.t.ORDERS_FETCH_SUCCESS],(function sendOrderCount(){var ordersCount,userOrderCount,activationData,isLoading,userId;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(orders_selectors.Ld)];case 1:return ordersCount=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(orders_selectors.Oz)];case 2:return userOrderCount=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(user_selectors.hP)];case 3:return activationData=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(orders_selectors.RQ)];case 4:return isLoading=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(user_selectors.F6)];case 5:return userId=_a.sent(),isLoading||ordersCount===activationData.ordersCount?[3,9]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendGTMEvent({eventName:"ORDERS_COUNT",data:{ordersCount}}))];case 6:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((activation={ordersCount},{type:constants.t.UPDATE_ACTIVATION_DATA,payload:activation}))];case 7:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(segment.ls,userId,{orders_count:userOrderCount})];case 8:_a.sent(),_a.label=9;case 9:return[2]}var activation}))})),(0,redux_saga_effects_npm_proxy_esm.p8)([constants.t.ORDERS_SELECT_ORDER,constants.t.ORDERS_SELECT_ALL_ORDERS,constants.t.ORDERS_CLEAR_SELECTED],(function trackOrderSelection(action){var selectedOrders,trackingReference,batchEntryIds,ordersData,batchEntries,ratesForOrders,defaultSenderAddress,defaultReturnAddress,defaultParcelTemplate,paymentMethods,labelSettings,_a,paymentType,stripeToken,trackedOrderDetailsByShipment,trackingReferenceWithOrderDetails,_b;return(0,tslib_es6.YH)(this,(function(_c){switch(_c.label){case 0:return action.trackEvent?[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(orders_selectors.Li)]:[2];case 1:return selectedOrders=_c.sent(),void 0!==(trackingReference=TrackingHelper.U.amendTrackingReferenceOrderSelection(TrackingHelper.U.getTrackingReference(types.iB.name,"order_table",{}),selectedOrders)).orderQuantity?[3,5]:action.type!==constants.t.ORDERS_SELECT_ORDER&&action.type!==constants.t.ORDERS_SELECT_ALL_ORDERS?[3,3]:[4,(0,redux_saga_effects_npm_proxy_esm.T1)(utils.Ro,TrackingHelper.U.amendTrackingReferenceOrders(trackingReference,Object.keys(action.payload)),types.iB.operations.DESELECTED,{})];case 2:_c.sent(),_c.label=3;case 3:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(utils.Ro,trackingReference,types.iB.operations.DESELECTED,{})];case 4:return _c.sent(),[3,15];case 5:return batchEntryIds=trackedOrderDetails_getBatchEntryIds(selectedOrders),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(orders_selectors.Sv)];case 6:return ordersData=_c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(batch_entry_selectors.zo)];case 7:return batchEntries=_c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(batch_entry_composite_selectors.Qt,{batchEntryIds})];case 8:return ratesForOrders=_c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(user_selectors.GA)];case 9:return defaultSenderAddress=_c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(user_selectors.kQ)];case 10:return defaultReturnAddress=_c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(user_selectors.ZC)];case 11:return defaultParcelTemplate=_c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(billing_selectors_getPaymentMethods)];case 12:return paymentMethods=_c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(label_settings_selectors_getLabelSettings)];case 13:return labelSettings=_c.sent(),paymentType=(_a=paymentMethods||{}).paymentType,stripeToken=_a.stripeToken,trackedOrderDetailsByShipment=trackedOrderDetails_getTrackedOrderDetailsByShipmentFromOrders({selectedOrders,ordersData,batchEntries,ratesForOrders,defaultSenderAddress,defaultReturnAddress,defaultParcelTemplate,paymentType,stripeToken,insuranceSettings:null===(_b=trackingReference.userDetails)||void 0===_b?void 0:_b.defaultInsuranceSetings,labelSettings}),trackingReferenceWithOrderDetails=TrackingHelper.U.amendTrackingReferenceTrackedOrderDetailsByShipment(trackingReference,trackedOrderDetailsByShipment),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(utils.Ro,trackingReferenceWithOrderDetails,types.iB.operations.VIEWED,{})];case 14:_c.sent(),_c.label=15;case 15:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.SHIPMENT_FETCH_SUCCESS,(function trackRateGenerated(action){var payload,trackingReference,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return payload=action.payload,trackingReference=action.trackingReference,"SUCCESS"!==(null===(_a=payload.shipment)||void 0===_a?void 0:_a.status)?[3,2]:[4,(0,redux_saga_effects_npm_proxy_esm.T1)(utils.mq,trackingReference,{url:"/shipments/".concat(payload.shipment.objectId),isError:!1,status:200,message:void 0})];case 1:return _b.sent(),[3,4];case 2:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(utils.mq,trackingReference,{url:"/shipments/".concat(payload.shipment.objectId),isError:!0,status:200,message:void 0})];case 3:_b.sent(),_b.label=4;case 4:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.LOGIN_SUCCESS,(function trackUserSignIn(){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.s)(constants.t.USER_DID_AUTHENTICATE)];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.s)(constants.t.USER_FETCH_SUCCESS)];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(sendGTMEvent({eventName:"USER_SIGNED_IN"}))];case 3:return _a.sent(),[2]}}))}));function getVersioning(){return services_api.kC.request({url:"/v1/ui/account/version"})}function upgradeVersioning(){return services_api.kC.request({method:"POST",data:{update:!0},url:"v1/ui/account/version"})}(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.FETCH_VERSION,(function getVersion(action){var response,err_1;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,3]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getVersioning)];case 1:return response=_a.sent(),action.callback((0,humps.b)(response.data)),[3,3];case 2:return err_1=_a.sent(),action.callback(err_1),[3,3];case 3:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.UPGRADE_VERSION,(function upgradeVersion(action){var response,err_2;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,3]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(upgradeVersioning)];case 1:return response=_a.sent(),action.callback(response.data),[3,3];case 2:return err_2=_a.sent(),action.callback(err_2),[3,3];case 3:return[2]}}))}));function editWebhook(data){return services_api.kC.request({url:"/webhooks/".concat(data.object_id),method:"PUT",data:{active:data.active,event:data.event,is_test:data.is_test,url:data.url}})}function deleteWebhook(data){return services_api.kC.request({url:"/webhooks/".concat(data.object_id),method:"DELETE"})}function saveWebhook(data){return services_api.kC.request({url:"/webhooks/",method:"POST",data:{active:data.active,event:data.event,is_test:data.is_test,url:data.url}})}function testWebhook(data){return services_api.kC.request({url:"/webhooks/".concat(data.object_id,"/test"),method:"POST",data:{event:"*"===data.event?"track_updated":data.event}})}function getWebhooks(){return services_api.kC.request({url:"/webhooks"})}(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.FETCH_WEBHOOKS,(function webhooks_saga_getWebhooks(action){var response,err_5;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,3]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getWebhooks)];case 1:return response=_a.sent(),action.callback((0,humps.b)(response.data.results)),[3,3];case 2:return err_5=_a.sent(),action.callback(err_5),[3,3];case 3:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.EDIT_WEBHOOK,(function webhooks_saga_editWebhook(action){var response,err_1;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,3]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(editWebhook,(0,humps.I)(action.payload.webhook))];case 1:return response=_a.sent(),action.callback((0,humps.b)(response.data)),[3,3];case 2:return err_1=_a.sent(),action.callback({error:err_1}),[3,3];case 3:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.SAVE_WEBHOOK,(function webhooks_saga_saveWebhook(action){var response,err_3;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,3]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(saveWebhook,(0,humps.I)(action.payload.webhook))];case 1:return response=_a.sent(),action.callback((0,humps.b)(response.data)),[3,3];case 2:return err_3=_a.sent(),action.callback({error:err_3}),[3,3];case 3:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.DELETE_WEBHOOK,(function webhooks_saga_deleteWebhook(action){var response,err_2;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,3]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(deleteWebhook,(0,humps.I)(action.payload.webhook))];case 1:return response=_a.sent(),action.callback(response),[3,3];case 2:return err_2=_a.sent(),action.callback({error:err_2}),[3,3];case 3:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.TEST_WEBHOOK,(function webhooks_saga_testWebhook(action){var err_4;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,3]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(testWebhook,(0,humps.I)(action.payload.webhook))];case 1:return _a.sent(),action.callback(!1),[3,3];case 2:return err_4=_a.sent(),action.callback(err_4),[3,3];case 3:return[2]}}))}));function selectState(selector){return(0,redux_saga_effects_npm_proxy_esm.Lt)(selector)}function addSnackbarMessage(payload){return{type:constants.t.SNACKBAR_ADD_MESSAGE,payload:{message:payload.message,i18n:payload.i18n||!1,severity:payload.severity}}}function createAPIAddress(action){var trackingReference,jsonAddress,response,address,isDefaultSender,isDefaultReturn,err_2,responseData,errorMessage;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:trackingReference=action.payload.trackingReference,_a.label=1;case 1:return _a.trys.push([1,10,,13]),jsonAddress=APIAddress.U2((0,Address.ko)(action.payload.address)),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(createApiAddress,jsonAddress)];case 2:return response=_a.sent(),(0,utils.mq)(trackingReference,{url:response.config.url||"",isError:response.status>=300,status:response.status,message:void 0}),address=APIAddress.rS(response.data),isDefaultSender=address.isDefaultSender,isDefaultReturn=address.isDefaultReturn,isDefaultSender?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(updateUserDefaultAddress({address}))]:[3,4];case 3:_a.sent(),_a.label=4;case 4:return isDefaultReturn?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(updateUserDefaultReturnAddress({address}))]:[3,6];case 5:_a.sent(),_a.label=6;case 6:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(address_actions._M({address,trackingReference}))];case 7:return _a.sent(),action.payload.key&&action.payload.addressBookName?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(address_actions.YK(action.payload.addressBookName,action.payload.key,address.id))]:[3,9];case 8:_a.sent(),_a.label=9;case 9:return[3,13];case 10:return err_2=_a.sent(),axios_default().isAxiosError(err_2)&&(0,utils.dj)(trackingReference,err_2),responseData=err_2.response.data,errorMessage="object"==typeof responseData?Object.values(responseData).join("\n"):Array.isArray(responseData)?responseData.join("\n"):responseData,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(address_actions.Tv({error:errorMessage}))];case 11:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(addSnackbarMessage({message:"orders:address:errors:create",i18n:!0,severity:"error"}))];case 12:return _a.sent(),[3,13];case 13:return[2]}}))}function editAPIAddress(action){var trackingReference,jsonAddress,address,isDefaultSender,isDefaultReturn,location_1,err_3,response,responseData,errorMessage,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:trackingReference=action.payload.trackingReference,_b.label=1;case 1:return _b.trys.push([1,11,,13]),jsonAddress=APIAddress.U2((0,Address.ko)(action.payload.address)),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(editApiAddress,action.payload.id,jsonAddress)];case 2:return response=_b.sent(),trackingReference&&(0,utils.mq)(trackingReference,{url:response.config.url||"",isError:response.status>=300,status:response.status,message:void 0}),address=APIAddress.rS(response.data),isDefaultSender=address.isDefaultSender,isDefaultReturn=address.isDefaultReturn,[4,selectState(getLocation)];case 3:return location_1=_b.sent(),isDefaultSender?(null===(_a=location_1.search)||void 0===_a?void 0:_a.includes("progressMeter"))?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("Progress Meter - Add Saved Address Complete"))]:[3,5]:[3,7];case 4:_b.sent(),_b.label=5;case 5:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(updateUserDefaultAddress({address}))];case 6:_b.sent(),_b.label=7;case 7:return isDefaultReturn?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(updateUserDefaultReturnAddress({address}))]:[3,9];case 8:_b.sent(),_b.label=9;case 9:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(address_actions.Yl({address,id:action.payload.id}))];case 10:return _b.sent(),[3,13];case 11:return err_3=_b.sent(),trackingReference&&axios_default().isAxiosError(err_3)&&err_3.response&&(response=err_3.response,(0,utils.mq)(trackingReference,{url:response.config.url||"",isError:response.status>=300,status:response.status,message:(0,utils.w$)(response.data)||err_3.message})),responseData=err_3.response.data,errorMessage="object"==typeof responseData?Object.values(responseData).join("\n"):Array.isArray(responseData)?responseData.join("\n"):responseData,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(address_actions.v7({error:errorMessage}))];case 12:return _b.sent(),[3,13];case 13:return[2]}}))}(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ADDRESSES_FETCH,(function fetchAddresses(){var response,parsedAddresses,err_1;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getApiAddresses)];case 1:return response=_a.sent(),parsedAddresses={addresses:response.data.results.map((function(a){return APIAddress.rS(a)}))},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(address_actions.Yj(parsedAddresses))];case 2:case 4:return _a.sent(),[3,5];case 3:return err_1=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(address_actions.NE({error:err_1.message}))];case 5:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.APIADDRESS_CREATE,createAPIAddress),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.APIADDRESS_EDIT,editAPIAddress),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.APIADDRESS_DELETE,(function deleteAPIAddress(action){var trackingReference,deleteResponse,addressBookInstances,_a,_b,_c,_i,addressBookName,err_4,_d,_e,_f;return(0,tslib_es6.YH)(this,(function(_g){switch(_g.label){case 0:trackingReference=action.payload.trackingReference,_g.label=1;case 1:return _g.trys.push([1,9,,11]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(deleteApiAddress,action.payload.id)];case 2:return deleteResponse=_g.sent(),(0,utils.mq)(trackingReference,{url:deleteResponse.config.url||"",isError:!1,status:deleteResponse.status,message:void 0}),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(address_actions.pM(action.payload.id))];case 3:return _g.sent(),action.payload.key?[4,selectState(address_selectors.kH)]:[3,8];case 4:for(_c in addressBookInstances=_g.sent(),_b=[],_a=addressBookInstances)_b.push(_c);_i=0,_g.label=5;case 5:return _i<_b.length?(_c=_b[_i])in _a?(addressBookName=_c,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(address_actions.Hp(addressBookName,action.payload.key))]):[3,7]:[3,8];case 6:_g.sent(),_g.label=7;case 7:return _i++,[3,5];case 8:return[3,11];case 9:return err_4=_g.sent(),axios_default().isAxiosError(err_4)&&err_4.response&&(0,utils.mq)(trackingReference,{url:(null===(_d=err_4.response)||void 0===_d?void 0:_d.config.url)||"",isError:!0,status:null===(_e=err_4.response)||void 0===_e?void 0:_e.status,message:(0,utils.w$)(null===(_f=err_4.response)||void 0===_f?void 0:_f.data)||err_4.message}),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(address_actions.c9({error:err_4.message}))];case 10:return _g.sent(),[3,11];case 11:return[2]}}))}));var web_orders_service=__webpack_require__("./app/services/web-orders.service/index.ts"),getPathValue=function(path,param){var pathParts=path.split("/"),paramIndex=pathParts.findIndex((function(part){return part===param}));return pathParts[paramIndex+1]||""},BATCH_ENTRIES_POLL_TIMEOUT=6e4;var getOrderIdsByTags=function(tags){return(0,tslib_es6.sH)(void 0,void 0,void 0,(function(){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,web_orders_service.WF)({tag:tags})];case 1:return[2,_a.sent().data.results.map((function(order){return order.object_id}))]}}))}))};function orders_saga_countOrders(){var isOldExpChosen,countOrders_1,response,lastOrderId,ordersCount,newLastOrderId;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return _b.trys.push([0,9,,11]),[4,selectState(getIsOldExpChosen)];case 1:return isOldExpChosen=_b.sent(),countOrders_1=isOldExpChosen?countOrdersLegacy:countOrders,[4,(0,redux_saga_effects_npm_proxy_esm.T1)(countOrders_1)];case 2:return response=_b.sent(),[4,selectState(orders_selectors.Ub)];case 3:return lastOrderId=_b.sent(),(ordersCount=response.data.count)>0?(newLastOrderId=Order.rS(response.data.results[0]).objectId,lastOrderId?[3,5]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Tp(newLastOrderId))]):[3,7];case 4:return _b.sent(),[3,7];case 5:return lastOrderId===newLastOrderId?[3,7]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.I$(newLastOrderId))];case 6:_b.sent(),_b.label=7;case 7:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.HU(ordersCount))];case 8:return _b.sent(),[3,11];case 9:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.mR())];case 10:return _b.sent(),[3,11];case 11:return[2]}}))}function ordersPollWorker(){var POLL_WAIT_TIME;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return POLL_WAIT_TIME=3e5,[4,(0,redux_saga_effects_npm_proxy_esm.T1)(orders_saga_countOrders)];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.cb)(POLL_WAIT_TIME)];case 2:return _a.sent(),[3,0];case 3:return[2]}}))}function firstTimeSyncWorker(){var POLL_WAIT_TIME;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return POLL_WAIT_TIME=2e3,[4,(0,redux_saga_effects_npm_proxy_esm.T1)(countOrders)];case 1:return _a.sent().data.results.length>0?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Gb("other",1,{},"",!1,"","","relevance","desc"))]:[3,5];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,stores_actions.hO)())];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Nx())];case 4:_a.sent(),_a.label=5;case 5:return[4,(0,redux_saga_effects_npm_proxy_esm.cb)(POLL_WAIT_TIME)];case 6:return _a.sent(),[3,0];case 7:return[2]}}))}var orders_saga_worker=null,ordersToPoll={},shipmentsToPoll={};function getBatchEntries(orderObjectIDs,includeReturns){var batchEntries,missingOrders,response,orderBatchEntriesMap_1,response_1;return void 0===includeReturns&&(includeReturns=!1),(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:batchEntries=[],missingOrders=[],_a.label=1;case 1:return _a.trys.push([1,5,,7]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getOrderBatchEntries,missingOrders.length?missingOrders:orderObjectIDs,includeReturns)];case 2:return response=_a.sent(),batchEntries=(0,tslib_es6.fX)([],(0,tslib_es6.zs)(response.data.results.map(OrderBatchEntry.kc)),!1),orderBatchEntriesMap_1=batchEntries.reduce((function(map,be){return map[be.orderObjectId]?map[be.orderObjectId].push(be):map[be.orderObjectId]=[be],map}),{}),(missingOrders=orderObjectIDs.filter((function(objectId){return!orderBatchEntriesMap_1[objectId]}))).length>0?[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getOrCloneBatchEntriesForOrders,missingOrders,[])]:[3,4];case 3:response_1=_a.sent(),batchEntries=(0,tslib_es6.fX)((0,tslib_es6.fX)([],(0,tslib_es6.zs)(batchEntries),!1),(0,tslib_es6.zs)(response_1.data.results.map(OrderBatchEntry.kc)),!1),_a.label=4;case 4:return[3,7];case 5:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.n$(missingOrders||orderObjectIDs))];case 6:return _a.sent(),[3,7];case 7:return[2,batchEntries]}}))}function getSelectedBatchEntryIds(){var pathName,batchEntryIdFromUrl,selectedOrders;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(getPathname)];case 1:return pathName=_a.sent(),(batchEntryIdFromUrl=getPathValue(pathName,"shipments"))?[2,[Number(batchEntryIdFromUrl)]]:[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(orders_selectors.Li)];case 2:return selectedOrders=_a.sent(),[2,(0,flatten.A)(Object.values(selectedOrders))]}}))}function batchEntriesWorker(ordersToPoll,shipmentsToPoll){var _loop_1,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:_loop_1=function(){var orderObjectIds,completedBatchEntries,ordersData,ordersBatchEntryIsTerminalPollingState,isNewReturnsWorkflowEnabled,batchEntries,selectedBatchEntries_1,hasSelectedBatchEntries,filteredBatchEntries,filteredBatchEntries_1,filteredBatchEntries_1_1,batchEntry,batchEntryInTerminalPollingState,shipmentObjectIds,shipmentsData,shipmentObjectIds_1,shipmentObjectIds_1_1,shipmentObjectId,trackingReference,shipment,e_7_1,err_23,e_8,_c,e_7,_d;return(0,tslib_es6.YH)(this,(function(_e){switch(_e.label){case 0:return _e.trys.push([0,24,,26]),(orderObjectIds=Object.keys(ordersToPoll)).length>0?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.bp(orderObjectIds))]:[3,6];case 1:return _e.sent(),completedBatchEntries=[],[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(orders_selectors.Sv)];case 2:return ordersData=_e.sent(),ordersBatchEntryIsTerminalPollingState=Object.values(ordersData).reduce((function(map,order){var _a;if(order.partialFulfillmentRequests.length){var entry={toPoll:order.partialFulfillmentRequests.map((function(be){return be.id})),donePolling:[]};return(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},map),((_a={})[order.objectId]=entry,_a))}return map}),{}),isNewReturnsWorkflowEnabled=!!(null===(_a=window._optimizelyClient)||void 0===_a?void 0:_a.isFeatureEnabled("new_returns_workflow")),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getBatchEntries,orderObjectIds,isNewReturnsWorkflowEnabled)];case 3:return batchEntries=_e.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getSelectedBatchEntryIds)];case 4:selectedBatchEntries_1=_e.sent(),hasSelectedBatchEntries=selectedBatchEntries_1.length>0,filteredBatchEntries=hasSelectedBatchEntries?batchEntries.filter((function(be){return selectedBatchEntries_1.includes(be.id)})):batchEntries;try{for(e_8=void 0,filteredBatchEntries_1=(0,tslib_es6.Ju)(filteredBatchEntries),filteredBatchEntries_1_1=filteredBatchEntries_1.next();!filteredBatchEntries_1_1.done;filteredBatchEntries_1_1=filteredBatchEntries_1.next())batchEntry=filteredBatchEntries_1_1.value,batchEntryInTerminalPollingState=!1,[OrdersBatch.DO.SHIPMENT_REQUEST_FAILED,OrdersBatch.DO.TRANSACTION_REQUEST_FAILED,OrdersBatch.DO.INVALID_ORDER,OrdersBatch.DO.PENDING,OrdersBatch.DO.COMPLETE_TRANSACTION].includes(batchEntry.objectStatus)&&(completedBatchEntries.push(batchEntry),batchEntryInTerminalPollingState=!0),batchEntry.shipmentObjectId&&batchEntry.objectStatus===OrdersBatch.DO.COMPLETE_SHIPMENT&&(shipmentsToPoll[batchEntry.shipmentObjectId]=(new Date).getTime(),completedBatchEntries.push(batchEntry),batchEntryInTerminalPollingState=!0),batchEntryInTerminalPollingState&&(batchEntry.partialFulfillmentRank>0&&ordersBatchEntryIsTerminalPollingState[batchEntry.orderObjectId]?(ordersBatchEntryIsTerminalPollingState[batchEntry.orderObjectId].donePolling=(0,tslib_es6.fX)((0,tslib_es6.fX)([],(0,tslib_es6.zs)(ordersBatchEntryIsTerminalPollingState[batchEntry.orderObjectId].donePolling),!1),[batchEntry.id],!1),ordersBatchEntryIsTerminalPollingState[batchEntry.orderObjectId].donePolling.length===ordersBatchEntryIsTerminalPollingState[batchEntry.orderObjectId].toPoll.length&&delete ordersToPoll[batchEntry.orderObjectId]):delete ordersToPoll[batchEntry.orderObjectId])}catch(e_8_1){e_8={error:e_8_1}}finally{try{filteredBatchEntries_1_1&&!filteredBatchEntries_1_1.done&&(_c=filteredBatchEntries_1.return)&&_c.call(filteredBatchEntries_1)}finally{if(e_8)throw e_8.error}}return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.CK(completedBatchEntries))];case 5:_e.sent(),_e.label=6;case 6:return(shipmentObjectIds=Object.keys(shipmentsToPoll)).length>0?[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(shipments_selectors.Q6)]:[3,19];case 7:shipmentsData=_e.sent(),_e.label=8;case 8:_e.trys.push([8,17,18,19]),e_7=void 0,shipmentObjectIds_1=(0,tslib_es6.Ju)(shipmentObjectIds),shipmentObjectIds_1_1=shipmentObjectIds_1.next(),_e.label=9;case 9:return shipmentObjectIds_1_1.done?[3,16]:(shipmentObjectId=shipmentObjectIds_1_1.value,trackingReference=TrackingHelper.U.getTrackingReference(types.Fd.name,"other",{rateIds:void 0}),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(shipments_selectors.Tm,{shipmentId:shipmentObjectId})]);case 10:return _e.sent()?[3,15]:(shipment=shipmentsData[shipmentObjectId])?[3,12]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(batchAction(fetchShipment(shipmentObjectId,trackingReference)))];case 11:return _e.sent(),shipmentsToPoll[shipmentObjectId]=(new Date).getTime(),[3,15];case 12:return[Shipment.PH.SUCCESS,Shipment.PH.ERROR].includes(shipment.status)?(delete shipmentsToPoll[shipment.objectId],[3,15]):[3,13];case 13:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(fetchShipment(shipmentObjectId,trackingReference))];case 14:_e.sent(),_e.label=15;case 15:return shipmentObjectIds_1_1=shipmentObjectIds_1.next(),[3,9];case 16:return[3,19];case 17:return e_7_1=_e.sent(),e_7={error:e_7_1},[3,19];case 18:try{shipmentObjectIds_1_1&&!shipmentObjectIds_1_1.done&&(_d=shipmentObjectIds_1.return)&&_d.call(shipmentObjectIds_1)}finally{if(e_7)throw e_7.error}return[7];case 19:return 0!==Object.keys(ordersToPoll).length||0!==Object.keys(shipmentsToPoll).length?[3,21]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Og())];case 20:return _e.sent(),[3,23];case 21:return[4,(0,redux_saga_effects_npm_proxy_esm.cb)(750)];case 22:_e.sent(),_e.label=23;case 23:return[3,26];case 24:return err_23=_e.sent(),esm_exports.Cp("Error in batchEntriesWorker ".concat(err_23),{level:"error"}),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Og())];case 25:return _e.sent(),[3,26];case 26:return[2]}}))},_b.label=1;case 1:return[5,_loop_1()];case 2:return"break"===_b.sent()?[3,3]:[3,1];case 3:return[2]}}))}function batchEntriesPollRace(){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.O4)({task:(0,redux_saga_effects_npm_proxy_esm.T1)(batchEntriesWorker,ordersToPoll,shipmentsToPoll),cancel:(0,redux_saga_effects_npm_proxy_esm.s)([constants.t.ORDERS_BATCH_ENTRIES_POLL_END]),timeout:(0,redux_saga_effects_npm_proxy_esm.cb)(BATCH_ENTRIES_POLL_TIMEOUT,!0)})];case 1:return _a.sent().timeout&&(ordersToPoll={}),orders_saga_worker=null,[2]}}))}function toggleCheckoutModal(orders){var preCheckoutQueue,hasValidBilling,isBillingBlocked,isHighFraudRisk,registrationStatuses,carrierAccountsMap,hasValidSenderAddress,requiresEmailVerification,_a,_b,_c,carrierAccountObjectId,regStatus,carrierAccount,accountCountry,e_10,_d;return(0,tslib_es6.YH)(this,(function(_e){switch(_e.label){case 0:return preCheckoutQueue=[],[4,selectState(user_selectors.VX)];case 1:return hasValidBilling=_e.sent(),[4,selectState(user_selectors.ni)];case 2:return isBillingBlocked=_e.sent(),[4,selectState(user_selectors.Lu)];case 3:return isHighFraudRisk=_e.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(batch_entry_composite_selectors.yu,{batchEntryIds:(0,flatten.A)(Object.values(orders))})];case 4:return registrationStatuses=_e.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(carrier_accounts_selectors.Nf)];case 5:return carrierAccountsMap=_e.sent(),[4,selectState(user_selectors.Oz)];case 6:return hasValidSenderAddress=_e.sent(),[4,selectState(user_selectors.ux)];case 7:requiresEmailVerification=_e.sent(),isBillingBlocked&&isHighFraudRisk&&preCheckoutQueue.push({kind:"account-alert"});try{for(_a=(0,tslib_es6.Ju)(Object.entries(registrationStatuses)),_b=_a.next();!_b.done;_b=_a.next())switch(_c=(0,tslib_es6.zs)(_b.value,2),carrierAccountObjectId=_c[0],regStatus=_c[1],(carrierAccount=carrierAccountsMap[carrierAccountObjectId]).carrier.id){case carriers.$5.id:accountCountry=void 0,carrierAccount.metadata&&constants_countries.Xr[carrierAccount.metadata]&&(accountCountry=constants_countries.Xr[carrierAccount.metadata].iso2),preCheckoutQueue.push({kind:"ups-activation",showFullForm:!(regStatus===CarrierAccountRegStatus.n.PENDING_TERMS&&hasValidSenderAddress),accountCountry});break;case carriers.i3.id:preCheckoutQueue.push({kind:"canada_post-activation",showFullForm:!0});break;case carriers.y6.id:preCheckoutQueue.push({kind:"dhl_express-activation"})}}catch(e_10_1){e_10={error:e_10_1}}finally{try{_b&&!_b.done&&(_d=_a.return)&&_d.call(_a)}finally{if(e_10)throw e_10.error}}return hasValidBilling||(requiresEmailVerification&&preCheckoutQueue.push({kind:"email-verification"}),preCheckoutQueue.push({kind:"credit-card-info"})),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.oG(orders,preCheckoutQueue))];case 8:return _e.sent(),[2]}}))}(function ordersPollWatcher(){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.s)(constants.t.ORDERS_POLL_START)];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.O4)({task:(0,redux_saga_effects_npm_proxy_esm.T1)(ordersPollWorker),cancel:(0,redux_saga_effects_npm_proxy_esm.s)(constants.t.ORDERS_NEW_ORDERS_FOUND)})];case 2:return _a.sent(),[3,0];case 3:return[2]}}))})(),function batchEntriesPollWatcher(){var action,orderObjectIds,orderObjectIds_1,orderObjectIds_1_1,orderObjectId,e_9,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.s)([constants.t.ORDERS_BATCH_ENTRIES_POLL_START,constants.t.ORDERS_FETCH_SUCCESS])];case 1:return action=_b.sent(),[4,selectState(getIsOldExpChosen)];case 2:if(_b.sent())return[3,0];switch(orderObjectIds=[],action.type){case constants.t.ORDERS_BATCH_ENTRIES_POLL_START:orderObjectIds=action.payload.orderObjectIds;break;case constants.t.ORDERS_FETCH_SUCCESS:orderObjectIds=action.payload.orders.map((function(order){return order.objectId}))}try{for(e_9=void 0,orderObjectIds_1=(0,tslib_es6.Ju)(orderObjectIds),orderObjectIds_1_1=orderObjectIds_1.next();!orderObjectIds_1_1.done;orderObjectIds_1_1=orderObjectIds_1.next())orderObjectId=orderObjectIds_1_1.value,ordersToPoll[orderObjectId]=(new Date).getTime()}catch(e_9_1){e_9={error:e_9_1}}finally{try{orderObjectIds_1_1&&!orderObjectIds_1_1.done&&(_a=orderObjectIds_1.return)&&_a.call(orderObjectIds_1)}finally{if(e_9)throw e_9.error}}return orders_saga_worker?[3,4]:[4,(0,redux_saga_effects_npm_proxy_esm.Zy)(batchEntriesPollRace)];case 3:orders_saga_worker=_b.sent(),_b.label=4;case 4:return[3,0];case 5:return[2]}}))}(),function firstTimeSyncWatcher(){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.s)(constants.t.ORDERS_FIRST_TIME_SYNC_POLL_START)];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.O4)({task:(0,redux_saga_effects_npm_proxy_esm.T1)(firstTimeSyncWorker),cancel:(0,redux_saga_effects_npm_proxy_esm.s)(constants.t.ORDERS_FIRST_TIME_SYNC_POLL_END)})];case 2:return _a.sent(),[3,0];case 3:return[2]}}))}(),(0,redux_saga_effects_npm_proxy_esm.jP)(constants.t.ORDER_FETCH,(function fetchOrder(action){var orderId,isOldExpChosen,service,response,payload;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,4,,6]),orderId=action.orderId,[4,selectState(getIsOldExpChosen)];case 1:return isOldExpChosen=_a.sent(),service=isOldExpChosen?getLegacy:getWithReturns,[4,(0,redux_saga_effects_npm_proxy_esm.T1)(service,orderId)];case 2:return response=_a.sent(),payload={order:Order.rS(response.data)},[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.us(payload))];case 3:case 5:return _a.sent(),[3,6];case 4:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.PF())];case 6:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_FETCH,(function fetchOrders(action){var isOldExpChosen,_a,tag,filters,transformedFilters,tagsOrderIds,_b,response,parsedOrders,totalOrderCount,err_2;return(0,tslib_es6.YH)(this,(function(_c){switch(_c.label){case 0:return _c.trys.push([0,9,,11]),[4,selectState(getIsOldExpChosen)];case 1:return isOldExpChosen=_c.sent(),_a=action.payload.filters,tag=_a.tag,filters=(0,tslib_es6.Tt)(_a,["tag"]),transformedFilters=function transformFilters(filters,orderStatus){return filters?(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},filters),{order_status:"pending"===orderStatus?[Order.Re.PAID,Order.Re.UNKNOWN,Order.Re.AWAITPAY,Order.Re.PARTIALLY_FULFILLED]:"fulfilled"===orderStatus?[Order.Re.SHIPPED]:"cancelled"===orderStatus?[Order.Re.CANCELLED]:[]}):{}}(filters,action.payload.orderStatus),(null==tag?void 0:tag.length)>0?[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getOrderIdsByTags,tag)]:[3,3];case 2:return _b=_c.sent(),[3,4];case 3:_b=void 0,_c.label=4;case 4:return tagsOrderIds=_b,[4,isOldExpChosen?(0,redux_saga_effects_npm_proxy_esm.T1)(getAllLegacy,action.payload.page,transformedFilters,action.payload.fetchCount,action.payload.showOnlyHidden,action.payload.sort):(0,redux_saga_effects_npm_proxy_esm.T1)(getAll,action.payload.page,transformedFilters,action.payload.fetchCount,action.payload.showOnlyHidden,action.payload.sort,action.payload.sortBy,action.payload.orderBy,tagsOrderIds)];case 5:return response=_c.sent(),parsedOrders=response.data.results.map(Order.rS),totalOrderCount=response.data.count,function isOrderSearch(filters){return filters.order_status.length>0||Object.keys(filters).length>1}(transformedFilters)?[4,(0,redux_saga_effects_npm_proxy_esm.T1)(utils.f0,action.payload.appLocation,segment.sV.order_search_completed,{orderCount:totalOrderCount,filters:transformedFilters})]:[3,7];case 6:_c.sent(),_c.label=7;case 7:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.bL(parsedOrders,response.data.count))];case 8:return _c.sent(),[3,11];case 9:return err_2=_c.sent(),esm_exports.Cp(err_2),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.dI())];case 10:return _c.sent(),[3,11];case 11:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_SYNC,(function orders_saga_syncOrders(action){var userFirstStoreConnected,totalOrdersInStore;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,selectState(stores_selectors.RT)];case 1:return userFirstStoreConnected=_a.sent(),[4,selectState(orders_selectors.SP)];case 2:totalOrdersInStore=_a.sent(),_a.label=3;case 3:return _a.trys.push([3,9,,11]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(syncOrders)];case 4:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(orders_saga_countOrders)];case 5:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.cu())];case 6:return _a.sent(),userFirstStoreConnected&&0===totalOrdersInStore?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Gb(action.payload.appLocation,1,{},"25",!1,"","","_score","desc"))]:[3,8];case 7:_a.sent(),_a.label=8;case 8:return[3,11];case 9:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.ZT())];case 10:return _a.sent(),[3,11];case 11:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_GET_ALL_LABELS,(function orders_saga_getAllLabels(action){var orderObjectIds,batchEntryIds,response,err_5;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,8]),orderObjectIds=Object.keys(action.payload.orderSelection),batchEntryIds=Object.values(action.payload.orderSelection).reduce((function(l,v){return(0,tslib_es6.fX)((0,tslib_es6.fX)([],(0,tslib_es6.zs)(l),!1),(0,tslib_es6.zs)(v),!1)}),[]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getAllLabels,orderObjectIds,batchEntryIds)];case 1:return response=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.kB(response.data.url))];case 2:return _a.sent(),[3,8];case 3:return err_5=_a.sent(),axios_default().isAxiosError(err_5)&&err_5.response&&err_5.response.data?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.FO(err_5.response.data))]:[3,5];case 4:return _a.sent(),[3,7];case 5:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.FO("We hit an unexpected error. Please try again."))];case 6:_a.sent(),_a.label=7;case 7:return[3,8];case 8:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_GET_LABEL,(function orders_saga_getLabel(action){var response;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(orders_service_getLabel,action.payload.transactionIds,action.payload.fileFormat)];case 1:return response=_a.sent(),action.payload.windowRef.location.assign(response.data.url),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.m3())];case 2:case 4:return _a.sent(),[3,5];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Vf())];case 5:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.IJ)(constants.t.ORDERS_GET_PACKING_SLIP,(function orders_saga_getOrderPackingSlip(action){var _a,orderObjectIds,batchEntryIds,response;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return _b.trys.push([0,3,,5]),_a=Order.Hl(action.payload.orderSelection),orderObjectIds=_a.orderObjectIds,batchEntryIds=_a.batchEntryIds,[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getOrderPackingSlip,orderObjectIds,batchEntryIds)];case 1:return response=_b.sent(),action.payload.windowRef.location.assign(response.data.slip_url),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(utils.MH,action.payload.appLocation,"packing_slip",action.payload.orderSelection)];case 2:case 4:return _b.sent(),[3,5];case 3:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.i2())];case 5:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_SEND_EMAIL_NOTIFICATION,(function orders_saga_sendEmailNotification(action){var transactionsToEmail;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(orders_selectors.PJ,{orderObjectIds:action.payload.ids})];case 1:return(transactionsToEmail=_a.sent())?[3,3]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.an())];case 2:return _a.sent(),[2];case 3:return _a.trys.push([3,6,,8]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(transactions_service_emailNotify,transactionsToEmail)];case 4:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.HE())];case 5:case 7:return _a.sent(),[3,8];case 6:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.an())];case 8:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.BATCH_CREATE,(function orders_saga_createBatch(action){var batchEntries,isOldExpChosen,_a,_b,orderObjectId,batchEntry,e_1_1,response,e_1,_c;return(0,tslib_es6.YH)(this,(function(_d){switch(_d.label){case 0:return _d.trys.push([0,14,,16]),batchEntries=[],[4,selectState(getIsOldExpChosen)];case 1:if(isOldExpChosen=_d.sent())return[3,9];_d.label=2;case 2:_d.trys.push([2,7,8,9]),_a=(0,tslib_es6.Ju)(action.payload.ids),_b=_a.next(),_d.label=3;case 3:return _b.done?[3,6]:(orderObjectId=_b.value,[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(batch_entry_selectors.o0,{orderObjectId})]);case 4:(batchEntry=_d.sent())&&batchEntries.push(batchEntry),_d.label=5;case 5:return _b=_a.next(),[3,3];case 6:return[3,9];case 7:return e_1_1=_d.sent(),e_1={error:e_1_1},[3,9];case 8:try{_b&&!_b.done&&(_c=_a.return)&&_c.call(_a)}finally{if(e_1)throw e_1.error}return[7];case 9:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(createBatch,action.payload.ids,batchEntries.filter((function(batchEntry){return batchEntry})))];case 10:return response=_d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.WV(OrdersBatch.rS(response.data)))];case 11:return _d.sent(),isOldExpChosen?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,actions.VC)({pathname:"/orders/batch/".concat(response.data.id)}))]:[3,13];case 12:_d.sent(),_d.label=13;case 13:return[3,16];case 14:return _d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.nM())];case 15:return _d.sent(),[3,16];case 16:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(constants.t.ORDER_HIDE,(function orders_saga_hideOrder(action){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(hideOrder,action.payload.ids)];case 1:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.w())];case 2:case 4:return _a.sent(),[3,5];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.hz("We hit an unexpected error. Please try again."))];case 5:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(constants.t.ORDERS_UPDATE_PARCEL,(function orders_saga_updateParcel(action){var jsonParcel,batchEntriesIdsToUpdate,updatedBatchEntriesResult,batchEntryOrderIds,ordersMap_2,ordersWithInvalidOrProcessingBatchEntryStatus,ordersWithoutSenderAddress,ordersToFetch,ordersToFetch_2,ordersToFetch_2_1,orderId,e_3_1,orderHasAddressToMap_2,responseOrderObjectIds,err_13,batchEntries,shipmentIds,e_3,_a,_b;return(0,tslib_es6.YH)(this,(function(_c){switch(_c.label){case 0:return _c.trys.push([0,16,,20]),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.De)(constants_form.n6))];case 1:return _c.sent(),jsonParcel=Parcel.U2(action.payload.parcel),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getBatchEntriesIdsToUpdate,action.payload.orderSelection)];case 2:return batchEntriesIdsToUpdate=_c.sent().batchEntriesIdsToUpdate,[4,(0,redux_saga_effects_npm_proxy_esm.T1)(updateParcel,batchEntriesIdsToUpdate,jsonParcel)];case 3:return updatedBatchEntriesResult=_c.sent(),(0,utils.mq)(action.payload.trackingReference,{url:updatedBatchEntriesResult.config.url||"",isError:!1,status:updatedBatchEntriesResult.status,message:void 0}),batchEntries=updatedBatchEntriesResult.data.map(OrderBatchEntry.kc),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.i0(batchEntries))];case 4:return _c.sent(),batchEntryOrderIds=batchEntries.map((function(batchEntry){return batchEntry.orderObjectId})),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(orders_selectors.Sv)];case 5:ordersMap_2=_c.sent(),ordersWithInvalidOrProcessingBatchEntryStatus=batchEntries.filter((function(batchEntry){return[OrdersBatch.DO.INVALID_ORDER,OrdersBatch.DO.PROCESSING_SHIPMENT].includes(batchEntry.objectStatus)})).map((function(batchEntry){return batchEntry.orderObjectId})),ordersWithoutSenderAddress=batchEntryOrderIds.filter((function(orderId){return!ordersMap_2[orderId].addressFrom})),ordersToFetch=(0,uniq.A)(ordersWithInvalidOrProcessingBatchEntryStatus.concat(ordersWithoutSenderAddress)),_c.label=6;case 6:_c.trys.push([6,11,12,13]),ordersToFetch_2=(0,tslib_es6.Ju)(ordersToFetch),ordersToFetch_2_1=ordersToFetch_2.next(),_c.label=7;case 7:return ordersToFetch_2_1.done?[3,10]:(orderId=ordersToFetch_2_1.value,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.XD(orderId))]);case 8:_c.sent(),_c.label=9;case 9:return ordersToFetch_2_1=ordersToFetch_2.next(),[3,7];case 10:return[3,13];case 11:return e_3_1=_c.sent(),e_3={error:e_3_1},[3,13];case 12:try{ordersToFetch_2_1&&!ordersToFetch_2_1.done&&(_a=ordersToFetch_2.return)&&_a.call(ordersToFetch_2)}finally{if(e_3)throw e_3.error}return[7];case 13:return orderHasAddressToMap_2=batchEntries.reduce((function(map,batchEntry){return map[batchEntry.orderObjectId]=!!batchEntry.addressTo,map}),{}),responseOrderObjectIds=batchEntryOrderIds.filter((function(orderId){return!!ordersMap_2[orderId].toAddress||orderHasAddressToMap_2[orderId]})),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Wj(responseOrderObjectIds))];case 14:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.uj)(constants_form.n6))];case 15:return _c.sent(),[3,20];case 16:return err_13=_c.sent(),esm_exports.Cp(err_13),axios_default().isAxiosError(err_13)&&(0,utils.mq)(action.payload.trackingReference,{url:err_13.config.url||"",isError:!0,status:(null===(_b=err_13.response)||void 0===_b?void 0:_b.status)||-1,message:err_13.message}),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.$D(err_13))];case 17:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(batch_entry_selectors.dM,{orderObjectIds:Object.keys(action.payload.orderSelection)})];case 18:return batchEntries=_c.sent(),shipmentIds=batchEntries.map((function(batchEntry){return batchEntry.shipmentObjectId})).filter((function(shipmentId){return null!==shipmentId})),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(clearRates(shipmentIds))];case 19:return _c.sent(),[3,20];case 20:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(constants.t.FETCH_ORDER_TRANSACTIONS,(function fetchOrderTransactions(action){var result,parsedTransactions;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getOrderTransactions,action.payload.orderObjectId)];case 1:return result=_a.sent(),parsedTransactions=result.data.results.map(Transaction.p9),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.$2(action.payload.orderObjectId,parsedTransactions))];case 2:case 4:return _a.sent(),[3,5];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.cy())];case 5:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(constants.t.ORDER_BATCH_ENTRY_FETCH,(function fetchOrderBatchEntry(action){var response,batchEntriesExtended;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getOrderBatchEntry,action.payload.orderObjectId,!0)];case 1:return response=_a.sent(),batchEntriesExtended=response.data.map(OrderBatchEntry.kc),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.CK(batchEntriesExtended))];case 2:case 4:return _a.sent(),[3,5];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Zq(action.payload.orderObjectId))];case 5:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(constants.t.ORDERS_COUNT_FETCH,orders_saga_countOrders),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_PATCH_BATCH_ENTRIES,(function orders_saga_patchBatchEntries(action){var batchEntriesIdsToUpdate,patchResult,batchEntries,batchEntryOrderIds,ordersMap_1,ordersWithInvalidOrProcessingBatchEntryStatus,ordersWithoutSenderAddress,ordersToFetch,ordersToFetch_1,ordersToFetch_1_1,orderId,e_2_1,responseOrderObjectIds,orderHasAddressToMap_1,err_12,e_2,_a,_b;return(0,tslib_es6.YH)(this,(function(_c){switch(_c.label){case 0:return _c.trys.push([0,18,,22]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getBatchEntriesIdsToUpdate,action.payload.orderSelection)];case 1:return batchEntriesIdsToUpdate=_c.sent().batchEntriesIdsToUpdate,action.payload.parcel||action.payload.extras?[3,3]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.nr("orders:errors:patchBatchEntry:zeroOptionalArgs"))];case 2:return _c.sent(),[2];case 3:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(patchBatchEntries,batchEntriesIdsToUpdate,action.payload.parcel,action.payload.extras)];case 4:return patchResult=_c.sent(),(0,utils.mq)(action.payload.trackingReference,{url:patchResult.config.url||"",isError:!1,status:patchResult.status,message:void 0}),action.payload.extras?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("ADDITIONAL_SERVICES_SAVE",{batchEntries:batchEntriesIdsToUpdate,payload:action.payload.extras}))]:[3,6];case 5:_c.sent(),_c.label=6;case 6:return batchEntries=patchResult.data.map(OrderBatchEntry.kc),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.SM(batchEntries))];case 7:return _c.sent(),batchEntryOrderIds=batchEntries.map((function(batchEntry){return batchEntry.orderObjectId})),[4,selectState(orders_selectors.Sv)];case 8:ordersMap_1=_c.sent(),ordersWithInvalidOrProcessingBatchEntryStatus=batchEntries.filter((function(batchEntry){return(0,tslib_es6.fX)([OrdersBatch.DO.INVALID_ORDER],(0,tslib_es6.zs)(action.payload.parcel?[OrdersBatch.DO.PROCESSING_SHIPMENT]:[]),!1).includes(batchEntry.objectStatus)})).map((function(batchEntry){return batchEntry.orderObjectId})),ordersWithoutSenderAddress=batchEntryOrderIds.filter((function(orderId){return!ordersMap_1[orderId].addressFrom})),ordersToFetch=(0,uniq.A)(ordersWithInvalidOrProcessingBatchEntryStatus.concat(ordersWithoutSenderAddress)),_c.label=9;case 9:_c.trys.push([9,14,15,16]),ordersToFetch_1=(0,tslib_es6.Ju)(ordersToFetch),ordersToFetch_1_1=ordersToFetch_1.next(),_c.label=10;case 10:return ordersToFetch_1_1.done?[3,13]:(orderId=ordersToFetch_1_1.value,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.XD(orderId))]);case 11:_c.sent(),_c.label=12;case 12:return ordersToFetch_1_1=ordersToFetch_1.next(),[3,10];case 13:return[3,16];case 14:return e_2_1=_c.sent(),e_2={error:e_2_1},[3,16];case 15:try{ordersToFetch_1_1&&!ordersToFetch_1_1.done&&(_a=ordersToFetch_1.return)&&_a.call(ordersToFetch_1)}finally{if(e_2)throw e_2.error}return[7];case 16:return responseOrderObjectIds=void 0,action.payload.parcel?(orderHasAddressToMap_1=batchEntries.reduce((function(map,batchEntry){return map[batchEntry.orderObjectId]=!!batchEntry.addressTo,map}),{}),responseOrderObjectIds=batchEntryOrderIds.filter((function(orderId){return!!ordersMap_1[orderId].toAddress||orderHasAddressToMap_1[orderId]}))):responseOrderObjectIds=batchEntryOrderIds.filter((function(orderId){return!!ordersMap_1[orderId].parcel})),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Wj(responseOrderObjectIds))];case 17:return _c.sent(),[3,22];case 18:return err_12=_c.sent(),axios_default().isAxiosError(err_12)&&(0,utils.mq)(action.payload.trackingReference,{url:err_12.config.url||"",isError:!0,status:(null===(_b=err_12.response)||void 0===_b?void 0:_b.status)||-1,message:err_12.message}),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.nr(err_12))];case 19:return _c.sent(),action.payload.extras?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("ADDITIONAL_SERVICES_SAVE_FAILED",{err:err_12}))]:[3,21];case 20:_c.sent(),_c.label=21;case 21:return[3,22];case 22:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_UPDATE_BATCH_ENTRIES_EXTRAS,(function updateBatchEntriesExtras(action){var batchEntriesIdsToUpdate,result,batchEntries,batchEntryOrderIds,ordersMap_3,batchEntriesWithInvalidOrder,ordersWithoutSenderAddress,ordersToFetch,ordersToFetch_3,ordersToFetch_3_1,orderId,e_4_1,responseOrderObjectIds,err_14,e_4,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return _b.trys.push([0,17,,20]),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.De)(action.payload.form))];case 1:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getBatchEntriesIdsToUpdate,action.payload.orderSelection)];case 2:return batchEntriesIdsToUpdate=_b.sent().batchEntriesIdsToUpdate,[4,(0,redux_saga_effects_npm_proxy_esm.T1)(updateBatchEntryExtras,batchEntriesIdsToUpdate,action.payload.extras)];case 3:return result=_b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("ADDITIONAL_SERVICES_SAVE",{batchEntries:batchEntriesIdsToUpdate,payload:action.payload.extras}))];case 4:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.uj)(action.payload.form))];case 5:return _b.sent(),batchEntries=result.data.map(OrderBatchEntry.kc),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Ay(batchEntries))];case 6:return _b.sent(),batchEntryOrderIds=batchEntries.map((function(batchEntry){return batchEntry.orderObjectId})),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(orders_selectors.Sv)];case 7:ordersMap_3=_b.sent(),batchEntriesWithInvalidOrder=batchEntries.filter((function(batchEntry){return batchEntry.objectStatus===OrdersBatch.DO.INVALID_ORDER})).map((function(batchEntry){return batchEntry.orderObjectId})),ordersWithoutSenderAddress=batchEntryOrderIds.filter((function(orderId){return!ordersMap_3[orderId].addressFrom})),ordersToFetch=(0,uniq.A)(batchEntriesWithInvalidOrder.concat(ordersWithoutSenderAddress)),_b.label=8;case 8:_b.trys.push([8,13,14,15]),ordersToFetch_3=(0,tslib_es6.Ju)(ordersToFetch),ordersToFetch_3_1=ordersToFetch_3.next(),_b.label=9;case 9:return ordersToFetch_3_1.done?[3,12]:(orderId=ordersToFetch_3_1.value,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.XD(orderId))]);case 10:_b.sent(),_b.label=11;case 11:return ordersToFetch_3_1=ordersToFetch_3.next(),[3,9];case 12:return[3,15];case 13:return e_4_1=_b.sent(),e_4={error:e_4_1},[3,15];case 14:try{ordersToFetch_3_1&&!ordersToFetch_3_1.done&&(_a=ordersToFetch_3.return)&&_a.call(ordersToFetch_3)}finally{if(e_4)throw e_4.error}return[7];case 15:return responseOrderObjectIds=batchEntryOrderIds.filter((function(orderId){return!!ordersMap_3[orderId].parcel})),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Wj(responseOrderObjectIds))];case 16:return _b.sent(),[3,20];case 17:return err_14=_b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.uj)(action.payload.form))];case 18:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("ADDITIONAL_SERVICES_SAVE_FAILED",{err:err_14}))];case 19:return _b.sent(),[3,20];case 20:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_PATCH_UPDATE_BATCH_ENTRIES_EXTRAS,(function orders_saga_patchUpdateBatchEntriesExtras(action){var batchEntriesIdsToUpdate,result,batchEntries,batchEntryOrderIds,ordersMap_4,batchEntriesWithInvalidOrder,ordersWithoutSenderAddress,ordersToFetch,ordersToFetch_4,ordersToFetch_4_1,orderId,e_5_1,responseOrderObjectIds,err_15,e_5,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return _b.trys.push([0,15,,18]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getBatchEntriesIdsToUpdate,action.payload.orderSelection)];case 1:return batchEntriesIdsToUpdate=_b.sent().batchEntriesIdsToUpdate,[4,(0,redux_saga_effects_npm_proxy_esm.T1)(patchUpdateBatchEntryExtras,batchEntriesIdsToUpdate,action.payload.extras)];case 2:return result=_b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("ADDITIONAL_SERVICES_SAVE",{batchEntries:batchEntriesIdsToUpdate,payload:action.payload.extras}))];case 3:return _b.sent(),batchEntries=result.data.map(OrderBatchEntry.kc),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.I2(batchEntries))];case 4:return _b.sent(),batchEntryOrderIds=batchEntries.map((function(batchEntry){return batchEntry.orderObjectId})),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(orders_selectors.Sv)];case 5:ordersMap_4=_b.sent(),batchEntriesWithInvalidOrder=batchEntries.filter((function(batchEntry){return batchEntry.objectStatus===OrdersBatch.DO.INVALID_ORDER})).map((function(batchEntry){return batchEntry.orderObjectId})),ordersWithoutSenderAddress=batchEntryOrderIds.filter((function(orderId){return!ordersMap_4[orderId].addressFrom})),ordersToFetch=(0,uniq.A)(batchEntriesWithInvalidOrder.concat(ordersWithoutSenderAddress)),_b.label=6;case 6:_b.trys.push([6,11,12,13]),ordersToFetch_4=(0,tslib_es6.Ju)(ordersToFetch),ordersToFetch_4_1=ordersToFetch_4.next(),_b.label=7;case 7:return ordersToFetch_4_1.done?[3,10]:(orderId=ordersToFetch_4_1.value,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.XD(orderId))]);case 8:_b.sent(),_b.label=9;case 9:return ordersToFetch_4_1=ordersToFetch_4.next(),[3,7];case 10:return[3,13];case 11:return e_5_1=_b.sent(),e_5={error:e_5_1},[3,13];case 12:try{ordersToFetch_4_1&&!ordersToFetch_4_1.done&&(_a=ordersToFetch_4.return)&&_a.call(ordersToFetch_4)}finally{if(e_5)throw e_5.error}return[7];case 13:return responseOrderObjectIds=batchEntryOrderIds.filter((function(orderId){return!!ordersMap_4[orderId].parcel})),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Wj(responseOrderObjectIds))];case 14:return _b.sent(),action.payload.callback&&action.payload.callback(),[3,18];case 15:return err_15=_b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.vm((0,utils_utils.XJ)(err_15)))];case 16:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("ADDITIONAL_SERVICES_SAVE_FAILED",{err:err_15}))];case 17:return _b.sent(),[3,18];case 18:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_PATCH_UPDATE_BATCH_ENTRIES_EXTRAS_PACKING_SLIP_NOTE,(function patchUpdateBatchEntriesExtrasPackingSlipNote(action){var batchEntryIds,batchEntriesIdsToUpdate,extras,result,batchEntries,batchEntryOrderIds,ordersMap_5,batchEntriesWithInvalidOrder,ordersWithoutSenderAddress,ordersToFetch,ordersToFetch_5,ordersToFetch_5_1,orderId,e_6_1,responseOrderObjectIds,err_16,e_6,_a;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return _b.trys.push([0,17,,21]),batchEntryIds=action.payload.batchEntryIds||[],action.payload.batchEntryIds?[3,2]:[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getBatchEntriesIdsToUpdate,action.payload.orderSelection)];case 1:batchEntriesIdsToUpdate=_b.sent().batchEntriesIdsToUpdate,batchEntryIds=batchEntriesIdsToUpdate,_b.label=2;case 2:return extras={packingSlipText:action.payload.packingSlipText},[4,(0,redux_saga_effects_npm_proxy_esm.T1)(patchUpdateBatchEntryExtras,batchEntryIds,extras)];case 3:return result=_b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("ADDITIONAL_SERVICES_SAVE",{batchEntries:batchEntryIds,payload:extras}))];case 4:return _b.sent(),batchEntries=result.data.map(OrderBatchEntry.kc),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.I2(batchEntries))];case 5:return _b.sent(),batchEntryOrderIds=batchEntries.map((function(batchEntry){return batchEntry.orderObjectId})),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(orders_selectors.Sv)];case 6:ordersMap_5=_b.sent(),batchEntriesWithInvalidOrder=batchEntries.filter((function(batchEntry){return batchEntry.objectStatus===OrdersBatch.DO.INVALID_ORDER})).map((function(batchEntry){return batchEntry.orderObjectId})),ordersWithoutSenderAddress=batchEntryOrderIds.filter((function(orderId){return!ordersMap_5[orderId].addressFrom})),ordersToFetch=(0,uniq.A)(batchEntriesWithInvalidOrder.concat(ordersWithoutSenderAddress)),_b.label=7;case 7:_b.trys.push([7,12,13,14]),ordersToFetch_5=(0,tslib_es6.Ju)(ordersToFetch),ordersToFetch_5_1=ordersToFetch_5.next(),_b.label=8;case 8:return ordersToFetch_5_1.done?[3,11]:(orderId=ordersToFetch_5_1.value,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.XD(orderId))]);case 9:_b.sent(),_b.label=10;case 10:return ordersToFetch_5_1=ordersToFetch_5.next(),[3,8];case 11:return[3,14];case 12:return e_6_1=_b.sent(),e_6={error:e_6_1},[3,14];case 13:try{ordersToFetch_5_1&&!ordersToFetch_5_1.done&&(_a=ordersToFetch_5.return)&&_a.call(ordersToFetch_5)}finally{if(e_6)throw e_6.error}return[7];case 14:return responseOrderObjectIds=batchEntryOrderIds.filter((function(orderId){return!!ordersMap_5[orderId].parcel})),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Wj(responseOrderObjectIds))];case 15:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(addSnackbarMessage({message:"orders:drawers:packingSlip:update:success",i18n:!0,severity:"success"}))];case 16:return _b.sent(),[3,21];case 17:return err_16=_b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.vm((0,utils_utils.XJ)(err_16)))];case 18:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("ADDITIONAL_SERVICES_SAVE_FAILED",{err:err_16}))];case 19:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(addSnackbarMessage({message:"orders:drawers:packingSlip:update:error",i18n:!0,severity:"error"}))];case 20:return _b.sent(),[3,21];case 21:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(constants.t.ORDERS_UPDATE_BATCH_ENTRIES_ADDRESS,(function updateBatchEntriesAddress(_a){var batchEntryCount,batchEntriesIdsToUpdate,address,result,parsedBatchEntries,err_17,_b,_c,_d=_a.payload,orderSelection=_d.orderSelection,originalAddress=_d.address,addressType=_d.addressType,addressBookAddress=_d.addressBookAddress,combineSenderReturnAddresses=_d.combineSenderReturnAddresses,createUserAddress=_d.createUserAddress,updateUserAddress=_d.updateUserAddress,source=_d.source,trackingReference=_d.trackingReference;return(0,tslib_es6.YH)(this,(function(_e){switch(_e.label){case 0:batchEntryCount=Object.values(orderSelection).reduce((function(count,batchEntryIds){return count+(batchEntryIds.length||1)}),0),_e.label=1;case 1:return _e.trys.push([1,11,,13]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getBatchEntriesIdsToUpdate,orderSelection)];case 2:return batchEntriesIdsToUpdate=_e.sent().batchEntriesIdsToUpdate,address=(0,tslib_es6.Cl)({},originalAddress),[addressBook.y9,addressBook.lj].includes(addressType)&&!combineSenderReturnAddresses&&createUserAddress&&address.id&&delete address.id,[4,(0,redux_saga_effects_npm_proxy_esm.T1)(updateBatchEntryAddress,(0,Address.ko)(address),addressType,(0,uniq.A)(batchEntriesIdsToUpdate))];case 3:if(result=_e.sent(),"function"!=typeof(null===(_b=null==result?void 0:result.data)||void 0===_b?void 0:_b.map))throw(0,utils.mq)(trackingReference,{url:result.config.url||"",isError:!0,status:result.status,message:"updateBatchEntryAddress got unexpected result"}),new Error("updateBatchEntryAddress got unexpected result: ".concat(result.data));return(0,utils.mq)(trackingReference,{url:result.config.url||"",isError:!1,status:result.status,message:void 0}),createUserAddress?[4,(0,redux_saga_effects_npm_proxy_esm.T1)(createAPIAddress,address_actions.TF({address,trackingReference}))]:[3,5];case 4:return _e.sent(),[3,7];case 5:return updateUserAddress&&addressBookAddress?[4,(0,redux_saga_effects_npm_proxy_esm.T1)(editAPIAddress,address_actions.h_({id:addressBookAddress.id,address:addressBookAddress,trackingReference}))]:[3,7];case 6:_e.sent(),_e.label=7;case 7:return parsedBatchEntries=result.data.map(OrderBatchEntry.kc).filter((function(batchEntry){return!batchEntry.transactionObjectId})),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.CK(parsedBatchEntries))];case 8:return _e.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Wj(parsedBatchEntries.map((function(batchEntry){return batchEntry.orderObjectId}))))];case 9:return _e.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Iu(batchEntryCount,"orders:success:batch:".concat(addressType),parsedBatchEntries,source))];case 10:return _e.sent(),[3,13];case 11:return err_17=_e.sent(),axios_default().isAxiosError(err_17)&&(0,utils.mq)(trackingReference,{url:err_17.config.url||"",isError:!0,status:(null===(_c=err_17.response)||void 0===_c?void 0:_c.status)||-1,message:err_17.message}),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.ES(batchEntryCount,"orders:errors:batch:".concat(addressType),source))];case 12:return _e.sent(),[3,13];case 13:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.jP)(constants.t.ORDERS_CREATE_ANOTHER_LABEL,(function batchEntriesRegen(action){var orderSelection,orderObjectIDs_1,batchEntryIDs_1,initialBatchEntries,results,parsedBatchEntries,resetBatchEntries,location_1;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,9,,10]),orderSelection=action.payload.orderSelection,orderObjectIDs_1=[],batchEntryIDs_1=[],[4,(0,redux_saga_effects_npm_proxy_esm.T1)(orderSelectionToBatchEntries,orderSelection)];case 1:return initialBatchEntries=_a.sent(),Object.entries(orderSelection).forEach((function(_a){var _b=(0,tslib_es6.zs)(_a,2),orderObjectId=_b[0],orderBatchEntryIDs=_b[1];orderObjectIDs_1.push(orderObjectId),(null==orderBatchEntryIDs?void 0:orderBatchEntryIDs.length)>0&&batchEntryIDs_1.push.apply(batchEntryIDs_1,(0,tslib_es6.fX)([],(0,tslib_es6.zs)(orderBatchEntryIDs),!1))})),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getOrCloneBatchEntriesForOrders,orderObjectIDs_1,batchEntryIDs_1)];case 2:return results=_a.sent(),parsedBatchEntries=results.data.map(OrderBatchEntry.kc),resetBatchEntries=findResetBatchEntries(initialBatchEntries,parsedBatchEntries),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.iZ(initialBatchEntries,resetBatchEntries))];case 3:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.CK(parsedBatchEntries))];case 4:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Wj(resetBatchEntries.map((function(batchEntry){return batchEntry.orderObjectId}))))];case 5:return _a.sent(),1!==parsedBatchEntries.length?[3,8]:[4,selectState(getLocation)];case 6:return location_1=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,actions.VC)("/orders/".concat(parsedBatchEntries[0].orderObjectId,"/shipments/").concat(parsedBatchEntries[0].id).concat(location_1.search)))];case 7:_a.sent(),_a.label=8;case 8:return[3,10];case 9:return _a.sent(),[3,10];case 10:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_BATCH_ENTRY_RETRY_SHIPMENT,(function retryShipment(action){var orderSelection,batchEntryIDs_2,results,parsedBatchEntries,location_2;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,7,,8]),orderSelection=action.payload.orderSelection,batchEntryIDs_2=[],Object.entries(orderSelection).forEach((function(_a){var orderBatchEntryIDs=(0,tslib_es6.zs)(_a,2)[1];(null==orderBatchEntryIDs?void 0:orderBatchEntryIDs.length)>0&&batchEntryIDs_2.push.apply(batchEntryIDs_2,(0,tslib_es6.fX)([],(0,tslib_es6.zs)(orderBatchEntryIDs),!1))})),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(refreshBatchEntry,batchEntryIDs_2)];case 1:return results=_a.sent(),parsedBatchEntries=results.data.map(OrderBatchEntry.kc),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.CK(parsedBatchEntries))];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Wj(parsedBatchEntries.map((function(batchEntry){return batchEntry.orderObjectId}))))];case 3:return _a.sent(),1!==parsedBatchEntries.length||batchEntryIDs_2[0]===parsedBatchEntries[0].id?[3,6]:[4,selectState(getLocation)];case 4:return location_2=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,actions.VC)("/orders/".concat(parsedBatchEntries[0].orderObjectId,"/shipments/").concat(parsedBatchEntries[0].id).concat(location_2.search)))];case 5:_a.sent(),_a.label=6;case 6:return[3,8];case 7:return _a.sent(),[3,8];case 8:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_CHECKOUT_SEND_EMAIL_NOTIFICATIONS,(function checkoutSendEmailNotification(action){var transactionsToEmail,batchEntries,orderBatchEntries,pickTransactionIDs,batchEntryTransactionIds,batchEntryTransactions;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(orders_selectors.x4,{orderObjectIds:action.payload.orderObjectIds})];case 1:return(transactionsToEmail=_a.sent())?[3,3]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.nw("We hit an unexpected problem, please try again."))];case 2:return _a.sent(),[2];case 3:return[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(batch_entry_selectors.uq,{batchEntryIds:action.payload.batchEntryIds})];case 4:batchEntries=_a.sent(),orderBatchEntries=batchEntries.reduce((function(acc,batchEntry){var _a,orderId=batchEntry.orderObjectId,orderBatchEntries=acc[orderId]||[];return(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},acc),((_a={})[orderId]=(0,tslib_es6.fX)((0,tslib_es6.fX)([],(0,tslib_es6.zs)(orderBatchEntries),!1),[batchEntry],!1),_a))}),{}),pickTransactionIDs=function(orderId){var batchEntries=orderBatchEntries[orderId],outgoingBatchEntries=batchEntries.filter((function(batchEntry){return!1===batchEntry.isReturn})),returnBatchEntries=batchEntries.filter((function(batchEntry){return!0===batchEntry.isReturn}));return outgoingBatchEntries.length>0&&returnBatchEntries.length>0?outgoingBatchEntries:batchEntries},batchEntryTransactionIds=Object.keys(orderBatchEntries).reduce((function(acc,orderId){var txnIds=pickTransactionIDs(orderId).map((function(batchEntry){return batchEntry.transactionObjectId}));return(0,tslib_es6.fX)((0,tslib_es6.fX)([],(0,tslib_es6.zs)(acc),!1),(0,tslib_es6.zs)(txnIds),!1)}),[]),batchEntryTransactions=transactionsToEmail.filter((function(transactionId){return batchEntryTransactionIds.includes(transactionId)})),_a.label=5;case 5:return _a.trys.push([5,8,,10]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(transactions_service_emailNotify,batchEntryTransactions)];case 6:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.uP())];case 7:return _a.sent(),[3,10];case 8:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.nw("We hit an unexpected problem, please try again."))];case 9:return _a.sent(),[3,10];case 10:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_UPDATE_BATCH_ENTRIES_SHIPMENT_DATE,(function updateBatchEntriesShipmentDate(action){var orderObjectIds,_a,orderSelection,shipmentDate,batchEntriesIdsToUpdate,result,parsedBatchEntries;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return _b.trys.push([0,6,8,11]),_a=action.payload,orderSelection=_a.orderSelection,shipmentDate=_a.shipmentDate,orderObjectIds=Object.keys(orderSelection),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getBatchEntriesIdsToUpdate,orderSelection)];case 1:return batchEntriesIdsToUpdate=_b.sent().batchEntriesIdsToUpdate,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.HI(batchEntriesIdsToUpdate,shipmentDate))];case 2:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(updateBatchEntryShipmentDate,shipmentDate,(0,uniq.A)(batchEntriesIdsToUpdate))];case 3:return result=_b.sent(),parsedBatchEntries=result.data.map(OrderBatchEntry.kc),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.CK(parsedBatchEntries))];case 4:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.LZ())];case 5:return _b.sent(),[3,11];case 6:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.yc())];case 7:return _b.sent(),[3,11];case 8:return orderObjectIds?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.Wj(orderObjectIds))]:[3,10];case 9:_b.sent(),_b.label=10;case 10:return[7];case 11:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_UPDATE_BATCH_ENTRIES_SERVICE_LEVEL_TOKEN,(function updateBatchEntriesServiceLevelToken(action){var _a,orderSelection,preferredServiceLevelToken,accountObjectId,batchEntryIdsToUpdate,result,parsedBatchEntries;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return _b.trys.push([0,3,,5]),_a=action.payload,orderSelection=_a.orderSelection,preferredServiceLevelToken=_a.preferredServiceLevelToken,accountObjectId=_a.accountObjectId,batchEntryIdsToUpdate=(0,compact.A)((0,flatten.A)(Object.values(orderSelection))).map((function(idString){return Number(idString)})),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(updateBatchEntryServiceLevelToken,preferredServiceLevelToken,batchEntryIdsToUpdate,accountObjectId)];case 1:return result=_b.sent(),parsedBatchEntries=result.data.map(OrderBatchEntry.kc),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.ND(parsedBatchEntries))];case 2:case 4:return _b.sent(),[3,5];case 3:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.kw())];case 5:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDER_UPDATE_WITH_BATCH_ENTRY,(function updateOrderWithBatchEntry(action){var _a,serviceLevelToken,objectID,accountObjectId,closePopover,results,parsedBatchEntries,orderSelection,trackingReference,_b,_c,_d;return(0,tslib_es6.YH)(this,(function(_e){switch(_e.label){case 0:_a=action.payload,serviceLevelToken=_a.serviceLevelToken,objectID=_a.objectID,accountObjectId=_a.accountObjectId,closePopover=_a.closePopover,_e.label=1;case 1:return _e.trys.push([1,6,,8]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getOrCloneBatchEntriesForOrders,[objectID],[])];case 2:return results=_e.sent(),closePopover&&closePopover(),(parsedBatchEntries=results.data.map(OrderBatchEntry.kc))&&0!==(null==parsedBatchEntries?void 0:parsedBatchEntries.length)?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.FF(parsedBatchEntries))]:[3,5];case 3:return _e.sent(),(_b={})[null===(_c=parsedBatchEntries[0])||void 0===_c?void 0:_c.orderObjectId]=[null===(_d=results.data[0])||void 0===_d?void 0:_d.id],orderSelection=_b,trackingReference=TrackingHelper.U.getTrackingReference(types.Fd.name,"other",{rateIds:[objectID]}),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(selectRate(objectID,"",!0,trackingReference,orderSelection,serviceLevelToken,accountObjectId))];case 4:_e.sent(),_e.label=5;case 5:return[3,8];case 6:return _e.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.kw())];case 7:return _e.sent(),[3,8];case 8:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.BATCH_ENTRY_RULES_FETCH,(function orders_saga_fetchBatchEntryRules(action){var response,rule,err_26;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,5,,7]),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(fetchBatchEntryRules,action.payload.batchEntryId)];case 1:return 0!==(response=_a.sent()).data.length?[3,3]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.x_(action.payload.batchEntryId))];case 2:return _a.sent(),[2];case 3:return rule=(0,businessRules.rJ)(response.data.map((function(batchEntryRule){return null==batchEntryRule?void 0:batchEntryRule.rule}))),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.pC(action.payload.batchEntryId,rule.businessRules))];case 4:case 6:return _a.sent(),[3,7];case 5:return err_26=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.kV((0,utils_utils.XJ)(err_26)))];case 7:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDER_CREATE_PARTIAL_FULFILLMENT_REQUESTS,(function orders_saga_createPartialFulfillmentRequests(action){var _a,partialFulfillments,filteredPartialFulfillments,response,orderWithPartialFulfillmentRequests_1,pathName,batchEntryId,batchEntry_1,_b,isPreSplit,qs_1,currentWorkingBatchEntry,orderObjectId,_c;return(0,tslib_es6.YH)(this,(function(_d){switch(_d.label){case 0:return _d.trys.push([0,17,,21]),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.De)(constants_form.CE))];case 1:return _d.sent(),_a=action.payload,orderObjectId=_a.orderObjectId,partialFulfillments=_a.partialFulfillments,filteredPartialFulfillments=partialFulfillments.filter((function(contents){return contents.some((function(item){return item.quantity>0}))})),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("SPLIT_ORDER_MODAL_SAVED",{numberOfShipments:null!==(_c=filteredPartialFulfillments.length)&&void 0!==_c?_c:0}))];case 2:return _d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(createPartialFulfillmentRequests,orderObjectId,filteredPartialFulfillments.map((function(contents){return contents.map(OrderBatchEntry.ZX)})))];case 3:return response=_d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.lM)(constants_form.CE))];case 4:return _d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.Wv)(constants_form.CE))];case 5:return _d.sent(),orderWithPartialFulfillmentRequests_1=Order.rS(response.data[0]),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.$$(orderWithPartialFulfillmentRequests_1))];case 6:return _d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.w5())];case 7:return _d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(getPathname)];case 8:return pathName=_d.sent(),batchEntryId=Number(pathName.slice(pathName.lastIndexOf("/")+1,pathName.length)),isNaN(batchEntryId)?[3,10]:[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(batch_entry_selectors.fu,{batchEntryId})];case 9:return _b=_d.sent(),[3,11];case 10:_b=null,_d.label=11;case 11:return batchEntry_1=_b,isPreSplit=pathName==="/orders/".concat(orderWithPartialFulfillmentRequests_1.objectId),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(getQS)];case 12:return qs_1=_d.sent(),batchEntry_1||isPreSplit?(currentWorkingBatchEntry=orderWithPartialFulfillmentRequests_1.partialFulfillmentRequests.find((function(be){if(!batchEntry_1)return!0;var isSingleBatchEntryToSplit=0===batchEntry_1.partialFulfillmentRank&&1===be.partialFulfillmentRank,isExistingSplit=be.partialFulfillmentRank===batchEntry_1.partialFulfillmentRank,isDeletedSplit=batchEntry_1.partialFulfillmentRank>orderWithPartialFulfillmentRequests_1.partialFulfillmentRequests.length;return!!(isSingleBatchEntryToSplit||isExistingSplit||isDeletedSplit)||void 0})))?[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,actions.HC)("/orders/".concat(orderWithPartialFulfillmentRequests_1.objectId,"/shipments/").concat(currentWorkingBatchEntry.id).concat(qs_1)))]:[3,14]:[3,16];case 13:return _d.sent(),[3,16];case 14:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,actions.HC)("/orders/".concat(orderWithPartialFulfillmentRequests_1.objectId).concat(qs_1)))];case 15:_d.sent(),_d.label=16;case 16:return[3,21];case 17:return _d.sent(),orderObjectId=action.payload.orderObjectId,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.lM)(constants_form.CE))];case 18:return _d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.uj)(constants_form.CE))];case 19:return _d.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.SG(orderObjectId,"network error"))];case 20:return _d.sent(),[3,21];case 21:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_START_CHECKOUT,(function orders_saga_startCheckout(action){var isSplitOrder,result,verification;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:return _b.trys.push([0,13,,15]),[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(batch_entry_selectors.id,{batchEntryIds:(0,flatten.A)(Object.values(action.payload.orders))})];case 1:return isSplitOrder=_b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("ORDER_CHECKOUT_STARTED",{"Is Split Order":isSplitOrder}))];case 2:return _b.sent(),[4,selectState(user_selectors.$H)];case 3:return _b.sent()?[3,5]:[4,(0,redux_saga_effects_npm_proxy_esm.T1)(toggleCheckoutModal,action.payload.orders)];case 4:return[2,_b.sent()];case 5:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getVerificationStatus)];case 6:switch(result=_b.sent(),verification=IDVerification.r(result.data),verification.state){case IDVerification.p.NO_VERIFICATION_NEEDED:case IDVerification.p.VERIFICATION_SUCCEEDED:return[3,7]}return[3,10];case 7:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(user_saga_refreshUser)];case 8:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(toggleCheckoutModal,action.payload.orders)];case 9:return[2,_b.sent()];case 10:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(setIdVerificationStatus(verification))];case 11:_b.sent(),_b.label=12;case 12:return[3,15];case 13:return _b.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(setIdVerificationStatus({state:IDVerification.p.VERIFICATION_FAILED_NO_RETRY,errors:["error_processing_request"]}))];case 14:return _b.sent(),[3,15];case 15:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_RESTART_CHECKOUT,(function reStartCheckout(){var transactions,selectedOrders_1,transactionsForRerun,orderSelection,newSelectedOrder,e_13;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,7,,8]),[4,selectState(transactions_selectors.M_)];case 1:return transactions=_a.sent(),[4,selectState(orders_selectors.Li)];case 2:return selectedOrders_1=_a.sent(),(transactionsForRerun=Object.values(transactions).filter((function(transaction){return transaction.status===Transaction.x8.ERROR&&transaction.order&&selectedOrders_1[transaction.order]}))).length?(orderSelection=transactionsForRerun.reduce((function(newOrders,transaction){return transaction.order&&(newOrders[transaction.order]=selectedOrders_1[transaction.order]),newOrders}),{}),[4,(0,redux_saga_effects_npm_proxy_esm.T1)(getBatchEntriesIdsToUpdate,orderSelection)]):[3,6];case 3:return newSelectedOrder=_a.sent().newSelectedOrder,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.lN(newSelectedOrder))];case 4:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.dT(newSelectedOrder,!0))];case 5:_a.sent(),_a.label=6;case 6:return[3,8];case 7:return e_13=_a.sent(),esm_exports.Cp(e_13),[3,8];case 8:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.IJ)(constants.t.ORDER_SPLIT_MODAL_OPEN,(function openOrderSplitModal(action){var orderObjectId;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return orderObjectId=action.payload.orderObjectId,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("SPLIT_ORDER_MODAL_OPENED",{orderObjectId}))];case 1:return _a.sent(),[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.IJ)(constants.t.ORDER_SPLIT_MODAL_CLOSE,(function closeOrderSplitModal(){return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,prod_analytics_actions.o)("SPLIT_ORDER_MODAL_CLOSED"))];case 1:return _a.sent(),[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDER_APPLY_PARCEL_TEMPLATE_TO_PARCEL_FORM,(function applyParcelTemplateToOrderParcelForm(action){var parcelTemplate,formValues,e_11;return(0,tslib_es6.YH)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,6,,7]),parcelTemplate=action.payload.parcelTemplate,[4,(0,redux_saga_effects_npm_proxy_esm.Lt)((0,getFormValues.A)(constants_form.n6))];case 1:return formValues=_a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.Zg)(constants_form.n6,"parcelTemplate",parcelTemplate))];case 2:return _a.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.Zg)(constants_form.n6,"extras",(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},formValues.extras),{isUsingCustomDimensions:!1})))];case 3:return _a.sent(),!parcelTemplate.weight||0===parcelTemplate.weight||formValues.useImportedOrderWeight?[3,5]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,redux_form_es.Zg)(constants_form.n6,"weight",parcelTemplate.weight))];case 4:_a.sent(),_a.label=5;case 5:return[3,7];case 6:return e_11=_a.sent(),esm_exports.Cp(e_11),[3,7];case 7:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDERS_FETCH_SUCCESS,(function fetchOrderTags(){var ordersData,orderIds,response,ordersWithTags,_a,_b;return(0,tslib_es6.YH)(this,(function(_c){switch(_c.label){case 0:return _c.trys.push([0,8,,10]),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.qW())];case 1:return _c.sent(),[4,selectState(orders_selectors.WF)];case 2:return ordersData=_c.sent(),orderIds=ordersData.map((function(_a){return _a.objectId})),0!==orderIds.length?[3,4]:[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.iN())];case 3:return _c.sent(),[2];case 4:return[4,(0,redux_saga_effects_npm_proxy_esm.T1)(web_orders_service.WF,{id:orderIds})];case 5:if(response=_c.sent(),!(ordersWithTags=null===(_b=null===(_a=response.data)||void 0===_a?void 0:_a.results)||void 0===_b?void 0:_b.reduce((function(orderTags,order){var _a;return(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},orderTags),((_a={})[order.object_id]=order.tags||[],_a))}),{}))||0===Object.keys(ordersWithTags).length)throw new Error("No tags found for orders");return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.eY(ordersWithTags))];case 6:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.nk())];case 7:case 9:return _c.sent(),[3,10];case 8:return _c.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.iN())];case 10:return[2]}}))})),(0,redux_saga_effects_npm_proxy_esm.p8)(constants.t.ORDER_CREATE_RETURN_LABEL,(function createReturnLabel(action){var _a,orderObjectId,shipment,parsedBatch,ordersData,partialFulfillmentRequestsWithoutReturns,orderWithReturnLabel,orderToBatchEntry,trackingReference,err_29,_b,_c,_d,_e,_f;return(0,tslib_es6.YH)(this,(function(_g){switch(_g.label){case 0:return _g.trys.push([0,10,,12]),_a=action.payload,orderObjectId=_a.orderObjectId,shipment=_a.shipment,(parsedBatch=(0,OrderBatchEntry.kc)(shipment)).returnOfID=action.payload.returnOfID,[4,(0,redux_saga_effects_npm_proxy_esm.Lt)(orders_selectors.Sv)];case 1:return ordersData=_g.sent(),partialFulfillmentRequestsWithoutReturns=(null===(_e=ordersData[orderObjectId])||void 0===_e?void 0:_e.partialFulfillmentRequests.filter((function(_a){return!_a.isReturn})))||[],orderWithReturnLabel=(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},ordersData[orderObjectId]),{partialFulfillmentRequests:(0,tslib_es6.fX)((0,tslib_es6.fX)([],(0,tslib_es6.zs)(partialFulfillmentRequestsWithoutReturns),!1),[parsedBatch],!1)}),(_b={})[orderObjectId]=parsedBatch.id,orderToBatchEntry=_b,[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.$$(orderWithReturnLabel,!0))];case 2:return _g.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.bp([orderObjectId]))];case 3:return _g.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.uF(!0))];case 4:return _g.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.PE((_c={},_c[orderObjectId]=[parsedBatch.id],_c),!0))];case 5:return _g.sent(),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions._Q(orderToBatchEntry))];case 6:return _g.sent(),(null===(_f=shipment.parcels)||void 0===_f?void 0:_f.length)?(trackingReference=TrackingHelper.U.getTrackingReference(types.yf.name,"other",{}),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)((0,orders_actions.kR)({orderSelection:(_d={},_d[orderObjectId]=[parsedBatch.id],_d),address:parsedBatch.addressFrom,addressType:addressBook.y9,combineSenderReturnAddresses:!1,createUserAddress:!1,source:"",trackingReference}))]):[3,8];case 7:_g.sent(),_g.label=8;case 8:return[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions._g())];case 9:return _g.sent(),[3,12];case 10:return err_29=_g.sent(),utils_observability.O.errorEvent("RETURN_WORKFLOW_DRAWER_OPEN",{errorMessage:"Something went wrong, please refresh and try again"}),[4,(0,redux_saga_effects_npm_proxy_esm.yJ)(orders_actions.HJ())];case 11:return _g.sent(),esm_exports.Cp("create return label action failed",err_29),[3,12];case 12:return[2]}}))}));var RateLoadingWithTimer=function(_a){var hasTimedoutOrders=_a.hasTimedoutOrders,selectedOrders=_a.selectedOrders,setHasTimedoutOrders=_a.setHasTimedoutOrders,t=_a.t,handleRefresh=(0,hooks_useRefreshRates.A)(selectedOrders).handleRefresh,timeoutIdRef=(0,react.useRef)(void 0);(0,react.useEffect)((function(){return timeoutIdRef.current=setTimeout((function(){return setHasTimedoutOrders(!0)}),BATCH_ENTRIES_POLL_TIMEOUT),function(){clearTimeout(timeoutIdRef.current),setHasTimedoutOrders(!1)}}),[]);return(0,emotion_react_jsx_runtime_browser_esm.Y)(Stack.A,(0,tslib_es6.Cl)({spacing:shippoTheme.A.spacing(2),sx:{placeItems:"center"}},{children:hasTimedoutOrders?(0,emotion_react_jsx_runtime_browser_esm.FD)(Stack.A,(0,tslib_es6.Cl)({spacing:shippoTheme.A.spacing(1),sx:{backgroundColor:styles_colors.T.backgroundDeemphasized,p:shippoTheme.A.spacing(2),borderRadius:shippoTheme.A.spacing(1)}},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Typography.A,(0,tslib_es6.Cl)({component:"p",variant:"body"},{children:t("orders:carrierRatesCard:timedoutAlertMsg")})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Button_Button.A,(0,tslib_es6.Cl)({size:"small",variant:"text",color:"secondary",onClick:function(e){setHasTimedoutOrders(!1),timeoutIdRef.current=setTimeout((function(){setHasTimedoutOrders(!0)}),BATCH_ENTRIES_POLL_TIMEOUT),handleRefresh(e)},startIcon:(0,emotion_react_jsx_runtime_browser_esm.Y)(Refresh.A,{})},{children:t("orders:carrierRatesCard:tryAgain")}))]})):(0,emotion_react_jsx_runtime_browser_esm.Y)(Box.A,(0,tslib_es6.Cl)({sx:{p:shippoTheme.A.spacing(2)}},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(CircularProgress.A,{size:"large",thickness:5})}))}))},LoadingRates=function(_a){var selectedOrders=_a.selectedOrders,hasTimedoutOrders=_a.hasTimedoutOrders,setHasTimedoutOrders=_a.setHasTimedoutOrders,t=_a.t;return(0,react.useEffect)((function(){utils_observability.O.startEvent("RATE_REFRESH_ORDER_DETAILS")}),[]),"boolean"==typeof hasTimedoutOrders&&setHasTimedoutOrders?(0,emotion_react_jsx_runtime_browser_esm.Y)(RateLoadingWithTimer,{hasTimedoutOrders,selectedOrders,setHasTimedoutOrders,t}):(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"flex flex-col items-center leading-2 pt-2"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Spinner.hQ,{})}))},ComposedCalculatedRates=(0,redux.Zz)((0,es.Ng)((function(){var getOrderById=(0,orders_selectors.H4)(),getBatchEntryById=(0,batch_entry_selectors.Xv)(),getIsBatchEntryProcessingShipment=(0,batch_entry_selectors.o1)(),getShipmentIsLoadingFromBatchEntry=(0,batch_entry_composite_selectors.Fu)(),getBatchEntryIsCompleted=(0,batch_entry_selectors.ku)(),getBatchEntryTransactionFromOrder=(0,batch_entry_composite_selectors.B6)();return function(state,ownProps){var batchEntryId=ownProps.batchEntryId,props={batchEntryId};return{isLoading:!(0,providers_selectors.X7)(state)||!getBatchEntryIsCompleted(state,props)&&!(0,batch_entry_selectors.lm)(state,props)&&(getIsBatchEntryProcessingShipment(state,props)||getShipmentIsLoadingFromBatchEntry(state,props)),order:getOrderById(state,ownProps),batchEntry:batchEntryId?getBatchEntryById(state,props):null,transaction:batchEntryId?getBatchEntryTransactionFromOrder(state,props):null,hasValidSenderAddress:(0,user_selectors.Oz)(state),carrierAccountsMap:(0,carrier_accounts_selectors.Nf)(state),registrationStatus:(0,batch_entry_composite_selectors.yu)(state,{batchEntryIds:[batchEntryId]})}}}),(function(dispatch){return{retryShipment:function(orderSelection){return dispatch((0,orders_actions.lN)(orderSelection))}}})),(0,utils_translate.Tl)("orders"),react_router.y)((function(props){var _a,_b,batchEntry=props.batchEntry,order=props.order,isLoading=props.isLoading,hasValidSenderAddress=props.hasValidSenderAddress,transaction=props.transaction,t=props.t,isUntrackable=props.isUntrackable,carrierAccountsMap=props.carrierAccountsMap,dataAnalytics=props.dataAnalytics,hasTimedoutOrders=props.hasTimedoutOrders,setHasTimedoutOrders=props.setHasTimedoutOrders,_c=hooks_useSingleCarrierRates(props.selectRate,null==batchEntry?void 0:batchEntry.id),selectRateWithAccountCheck=_c.selectRateWithAccountCheck,rates=_c.rates,selectedRate=_c.selectedRate,shipment=_c.shipment,calculatedRatesRef=(0,react.useRef)(null),handleKeyboardEvents=function(parentElementRef,selectRate,shipmentObjectId){var getCardArray=(0,react.useCallback)((function(parentElementRef){var cardNodelist=parentElementRef.querySelectorAll('[data-testid="calculated-rates-list-item"]');return Array.from(cardNodelist)}),[]),getFocusCardIndex=(0,react.useCallback)((function(e,cards){return cards.findIndex((function(card){return card.dataset.key===e.currentTarget.dataset.key}))}),[]),focusNextCard=(0,react.useCallback)((function(cards,focusCardIndex){focusCardIndex<cards.length-1&&cards[focusCardIndex+1].focus()}),[]),focusPreviousElement=(0,react.useCallback)((function(cards,focusCardIndex){focusCardIndex>0&&cards[focusCardIndex-1].focus()}),[]);return{handleKeyboardEvents:(0,react.useCallback)((function(e,rate){if("keydown"===e.type&&shipmentObjectId&&rate&&parentElementRef.current){var cards=getCardArray(parentElementRef.current),focusCardIndex=getFocusCardIndex(e,cards);switch(e.code){case"Enter":case"Space":e.preventDefault(),selectRate(shipmentObjectId,rate);break;case"ArrowDown":e.preventDefault(),focusNextCard(cards,focusCardIndex);break;case"ArrowUp":e.preventDefault(),focusPreviousElement(cards,focusCardIndex)}}}),[shipmentObjectId,parentElementRef])}}(calculatedRatesRef,selectRateWithAccountCheck,null==shipment?void 0:shipment.objectId).handleKeyboardEvents,insightsFeatureFlag=(0,featureflags.u)(featureflags.gH.INSIGHTS),orderID=order.objectId,batchEntryID=(null==batchEntry?void 0:batchEntry.id)||null,hasErrors=(0,hasRatingErrors.A)(order,batchEntry,shipment,transaction,rates,hasValidSenderAddress).hasErrors,_d=(0,Address.tS)(order,batchEntry),addressTo=_d.addressTo,addressFrom=_d.addressFrom,_e=useFetchTransitTime(!!(null==insightsFeatureFlag?void 0:insightsFeatureFlag.enabled),null==addressFrom?void 0:addressFrom.zip,null==addressTo?void 0:addressTo.zip),isLoadingTransit=_e.isLoadingTransit,transitData=_e.transitData,transitError=_e.transitError,transitDataServiceLevels=!transitData||isLoadingTransit||transitError?void 0:transitData,warnings=(0,getRateWarnings.Ay)(order,batchEntry,selectedRate),nonUPSSurchargeWarnings=(0,RatingErrors_util.Lj)(warnings).nonUPSSurchargeWarnings,dataAnalyticsContext="".concat(dataAnalytics,"ServiceLevel"),batchEntryIds=props.batchEntry?[props.batchEntry.id]:[],orderSelection=((_a={})[props.order.objectId]=batchEntryIds,_a);(0,react.useEffect)((function(){hasErrors||(null==batchEntry?void 0:batchEntry.objectStatus)!==OrdersBatch.DO.PENDING||props.retryShipment(orderSelection)}),[null==batchEntry?void 0:batchEntry.objectStatus,hasErrors]),hooks_useTrackRateSelect(selectedRate,hasErrors,dataAnalytics);var sendTrackEvent=hooks_useSendTrackEvent();(0,react.useEffect)((function(){hasErrors||sendTrackEvent("App - All Rates Viewed",{rateRequestLocation:dataAnalytics||"",areSavingsShown:!1})}),[hasErrors]);var ratesToDisplay=(0,Rate.P2)(rates),hasWarnings=rates.length>0&&shipment,warningMessages=(0,react.useMemo)((function(){return(null==shipment?void 0:shipment.messages.filter(APIMessage.OR))||[]}),[shipment]);if((0,react.useEffect)((function(){isLoading||hasErrors||utils_observability.O.successEvent("RATE_REFRESH_ORDER_DETAILS",{resultsCount:rates.length,warningSourcesCount:hasWarnings?warningMessages.map((function(message){return message.source})).reduce((function(acc,cur){return acc[cur]?acc[cur]++:acc[cur]=1,acc}),{}):{}})}),[hasErrors,hasWarnings,isLoading,rates.length,warningMessages]),(0,react.useEffect)((function(){return function(){utils_observability.O.cancelEvent("RATE_REFRESH_ORDER_DETAILS")}}),[]),!hasErrors&&props.batchEntry){if(props.batchEntry.objectStatus===OrdersBatch.DO.PENDING)return null;if(props.batchEntry.objectStatus===OrdersBatch.DO.COMPLETE_TRANSACTION)return null;if(null===(_b=props.transaction)||void 0===_b?void 0:_b.trackingNumber)return null}var rateListProps={selectedRate,shipment,onSelectRate:selectRateWithAccountCheck,isUntrackable,carrierAccountsMap,dataAnalyticsContext,handleKeyboardEvents,warnings,t};return(0,emotion_react_jsx_runtime_browser_esm.Y)(ManualErrorBoundary.A,(0,tslib_es6.Cl)({onError:function(){utils_observability.O.errorEvent("RATE_REFRESH_ORDER_DETAILS",{requestFailed:!0,errorMessage:"An error occurred. Please refresh the page."})}},{children:hasErrors&&(0,emotion_react_jsx_runtime_browser_esm.Y)(RatingErrors_container,{orderId:orderID,batchEntryId:batchEntryID})||(0,emotion_react_jsx_runtime_browser_esm.Y)(components_GradientWrapper,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(Stack.A,(0,tslib_es6.Cl)({gap:1,"data-testid":"order-details-calculated-rates"},{children:[!!nonUPSSurchargeWarnings.length&&(0,emotion_react_jsx_runtime_browser_esm.Y)(RatingErrors_RateWarnings,{warnings:nonUPSSurchargeWarnings,addressTo,addressFrom,orderID,batchEntryID}),0===nonUPSSurchargeWarnings.length&&0===rates.length&&!isLoading&&(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"flex flex-col items-center leading-4 py-4"},{children:t("orders:table:errors:noRates")})),(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({ref:calculatedRatesRef},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Stack.A,(0,tslib_es6.Cl)({gap:3},{children:ratesToDisplay.map((function(_a){var rates=_a.rates,displayAttribute=_a.displayAttribute;return(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderDetailsPage_RateList,(0,tslib_es6.Cl)({transitDataServiceLevels,rates,attributeText:t("orders:calculateRates:rates:attributes:".concat(displayAttribute))},rateListProps),displayAttribute)}))}))})),isLoading&&(0,emotion_react_jsx_runtime_browser_esm.Y)(LoadingRates,{selectedOrders:orderSelection,hasTimedoutOrders,setHasTimedoutOrders,t}),(0,emotion_react_jsx_runtime_browser_esm.Y)(ShipmentErrors,{t,messages:warningMessages})]}))})}))}));const OrderDetailsPage_CalculatedRates=ComposedCalculatedRates;var RatesCell_CaretIcon=(0,emotion_styled_browser_esm.A)("img")(RatesCell_templateObject_1||(RatesCell_templateObject_1=(0,tslib_es6.ue)(["\n  ","\n"],["\n  ","\n"])),(function(_a){return _a.isOpen?"transform: rotate(180deg)":"opacity: 0.2"})),ServiceIconContainer=(0,emotion_styled_browser_esm.A)("div")(RatesCell_templateObject_2||(RatesCell_templateObject_2=(0,tslib_es6.ue)(["\n  display: flex;\n  align-items: center;\n"],["\n  display: flex;\n  align-items: center;\n"]))),ProviderIcon=(0,emotion_styled_browser_esm.A)("img")(RatesCell_templateObject_3||(RatesCell_templateObject_3=(0,tslib_es6.ue)(["\n  height: 1.25rem;\n  width: 1.25rem;\n"],["\n  height: 1.25rem;\n  width: 1.25rem;\n"]))),SelectedRateButton=(0,emotion_styled_browser_esm.A)("button")(RatesCell_templateObject_4||(RatesCell_templateObject_4=(0,tslib_es6.ue)(["\n  ",";\n"],["\n  ",";\n"])),(function(_a){if(_a.isOpen)return"background-color: ".concat(styles_constants.Tj.sea50)})),RatesCell_ButtonContent=(0,emotion_styled_browser_esm.A)("span")(RatesCell_templateObject_5||(RatesCell_templateObject_5=(0,tslib_es6.ue)(["\n  grid-template-columns: 1.5rem 1fr 1.5rem;\n  gap: 0.5rem;\n"],["\n  grid-template-columns: 1.5rem 1fr 1.5rem;\n  gap: 0.5rem;\n"]))),NoRates=(0,emotion_styled_browser_esm.A)("div")(RatesCell_templateObject_6||(RatesCell_templateObject_6=(0,tslib_es6.ue)(["\n  padding: 0.875rem 0.5rem;\n  font-size: 0.8125rem;\n  line-height: 1.5rem;\n"],["\n  padding: 0.875rem 0.5rem;\n  font-size: 0.8125rem;\n  line-height: 1.5rem;\n"]))),LoadingRateContainer=(0,emotion_styled_browser_esm.A)("div")(RatesCell_templateObject_7||(RatesCell_templateObject_7=(0,tslib_es6.ue)(["\n  display: flex;\n  align-items: center;\n"],["\n  display: flex;\n  align-items: center;\n"]))),SelectedRateContainer=(0,emotion_styled_browser_esm.A)("div")(RatesCell_templateObject_8||(RatesCell_templateObject_8=(0,tslib_es6.ue)(["\n  display: flex;\n  align-items: center;\n  font-size: 0.8125rem;\n"],["\n  display: flex;\n  align-items: center;\n  font-size: 0.8125rem;\n"]))),LoadingRate=(0,emotion_styled_browser_esm.A)("div")(RatesCell_templateObject_9||(RatesCell_templateObject_9=(0,tslib_es6.ue)(["\n  padding-left: 0.3125rem;\n"],["\n  padding-left: 0.3125rem;\n"]))),SelectedRateContent=(0,emotion_styled_browser_esm.A)("div")(RatesCell_templateObject_10||(RatesCell_templateObject_10=(0,tslib_es6.ue)(["\n  color: ",";\n  font-size: 0.8125rem;\n  line-height: 1.25rem;\n  font-weight: ",";\n  overflow: hidden;\n"],["\n  color: ",";\n  font-size: 0.8125rem;\n  line-height: 1.25rem;\n  font-weight: ",";\n  overflow: hidden;\n"])),styles_constants.Tj.fontColor,styles_constants.Wy.medium),RateTitle=(0,emotion_styled_browser_esm.A)("div")(RatesCell_templateObject_11||(RatesCell_templateObject_11=(0,tslib_es6.ue)(["\n  font-size: 0.875rem;\n  line-height: 1.5rem;\n  color: ",";\n"],["\n  font-size: 0.875rem;\n  line-height: 1.5rem;\n  color: ",";\n"])),styles_constants.Tj.gray1000),RatesSubtitle=(0,emotion_styled_browser_esm.A)("div")(RatesCell_templateObject_12||(RatesCell_templateObject_12=(0,tslib_es6.ue)(["\n  width: 100%;\n  margin-top: -0.5rem;\n  margin-bottom: 0.5rem;\n  color: ",";\n  font-size: 0.875rem;\n"],["\n  width: 100%;\n  margin-top: -0.5rem;\n  margin-bottom: 0.5rem;\n  color: ",";\n  font-size: 0.875rem;\n"])),styles_constants.Tj.gray500),RatesCell_RateDetails=(0,emotion_styled_browser_esm.A)("div")(RatesCell_templateObject_13||(RatesCell_templateObject_13=(0,tslib_es6.ue)(["\n  color: ",";\n  font-weight: ",";\n"],["\n  color: ",";\n  font-weight: ",";\n"])),styles_constants.Tj.gray700,styles_constants.Wy.normal),EstimatedDays=(0,emotion_styled_browser_esm.A)("span")(RatesCell_templateObject_14||(RatesCell_templateObject_14=(0,tslib_es6.ue)(["\n  margin-left: 0.5rem;\n  white-space: nowrap;\n"],["\n  margin-left: 0.5rem;\n  white-space: nowrap;\n"]))),WarningIconContainer=(0,emotion_styled_browser_esm.A)("img")(RatesCell_templateObject_15||(RatesCell_templateObject_15=(0,tslib_es6.ue)(["\n  margin-right: 0.5rem;\n"],["\n  margin-right: 0.5rem;\n"]))),CardContainer=(0,emotion_styled_browser_esm.A)("div")(RatesCell_templateObject_16||(RatesCell_templateObject_16=(0,tslib_es6.ue)(["\n  max-height: 440px;\n  overflow-y: auto;\n  max-width: 21.25rem;\n\n  /* hide scrollbar for different browsers */\n  scrollbar-width: none;\n  -ms-overflow-style: none;\n  &::-webkit-scrollbar {\n    display: none;\n  }\n"],["\n  max-height: 440px;\n  overflow-y: auto;\n  max-width: 21.25rem;\n\n  /* hide scrollbar for different browsers */\n  scrollbar-width: none;\n  -ms-overflow-style: none;\n  &::-webkit-scrollbar {\n    display: none;\n  }\n"])));const RatesCell_RatesCell=(0,redux.Zz)((0,es.Ng)((function(state,ownProps){if(!ownProps.batchEntry)return{};var batchEntry=ownProps.batchEntry;return{isUntrackable:(0,OrderBatchEntry.p2)(batchEntry)&&!!batchEntry.addressTo&&(0,Address.tQ)(batchEntry.addressTo),rates:(0,batch_entry_composite_selectors.jl)(state,{batchEntryId:ownProps.batchEntry.id}),selectedRate:(0,batch_entry_composite_selectors.aq)(state,{batchEntryId:ownProps.batchEntry.id})}}),(function(dispatch,ownProps){return{selectRate:function(rateObjectId,serviceLevelToken,shipmentObjectId,accountObjectId){var _a,orderSelection=((_a={})[ownProps.batchEntry.orderObjectId]=[ownProps.batchEntry.id],_a),trackingReference=TrackingHelper.U.getTrackingReference(types.Fd.name,"order_table",{rateIds:[rateObjectId]});dispatch(selectRate(shipmentObjectId,rateObjectId,!0,trackingReference,orderSelection,serviceLevelToken,accountObjectId))}}})),(0,utils_translate.Tl)(),react_router.y)((function(props){var _a,t=props.t,selectedRate=props.selectedRate,batchEntry=props.batchEntry,rates=props.rates,order=props.order,isLoading=props.isLoading,defaultServiceProvider=props.defaultServiceProvider,selectRate=props.selectRate,isUntrackable=props.isUntrackable,defaultServiceTitle=props.defaultServiceTitle,preferredServiceTitle=props.preferredServiceTitle,method=order.shippingMethod,cost=order.shippingCost,currency=order.shippingCostCurrency,_b=(0,tslib_es6.zs)(react.useState(!1),2),isRateSelectOpen=_b[0],setIsRateSelectOpen=_b[1];if(!isLoading&&rates&&0===rates.length)return(0,emotion_react_jsx_runtime_browser_esm.Y)(NoRates,{children:t("orders:table:noRates")});var warnings=(0,getRateWarnings.Ay)(order,batchEntry,selectedRate),selectedRateProvider=selectedRate?carriers.Ps[(0,Carrier.Z)(selectedRate.provider)]:defaultServiceProvider&&batchEntry?carriers.Ps[(0,Carrier.Z)(defaultServiceProvider)]:void 0,serviceLevelTitle=selectedRate?(0,Rate.$O)(selectedRate):preferredServiceTitle||(defaultServiceTitle&&batchEntry?defaultServiceTitle:void 0),buttonBackgroundReset=isRateSelectOpen?"":"bg-transparent";return(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Popup.A,(0,tslib_es6.Cl)({trigger:(0,emotion_react_jsx_runtime_browser_esm.Y)(SelectedRateButton,(0,tslib_es6.Cl)({className:"h-full w-full border-none cursor-pointer rounded-none p-2 ".concat(buttonBackgroundReset),onClick:function(){setIsRateSelectOpen(!isRateSelectOpen)},"data-pendo":"orders-rate-toggle","data-analytics":"".concat("orders_table","ServiceLevel-click-button"),isOpen:isRateSelectOpen},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(RatesCell_ButtonContent,(0,tslib_es6.Cl)({className:"h-full w-full grid items-center text-left"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(ServiceIconContainer,{children:!isLoading&&selectedRateProvider&&(0,emotion_react_jsx_runtime_browser_esm.Y)(ProviderIcon,{src:selectedRateProvider.icon,alt:selectedRateProvider.name})}),(0,emotion_react_jsx_runtime_browser_esm.FD)(SelectedRateContent,(0,tslib_es6.Cl)({title:serviceLevelTitle},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(RateTitle,(0,tslib_es6.Cl)({className:styles_constants.xW.fulfilledOrderText},{children:!isLoading&&serviceLevelTitle})),(0,emotion_react_jsx_runtime_browser_esm.Y)(RatesCell_RateDetails,{children:function(){if(selectedRate){var estimatedDays=selectedRate.estimatedDays,ratePrice=t("translations:currency",{value:{value:Number(selectedRate.amount),currency_iso:selectedRate.currency}}),estimatedDaysTranslated=estimatedDays?t("translations:day",{count:estimatedDays}):t("orders:calculateRates:rates:info:etaUnavailable");return(0,emotion_react_jsx_runtime_browser_esm.FD)(SelectedRateContainer,{children:[warnings.length>0&&(0,emotion_react_jsx_runtime_browser_esm.Y)(WarningIconContainer,{src:question_circle_yellow,alt:"error"}),(0,emotion_react_jsx_runtime_browser_esm.Y)("span",{children:ratePrice}),(0,emotion_react_jsx_runtime_browser_esm.Y)(EstimatedDays,{children:estimatedDaysTranslated})]})}return(0,emotion_react_jsx_runtime_browser_esm.FD)(LoadingRateContainer,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Spinner.hQ,{}),(0,emotion_react_jsx_runtime_browser_esm.Y)(LoadingRate,{children:t("orders:table:loadingRate")})]})}()}),(0,emotion_react_jsx_runtime_browser_esm.Y)(CustomerShippingMethod.q,{shippingMethod:method,shippingCost:cost,shippingCostCurrency:currency})]})),(0,emotion_react_jsx_runtime_browser_esm.Y)(RatesCell_CaretIcon,{src:icons.jH,isOpen:isRateSelectOpen})]}))})),open:isRateSelectOpen,onClose:function(){setIsRateSelectOpen(!1)},on:"click",position:"bottom center",wrapperClassName:"w-full h-full",style:{padding:0,margin:0}},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(CardContainer,(0,tslib_es6.Cl)({className:"p-4"},{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(Tabs_ShipmentInfoCardTitle,(0,tslib_es6.Cl)({insideTable:!0},{children:[t("orders:calculateRates:rates:chooseRates"),rates&&!!rates.length&&(0,emotion_react_jsx_runtime_browser_esm.Y)(Addons_RefreshRatesButton,{orderSelection:(_a={},_a[order.objectId]=batchEntry?[batchEntry.id]:[],_a),isLoading,dataAnalytics:"".concat("orders_table","-refresh-rates-popup")})]})),(0,emotion_react_jsx_runtime_browser_esm.Y)(RatesSubtitle,{children:t("orders:calculateRates:rates:transitTimeEstimated")}),(0,emotion_react_jsx_runtime_browser_esm.Y)(Tabs_OrderDetails,{orderId:order.objectId}),batchEntry&&(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderDetailsPage_CalculatedRates,{selectRate:function(_a){var rateObjectId=_a.rateObjectId,serviceLevelToken=_a.serviceLevelToken,shipmentObjectId=_a.shipmentObjectId,accountObjectId=_a.accountObjectId;return selectRate(rateObjectId,serviceLevelToken,shipmentObjectId,accountObjectId)},shipmentId:batchEntry.shipmentObjectId,orderId:batchEntry.orderObjectId,batchEntryId:batchEntry.id,isUntrackable,dataAnalytics:"orders_table"})]}))}))}));var RatesCell_templateObject_1,RatesCell_templateObject_2,RatesCell_templateObject_3,RatesCell_templateObject_4,RatesCell_templateObject_5,RatesCell_templateObject_6,RatesCell_templateObject_7,RatesCell_templateObject_8,RatesCell_templateObject_9,RatesCell_templateObject_10,RatesCell_templateObject_11,RatesCell_templateObject_12,RatesCell_templateObject_13,RatesCell_templateObject_14,RatesCell_templateObject_15,RatesCell_templateObject_16,ErrorPreviewList=(0,emotion_styled_browser_esm.A)("ul")(ErrorsCellErrorList_templateObject_1||(ErrorsCellErrorList_templateObject_1=(0,tslib_es6.ue)(["\n  color: ",";\n  margin: 0;\n  padding: 0 0 5px;\n  font-weight: ",";\n"],["\n  color: ",";\n  margin: 0;\n  padding: 0 0 5px;\n  font-weight: ",";\n"])),styles_constants.Tj.gray700,styles_constants.Wy.normal),ErrorPreview=(0,emotion_styled_browser_esm.A)("li")(ErrorsCellErrorList_templateObject_2||(ErrorsCellErrorList_templateObject_2=(0,tslib_es6.ue)(["\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n"],["\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n"]))),ErrorsCellErrorList_ErrorList=(0,emotion_styled_browser_esm.A)("ul")(ErrorsCellErrorList_templateObject_3||(ErrorsCellErrorList_templateObject_3=(0,tslib_es6.ue)(["\n  list-style: disc;\n  padding-left: 24px;\n  margin-top: 8px;\n"],["\n  list-style: disc;\n  padding-left: 24px;\n  margin-top: 8px;\n"])));const ErrorsCell_ErrorsCellErrorList=(0,redux.Zz)((0,utils_translate.Tl)("orders"),react_router.y)((function(props){var errorList,t=props.t,errors=props.errors,i18n=props.i18n,isPreview=props.isPreview,order=props.order,batchEntry=props.batchEntry,setEditParcelOverlayIsOpen=props.setEditParcelOverlayIsOpen,editParcelOverlayIsOpen=props.editParcelOverlayIsOpen,addressFrom=props.addressFrom,addressTo=props.addressTo,addressBookContext=react.useContext(context.o),handleOpenCreateAddressModal=react.useCallback((function(evt){var _a;evt.stopPropagation(),evt.preventDefault();var orderSelection=((_a={})[order.objectId]=batchEntry?[batchEntry.id]:[],_a);addressBookContext.openCreateAddress(addressBook.i1,orderSelection)}),[order,batchEntry]),handleOpenEditAddressModal=react.useCallback((function(evt){var _a;evt.stopPropagation(),evt.preventDefault(),addressFrom&&addressBookContext.selectAddress(addressBook.y9,addressFrom),addressTo&&addressBookContext.selectAddress(addressBook.i1,addressTo);var orderSelection=((_a={})[order.objectId]=batchEntry?[batchEntry.id]:[],_a);addressBookContext.openEditAddress(addressBook.y9,orderSelection)}),[addressFrom,addressTo,order,batchEntry]),onOpenOverlay=function(){setEditParcelOverlayIsOpen(!0)},onCloseOverlay=function(){setEditParcelOverlayIsOpen(!1)},getErrorLink=function(error){return error===t("orders:table:errors:missingParcelInfo")?(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Popup.A,(0,tslib_es6.Cl)({trigger:(0,emotion_react_jsx_runtime_browser_esm.Y)(Link.tp,(0,tslib_es6.Cl)({onClick:onOpenOverlay},{children:t("orders:table:parcelNeeded")})),open:editParcelOverlayIsOpen,onClose:onCloseOverlay,onOpen:onOpenOverlay,on:"click",position:"bottom center",wrapperClassName:"w-full h-full inline",style:{padding:0,margin:0}},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(All_EditParcelOverlayPanel,{onCancel:onCloseOverlay,onSave:onCloseOverlay,onSubmitForm:onCloseOverlay,order,batchEntry,dataAnalyticsContext:"orders_table"})})):error===t("orders:table:errors:missingRecipientAddress")?(0,emotion_react_jsx_runtime_browser_esm.Y)(Link.tp,(0,tslib_es6.Cl)({onClick:handleOpenCreateAddressModal},{children:t("orders:table:addRecipient")})):error===t("orders:calculateRates:rates:errors:senderPhoneNumber")?(0,emotion_react_jsx_runtime_browser_esm.Y)(Link.tp,(0,tslib_es6.Cl)({onClick:handleOpenEditAddressModal},{children:t("orders:table:editSender")})):void 0},renderErrors=function(){return errors.map((function(error){return function(error){var ListItem=isPreview?ErrorPreview:"li";if("string"==typeof error)return(0,emotion_react_jsx_runtime_browser_esm.FD)(ListItem,{children:[error," ",!isPreview&&getErrorLink(error)]},"".concat(error));if(error.hasOwnProperty("code")){var nonJSXError=error,translatePath="orders:calculateRates:rates:errors:".concat(nonJSXError.code),errorText=i18n.exists(translatePath)?t("orders:table:errors:packageWeight"):function(error){switch(error.kind){case"APIError":return error.message;case"APIMessage":return error.text}}(nonJSXError);return(0,emotion_react_jsx_runtime_browser_esm.Y)(ListItem,{children:errorText},"".concat(nonJSXError.code))}return(0,emotion_react_jsx_runtime_browser_esm.Y)(ListItem,{children:error},"JSX-".concat(error))}(error)}))};return(0,emotion_react_jsx_runtime_browser_esm.Y)(react.Fragment,{children:isPreview?(0,emotion_react_jsx_runtime_browser_esm.Y)(ErrorPreviewList,{children:(errorList=[],errors.length<3?errorList=renderErrors():(errorList.push(renderErrors()[0]),errorList.push((0,emotion_react_jsx_runtime_browser_esm.Y)("li",{children:t("orders:table:errors:plusMore",{count:errors.length-1})},"plus-1"))),errorList)}):(0,emotion_react_jsx_runtime_browser_esm.Y)(ErrorsCellErrorList_ErrorList,{children:renderErrors()})})}));var ErrorsCellErrorList_templateObject_1,ErrorsCellErrorList_templateObject_2,ErrorsCellErrorList_templateObject_3,ErrorsCell_ServiceIconContainer=(0,emotion_styled_browser_esm.A)("div")(ErrorsCell_templateObject_1||(ErrorsCell_templateObject_1=(0,tslib_es6.ue)(["\n  display: flex;\n  align-items: center;\n"],["\n  display: flex;\n  align-items: center;\n"]))),ErrorsCell_RateTitle=(0,emotion_styled_browser_esm.A)("div")(ErrorsCell_templateObject_2||(ErrorsCell_templateObject_2=(0,tslib_es6.ue)(["\n  color: ",";\n  font-weight: ",";\n  font-size: 0.875rem;\n  line-height: 1.5rem;\n"],["\n  color: ",";\n  font-weight: ",";\n  font-size: 0.875rem;\n  line-height: 1.5rem;\n"])),styles_constants.Tj.gray1000,styles_constants.Wy.medium),ErrorsCell_IconContainer=(0,emotion_styled_browser_esm.A)("img")(ErrorsCell_templateObject_3||(ErrorsCell_templateObject_3=(0,tslib_es6.ue)(["\n  width: 1.5rem;\n  height: 1rem;\n"],["\n  width: 1.5rem;\n  height: 1rem;\n"]))),ErrorsCell_ErrorTitle=(0,emotion_styled_browser_esm.A)("div")(ErrorsCell_templateObject_4||(ErrorsCell_templateObject_4=(0,tslib_es6.ue)(["\n  font-weight: ",";\n"],["\n  font-weight: ",";\n"])),styles_constants.Wy.medium),ErrorContainer=(0,emotion_styled_browser_esm.A)("div")(ErrorsCell_templateObject_5||(ErrorsCell_templateObject_5=(0,tslib_es6.ue)(["\n  padding: 0 0.5rem;\n"],["\n  padding: 0 0.5rem;\n"]))),RateContentContainer=(0,emotion_styled_browser_esm.A)("div")(ErrorsCell_templateObject_6||(ErrorsCell_templateObject_6=(0,tslib_es6.ue)([""],[""]))),RateContent=(0,emotion_styled_browser_esm.A)("div")(ErrorsCell_templateObject_7||(ErrorsCell_templateObject_7=(0,tslib_es6.ue)(["\n  display: flex;\n"],["\n  display: flex;\n"]))),ErrorsCell_ProviderIcon=(0,emotion_styled_browser_esm.A)("img")(ErrorsCell_templateObject_8||(ErrorsCell_templateObject_8=(0,tslib_es6.ue)(["\n  height: 1.25rem;\n  width: 1.25rem;\n"],["\n  height: 1.25rem;\n  width: 1.25rem;\n"]))),WarningMessageContainer=(0,emotion_styled_browser_esm.A)("div")(ErrorsCell_templateObject_9||(ErrorsCell_templateObject_9=(0,tslib_es6.ue)(["\n  display: grid;\n  grid-template-columns: 30px 1fr;\n  align-items: center;\n"],["\n  display: grid;\n  grid-template-columns: 30px 1fr;\n  align-items: center;\n"])));const ErrorsCell_ErrorsCell=(0,redux.Zz)((0,es.Ng)(null,(function(dispatch){return{fetchOrders:function(page,filters,fetchCount,showOnlyHidden,orderStatus,sort,sortBy,orderBy){return dispatch((0,orders_actions.Gb)("order_table",page,filters,fetchCount,showOnlyHidden,orderStatus,sort,sortBy,orderBy))}}})),(0,utils_translate.Tl)("orders"),react_router.y)((function(props){var _a,t=props.t,errors=props.errors,title=props.title,children=props.children,batchEntry=props.batchEntry,order=props.order,history=props.history,defaultCarrierHashMap=props.defaultCarrierHashMap,_b=(0,Address.eu)(order,batchEntry||void 0),addressFrom=_b.addressFrom,addressTo=_b.addressTo,_c=(0,tslib_es6.zs)(react.useState(!1),2),isRateSelectOpen=_c[0],setIsRateSelectOpen=_c[1],_d=(0,tslib_es6.zs)(react.useState(!1),2),editParcelOverlayIsOpen=_d[0],setEditParcelOverlayIsOpen=_d[1],mappedServiceLevelsByToken=(0,es.d4)(providers_selectors.cW),userDefaultServiceLevel=(0,es.d4)(user_selectors.Fh),onClosePopover=function(){setIsRateSelectOpen(!1)},openOrderScreen=function(){var url="/orders/".concat(order.objectId);batchEntry&&(url="".concat(url,"/shipments/").concat(batchEntry.id)),history.push("".concat(url).concat(history.location.search))},serviceLevelAccount=function(){if(0!==Object.keys(mappedServiceLevelsByToken).length){if(null==batchEntry?void 0:batchEntry.preferredServiceLevelToken)return function(dataSet){if(null==dataSet?void 0:dataSet.provider_name){var hashMap=carriers.Ps[(0,Carrier.Z)(null==dataSet?void 0:dataSet.provider_name)];return(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},hashMap),{title:null==dataSet?void 0:dataSet.name})}}((0,types_ServiceLevel.Zd)({mappedServiceLevels:mappedServiceLevelsByToken,accountId:null==batchEntry?void 0:batchEntry.preferredAccountObjectID,token:null==batchEntry?void 0:batchEntry.preferredServiceLevelToken}));if(defaultCarrierHashMap&&userDefaultServiceLevel){var defaultServiceLevelAccount=(0,types_ServiceLevel.Zd)({mappedServiceLevels:mappedServiceLevelsByToken,accountId:null==userDefaultServiceLevel?void 0:userDefaultServiceLevel.accountId,token:null==userDefaultServiceLevel?void 0:userDefaultServiceLevel.token});return(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},defaultCarrierHashMap),{title:defaultServiceLevelAccount?null==defaultServiceLevelAccount?void 0:defaultServiceLevelAccount.name:""})}}}(),buttonBackgroundReset=isRateSelectOpen?"":"bg-transparent";return(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Popup.A,(0,tslib_es6.Cl)({trigger:(0,emotion_react_jsx_runtime_browser_esm.Y)(SelectedRateButton,(0,tslib_es6.Cl)({className:"h-full w-full border-none cursor-pointer rounded-none p-2 ".concat(buttonBackgroundReset),onClick:function(){setIsRateSelectOpen(!isRateSelectOpen)},isOpen:isRateSelectOpen},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(RatesCell_ButtonContent,(0,tslib_es6.Cl)({className:"h-full w-full grid items-center text-left"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(ErrorsCell_ServiceIconContainer,{children:serviceLevelAccount?(0,emotion_react_jsx_runtime_browser_esm.Y)(ErrorsCell_ProviderIcon,{src:null==serviceLevelAccount?void 0:serviceLevelAccount.icon,alt:null==serviceLevelAccount?void 0:serviceLevelAccount.name}):(0,emotion_react_jsx_runtime_browser_esm.Y)(ErrorsCell_IconContainer,{src:question_circle_gray,alt:"error"})}),(0,emotion_react_jsx_runtime_browser_esm.FD)(RateContentContainer,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(ErrorsCell_RateTitle,{children:(null==serviceLevelAccount?void 0:serviceLevelAccount.title)||title}),(0,emotion_react_jsx_runtime_browser_esm.FD)(RateContent,{children:[!serviceLevelAccount||(0,emotion_react_jsx_runtime_browser_esm.Y)(ErrorsCell_IconContainer,{src:question_circle_gray,alt:"error"}),(0,emotion_react_jsx_runtime_browser_esm.Y)(ErrorsCell_ErrorsCellErrorList,{errors,isPreview:!0,order,batchEntry,setEditParcelOverlayIsOpen,addressFrom,addressTo})]}),children,(0,emotion_react_jsx_runtime_browser_esm.Y)(CustomerShippingMethod.q,{shippingCost:order.shippingCost,shippingCostCurrency:order.shippingCostCurrency,shippingMethod:order.shippingMethod})]}),(0,emotion_react_jsx_runtime_browser_esm.Y)(RatesCell_CaretIcon,{src:icons.jH,isOpen:isRateSelectOpen})]}))})),open:isRateSelectOpen||editParcelOverlayIsOpen,on:"click",position:"bottom center",onOpen:function(){setIsRateSelectOpen(!0)},wrapperClassName:"w-full h-full",onClose:onClosePopover},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(CardContainer,{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(FlexContainer.Ay,(0,tslib_es6.Cl)({horizontalAlign:FlexContainer.wq.SpaceBetween,flexDirection:FlexContainer.bo.Row},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(ErrorsCell_ErrorTitle,{children:t("orders:calculateRates:rates:chooseService")}),(0,emotion_react_jsx_runtime_browser_esm.Y)(Addons_RefreshRatesButton,{orderSelection:(_a={},_a[order.objectId]=batchEntry?[batchEntry.id]:[],_a),isLoading:!1,dataAnalytics:"".concat("orders_table","-refresh-rates-popup")})]})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Message._j,{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(WarningMessageContainer,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(ErrorsCell_IconContainer,{src:question_circle_yellow,alt:"error"}),(0,emotion_react_jsx_runtime_browser_esm.FD)(ErrorContainer,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(ErrorsCell_ErrorTitle,{children:t("orders:table:errors:ratesUnavailableBecause")}),(0,emotion_react_jsx_runtime_browser_esm.Y)(ErrorsCell_ErrorsCellErrorList,{errors,isPreview:!1,order,batchEntry,editParcelOverlayIsOpen,setEditParcelOverlayIsOpen,addressFrom,addressTo})]})]})}),(0,emotion_react_jsx_runtime_browser_esm.Y)(ServiceLevel_ServiceLevelNoRate,{closePopover:onClosePopover,order,batchEntry}),(0,emotion_react_jsx_runtime_browser_esm.Y)(Tabs_OrderDetails,{orderId:order.objectId}),!serviceLevelAccount&&(0,emotion_react_jsx_runtime_browser_esm.Y)(FlexContainer.Ay,(0,tslib_es6.Cl)({flexDirection:FlexContainer.bo.Row,horizontalAlign:FlexContainer.wq.FlexEnd},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Button.jn,(0,tslib_es6.Cl)({onClick:function(evt){evt.stopPropagation(),openOrderScreen()},dataPendo:"package-save"},{children:t("orders:actions:single:viewOrder")}))}))]})}))}));var ErrorsCell_templateObject_1,ErrorsCell_templateObject_2,ErrorsCell_templateObject_3,ErrorsCell_templateObject_4,ErrorsCell_templateObject_5,ErrorsCell_templateObject_6,ErrorsCell_templateObject_7,ErrorsCell_templateObject_8,ErrorsCell_templateObject_9;const BatchEntryCell_ErrorsCell=ErrorsCell_ErrorsCell,BatchEntryCell_RatesCell=RatesCell_RatesCell;var TrackingInfo=(0,emotion_styled_browser_esm.A)("div")(TrackingCell_templateObject_1||(TrackingCell_templateObject_1=(0,tslib_es6.ue)(["\n  line-height: 1.1875rem;\n  color: ",";\n  font-size: 0.875rem;\n  font-weight: ",";\n"],["\n  line-height: 1.1875rem;\n  color: ",";\n  font-size: 0.875rem;\n  font-weight: ",";\n"])),styles_constants.Tj.gray700,styles_constants.Wy.normal),TrackingCell_ProviderIcon=(0,emotion_styled_browser_esm.A)("img")(TrackingCell_templateObject_2||(TrackingCell_templateObject_2=(0,tslib_es6.ue)(["\n  width: 1.25rem;\n  height: 1.25rem;\n  margin-right: 0.75rem;\n"],["\n  width: 1.25rem;\n  height: 1.25rem;\n  margin-right: 0.75rem;\n"]))),CopyIcon=(0,emotion_styled_browser_esm.A)("img")(TrackingCell_templateObject_3||(TrackingCell_templateObject_3=(0,tslib_es6.ue)(["\n  width: 1rem;\n  height: 1rem;\n  margin-left: 0.5rem;\n  cursor: pointer;\n"],["\n  width: 1rem;\n  height: 1rem;\n  margin-left: 0.5rem;\n  cursor: pointer;\n"]))),TrackingNumber=(0,emotion_styled_browser_esm.A)("div")(TrackingCell_templateObject_4||(TrackingCell_templateObject_4=(0,tslib_es6.ue)(["\n  margin-top: 0.25rem;\n  word-break: break-word;\n"],["\n  margin-top: 0.25rem;\n  word-break: break-word;\n"]))),TrackingCell=function(_super){function TrackingCell(props){var _this=_super.call(this,props)||this;return _this.handleCopy=function(){var _a,_b,_c,trackingNumber=_this.trackingNumberRef.current;trackingNumber.contentEditable="true",trackingNumber.focus(),document.execCommand("selectAll"),document.execCommand("copy"),trackingNumber.contentEditable="false",null===(_a=getSelection())||void 0===_a||_a.empty(),_this.setState({showCopySuccess:!0}),setTimeout((function(){_this.setState({showCopySuccess:!1})}),3e3),(0,segment.u4)(segment.sV.tracking_status_viewed,{carrier:null===(_b=_this.props.rate)||void 0===_b?void 0:_b.provider,shipment_id:null===(_c=_this.props.rate)||void 0===_c?void 0:_c.shipment})},_this.trackingNumberRef=react.createRef(),_this.state={showCopySuccess:!1},_this}return(0,tslib_es6.C6)(TrackingCell,_super),TrackingCell.prototype.render=function(){var _a,_b=this.props,rate=_b.rate,trackingNumber=_b.trackingNumber,t=_b.t,showCopySuccess=this.state.showCopySuccess,icon=(null==rate?void 0:rate.provider)&&(null===(_a=carriers.Ay.find((function(x){return x.name===rate.provider})))||void 0===_a?void 0:_a.icon);return(0,emotion_react_jsx_runtime_browser_esm.Y)("button",(0,tslib_es6.Cl)({className:"flex items-center h-full cursor-pointer bg-transparent border-none text-left m-0 p-0",onClick:this.handleCopy},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(components_Popup.A,(0,tslib_es6.Cl)({open:showCopySuccess,inverted:!0,size:"mini",position:"top center",trigger:(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"flex flex-row items-center mx-0.5 p-2"},{children:[rate&&rate.providerImage200&&(0,emotion_react_jsx_runtime_browser_esm.Y)(TrackingCell_ProviderIcon,{className:"self-center",src:icon||rate.providerImage200}),(0,emotion_react_jsx_runtime_browser_esm.FD)(TrackingInfo,(0,tslib_es6.Cl)({className:"flex flex-col"},{children:[rate&&(0,emotion_react_jsx_runtime_browser_esm.FD)("div",{children:[rate.provider," Tracking"]}),(0,emotion_react_jsx_runtime_browser_esm.Y)(TrackingNumber,(0,tslib_es6.Cl)({ref:this.trackingNumberRef},{children:trackingNumber}))]})),(0,emotion_react_jsx_runtime_browser_esm.Y)(CopyIcon,{className:"self-center",src:icons.nJ,alt:"Click to copy tracking number to your clipboard"})]}))},{children:t("table.clipboard")}))}))},TrackingCell}(react.PureComponent);var TrackingCell_templateObject_1,TrackingCell_templateObject_2,TrackingCell_templateObject_3,TrackingCell_templateObject_4;const BatchEntryCell_TrackingCell=(0,utils_translate.Tl)("orders")(TrackingCell);var BatchEntryCell_IconContainer=(0,emotion_styled_browser_esm.A)("div")(BatchEntryCell_templateObject_1||(BatchEntryCell_templateObject_1=(0,tslib_es6.ue)(["\n  height: 1.25rem;\n  width: 1.25rem;\n  background-color: ",";\n  box-shadow: 0 2px 4px 0 ",";\n\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  border-radius: 50%;\n  margin-right: 0.75rem;\n"],["\n  height: 1.25rem;\n  width: 1.25rem;\n  background-color: ",";\n  box-shadow: 0 2px 4px 0 ",";\n\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  border-radius: 50%;\n  margin-right: 0.75rem;\n"])),styles_constants.Tj.white,styles_constants.Tj.gray50),FulfilledText=(0,emotion_styled_browser_esm.A)("div")(BatchEntryCell_templateObject_2||(BatchEntryCell_templateObject_2=(0,tslib_es6.ue)(["\n  font-size: 0.875rem;\n  line-height: 1.5rem;\n"],["\n  font-size: 0.875rem;\n  line-height: 1.5rem;\n"]))),BatchEntryCellComponent=function(_super){function BatchEntryCellComponent(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.renderFulfilledExternally=function(){var t=_this.props.t;return(0,emotion_react_jsx_runtime_browser_esm.FD)("div",(0,tslib_es6.Cl)({className:"h-full w-full flex justify-start items-center cursor-pointer p-2"},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(ImageContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(BatchEntryCell_IconContainer,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)("img",{src:icon_check_gray,alt:""})})}),(0,emotion_react_jsx_runtime_browser_esm.Y)(FulfilledText,{children:t("orders:table:fulfilledOutside")})]}))},_this.getErrors=function(transaction){var t=_this.props.t;return transaction.messages.length>0?transaction.messages:[t("orders:table:errors:transactionFailedMessage")]},_this.getDefaultServiceLevel=function(){var _a=_this.props,userDefaultServiceLevel=_a.userDefaultServiceLevel,mappedServiceLevelsByToken=_a.mappedServiceLevelsByToken;if(null==userDefaultServiceLevel?void 0:userDefaultServiceLevel.token){var serviceLevelAccount=(0,types_ServiceLevel.Zd)({mappedServiceLevels:mappedServiceLevelsByToken,accountId:null==userDefaultServiceLevel?void 0:userDefaultServiceLevel.accountId,token:null==userDefaultServiceLevel?void 0:userDefaultServiceLevel.token});return null==serviceLevelAccount?void 0:serviceLevelAccount.name}},_this.getPreferredServiceLevel=function(){var _a=_this.props,batchEntry=_a.batchEntry,mappedServiceLevelsByToken=_a.mappedServiceLevelsByToken;if(null==batchEntry?void 0:batchEntry.preferredServiceLevelToken){var serviceLevel=(0,types_ServiceLevel.Zd)({mappedServiceLevels:mappedServiceLevelsByToken,accountId:null==batchEntry?void 0:batchEntry.preferredAccountObjectID,token:null==batchEntry?void 0:batchEntry.preferredServiceLevelToken});return null==serviceLevel?void 0:serviceLevel.name}},_this}return(0,tslib_es6.C6)(BatchEntryCellComponent,_super),BatchEntryCellComponent.prototype.render=function(){var _a,_b=this.props,batchEntry=_b.batchEntry,shipment=_b.shipment,order=_b.order,userDefaultServiceLevel=_b.userDefaultServiceLevel,hasValidSenderAddress=_b.hasValidSenderAddress,isLoading=_b.isLoading,needNewRates=_b.needNewRates,transaction=_b.transaction,t=_b.t,rates=order.rates,errors=(0,orderValidation.u)(order,batchEntry||void 0),_c=(0,Address.tS)(order,batchEntry),addressFrom=_c.addressFrom,addressTo=_c.addressTo,hasPhoneNumberRequiredError=(0,CustomsDeclaration.e8)({addressFrom,addressTo}).hasPhoneNumberRequiredError,defaultServiceTitle=this.getDefaultServiceLevel(),preferredServiceTitle=this.getPreferredServiceLevel(),defaultCarrierHashMap=userDefaultServiceLevel?carriers.Ps[(0,Carrier.Z)(userDefaultServiceLevel.provider)]:void 0;if((0,Order.Gy)(order))return this.renderFulfilledExternally();if((0,batchEntryRendering.lo)(order,batchEntry||void 0)){var transactions=order.transactions;if(!transactions)return null;var oldExperienceTransaction_1=(0,batchEntryRendering.GE)(transactions,batchEntry||void 0);if(!oldExperienceTransaction_1)return null;if(oldExperienceTransaction_1.status===Transaction.x8.ERROR)return(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"h-full w-full flex justify-start items-center p-2"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(BatchEntryCell_ErrorsCell,{title:t("orders:table:errors:transactionFailedTitle"),errors:this.getErrors(oldExperienceTransaction_1),batchEntry,order,isLoading})}));var rate=rates.find((function(x){return x.objectId===oldExperienceTransaction_1.rate}));return(0,emotion_react_jsx_runtime_browser_esm.Y)(BatchEntryCell_TrackingCell,{trackingNumber:oldExperienceTransaction_1.trackingNumber,rate})}var packageErrors=(0,orderValidation.c)(t,hasValidSenderAddress,hasPhoneNumberRequiredError,order,batchEntry||void 0,addressFrom);if(errors.push.apply(errors,(0,tslib_es6.fX)([],(0,tslib_es6.zs)(packageErrors),!1)),errors.length>0)return(0,emotion_react_jsx_runtime_browser_esm.Y)(BatchEntryCell_ErrorsCell,{title:t("orders:table:errors:noRates"),defaultCarrierHashMap,errors,orderObjectId:order.objectId,batchEntry,order,isLoading});if(!batchEntry&&!isLoading)return null;if(needNewRates)return(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"h-full w-full flex justify-start items-center p-2",role:"button"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Addons_RefreshRatesButton,(0,tslib_es6.Cl)({orderSelection:(_a={},_a[order.objectId]=batchEntry?[batchEntry.id]:[],_a),isLoading,dataAnalytics:"".concat("orders_table","-refresh-rates-stale")},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(CustomerShippingMethod.q,{shippingCost:order.shippingCost,shippingCostCurrency:order.shippingCostCurrency,shippingMethod:order.shippingMethod})}))}));if(batchEntry&&transaction){if(transaction.status===Transaction.x8.ERROR)return(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"h-full w-full flex justify-start items-center p-2"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(BatchEntryCell_ErrorsCell,{title:t("orders:table:errors:transactionFailedTitle"),errors:this.getErrors(transaction),batchEntry,order,isLoading})}));rate=rates.find((function(x){return x.objectId===transaction.rate}));if(transaction.trackingNumber)return(0,emotion_react_jsx_runtime_browser_esm.Y)(BatchEntryCell_TrackingCell,{trackingNumber:transaction.trackingNumber,rate})}return(0,batchEntryRendering.MY)(batchEntry,shipment)?(0,emotion_react_jsx_runtime_browser_esm.Y)(BatchEntryCell_ErrorsCell,{title:t("orders:table:errors:noRates"),errors:shipment.messages,batchEntry,order,isLoading}):(0,emotion_react_jsx_runtime_browser_esm.Y)(BatchEntryCell_RatesCell,{defaultServiceTitle,preferredServiceTitle,defaultServiceProvider:null==userDefaultServiceLevel?void 0:userDefaultServiceLevel.provider,batchEntry,order,isLoading})},BatchEntryCellComponent}(react.PureComponent);var BatchEntryCell_templateObject_1,BatchEntryCell_templateObject_2;const OrdersTable_BatchEntryCell=(0,redux.Zz)((0,es.Ng)((function(){var getDoesBatchEntryNeedNewRates=(0,batch_entry_selectors.Vw)(),getBatchEntryTransactionFromOrder=(0,batch_entry_composite_selectors.B6)();return function(state,ownProps){var batchEntry=ownProps.batchEntry,shippingLoadingStates=(0,shipments_selectors.Rm)(state);return{batchEntry,mappedServiceLevelsByToken:(0,providers_selectors.cW)(state),userDefaultServiceLevel:(0,user_selectors.Fh)(state),shipment:(null==batchEntry?void 0:batchEntry.shipmentObjectId)?(0,shipments_selectors.Zb)(state,{shipmentId:batchEntry.shipmentObjectId}):null,transaction:batchEntry?getBatchEntryTransactionFromOrder(state,{batchEntryId:batchEntry.id}):null,isLoading:!batchEntry||!(0,batch_entry_selectors.GX)(batchEntry||void 0)&&((0,batch_entry_selectors.Kk)(batchEntry||void 0)||(0,batch_entry_composite_selectors.D9)(shippingLoadingStates,batchEntry)),hasValidSenderAddress:(0,user_selectors.Oz)(state),defaultSenderAddress:(0,user_selectors.GA)(state),rates:(null==batchEntry?void 0:batchEntry.id)?(0,batch_entry_composite_selectors.jl)(state,{batchEntryId:batchEntry.id}):[],needNewRates:batchEntry&&getDoesBatchEntryNeedNewRates(state,{batchEntryId:batchEntry.id})}}}),(function(dispatch){return{retryShipment:function(orderSelection){return dispatch((0,orders_actions.lN)(orderSelection))}}})),(0,utils_translate.Tl)("orders"),react_router.y)(BatchEntryCellComponent);var ORDERS_TABLE_ADDRESS_BOOK_NAME="orders-table",baseRowStyle=(0,emotion_react_browser_esm.AH)(OrdersTable_templateObject_1||(OrdersTable_templateObject_1=(0,tslib_es6.ue)(["\n  height: 100%;\n  min-height: ",";\n  max-height: 5.5rem;\n"],["\n  height: 100%;\n  min-height: ",";\n  max-height: 5.5rem;\n"])),styles_constants.df),CellContent=(0,emotion_styled_browser_esm.A)("div")(OrdersTable_templateObject_2||(OrdersTable_templateObject_2=(0,tslib_es6.ue)(["\n  min-height: ",";\n"],["\n  min-height: ",";\n"])),styles_constants.df),HeaderCheckboxLabel=(0,emotion_styled_browser_esm.A)("label")(OrdersTable_templateObject_3||(OrdersTable_templateObject_3=(0,tslib_es6.ue)(["\n  min-height: 3rem;\n"],["\n  min-height: 3rem;\n"]))),CellCheckboxLabel=(0,emotion_styled_browser_esm.A)("label")(OrdersTable_templateObject_4||(OrdersTable_templateObject_4=(0,tslib_es6.ue)(["\n  min-height: ",";\n"],["\n  min-height: ",";\n"])),styles_constants.df),rowBorder=(0,emotion_react_browser_esm.AH)(OrdersTable_templateObject_5||(OrdersTable_templateObject_5=(0,tslib_es6.ue)(["\n  border-bottom: 1px solid ",";\n"],["\n  border-bottom: 1px solid ",";\n"])),styles_constants.Tj.gray400),borderTop=(0,emotion_react_browser_esm.AH)(OrdersTable_templateObject_6||(OrdersTable_templateObject_6=(0,tslib_es6.ue)(["\n  border-top: 1px solid ",";\n"],["\n  border-top: 1px solid ",";\n"])),styles_constants.Tj.gray400),rowNoBorder=(0,emotion_react_browser_esm.AH)(OrdersTable_templateObject_7||(OrdersTable_templateObject_7=(0,tslib_es6.ue)(["\n  border-bottom: 0;\n"],["\n  border-bottom: 0;\n"]))),fulfilledOrderRow=(0,emotion_react_browser_esm.AH)(OrdersTable_templateObject_8||(OrdersTable_templateObject_8=(0,tslib_es6.ue)(["\n  background-color: ",";\n  /* overrides specific to make all text gray and lighter */\n  ."," {\n    font-size: 0.875rem;\n    font-weight: ",";\n    color: ",";\n  }\n"],["\n  background-color: ",";\n  /* overrides specific to make all text gray and lighter */\n  ."," {\n    font-size: 0.875rem;\n    font-weight: ",";\n    color: ",";\n  }\n"])),styles_colors.T.backgroundDeemphasized,styles_constants.xW.fulfilledOrderText,styles_constants.Wy.normal,styles_constants.Tj.gray700),orderCheckboxBaseCellCss=(0,emotion_react_browser_esm.AH)(OrdersTable_templateObject_9||(OrdersTable_templateObject_9=(0,tslib_es6.ue)(["\n  /* we can remove this !important when the table cell's :first-of-type is removed */\n  padding-left: 0 !important;\n  width: 1.5rem;\n"],["\n  /* we can remove this !important when the table cell's :first-of-type is removed */\n  padding-left: 0 !important;\n  width: 1.5rem;\n"]))),orderCheckboxHeaderCss=(0,emotion_react_browser_esm.AH)(OrdersTable_templateObject_10||(OrdersTable_templateObject_10=(0,tslib_es6.ue)(["\n  ",";\n  padding: 0;\n"],["\n  ",";\n  padding: 0;\n"])),orderCheckboxBaseCellCss),orderCheckboxCellCss=(0,emotion_react_browser_esm.AH)(OrdersTable_templateObject_11||(OrdersTable_templateObject_11=(0,tslib_es6.ue)(["\n  ",";\n"],["\n  ",";\n"])),orderCheckboxBaseCellCss),splitChildCheckbox=(0,emotion_react_browser_esm.AH)(OrdersTable_templateObject_12||(OrdersTable_templateObject_12=(0,tslib_es6.ue)(["\n  ",";\n  background: "," !important;\n"],["\n  ",";\n  background: "," !important;\n"])),orderCheckboxBaseCellCss,styles_constants.Tj.gray100),invalidRowCss=(0,emotion_react_browser_esm.AH)(OrdersTable_templateObject_13||(OrdersTable_templateObject_13=(0,tslib_es6.ue)(["\n  /* we can remove these !important declarations when the table row's styling isn't embedded in the table row element */\n  background-color: "," !important;\n"],["\n  /* we can remove these !important declarations when the table row's styling isn't embedded in the table row element */\n  background-color: "," !important;\n"])),styles_constants.Tj.form.warningBackground),splitParentCheckbox=(0,emotion_react_browser_esm.AH)(OrdersTable_templateObject_14||(OrdersTable_templateObject_14=(0,tslib_es6.ue)(["\n  ",";\n"],["\n  ",";\n"])),splitChildCheckbox),OrdersTable=function(_super){function OrdersTable(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.getParentOrderObjectIndexFromRowIndex=function(index){var data=_this.props.tableData[index];switch(data.kind){case"single":case"partial-parent":return index;case"partial-child":return index-data.batchEntry.partialFulfillmentRank}},_this.handleRowClick=function(rowIndex){return _this.props.isOldExpChosen?_this.handleSelectOrder(rowIndex):_this.openOrderScreen(rowIndex)},_this.openOrderScreen=function(index){var _a=_this.props,history=_a.history,tableData=_a.tableData,orderIdToBatchEntryIdMap=_a.orderIdToBatchEntryIdMap,data=tableData[index],orderId=data.order.objectId,orderDetailScreenPath="/orders/".concat(orderId);switch(data.kind){case"single":(batchEntryId=orderIdToBatchEntryIdMap[orderId][0])&&(orderDetailScreenPath+="/shipments/".concat(batchEntryId));break;case"partial-parent":var batchEntryId=orderIdToBatchEntryIdMap[orderId][0];orderDetailScreenPath+="/shipments/".concat(batchEntryId);break;case"partial-child":orderDetailScreenPath+="/shipments/".concat(data.batchEntry.id)}history.push(orderDetailScreenPath)},_this.handleSelectOrder=function(index){var _a,_b,_c,_d,_e=_this.props,isOldExpChosen=_e.isOldExpChosen,tableData=_e.tableData,orderIdToBatchEntryIdMap=_e.orderIdToBatchEntryIdMap,data=tableData[index];if(isOldExpChosen)return _this.props.selectOrder(((_a={})[data.order.objectId]=[],_a));switch(data.kind){case"single":return _this.props.selectOrder(((_b={})[data.order.objectId]=orderIdToBatchEntryIdMap[data.order.objectId]||[],_b));case"partial-parent":return _this.props.selectOrder(((_c={})[data.order.objectId]=orderIdToBatchEntryIdMap[data.order.objectId]||[],_c));case"partial-child":return _this.props.selectOrder(((_d={})[data.order.objectId]=[data.batchEntry.id],_d))}},_this.handleCheckboxSelect=function(index){return function(){_this.handleSelectOrder(index)}},_this.handleSplitOrderCheckboxClick=function(event){event.stopPropagation()},_this.ordersTableColumns=[{header:function(){return(0,emotion_react_jsx_runtime_browser_esm.Y)(SelectAllOrders_container,{dataPendo:"orders-select-all"})},width:"20px",cell:function(_a){var rowIndex=_a.rowIndex,order=_a.data.order;return(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderCheckbox_container,{orderObjectId:order.objectId,dataPendo:"orders-select-row",onChange:_this.handleCheckboxSelect(rowIndex)})},onCellClick:_this.handleSelectOrder},{header:_this.props.t("orders:table:headers:number"),width:"50px",noRightPadding:!0,cell:function(_a){var order=_a.data.order;return(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderNumberWithImage,{order})}},{header:function(){return(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{children:_this.props.t("orders:table:headers:date")})},width:"70px",cell:function(_a){var order=_a.data.order;return(0,emotion_react_jsx_runtime_browser_esm.Y)(react.Fragment,{children:order.placedAt.format("L")})}},{header:"",cell:function(_a){var order=_a.data.order;return order.toAddress&&order.toAddress.country?(0,emotion_react_jsx_runtime_browser_esm.Y)(CountryFlag.A,{country:order.toAddress.country.iso2}):null},width:"10px",noRightPadding:!0},{header:_this.props.t("orders:table:headers:customer"),width:"115px",cell:function(_a){var order=_a.data.order;return(0,emotion_react_jsx_runtime_browser_esm.Y)(CustomerInfo,{address:order.toAddress,shortenedAddress:!_this.props.isOldExpChosen})}},{header:_this.props.t("orders:table:headers:items"),width:"20%",cell:function(_a){var order=_a.data.order;return(0,emotion_react_jsx_runtime_browser_esm.Y)(LineItems,{data:order.lineItems,total:(0,Order.Mp)(order)?parseFloat(order.totalPrice):void 0,currency:order.currency||"USD"})}},{header:_this.props.t("orders:table:headers:shipping"),width:"20%",cell:function(_a){var order=_a.data.order;return(0,emotion_react_jsx_runtime_browser_esm.Y)(cells_ShippingMethod,{data:order})}},{header:"",width:"25px",cell:function(_a){var order=_a.data.order;return(0,emotion_react_jsx_runtime_browser_esm.Y)(cells_OrderNotes,{notes:order.notes})},noRightPadding:!0},{header:"",width:"25px",cell:function(_a){var order=_a.data.order;return(0,emotion_react_jsx_runtime_browser_esm.Y)(cells_OrderPaymentStatus,{order})},noLeftPadding:!0,noRightPadding:!0},{header:"",width:"25px",cell:function(_a){var order=_a.data.order;return(0,emotion_react_jsx_runtime_browser_esm.Y)(cells_OrderFulfillmentStatus,{order})},noLeftPadding:!0,noRightPadding:!0},{header:"",width:"27px",cell:function(_a){var order=_a.data.order;return(0,emotion_react_jsx_runtime_browser_esm.Y)(cells_OrderError,{onErrorClick:_this.props.onOrderErrorClick,order})},noLeftPadding:!0},{header:function(){return(0,emotion_react_jsx_runtime_browser_esm.Y)(All_LabelHeader,{label:_this.props.t("orders:table:headers:label")})},width:"150px",cell:function(_a){var order=_a.data.order;return(0,emotion_react_jsx_runtime_browser_esm.Y)(All_SingleOrderActions,{order,openTransactionModal:_this.props.openTransactionModal,hideOrder:_this.props.hideOrder,toggleInvalidAddressModal:_this.props.toggleInvalidAddressModal})}}],_this.newExperienceColumns=[{header:function(){var checkboxID="orders-table-select-all-checkbox";return(0,emotion_react_jsx_runtime_browser_esm.Y)(HeaderCheckboxLabel,(0,tslib_es6.Cl)({className:"flex items-center justify-center cursor-pointer pl-1 pr-1",htmlFor:checkboxID},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(SelectAllOrders_container,{dataPendo:"orders-select-all",id:checkboxID})}))},noPadding:!0,cell:function(_a){var rowIndex=_a.rowIndex,_b=_a.data,kind=_b.kind,objectId=_b.order.objectId,checkboxID="orders-table-row-checkbox-".concat(rowIndex);return"partial-child"===kind?(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"h-full flex items-center justify-center cursor-pointer"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)("img",{src:icon_splitment_arrow,alt:""})})):(0,emotion_react_jsx_runtime_browser_esm.Y)(CellCheckboxLabel,(0,tslib_es6.Cl)({htmlFor:checkboxID,className:"flex items-center justify-center cursor-pointer"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(OrderCheckbox_container,{id:checkboxID,orderObjectId:objectId,dataPendo:"orders-select-row",onChange:_this.handleCheckboxSelect(rowIndex)})}))},onCellClick:noop.A,customCellStyles:function(_a){switch(_a.data.kind){case"partial-parent":return splitParentCheckbox;case"partial-child":return splitChildCheckbox;default:return orderCheckboxCellCss}},customHeaderStyles:orderCheckboxHeaderCss},{header:function(){return(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{children:_this.props.t("orders:table:headers:order")})},cell:function(_a){var data=_a.data,rowIndex=_a.rowIndex;return(0,emotion_react_jsx_runtime_browser_esm.Y)(cells_OrderInfoCell,{data,rowIndex,onSplitOrderCheckboxClick:_this.handleSplitOrderCheckboxClick,onSplitOrderCheckboxChange:_this.handleCheckboxSelect})},minWidth:"9rem",noPadding:!0},{header:_this.props.t("orders:table:headers:customer"),noPadding:!0,cell:function(_a){var _b,_c=_a.data,kind=_c.kind,order=_c.order,batchEntry=_c.batchEntry;switch(kind){case"single":case"partial-child":var addressTo=(0,Address.tS)(order,batchEntry).addressTo;return!(0,Order.Gy)(order)||batchEntry||addressTo?(0,emotion_react_jsx_runtime_browser_esm.Y)(CustomerInfo,{address:addressTo,shortenedAddress:!_this.props.isOldExpChosen,orderSelection:(_b={},_b[order.objectId]=batchEntry?[batchEntry.id]:[],_b)}):null;case"partial-parent":return null}},customCellStyles:(0,emotion_react_browser_esm.AH)(OrdersTable_templateObject_15||(OrdersTable_templateObject_15=(0,tslib_es6.ue)(["\n        &:hover {\n          a:first-of-type {\n            text-decoration: underline;\n          }\n        }\n      "],["\n        &:hover {\n          a:first-of-type {\n            text-decoration: underline;\n          }\n        }\n      "]))),minWidth:"10.5rem"},{header:_this.props.t("orders:table:headers:items"),noPadding:!0,cell:function(_a){var data=_a.data;return"partial-parent"===data.kind?null:(0,emotion_react_jsx_runtime_browser_esm.Y)(LineItemsNew,{order:data.order,batchEntry:data.batchEntry})},minWidth:"8.5rem"},{header:_this.props.t("orders:table:headers:parcelInfo"),noPadding:!0,cell:function(_a){var data=_a.data;return"partial-parent"===data.kind||(0,Order.Gy)(data.order)&&!data.batchEntry?null:(0,Order.Pt)(data.order)&&!data.batchEntry?(0,emotion_react_jsx_runtime_browser_esm.Y)("div",(0,tslib_es6.Cl)({className:"p-2  h-full flex items-center"},{children:"No package details"})):(0,emotion_react_jsx_runtime_browser_esm.Y)(cells_OrderParcelInfo,{order:data.order,batchEntry:data.batchEntry})},minWidth:"11.5rem"},{header:_this.props.t("orders:table:headers:rates"),cell:function(_a){var data=_a.data;return"partial-parent"===data.kind?null:(0,emotion_react_jsx_runtime_browser_esm.Y)(ManualErrorBoundary.A,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(CellContent,(0,tslib_es6.Cl)({className:"flex h-full justify-start items-center"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(OrdersTable_BatchEntryCell,{order:data.order,batchEntry:data.batchEntry})}))})},onCellClick:noop.A,cursor:"auto",noPadding:!0,minWidth:"14.5rem"},{header:All_LabelHeader,noPadding:!0,customCellStyles:(0,emotion_react_browser_esm.AH)(OrdersTable_templateObject_16||(OrdersTable_templateObject_16=(0,tslib_es6.ue)(["\n        padding-left: 4px !important;\n      "],["\n        padding-left: 4px !important;\n      "]))),minWidth:"10rem",cell:function(_a){var data=_a.data;return"partial-parent"===data.kind?(0,emotion_react_jsx_runtime_browser_esm.Y)(CellContent,(0,tslib_es6.Cl)({className:"flex h-full items-center"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(All_ParentOrderActionMenu,{order:data.order,kind:data.kind,openTransactionModal:_this.props.openTransactionModal,hideOrder:_this.props.hideOrder,toggleInvalidAddressModal:_this.props.toggleInvalidAddressModal})})):(0,emotion_react_jsx_runtime_browser_esm.Y)(CellContent,(0,tslib_es6.Cl)({className:"flex h-full items-center"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(All_OrderActionMenu,{ordersRenderData:data,openTransactionModal:_this.props.openTransactionModal,openOrderNoteModal:_this.props.openOrderNoteModal,hideOrder:_this.props.hideOrder,toggleInvalidAddressModal:_this.props.toggleInvalidAddressModal})}))}}],_this.isRowSelected=function(index,selectedOrders,tableData,orderIdToBatchEntryIdMap){var data=tableData[index];switch(data.kind){case"single":return!!selectedOrders[data.order.objectId];case"partial-parent":return(selectedOrders[data.order.objectId]||[]).length===(orderIdToBatchEntryIdMap[data.order.objectId]||[]).length;case"partial-child":return(selectedOrders[data.order.objectId]||[]).includes(data.batchEntry.id)}},_this.getSelectedIndexes=(0,memoize_one_esm.A)((function(tableData,selectedOrders,orderIdToBatchEntryIdMap){return tableData.reduce((function(list,_,index){return _this.isRowSelected(index,selectedOrders,tableData,orderIdToBatchEntryIdMap)?(0,tslib_es6.fX)((0,tslib_es6.fX)([],(0,tslib_es6.zs)(list),!1),[index],!1):list}),[])})),_this.getTableColumns=function(isOldExpChosen){return isOldExpChosen?_this.ordersTableColumns:_this.newExperienceColumns},_this.checkFulfilledRow=function(customStyle,ordersRenderData,rowIndex){var _a=_this.props,validBatchEntriesObject=_a.validBatchEntriesObject,orderHasValidBatchEntryToBuyObject=_a.orderHasValidBatchEntryToBuyObject,selectedOrders=_a.selectedOrders,tableData=_a.tableData,orderIdToBatchEntryIdMap=_a.orderIdToBatchEntryIdMap,order=ordersRenderData.order,batchEntry=ordersRenderData.batchEntry,isSelected=_this.isRowSelected(rowIndex,selectedOrders,tableData,orderIdToBatchEntryIdMap),isInvalidForPurchase=!1;"partial-parent"===ordersRenderData.kind&&isSelected?isInvalidForPurchase=!orderHasValidBatchEntryToBuyObject[order.objectId]:isSelected&&(isInvalidForPurchase=!batchEntry||batchEntry&&!validBatchEntriesObject[batchEntry.id]);var invalidStyle=isInvalidForPurchase?invalidRowCss:"",isEntryFulfilled=(0,batchEntryRendering.WO)(order,(0,batchEntryRendering.s0)(ordersRenderData),batchEntry||void 0),borderTopStyle="single"===ordersRenderData.kind&&isEntryFulfilled?borderTop:"";return isEntryFulfilled?(0,emotion_react_browser_esm.AH)(OrdersTable_templateObject_17||(OrdersTable_templateObject_17=(0,tslib_es6.ue)(["\n        ","\n        ","\n        ","\n        ","\n        ","\n      "],["\n        ","\n        ","\n        ","\n        ","\n        ","\n      "])),baseRowStyle,customStyle,fulfilledOrderRow,borderTopStyle,invalidStyle):(0,emotion_react_browser_esm.AH)(OrdersTable_templateObject_18||(OrdersTable_templateObject_18=(0,tslib_es6.ue)(["\n      ","\n      ","\n      ","\n    "],["\n      ","\n      ","\n      ","\n    "])),baseRowStyle,customStyle,invalidStyle)},_this.getCustomRowStyles=function(_a){var _b,data=_a.data,rowIndex=_a.rowIndex;switch(data.kind){case"partial-parent":return _this.checkFulfilledRow(rowNoBorder,data,rowIndex);case"partial-child":if((null===(_b=data.batchEntry)||void 0===_b?void 0:_b.partialFulfillmentRank)<data.order.totalPartialFulfillments)return _this.checkFulfilledRow(rowNoBorder,data,rowIndex)}return _this.checkFulfilledRow(rowBorder,data,rowIndex)},_this}return(0,tslib_es6.C6)(OrdersTable,_super),OrdersTable.prototype.componentDidMount=function(){var _a=this.props,handleFetchServiceLevelsByAccount=_a.handleFetchServiceLevelsByAccount,isServiceLevelsRequestInitiated=_a.isServiceLevelsRequestInitiated;this.context.initSelectedAddresses({to:null}),isServiceLevelsRequestInitiated||handleFetchServiceLevelsByAccount()},OrdersTable.prototype.render=function(){var tableColumns=this.getTableColumns(this.props.isOldExpChosen),selectedIndexes=this.getSelectedIndexes(this.props.tableData,this.props.selectedOrders,this.props.orderIdToBatchEntryIdMap);return(0,emotion_react_jsx_runtime_browser_esm.Y)(Table_Table,{message:this.props.tableMessage,messageTag:"orders-fetch-new",data:this.props.tableData,columns:tableColumns,onMessageClick:this.props.onMessageClick,onRowClick:this.handleRowClick,rowClickTag:"orders-select-row-click",selectedIndexes,columnVerticalAlignment:this.props.isOldExpChosen?"":"middle",customRowStyles:this.getCustomRowStyles})},OrdersTable.contextType=context.o,OrdersTable}(react.PureComponent);(0,redux.Zz)((0,es.Ng)((function(state){return{selectedOrders:(0,orders_selectors.Li)(state),tableData:(0,batch_entry_composite_selectors.mh)(state),validBatchEntriesObject:(0,batch_entry_composite_selectors.do)(state),orderHasValidBatchEntryToBuyObject:(0,batch_entry_composite_selectors.Tl)(state),allOrderIds:(0,orders_selectors.zF)(state),isOldExpChosen:getIsOldExpChosen(state),orderIdToBatchEntryIdMap:(0,batch_entry_selectors.jU)(state),getOrdersLoading:(0,orders_selectors.RQ)(state),isServiceLevelsRequestInitiated:(0,providers_selectors.Hk)(state)}}),(function(dispatch){return{selectOrder:function(selection){return dispatch((0,orders_actions.PE)(selection,!0))},handleFetchServiceLevelsByAccount:function(){return dispatch(fetchServiceLevelsByAccount())}}})),(0,utils_translate.Tl)("orders"),react_router.y,components_withAddressBook({name:ORDERS_TABLE_ADDRESS_BOOK_NAME,appLocation:"order_table"}))(OrdersTable);var OrdersTable_templateObject_1,OrdersTable_templateObject_2,OrdersTable_templateObject_3,OrdersTable_templateObject_4,OrdersTable_templateObject_5,OrdersTable_templateObject_6,OrdersTable_templateObject_7,OrdersTable_templateObject_8,OrdersTable_templateObject_9,OrdersTable_templateObject_10,OrdersTable_templateObject_11,OrdersTable_templateObject_12,OrdersTable_templateObject_13,OrdersTable_templateObject_14,OrdersTable_templateObject_15,OrdersTable_templateObject_16,OrdersTable_templateObject_17,OrdersTable_templateObject_18,orderErrors=__webpack_require__("./app/pages/Orders/Blackbeard/Drawers/LabelPurchaseDrawer/orderErrors.ts");function useLabelPurchaseAddresses(){var _a=useAddressBook(ORDERS_TABLE_ADDRESS_BOOK_NAME),addresses=_a.addresses,onAddressBookConsumerMounted=_a.onAddressBookConsumerMounted,clearAddress=_a.clearAddress,selectAddress=_a.selectAddress,_b=function useBulkAddressEdit(initSelectedAddresses,addresses,clearAddress,selectAddress){var selectedCount=(0,es.d4)(orders_selectors.BE),selectedOrders=(0,es.d4)(orders_selectors.Li),addressesFromOrderSelection=(0,es.d4)(batch_entry_composite_selectors.DC),isMultipleSenderAddressesSelected=(0,es.d4)(batch_entry_composite_selectors.Lc),isMultipleReturnAddressesSelected=(0,es.d4)(batch_entry_composite_selectors._7),isMultipleSenderAddressesSelectedRef=(0,react.useRef)(isMultipleSenderAddressesSelected),isMultipleReturnAddressesSelectedRef=(0,react.useRef)(isMultipleReturnAddressesSelected);return(0,react.useEffect)((function(){initSelectedAddresses({sender:getAddressFromAddressBook(addressesFromOrderSelection.senderAddresses[0],addresses),return:getAddressFromAddressBook(addressesFromOrderSelection.returnAddresses[0],addresses)},!1)}),[]),(0,react.useEffect)((function(){isMultipleSenderAddressesSelectedRef.current!==isMultipleSenderAddressesSelected&&(isMultipleSenderAddressesSelected?clearAddress(addressBook.y9):selectAddress(addressBook.y9,getAddressFromAddressBook(addressesFromOrderSelection.senderAddresses[0],addresses)),isMultipleSenderAddressesSelectedRef.current=isMultipleSenderAddressesSelected)}),[isMultipleSenderAddressesSelected]),(0,react.useEffect)((function(){isMultipleReturnAddressesSelectedRef.current!==isMultipleReturnAddressesSelected&&(isMultipleReturnAddressesSelected?clearAddress(addressBook.lj):selectAddress(addressBook.lj,getAddressFromAddressBook(addressesFromOrderSelection.returnAddresses[0],addresses)),isMultipleReturnAddressesSelectedRef.current=isMultipleReturnAddressesSelected)}),[isMultipleReturnAddressesSelected]),{selectedCount,isMultipleReturnAddressesSelected,isMultipleSenderAddressesSelected,selectedOrders,addressesFromOrderSelection}}(_a.initializeAddressBook,addresses,clearAddress,selectAddress),isMultipleReturnAddressesSelected=_b.isMultipleReturnAddressesSelected,isMultipleSenderAddressesSelected=_b.isMultipleSenderAddressesSelected,addressesFromOrderSelection=_b.addressesFromOrderSelection;return(0,react.useEffect)(onAddressBookConsumerMounted,[]),{isMultipleReturnAddressesSelected,isMultipleSenderAddressesSelected,addressesFromOrderSelection}}var getConditionalFieldsFlags=function(_a){var sender=_a.sender,recipient=_a.recipient;return{showEELPFC:isSenderAddressUS(sender),showEORI:isSenderOrRecipientUKorEU({sender,recipient}),showB13A:isSenderAddressCA(sender)}},isSenderAddressUS=function(sender){var address=sender.batchEntryAddress||sender.orderAddress;return!!address&&(address.country===constants_countries.Xr.US.iso2||address&&address.country===constants_countries.Xr.US.iso2&&(0,states.B2)(address.state))},isSenderOrRecipientUKorEU=function(_a){var sender=_a.sender,recipient=_a.recipient,senderAddress=sender.batchEntryAddress||sender.orderAddress,recipientAddress=recipient.batchEntryAddress||recipient.orderAddress;return!(!senderAddress&&!recipientAddress)&&(countries.R$.includes(null==senderAddress?void 0:senderAddress.country)||(null==senderAddress?void 0:senderAddress.country)===constants_countries.Xr.GB.iso2||countries.R$.includes(null==recipientAddress?void 0:recipientAddress.country)||(null==recipientAddress?void 0:recipientAddress.country)===constants_countries.Xr.GB.iso2)},isSenderAddressCA=function(sender){var address=sender.batchEntryAddress||sender.orderAddress;return!!address&&(address.country===constants_countries.Xr.CA.iso2&&!!states.OB[address.state])};function useSingleOrderAndBatchEntry(selectedOrders){var isBulk=(0,react.useMemo)((function(){return Object.keys(selectedOrders).length>1||!!Object.values(selectedOrders).find((function(batchEntryIds){return batchEntryIds.length>1}))}),[selectedOrders]),getOrderById=(0,orders_selectors.H4)(),orderIdObject=(0,react.useMemo)((function(){if(isBulk)return{orderId:"-1"};var orderIds=Object.keys(selectedOrders);return orderIds&&orderIds[0]?{orderId:orderIds[0]}:{orderId:"-1"}}),[isBulk,selectedOrders]),firstOrder=(0,es.d4)((function(state){return getOrderById(state,orderIdObject)})),getBatchEntryById=(0,batch_entry_selectors.Xv)(),batchEntryIdSelector=(0,react.useMemo)((function(){if(isBulk||!firstOrder)return{batchEntryId:-1};var batchEntryIds=Object.values(selectedOrders);return batchEntryIds[0]?{batchEntryId:batchEntryIds[0][0]||-1}:{batchEntryId:-1}}),[firstOrder,isBulk,selectedOrders]),firstBatchEntry=(0,es.d4)((function(state){return getBatchEntryById(state,batchEntryIdSelector)})),batchEntry=(0,react.useMemo)((function(){if(!isBulk&&firstBatchEntry)return firstBatchEntry.parcel?(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},firstBatchEntry),{parcel:(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},firstBatchEntry.parcel),{useImportedOrderWeight:firstBatchEntry.useImportedWeight})}):firstBatchEntry}),[isBulk,firstBatchEntry]),order=(0,react.useMemo)((function(){if(!isBulk)return firstOrder&&firstOrder.parcel&&batchEntry?(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},firstOrder),{parcel:(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},firstOrder.parcel),{useImportedOrderWeight:batchEntry.useImportedWeight})}):firstOrder}),[batchEntry,firstOrder,isBulk]),batchEntryIsCompleted=(0,es.d4)((function(state){return(0,batch_entry_selectors.Uv)(state,batchEntryIdSelector)})),batchEntryHasTransactionRequestFailed=(0,es.d4)((function(state){return(0,batch_entry_selectors.lm)(state,batchEntryIdSelector)})),batchEntryIsLoading=function useOrderDetailsLoading(batchEntry,batchEntryIsCompleted,batchEntryHasTransactionRequestFailed,batchEntryIdSelector){var batchEntryIsProcessingShipment=(0,es.d4)((function(state){return(0,batch_entry_selectors.Kl)(state,batchEntryIdSelector)})),shipmentIsLoadingFromBatchEntry=(0,es.d4)((function(state){return(0,batch_entry_composite_selectors.vc)(state,batchEntryIdSelector)})),isLoadingOrder=(0,es.d4)(orders_selectors.JF),isServiceLevelsRequestComplete=(0,es.d4)(providers_selectors.X7);return(0,react.useMemo)((function(){return batchEntry&&!batchEntryIsCompleted&&!batchEntryHasTransactionRequestFailed&&(batchEntryIsProcessingShipment||shipmentIsLoadingFromBatchEntry)||isLoadingOrder||!isServiceLevelsRequestComplete}),[batchEntry,batchEntryIsCompleted,batchEntryHasTransactionRequestFailed,batchEntryIsProcessingShipment,shipmentIsLoadingFromBatchEntry,isLoadingOrder,isServiceLevelsRequestComplete])}(batchEntry,batchEntryIsCompleted,batchEntryHasTransactionRequestFailed,batchEntryIdSelector);return{isBulk,order,batchEntry,batchEntryIsLoading}}var AddressBookListItem=__webpack_require__("./app/pages/Orders/Blackbeard/Drawers/AddressDrawer/AddressBookListItem.tsx");var useAddressFromAddressBook=function(_a){var addresses=_a.addresses,currentAddress=function getSelectedAddress(selectedAddresses){return Array.isArray(selectedAddresses)?1===selectedAddresses.length||(0,Address.UD)(selectedAddresses)?selectedAddresses[0]:null:selectedAddresses}(_a.selectedAddresses),addressFromAddressBook=(0,react.useMemo)((function(){return function getSelectedAddressFromAddressBook(addresses,selectedAddress){return selectedAddress&&addresses.find((function(address){return(0,Address.fq)(address,selectedAddress)}))||null}(addresses,currentAddress)}),[addresses,currentAddress]);return{addressFromAddressBook,currentAddress}};function AddressBookList(_a){var t=_a.t,addresses=_a.addresses,addressInfo=_a.addressInfo,editingAddressType=_a.editingAddressType,onUpdateAddress=_a.onUpdateAddress,onEditAddress=_a.onEditAddress,onClickAddNewAddress=_a.onClickAddNewAddress,setFooterOptions=(0,DrawerProvider.g)().setFooterOptions,selectedAddresses=addressInfo[editingAddressType],_b=useAddressFromAddressBook({addresses,selectedAddresses}),addressFromAddressBook=_b.addressFromAddressBook,currentAddress=_b.currentAddress,_c=(0,tslib_es6.zs)((0,react.useState)(addressFromAddressBook),2),selectedAddress=_c[0],setSelectedAddress=_c[1],updateAddressSelection=(0,react.useCallback)((function(){onUpdateAddress(selectedAddress,!1)}),[onUpdateAddress,selectedAddress]),isFooterButtonEnabled=addressFromAddressBook!==selectedAddress,selectedAddressesCount=selectedAddresses&&Array.isArray(selectedAddresses)?selectedAddresses.length:0;(0,react.useEffect)((function(){return setFooterOptions({footerButtonPrimary:{text:t("orders:manualLabel:updateAddress"),action:updateAddressSelection,disabled:!isFooterButtonEnabled},explicitFooterObject:(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{})}),function(){setFooterOptions({})}}),[isFooterButtonEnabled,setFooterOptions,t,updateAddressSelection]);var onSelect=(0,react.useCallback)((function(address){setSelectedAddress(address===currentAddress?null:address)}),[currentAddress,setSelectedAddress]);return(0,emotion_react_jsx_runtime_browser_esm.FD)(emotion_react_jsx_runtime_browser_esm.FK,{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(Box.A,(0,tslib_es6.Cl)({role:"list",display:"flex",flexDirection:"column",gap:shippoTheme.A.spacing(2),mb:shippoTheme.A.spacing(2)},{children:[!addressFromAddressBook&&currentAddress?(0,emotion_react_jsx_runtime_browser_esm.FD)(emotion_react_jsx_runtime_browser_esm.FK,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(AddressBookListItem.L,{t,address:currentAddress,isSelected:null===selectedAddress,onSelect,onEdit:onEditAddress},currentAddress.id),(0,emotion_react_jsx_runtime_browser_esm.Y)(Divider.A,{})]}):null,selectedAddressesCount>1?(0,emotion_react_jsx_runtime_browser_esm.FD)(emotion_react_jsx_runtime_browser_esm.FK,{children:[(0,emotion_react_jsx_runtime_browser_esm.FD)(AddressBookListItem.q,(0,tslib_es6.Cl)({role:"listitem",isSelected:!selectedAddress,onClick:function(){return setSelectedAddress(null)}},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Typography.A,(0,tslib_es6.Cl)({component:"p",variant:"bodyEmphasized"},{children:t("orders:addressDrawer:keepCurrentSelections")})),(0,emotion_react_jsx_runtime_browser_esm.FD)(Typography.A,(0,tslib_es6.Cl)({component:"p",variant:"body"},{children:[selectedAddressesCount," ",t("orders:addressDrawer:addresses")]}))]})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Divider.A,{})]}):null,addresses.map((function(address){return(0,emotion_react_jsx_runtime_browser_esm.Y)(AddressBookListItem.L,{t,isSelected:address===selectedAddress,address,onSelect,onEdit:onEditAddress},address.id)}))]})),(0,emotion_react_jsx_runtime_browser_esm.Y)(Button_Button.A,(0,tslib_es6.Cl)({fullWidth:!0,color:"secondary",onClick:onClickAddNewAddress},{children:t("orders:addressDrawer:useNewAddress")}))]})}var AddressDrawerForm=__webpack_require__("./app/pages/Orders/Blackbeard/Drawers/AddressDrawer/AddressDrawerForm.tsx");function idFromAddressInfo(addressInfo,editingAddressType){var startingAddress=addressInfo[editingAddressType];return startingAddress&&!(0,lodash.isArray)(startingAddress)&&startingAddress.hasOwnProperty("id")?startingAddress.id:void 0}const AddressDrawer_AddressMultiselectDrawer=function(_a){var addresses=_a.addresses,addressInfo=_a.addressInfo,editingAddressType=_a.editingAddressType,editingAddress=_a.editingAddress,_b=_a.hasReturnBatchEntry,hasReturnBatchEntry=void 0!==_b&&_b,onClearEditingAddress=_a.onClearEditingAddress,onSubmitSelectedAddress=_a.onSubmitSelectedAddress,onCancel=_a.onCancel,onClose=_a.onClose,onSubmitEditedAddress=_a.onSubmitEditedAddress,onEditAddress=_a.onEditAddress,t=_a.t,persistent=_a.persistent,isSelectedSenderInSavedAddresses=_a.isSelectedSenderInSavedAddresses,isSelectedReturnInSavedAddresses=_a.isSelectedReturnInSavedAddresses,combineSenderReturnAddresses=_a.combineSenderReturnAddresses,areAllSenderReturnAddressesEqual=_a.areAllSenderReturnAddressesEqual,hasRecipientPhoneRequireError=_a.hasRecipientPhoneRequireError,onSubmitEditAddressBookAddress=_a.onSubmitEditAddressBookAddress,_c=(0,tslib_es6.zs)((0,react.useState)(!1),2),newAddressForm=_c[0],setNewAddressForm=_c[1],_d=(0,tslib_es6.zs)((0,react.useState)(!1),2),isAddingNewAddress=_d[0],setIsAddingNewAddress=_d[1],selectedOrders=(0,es.d4)(orders_selectors.Li),selectedThingsCount=Object.entries(selectedOrders).reduce((function(count,_a){var _b=(0,tslib_es6.zs)(_a,2);_b[0];return count+(_b[1].length||1)}),0),addressInfoForForm=(0,react.useMemo)((function(){var _a;return(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},addressInfo),((_a={})[editingAddressType]=editingAddress||null,_a))}),[addressInfo,editingAddress,editingAddressType]),addressFromAddressBook=useAddressFromAddressBook({addresses,selectedAddresses:addressInfoForForm[editingAddressType]}).addressFromAddressBook,handleTrackAddressUpdate=(0,react.useCallback)((function(trackingReference){(0,utils.Rk)(trackingReference,types.eJ.operations.SAVE_ATTEMPTED,{});var action=addressInfo[editingAddressType]?types.eJ.operations.UPDATED:types.eJ.operations.ADDED;(0,utils.Rk)(trackingReference,action,{address_type:editingAddressType,orders_selected:selectedThingsCount})}),[addressInfo,editingAddressType,selectedThingsCount]),onSubmit=(0,react.useCallback)((function(address,senderAndReturnAreSame){var addressId=idFromAddressInfo(addressInfo,editingAddressType),trackingReference=TrackingHelper.U.getTrackingReference(types.eJ.name,"side_panel",{addressId,addressType:editingAddressType});onSubmitSelectedAddress(address,senderAndReturnAreSame,trackingReference),handleTrackAddressUpdate(trackingReference)}),[addressInfo,editingAddressType,handleTrackAddressUpdate,onSubmitSelectedAddress]),onClickAddNewAddress=(0,react.useCallback)((function(){setIsAddingNewAddress(!0),setNewAddressForm(!0)}),[]),onCloseForm=(0,react.useCallback)((function(){setNewAddressForm(!1),setIsAddingNewAddress(!1),onClearEditingAddress()}),[onClearEditingAddress]),onUpdateAddress=(0,react.useCallback)((function(newAddress,meta){var addressId=idFromAddressInfo(addressInfo,editingAddressType),trackingReference=TrackingHelper.U.getTrackingReference(types.eJ.name,"side_panel",{addressId,addressType:editingAddressType});if(onSubmitEditedAddress(newAddress,editingAddressType,meta,trackingReference),handleTrackAddressUpdate(trackingReference),meta.applyToSavedAddress&&addressFromAddressBook){var address=function(address,addressFromAddressBook){return(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},addressFromAddressBook),{name:address.name,company:address.company,email:address.email,phone:address.phone,street1:address.street1,street2:address.street2,city:address.city,state:address.state,zip:address.zip,country:address.country,streetNumber:address.streetNumber})}(newAddress,addressFromAddressBook);onSubmitEditAddressBookAddress({id:address.id,address})}}),[addressInfo,editingAddressType,handleTrackAddressUpdate,onSubmitEditedAddress,addressFromAddressBook,onSubmitEditAddressBookAddress]),onEdit=(0,react.useCallback)((function(address){onEditAddress(editingAddressType,address),setNewAddressForm(!0)}),[onEditAddress,editingAddressType]),onFormFirstLoad=(0,react.useCallback)((function(){var addressId=idFromAddressInfo(addressInfo,editingAddressType);(0,utils.Rk)(TrackingHelper.U.getTrackingReference(types.eJ.name,"side_panel",{addressId,addressType:editingAddressType}),types.eJ.operations.VIEWED,{})}),[addressInfo,editingAddressType]),_e=function useLabelPurchaseDrawerOrdersAndBatchEntries(defaultUserAddress){var _a,selectedOrders=(0,es.d4)(orders_selectors.Li),ordersData=(0,es.d4)(orders_selectors.Sv),selectedOrdersData=(0,es.d4)(orders_selectors.ZN),batchEntryIds=(0,react.useMemo)((function(){return(0,flatten.A)(Object.values(selectedOrders))}),[selectedOrders]),addressesFromOrderSelection=useLabelPurchaseAddresses().addressesFromOrderSelection,batchEntryData=(0,es.d4)(batch_entry_selectors.zo),batchEntries=(0,react.useMemo)((function(){return(0,batch_entry_selectors.mS)(batchEntryData,batchEntryIds)}),[batchEntryData,batchEntryIds]),returnBatchEntryId=null===(_a=batchEntries.find((function(_a){return _a.isReturn})))||void 0===_a?void 0:_a.id,selectedOrdersCount=(0,es.d4)(orders_selectors.BE),selectedFulfilledOrders=(0,react.useMemo)((function(){return(0,LabelPurchaseDrawer_utils.Yt)(batchEntryIds,selectedOrdersData,batchEntryData)}),[batchEntryIds,selectedOrdersData,batchEntryData]),mostCommonShipmentDate=(0,es.d4)(batch_entry_composite_selectors.vm),ratesByShipmentObjectID=(0,es.d4)(rates_selectors.Qo),selectedOrdersErrors=(0,react.useMemo)((function(){return(0,orderErrors.uF)(selectedOrders,batchEntries,ordersData,mostCommonShipmentDate,addressesFromOrderSelection,defaultUserAddress,ratesByShipmentObjectID)}),[batchEntries,defaultUserAddress,mostCommonShipmentDate,ordersData,selectedOrders,addressesFromOrderSelection]);if(returnBatchEntryId){var filteredBatchEntries=batchEntries.filter((function(_a){return _a.id===returnBatchEntryId})),filteredSelectedOrders=Object.keys(selectedOrders).reduce((function(filteredOrders,orderId){var _a;return(0,tslib_es6.Cl)((0,tslib_es6.Cl)({},filteredOrders),((_a={})[orderId]=selectedOrders[orderId].filter((function(id){return id===returnBatchEntryId})),_a))}),{}),filteredBatchEntryIds=batchEntryIds.filter((function(id){return id===returnBatchEntryId})),filteredSelectedOrdersCount=filteredBatchEntryIds.length,filteredSelectedFullfilledOrders=(0,LabelPurchaseDrawer_utils.Yt)(filteredBatchEntryIds,selectedOrdersData,batchEntryData),filteredSelectedOrdersErrors=(0,orderErrors.uF)(filteredSelectedOrders,filteredBatchEntries,ordersData,mostCommonShipmentDate,addressesFromOrderSelection,defaultUserAddress,ratesByShipmentObjectID);return{selectedOrders:filteredSelectedOrders,ordersData,selectedOrdersData,batchEntries:filteredBatchEntries,batchEntryData,batchEntryIds:filteredBatchEntryIds,mostCommonShipmentDate,selectedOrdersCount:filteredSelectedOrdersCount,selectedOrdersErrors:filteredSelectedOrdersErrors,selectedFulfilledOrders:filteredSelectedFullfilledOrders,hasReturnBatchEntry:!0}}return{selectedOrders,ordersData,selectedOrdersData,batchEntries,batchEntryData,batchEntryIds,mostCommonShipmentDate,selectedOrdersCount,selectedOrdersErrors,selectedFulfilledOrders,hasReturnBatchEntry:!1}}(void 0),selectedOrdersCount=_e.selectedOrdersCount,batchEntryIds=_e.batchEntryIds,order=useSingleOrderAndBatchEntry(selectedOrders).order,validBatchEntriesToBuyCount=(0,es.d4)((function(state){return(0,batch_entry_composite_selectors.Pf)(state,{batchEntryIds})})),_f=(0,DrawerProvider.g)(),_g=_f.footerOptions,footerButtonPrimary=_g.footerButtonPrimary,explicitFooterObject=_g.explicitFooterObject,setFooterOptions=_f.setFooterOptions,showForm=newAddressForm||!!editingAddress,returnsEditAddressTitle=editingAddressType===addressBook.lj?t("orders:manualLabel:returnAddressNames:editReturnTo"):t("orders:manualLabel:returnAddressNames:editSender"),outbountEditAddressSubtitle=1===selectedOrdersCount?(0,LabelPurchaseDrawer_utils.ut)(t,(null==order?void 0:order.orderNumber)||""):(0,LabelPurchaseDrawer_utils.GZ)(selectedOrdersCount,validBatchEntriesToBuyCount,t);return(0,emotion_react_jsx_runtime_browser_esm.Y)(MobileAndDesktopDrawer.A,(0,tslib_es6.Cl)({drawerProps:{transitionDuration:0},title:hasReturnBatchEntry?returnsEditAddressTitle:t("orders:manualLabel:editAddress",{count:selectedOrdersCount}),subtitle:hasReturnBatchEntry?void 0:outbountEditAddressSubtitle,open:!0,onBack:newAddressForm?onCloseForm:onCancel,onClose,fullWidth:!0,fullHeight:!0,persistent,paperBoxShadow:"none",footerButtonPrimary,explicitFooterObject},{children:showForm?(0,emotion_react_jsx_runtime_browser_esm.Y)(AddressDrawerForm.A,{hasRecipientPhoneRequireError,addressInfoForForm,areAllSenderReturnAddressesEqual,editingAddressType,onCancel:newAddressForm?onCloseForm:onCancel,initialCombineSenderReturn:combineSenderReturnAddresses,hasReturnBatchEntry,onFirstLoad:onFormFirstLoad,onUpdateAddress,isSelectedReturnInSavedAddresses,isSelectedSenderInSavedAddresses,addressFromAddressBook,setFooterOptions,hasFooterOptions:!0,t,isAddingNewAddress}):(0,emotion_react_jsx_runtime_browser_esm.Y)(AddressBookList,{t,addressInfo,editingAddressType,addresses,onUpdateAddress:onSubmit,onEditAddress:onEdit,onClickAddNewAddress})}))};var mocks=__webpack_require__("./app/tests/mocks/index.ts");const AddressMultiselectDrawer_stories={title:"Order V2 / Drawers / AddressMultiselectDrawer",component:AddressDrawer_AddressMultiselectDrawer,parameters:{layout:"centered"},argTypes:{setSearchBarQuery:{action:"set-query"}}};var AddressMultiselectDrawerWithTranslate=(0,utils_translate.Tl)("orders")(AddressDrawer_AddressMultiselectDrawer),apiAddresses=[{name:"John Doe",company:"Shippo",email:"joshn.doe@shippo.com",phone:"+12220200301",street1:"2611 Pleasent Ave",street2:"APT 112",streetNumber:"2611",city:"Minneapolis",state:"MN",zip:"55415",country:{name:"United States",iso2:"US"},id:1232},(0,mocks.$8)({seed:12345}),(0,mocks.$8)({seed:12346}),(0,mocks.$8)({seed:12347}),(0,mocks.$8)({seed:12348}),(0,mocks.$8)({seed:12349}),(0,mocks.$8)({seed:12340})],addresses=[{name:"John Doe",company:"Shippo",email:"joshn.doe@shippo.com",phone:"+12220200301",street1:"2611 Pleasent Ave",street2:"APT 112",streetNumber:"2611",city:"Minneapolis",state:"MN",zip:"55415",country:{name:"United States",iso2:"US"},id:1232,objectId:"1232",objectState:"",objectPurpose:"",objectSource:"",objectCreated:new Date,objectUpdated:new Date,objectOwner:"1234",street3:"Pleasent Ave",isResidential:!1,ip:"",messages:[],metadata:"",test:!1}],Regular=function(args){return(0,emotion_react_jsx_runtime_browser_esm.Y)(es.Kq,(0,tslib_es6.Cl)({store:(0,redux.y$)((0,redux.HY)(reducers.A))},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(AddressMultiselectDrawerWithTranslate,(0,tslib_es6.Cl)({},args))}))}.bind({});Regular.args={addresses:apiAddresses,editingAddressType:"sender",addressInfo:{to:addresses[0],sender:addresses[0],return:addresses[0]}},Regular.parameters={...Regular.parameters,docs:{...Regular.parameters?.docs,source:{originalSource:"(args: AddressMultiselectDrawerProps) => <Provider store={createStore(combineReducers(reducers))}>\n    <AddressMultiselectDrawerWithTranslate {...args} />\n  </Provider>",...Regular.parameters?.docs?.source}}}},"?4f7e":()=>{}}]);