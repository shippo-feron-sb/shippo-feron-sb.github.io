"use strict";(self.webpackChunk_shippo_feron=self.webpackChunk_shippo_feron||[]).push([[268],{"./app/pages/Orders/Blackbeard/Drawers/LabelPurchaseDrawer/orderErrors.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{uF:()=>getOrderErrors});var tslib__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),date_fns__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/date-fns/esm/isSameDay/index.js"),_types_Address__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./app/types/Address.ts"),_types_CustomsDeclaration__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./app/types/CustomsDeclaration.ts"),_types_Order__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./app/types/Order.ts"),_types_OrderBatchEntry__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./app/types/OrderBatchEntry.ts"),getOrderErrors=function(selectedOrders,batchEntries,ordersData,mostCommonShipmentDate,selectedOrdersAddresses,defaultUserAddress,ratesByShipmentObjectID){var carrierParcelNoRatesErrors=0,customsErrors=0,dateErrors=0,senderErrors=0,returnErrors=0,recipientErrors=0,packageErrors=0,returnAddresses=selectedOrdersAddresses.returnAddresses,senderAddresses=selectedOrdersAddresses.senderAddresses,hasNoSenderAddresses=0===senderAddresses.length,hasIncompleteSenderAddress=senderAddresses.some((function(address){return(0,_types_Address__WEBPACK_IMPORTED_MODULE_0__.X2)(address)}));(hasNoSenderAddresses||hasIncompleteSenderAddress)&&senderErrors++;var hasNoReturnAddresses=0===returnAddresses.length,hasIncompleteReturnAddress=returnAddresses.some((function(address){return(0,_types_Address__WEBPACK_IMPORTED_MODULE_0__.X2)(address)}));return(hasNoReturnAddresses||hasIncompleteReturnAddress)&&returnErrors++,Object.entries(selectedOrders).forEach((function(_a){var _b=(0,tslib__WEBPACK_IMPORTED_MODULE_4__.zs)(_a,2),orderId=_b[0];if(!_b[1].length){var order=ordersData[orderId];orderHasCustomsError(order,void 0,defaultUserAddress)&&customsErrors++,orderHasShipmentDateError(mostCommonShipmentDate)&&dateErrors++,orderHasRecipientError(order)&&recipientErrors++,orderHasPackageError(order)&&packageErrors++}})),batchEntries.forEach((function(batchEntry){var order=ordersData[batchEntry.orderObjectId];orderHasCarrierParcelNoRatesError(batchEntry,ratesByShipmentObjectID)&&carrierParcelNoRatesErrors++,orderHasCustomsError(order,batchEntry,defaultUserAddress)&&customsErrors++,orderHasShipmentDateError(mostCommonShipmentDate,batchEntry)&&dateErrors++,orderHasRecipientError(order,batchEntry)&&recipientErrors++,orderHasPackageError(order,batchEntry)&&packageErrors++})),{carrierParcelNoRatesErrors,customsErrors,dateErrors,packageErrors,recipientErrors,returnErrors,senderErrors}},orderHasCarrierParcelNoRatesError=function(batchEntry,ratesByShipmentObjectID){var _a;return(null===(_a=batchEntry.parcel)||void 0===_a?void 0:_a.carrierParcelTemplate)&&batchEntry.shipmentObjectId&&ratesByShipmentObjectID&&batchEntry.shipmentObjectId in ratesByShipmentObjectID&&0===ratesByShipmentObjectID[batchEntry.shipmentObjectId].length},orderHasCustomsError=function(order,batchEntry,defaultUserAddress){var _a,_b,isBypassCustoms=!!(null===(_a=null==batchEntry?void 0:batchEntry.extras)||void 0===_a?void 0:_a.isBypassCustoms),requiresCustoms=batchEntry?(0,_types_OrderBatchEntry__WEBPACK_IMPORTED_MODULE_3__.p2)(batchEntry)&&!isBypassCustoms:(0,_types_Order__WEBPACK_IMPORTED_MODULE_2__.p2)(order,defaultUserAddress),customsItems=(null===(_b=null==batchEntry?void 0:batchEntry.customsItems)||void 0===_b?void 0:_b.length)?batchEntry.customsItems:[];return requiresCustoms&&!(0,_types_Order__WEBPACK_IMPORTED_MODULE_2__.sf)(order)&&!customsItems.length},orderHasShipmentDateError=function(mostCommonShipmentDate,batchEntry){return!(0,date_fns__WEBPACK_IMPORTED_MODULE_5__.default)(mostCommonShipmentDate,(null==batchEntry?void 0:batchEntry.shipmentDate)?batchEntry.shipmentDate.toDate():new Date)},orderHasPackageError=function(order,batchEntry){var _a,_b,_c,_d,hasParcelError=!(null==batchEntry?void 0:batchEntry.parcel),hasParcelWeightErrors=batchEntry?!(Number(null===(_a=batchEntry.parcel)||void 0===_a?void 0:_a.weight)>0&&(null===(_b=batchEntry.parcel)||void 0===_b?void 0:_b.weightUnit)):!(Number(null===(_c=null==order?void 0:order.parcel)||void 0===_c?void 0:_c.weight)>0&&(null===(_d=null==order?void 0:order.parcel)||void 0===_d?void 0:_d.weightUnit)),batchEntryErrors=(null==batchEntry?void 0:batchEntry.errors)?(0,tslib__WEBPACK_IMPORTED_MODULE_4__.fX)([],(0,tslib__WEBPACK_IMPORTED_MODULE_4__.zs)(batchEntry.errors),!1):[],orderErrors=0===(null==batchEntry?void 0:batchEntry.partialFulfillmentRank)||0===(null==order?void 0:order.partialFulfillmentRequests.length)?(0,tslib__WEBPACK_IMPORTED_MODULE_4__.fX)([],(0,tslib__WEBPACK_IMPORTED_MODULE_4__.zs)(order.errors),!1):[],hasExceededPackageWeightError=!!(batchEntryErrors.length?batchEntryErrors:orderErrors).find((function(error){return"order_weight_exceeded"===error.code}));return hasParcelError||hasParcelWeightErrors||hasExceededPackageWeightError},orderHasRecipientError=function(order,batchEntry){var _a=(0,_types_Address__WEBPACK_IMPORTED_MODULE_0__.tS)(order,batchEntry),addressFrom=_a.addressFrom,addressTo=_a.addressTo;return!!(0,_types_CustomsDeclaration__WEBPACK_IMPORTED_MODULE_1__.e8)({addressFrom,addressTo}).hasPhoneNumberRequiredError||!(batchEntry&&!(0,_types_Address__WEBPACK_IMPORTED_MODULE_0__.X2)(null==batchEntry?void 0:batchEntry.addressTo))&&!!(0,_types_Address__WEBPACK_IMPORTED_MODULE_0__.X2)(null==order?void 0:order.toAddress)}},"./app/pages/Orders/Blackbeard/LabelPurchase/modules/CarrierIconMui.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var tslib__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js"),_goshippo_components__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@goshippo/components/esm/Badge/Badge.js"),_goshippo_components__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@goshippo/components/esm/styles/colors.js"),_constants_carriers__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./app/constants/carriers.ts");const __WEBPACK_DEFAULT_EXPORT__=function(_a){var _b,count=_a.count,provider=_a.provider,size=_a.size;_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.bK[provider]&&(provider=_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.bK[provider]);var icon=null===(_b=_constants_carriers__WEBPACK_IMPORTED_MODULE_0__.Ay.find((function(x){return x.name.toLowerCase()===provider.toLowerCase()})))||void 0===_b?void 0:_b.icon,sizeOrDefault=size||40;return(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Y)(_goshippo_components__WEBPACK_IMPORTED_MODULE_2__.A,(0,tslib__WEBPACK_IMPORTED_MODULE_3__.Cl)({badgeContent:count,color:"default",sx:{".MuiBadge-badge":{backgroundColor:_goshippo_components__WEBPACK_IMPORTED_MODULE_4__.T.secondary,color:_goshippo_components__WEBPACK_IMPORTED_MODULE_4__.T.white}}},{children:(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Y)("img",{alt:provider,src:icon,style:{borderRadius:"0.125rem",height:"".concat(sizeOrDefault,"px"),width:"".concat(sizeOrDefault,"px")}})}))}},"./app/pages/Orders/Blackbeard/hooks/hooks/useGroupedRates.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),lodash_es_flatten__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/lodash-es/flatten.js"),react_redux__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react-redux/es/index.js"),_selectors_batch_entry_composite_selectors__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./app/selectors/batch-entry.composite.selectors.ts"),_selectors_providers_selectors__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./app/selectors/providers.selectors.ts"),_selectors_rates_selectors__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./app/selectors/rates.selectors.ts"),_types_Rate__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./app/types/Rate.ts");const __WEBPACK_DEFAULT_EXPORT__=function(selectedOrders){var userDefaultReturnServiceLevel=(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.d4)(_selectors_providers_selectors__WEBPACK_IMPORTED_MODULE_3__.tS),batchEntryIds=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((function(){return{batchEntryIds:(0,lodash_es_flatten__WEBPACK_IMPORTED_MODULE_6__.A)(Object.values(selectedOrders))}}),[selectedOrders]),validBatchEntries=(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.d4)((function(state){return(0,_selectors_batch_entry_composite_selectors__WEBPACK_IMPORTED_MODULE_2__.mT)(state,batchEntryIds)})),selectedRatesForValidOrders=(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.d4)((function(state){return(0,_selectors_batch_entry_composite_selectors__WEBPACK_IMPORTED_MODULE_2__.Qt)(state,batchEntryIds)})),ratesData=(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.d4)(_selectors_rates_selectors__WEBPACK_IMPORTED_MODULE_4__.aT);return{groupedRates:(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((function(){return(0,_types_Rate__WEBPACK_IMPORTED_MODULE_5__.L4)(selectedRatesForValidOrders.map((function(rate){return rate.objectId})),ratesData,validBatchEntries)}),[ratesData,selectedRatesForValidOrders,validBatchEntries]),userDefaultReturnServiceLevel}}},"./app/pages/Orders/Blackbeard/hooks/hooks/useRefreshRates.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var tslib__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_redux__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react-redux/es/index.js"),react_router_dom__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/react-router/esm/react-router.js"),_actions_orders_actions__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./app/actions/orders.actions.ts"),_selectors_batch_entry_composite_selectors__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./app/selectors/batch-entry.composite.selectors.ts"),_selectors_batch_entry_selectors__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./app/selectors/batch-entry.selectors.ts"),_utils_segment__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./app/utils/segment/index.ts"),_types_utils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./app/pages/Orders/Blackbeard/types/utils.ts");const __WEBPACK_DEFAULT_EXPORT__=function(orderSelection){var dispatch=(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.wA)(),history=(0,react_router_dom__WEBPACK_IMPORTED_MODULE_7__.W6)(),params=(0,react_router_dom__WEBPACK_IMPORTED_MODULE_7__.g)(),_a=(0,tslib__WEBPACK_IMPORTED_MODULE_8__.zs)((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),2),isRefreshing=_a[0],setIsRefreshing=_a[1],batchEntries=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((function(){return function(orderSelection){var orders=Object.keys(orderSelection),batchEntries=Object.values(orderSelection);return orders.length>0&&batchEntries.length>0&&batchEntries[0].length>0}(orderSelection)?Object.values(orderSelection).flat():[]}),[orderSelection]),getBatchEntryIsCompleted=(0,_selectors_batch_entry_selectors__WEBPACK_IMPORTED_MODULE_4__.WX)(),getIsBatchEntryProcessingShipment=(0,_selectors_batch_entry_selectors__WEBPACK_IMPORTED_MODULE_4__.gx)(),getShipmentIsLoadingFromBatchEntry=(0,_selectors_batch_entry_composite_selectors__WEBPACK_IMPORTED_MODULE_3__.$T)(),completedEntries=(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.d4)((function(state){return getBatchEntryIsCompleted(state,{batchEntryIds:batchEntries})}),_types_utils__WEBPACK_IMPORTED_MODULE_6__.t7),processingEntries=(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.d4)((function(state){return getIsBatchEntryProcessingShipment(state,{batchEntryIds:batchEntries})}),_types_utils__WEBPACK_IMPORTED_MODULE_6__.t7),loadingEntries=(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.d4)((function(state){return getShipmentIsLoadingFromBatchEntry(state,{batchEntryIds:batchEntries})}),_types_utils__WEBPACK_IMPORTED_MODULE_6__.t7),newBatchEntry=(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.d4)((function(state){return(0,_selectors_batch_entry_selectors__WEBPACK_IMPORTED_MODULE_4__.rk)(state,{orderObjectId:params.orderId})}),_types_utils__WEBPACK_IMPORTED_MODULE_6__.t7);(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){setIsRefreshing((function(oldValue){var newValue=0===batchEntries.length||!completedEntries&&(processingEntries||loadingEntries);return params.orderId&&batchEntries.length>0&&newBatchEntry.indexOf(batchEntries[0])<0&&!oldValue&&oldValue!==newValue&&history.push("/orders/".concat(params.orderId)),newValue}))}),[completedEntries,processingEntries,loadingEntries,batchEntries,params.orderId,newBatchEntry,history]);var selectedThingsCount=Object.entries(orderSelection).reduce((function(count,_a){var _b=(0,tslib__WEBPACK_IMPORTED_MODULE_8__.zs)(_a,2);_b[0];return count+(_b[1].length||1)}),0),handleRefresh=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(event){event.preventDefault(),event.stopPropagation(),(0,_utils_segment__WEBPACK_IMPORTED_MODULE_5__.u4)("Carrier Rates Updated",{orders_selected:selectedThingsCount}),dispatch((0,_actions_orders_actions__WEBPACK_IMPORTED_MODULE_2__.lN)(orderSelection))}),[dispatch,orderSelection,selectedThingsCount]);return{batchEntries,handleRefresh,isRefreshing}}},"./app/pages/Orders/Blackbeard/types/utils.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c4:()=>getRegExpForQueryParameter,t7:()=>areEqual,xu:()=>searchQueryToSearchParameter,zM:()=>searchParameterToSearchQuery});var tslib__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),getRegExpForQueryParameter=(__webpack_require__("./app/constants/distance.ts"),__webpack_require__("./app/constants/weight.ts"),__webpack_require__("./app/types/LineItem.ts"),__webpack_require__("./app/types/Order.ts"),__webpack_require__("./app/types/OrderBatchEntry.ts"),__webpack_require__("./app/types/ParcelTemplate.ts"),function(parameter){return new RegExp("^".concat(parameter,"(\\[\\d+\\])?$"))}),searchQueryToSearchParameter=function(searchQuery,parameter){return Object.entries(searchQuery).filter((function(_a){var key=(0,tslib__WEBPACK_IMPORTED_MODULE_6__.zs)(_a,1)[0];return getRegExpForQueryParameter(parameter).test(key)})).reduce((function(accum,_a){var value=(0,tslib__WEBPACK_IMPORTED_MODULE_6__.zs)(_a,2)[1];return value&&accum.push(value),accum}),[])},searchParameterToSearchQuery=function(filterValue,queryParams,parameter){filterValue.forEach((function(item,index){queryParams["".concat(parameter,"[").concat(index,"]")]=item}))},areEqual=function(a,b){return JSON.stringify(a)===JSON.stringify(b)}},"./app/types/CarrierAccountRegStatus.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{var RegStatus;__webpack_require__.d(__webpack_exports__,{n:()=>RegStatus,r:()=>fromJSON}),function(RegStatus){RegStatus.COMPLETE="COMPLETE",RegStatus.ERROR="ERROR",RegStatus.OPTED_OUT="OPTED_OUT",RegStatus.PENDING_INFO="PENDING_INFO",RegStatus.PENDING_TERMS="PENDING_TERMS",RegStatus.PROCESSING="PROCESSING",RegStatus.UNDEFINED="UNDEFINED"}(RegStatus||(RegStatus={}));var fromJSON=function(jsonRegStatus){return{carrierAccount:jsonRegStatus.carrier_account,status:RegStatus[jsonRegStatus.status]||RegStatus.UNDEFINED}}},"./app/pages/Orders/Blackbeard/LabelPurchase/modules/CarrierRatesCard/CalculatedRateItemColumnLayout.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{MixOrderStatus:()=>CalculatedRateItemColumnLayout_stories_MixOrderStatus,MultipleCarrierRates:()=>CalculatedRateItemColumnLayout_stories_MultipleCarrierRates,NoCarrierRate:()=>CalculatedRateItemColumnLayout_stories_NoCarrierRate,RefreshCarrierRate:()=>CalculatedRateItemColumnLayout_stories_RefreshCarrierRate,SingleCarrierRates:()=>CalculatedRateItemColumnLayout_stories_SingleCarrierRates,SingleCarrierWithMultipleOrders:()=>SingleCarrierWithMultipleOrders,default:()=>CalculatedRateItemColumnLayout_stories});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),emotion_react_jsx_runtime_browser_esm=__webpack_require__("./node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js"),translate=__webpack_require__("./app/utils/translate.ts"),react=__webpack_require__("./node_modules/react/index.js"),Typography=__webpack_require__("./node_modules/@goshippo/components/esm/Typography/Typography.js"),shippoTheme=__webpack_require__("./node_modules/@goshippo/components/esm/styles/shippoTheme.js"),Stack=__webpack_require__("./node_modules/@goshippo/components/esm/Stack/Stack.js"),Button=__webpack_require__("./node_modules/@goshippo/components/esm/Button/Button.js"),colors=__webpack_require__("./node_modules/@goshippo/components/esm/styles/colors.js"),Box=__webpack_require__("./node_modules/@goshippo/components/esm/Box/Box.js"),IconButton=__webpack_require__("./node_modules/@goshippo/components/esm/IconButton/IconButton.js"),Refresh=__webpack_require__("./node_modules/@mui/icons-material/esm/Refresh.js");__webpack_require__("./node_modules/react-redux/es/index.js"),__webpack_require__("./app/selectors/orders.selectors.ts"),__webpack_require__("./app/types/OrderBatchEntry.ts"),__webpack_require__("./app/types/Rate.ts"),__webpack_require__("./app/utils/observability/index.ts"),__webpack_require__("./app/pages/Orders/Blackbeard/Drawers/LabelPurchaseDrawer/orderErrors.ts"),__webpack_require__("./app/selectors/rates.selectors.ts"),__webpack_require__("./app/pages/Orders/Blackbeard/hooks/hooks/useGroupedRates.ts");__webpack_require__("./app/pages/Orders/Blackbeard/hooks/hooks/useRefreshRates.ts");var MAPPED_ERRORS={addressesErrors:{key:"addressesErrors",selector:"#address-accordion-header"},carrierParcelNoRatesErrors:{key:"carrierParcelNoRatesErrors",selector:"#packageInfoSummary-header"},customsErrors:{key:"customsErrors",selector:"#items-accordion-header"},dateErrors:{key:"dateErrors",selector:"#shipment-date-accordion-header"},packageErrors:{key:"packageErrors",selector:"#packageInfoSummary-header"},recipientErrors:{key:"recipientErrors",selector:"#address-accordion-header"},returnErrors:{key:"returnErrors",selector:"#address-accordion-header"},senderErrors:{key:"senderErrors",selector:"#address-accordion-header"}};var gotoElementInAccordion=function(_a){var sectionElement=_a.sectionElement,targetElement=_a.targetElement;!function(sectionElement){sectionElement&&(sectionElement.classList.contains("Mui-expanded")||sectionElement.click())}(sectionElement),setTimeout((function(){!function(targetElement){targetElement&&targetElement.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}(targetElement)}),500)};const useGotoElementInAccordion=function(selectors,ref){var element=selectors.element,section=selectors.section;return(0,react.useCallback)((function(){var _a,_b,elementHTMLElement=null===(_a=null==ref?void 0:ref.current)||void 0===_a?void 0:_a.querySelector(element||section),sectionHTMLElement=null===(_b=null==ref?void 0:ref.current)||void 0===_b?void 0:_b.querySelector(section);elementHTMLElement&&sectionHTMLElement&&gotoElementInAccordion({sectionElement:sectionHTMLElement,targetElement:elementHTMLElement})}),[ref,element,section])};var CarrierIconMui=__webpack_require__("./app/pages/Orders/Blackbeard/LabelPurchase/modules/CarrierIconMui.tsx"),SubText=function(_a){var text=_a.text;return(0,emotion_react_jsx_runtime_browser_esm.Y)(Typography.A,(0,tslib_es6.Cl)({color:shippoTheme.A.palette.grey[900],component:"p",variant:"caption"},{children:text}))},IncompleteErrorList=function(_a){var errorKeys=_a.errorKeys,t=_a.t;if(!errorKeys.length)return null;return errorKeys.length<=2?(0,emotion_react_jsx_runtime_browser_esm.Y)("div",{children:errorKeys.map((function(error){return(0,emotion_react_jsx_runtime_browser_esm.Y)(SubText,{text:t("orders:calculateRates:rates:errors:".concat(MAPPED_ERRORS[error].key))},error)}))}):(0,emotion_react_jsx_runtime_browser_esm.FD)(Stack.A,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(SubText,{text:t("orders:calculateRates:rates:errors:".concat(MAPPED_ERRORS[errorKeys[0]].key))}),(0,emotion_react_jsx_runtime_browser_esm.Y)(SubText,{text:"".concat(errorKeys.length-1," ").concat(t("orders:calculateRates:rates:errors:moreRequired"))})]})},NoCarrierRate=function(_a){var drawerContainerRef=_a.drawerContainerRef,errorKeys=_a.errorKeys,t=_a.t,filteredErrorKeys=function(errorKeys){var addressErrorKeys=["senderErrors","recipientErrors","returnErrors"];if(errorKeys.filter((function(errorKey){return addressErrorKeys.includes(errorKey)})).length>1){var nonAddressesErrors=errorKeys.filter((function(errorKey){return!addressErrorKeys.includes(errorKey)}));return(0,tslib_es6.fX)(["addressesErrors"],(0,tslib_es6.zs)(nonAddressesErrors),!1)}return errorKeys}(errorKeys),scrollToFirstIncompleteError=(0,react.useCallback)((function(){var _a,firstErrorKey=(0,tslib_es6.zs)(filteredErrorKeys,1)[0],sectionSelector=MAPPED_ERRORS[firstErrorKey].selector,targetElement=null===(_a=null==drawerContainerRef?void 0:drawerContainerRef.current)||void 0===_a?void 0:_a.querySelector(sectionSelector);targetElement&&gotoElementInAccordion({sectionElement:targetElement,targetElement})}),[drawerContainerRef,filteredErrorKeys]);return(0,emotion_react_jsx_runtime_browser_esm.Y)(Button.A,(0,tslib_es6.Cl)({"data-testid":"drawer-footer-secondary-button",disableRipple:!0,onClick:scrollToFirstIncompleteError,sx:{"&.MuiButtonBase-root.MuiButton-root.MuiButton-textPrimary:hover":{backgroundColor:colors.T.hoverFocus},borderRadius:"8px",p:1,textAlign:"left"},variant:"text"},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(Stack.A,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Typography.A,(0,tslib_es6.Cl)({component:"h6",variant:"caption"},{children:t("orders:calculateRates:rates:errors:ratesUnavailable")})),(0,emotion_react_jsx_runtime_browser_esm.Y)(IncompleteErrorList,{errorKeys:filteredErrorKeys,t})]})}))},MultipleCarrierRates=function(_a){var drawerContainerRef=_a.drawerContainerRef,estimatedDateRangeText=_a.estimatedDateRangeText,t=_a.t,totalText=_a.totalText,scrollToRateCards=useGotoElementInAccordion({section:"#carrier-rates-accordion-header"},drawerContainerRef);return(0,emotion_react_jsx_runtime_browser_esm.Y)(Stack.A,(0,tslib_es6.Cl)({direction:"column",onClick:scrollToRateCards,spacing:1,sx:{cursor:"pointer",overflow:"hidden"}},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(Box.A,(0,tslib_es6.Cl)({sx:{overflow:"hidden"}},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Typography.A,(0,tslib_es6.Cl)({color:shippoTheme.A.palette.grey[900],component:"h6",noWrap:!0,variant:"caption"},{children:t("orders:calculateRates:multipleRates")})),(0,emotion_react_jsx_runtime_browser_esm.FD)(Stack.A,(0,tslib_es6.Cl)({direction:"row",spacing:shippoTheme.A.spacing(1)},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(SubText,{text:"".concat(totalText," ").concat(t("orders:calculateRates:total"))}),(0,emotion_react_jsx_runtime_browser_esm.Y)(SubText,{text:estimatedDateRangeText})]}))]}))}))},MixOrderStatus=function(_a){var drawerContainerRef=_a.drawerContainerRef,errorKeys=_a.errorKeys,estimatedDateRangeText=_a.estimatedDateRangeText,selectedOrderCount=_a.selectedOrderCount,t=_a.t,totalText=_a.totalText,validBatchEntriesToBuyCount=_a.validBatchEntriesToBuyCount,scrollToFirstIncompleteError=(0,react.useCallback)((function(){var _a,sectionSelector=MAPPED_ERRORS[errorKeys[0]].selector,targetElement=null===(_a=null==drawerContainerRef?void 0:drawerContainerRef.current)||void 0===_a?void 0:_a.querySelector(sectionSelector);targetElement&&gotoElementInAccordion({sectionElement:targetElement,targetElement})}),[drawerContainerRef,errorKeys]);return(0,emotion_react_jsx_runtime_browser_esm.Y)(Button.A,(0,tslib_es6.Cl)({"data-testid":"drawer-footer-secondary-button",disableRipple:!0,onClick:scrollToFirstIncompleteError,sx:{"&.MuiButtonBase-root.MuiButton-root.MuiButton-textPrimary:hover":{backgroundColor:colors.T.hoverFocus},borderRadius:"8px",cursor:"pointer",p:1,textAlign:"left"},variant:"text"},{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(Stack.A,(0,tslib_es6.Cl)({direction:"column",spacing:1},{children:(0,emotion_react_jsx_runtime_browser_esm.FD)(Box.A,{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Typography.A,(0,tslib_es6.Cl)({component:"h6",variant:"caption"},{children:t("orders:calculateRates:readyToBuy",{ready:validBatchEntriesToBuyCount,total:selectedOrderCount})})),(0,emotion_react_jsx_runtime_browser_esm.FD)(Stack.A,(0,tslib_es6.Cl)({direction:"row",spacing:shippoTheme.A.spacing(1)},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(SubText,{text:"".concat(totalText," ").concat(t("orders:calculateRates:total"))}),(0,emotion_react_jsx_runtime_browser_esm.Y)(SubText,{text:estimatedDateRangeText})]}))]})}))}))},SingleCarrierRates=function(_a){var _b,_c,carrierRate=_a.carrierRate,drawerContainerRef=_a.drawerContainerRef,estimatedDateRangeText=_a.estimatedDateRangeText,totalText=_a.totalText,amount=carrierRate.amount,rate=carrierRate.rate,hasMultipleOrders=amount>1,token=null===(_b=rate.servicelevel)||void 0===_b?void 0:_b.token,handleScrollToRate=useGotoElementInAccordion({element:"#carrier-rates-accordion-header",section:"#".concat(token,"-rate-card")},drawerContainerRef);return(0,emotion_react_jsx_runtime_browser_esm.FD)(Stack.A,(0,tslib_es6.Cl)({alignItems:"center",direction:"row",onClick:handleScrollToRate,spacing:hasMultipleOrders?2:1,sx:{cursor:"pointer",overflow:"hidden",py:shippoTheme.A.spacing(1.5)}},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Box.A,{children:(0,emotion_react_jsx_runtime_browser_esm.Y)(CarrierIconMui.A,{count:hasMultipleOrders?amount:void 0,provider:rate.provider,size:32})}),(0,emotion_react_jsx_runtime_browser_esm.FD)(Box.A,(0,tslib_es6.Cl)({sx:{overflow:"hidden"}},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Typography.A,(0,tslib_es6.Cl)({component:"h6",noWrap:!0,variant:"caption"},{children:"".concat(rate.provider," ").concat(null===(_c=rate.servicelevel)||void 0===_c?void 0:_c.name)})),(0,emotion_react_jsx_runtime_browser_esm.FD)(Stack.A,(0,tslib_es6.Cl)({direction:"row",spacing:shippoTheme.A.spacing(1)},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(SubText,{text:totalText}),(0,emotion_react_jsx_runtime_browser_esm.Y)(SubText,{text:estimatedDateRangeText})]}))]}))]}))},FooterRefreshButton=function(_a){var isRefreshing=_a.isRefreshing,onClick=_a.onClick,text=_a.text,handleClick=(0,react.useCallback)((function(evt){evt.detail<2&&onClick(evt)}),[onClick]);return(0,emotion_react_jsx_runtime_browser_esm.FD)(IconButton.A,(0,tslib_es6.Cl)({color:"primary","data-testid":"drawer-footer-secondary-button",disabled:isRefreshing,onClick:handleClick,sx:{"&.MuiButtonBase-root.MuiIconButton-root.MuiIconButton-colorPrimary:hover":{backgroundColor:"".concat(colors.T.hoverFocus," !important")},borderRadius:"8px",gap:1}},{children:[(0,emotion_react_jsx_runtime_browser_esm.Y)(Refresh.A,{fontSize:"small",sx:{animation:isRefreshing?"spin 1s linear infinite":""}}),(0,emotion_react_jsx_runtime_browser_esm.Y)(Typography.A,(0,tslib_es6.Cl)({component:"h6",variant:"caption"},{children:text}))]}))},RefreshCarrierRate=function(_a){var handleRefresh=_a.handleRefresh,isRefreshing=_a.isRefreshing,t=_a.t;return(0,emotion_react_jsx_runtime_browser_esm.Y)(FooterRefreshButton,{isRefreshing,onClick:handleRefresh,text:t("orders:calculateRates:refreshRates")})};const CarrierRatesCard_CalculatedRateItemColumnLayout=(0,react.memo)((function(_a){var drawerContainerRef=_a.drawerContainerRef,errorKeys=_a.errorKeys,estimatedDateRangeText=_a.estimatedDateRangeText,groupedRates=_a.groupedRates,handleRefresh=_a.handleRefresh,isRefreshing=_a.isRefreshing,requireRefresh=_a.requireRefresh,selectedOrderCount=_a.selectedOrderCount,t=_a.t,totalText=_a.totalText,validBatchEntriesToBuyCount=_a.validBatchEntriesToBuyCount;return requireRefresh?(0,emotion_react_jsx_runtime_browser_esm.Y)(RefreshCarrierRate,{handleRefresh,isRefreshing:!1,t}):isRefreshing&&!requireRefresh?(0,emotion_react_jsx_runtime_browser_esm.Y)(RefreshCarrierRate,{handleRefresh,isRefreshing,t}):validBatchEntriesToBuyCount>=1&&selectedOrderCount!==validBatchEntriesToBuyCount?(0,emotion_react_jsx_runtime_browser_esm.Y)(MixOrderStatus,{drawerContainerRef,errorKeys,estimatedDateRangeText,selectedOrderCount,t,totalText,validBatchEntriesToBuyCount}):1===(null==groupedRates?void 0:groupedRates.length)?(0,emotion_react_jsx_runtime_browser_esm.Y)(SingleCarrierRates,{carrierRate:groupedRates[0],drawerContainerRef,estimatedDateRangeText,totalText}):(null==groupedRates?void 0:groupedRates.length)>1?(0,emotion_react_jsx_runtime_browser_esm.Y)(MultipleCarrierRates,{drawerContainerRef,estimatedDateRangeText,t,totalText}):groupedRates&&!errorKeys.length?(0,emotion_react_jsx_runtime_browser_esm.Y)(RefreshCarrierRate,{handleRefresh,isRefreshing:!1,t}):(0,emotion_react_jsx_runtime_browser_esm.Y)(NoCarrierRate,{drawerContainerRef,errorKeys,t})})),CalculatedRateItemColumnLayout_stories={component:CarrierRatesCard_CalculatedRateItemColumnLayout,parameters:{layout:"centered"},title:"CalculatedRateItemColumnLayout"};var CalculatedRateItemColumnLayoutWithTranslate=(0,translate.Tl)("orders")(CarrierRatesCard_CalculatedRateItemColumnLayout),Template=function(args){return(0,emotion_react_jsx_runtime_browser_esm.Y)(CalculatedRateItemColumnLayoutWithTranslate,(0,tslib_es6.Cl)({},args))},CalculatedRateItemColumnLayout_stories_SingleCarrierRates=Template.bind({});CalculatedRateItemColumnLayout_stories_SingleCarrierRates.args={errorKeys:[],estimatedDateRangeText:"2 day",groupedRates:[{amount:1,currency:"USD",rate:{provider:"USPS",servicelevel:{extended_token:"usps_priority",name:"Priority Mail",parent_servicelevel:void 0,terms:"",token:"usps_priority"}},returnAmount:0,shipmentObjectId:"c1dc84dd4350435189ca9cb3e8e2dbfa",total:7.16,totalInsuranceAmount:0}],totalText:"$23.79"};var SingleCarrierWithMultipleOrders=Template.bind({});SingleCarrierWithMultipleOrders.args={errorKeys:[],estimatedDateRangeText:"2 day",groupedRates:[{amount:3,currency:"USD",rate:{provider:"UPS",servicelevel:{extended_token:"ups_ground",name:"Ground",parent_servicelevel:void 0,terms:"",token:"ups_ground"}},returnAmount:0,shipmentObjectId:"c1dc84dd4350435189ca9cb3e8e2dbfa",total:17.36,totalInsuranceAmount:0}],totalText:"$23.79"};var CalculatedRateItemColumnLayout_stories_MultipleCarrierRates=Template.bind({});CalculatedRateItemColumnLayout_stories_MultipleCarrierRates.args={errorKeys:[],estimatedDateRangeText:"2-7 days",groupedRates:[{amount:1,currency:"USD",rate:{provider:"USPS",servicelevel:{extended_token:"usps_priority",name:"Priority Mail",parent_servicelevel:void 0,terms:"",token:"usps_priority"}},returnAmount:0,shipmentObjectId:"c1dc84dd4350435189ca9cb3e8e2dbfa",total:7.16,totalInsuranceAmount:0},{amount:1,currency:"USD",rate:{provider:"UPS",servicelevel:{extended_token:"ups_ground",name:"Ground",parent_servicelevel:void 0,terms:"",token:"ups_ground"}},returnAmount:0,shipmentObjectId:"ej34dd4350435189ca9cb3e8esasf",total:9.53,totalInsuranceAmount:0}],totalText:"$16.69"};var CalculatedRateItemColumnLayout_stories_MixOrderStatus=Template.bind({});CalculatedRateItemColumnLayout_stories_MixOrderStatus.args={errorKeys:["recipientErrors","packageErrors"],estimatedDateRangeText:"2-7 days",groupedRates:[{amount:1,currency:"USD",rate:{provider:"USPS",servicelevel:{extended_token:"usps_priority",name:"Priority Mail",parent_servicelevel:void 0,terms:"",token:"usps_priority"}},returnAmount:0,shipmentObjectId:"c1dc84dd4350435189ca9cb3e8e2dbfa",total:7.16,totalInsuranceAmount:0},{amount:1,currency:"USD",rate:{provider:"UPS",servicelevel:{extended_token:"ups_ground",name:"Ground",parent_servicelevel:void 0,terms:"",token:"ups_ground"}},returnAmount:0,shipmentObjectId:"ej34dd4350435189ca9cb3e8esasf",total:9.53,totalInsuranceAmount:0}],selectedOrderCount:2,totalText:"$16.69",validBatchEntriesToBuyCount:1};var CalculatedRateItemColumnLayout_stories_RefreshCarrierRate=Template.bind({});CalculatedRateItemColumnLayout_stories_RefreshCarrierRate.args={handleRefresh:function(){},isRefreshing:!1,requireRefresh:!0};var CalculatedRateItemColumnLayout_stories_NoCarrierRate=Template.bind({});CalculatedRateItemColumnLayout_stories_NoCarrierRate.args={errorKeys:["packageErrors"]},CalculatedRateItemColumnLayout_stories_SingleCarrierRates.parameters={...CalculatedRateItemColumnLayout_stories_SingleCarrierRates.parameters,docs:{...CalculatedRateItemColumnLayout_stories_SingleCarrierRates.parameters?.docs,source:{originalSource:"(args: CalculatedRateItemColumnLayoutProps) => <CalculatedRateItemColumnLayoutWithTranslate {...args} />",...CalculatedRateItemColumnLayout_stories_SingleCarrierRates.parameters?.docs?.source}}},SingleCarrierWithMultipleOrders.parameters={...SingleCarrierWithMultipleOrders.parameters,docs:{...SingleCarrierWithMultipleOrders.parameters?.docs,source:{originalSource:"(args: CalculatedRateItemColumnLayoutProps) => <CalculatedRateItemColumnLayoutWithTranslate {...args} />",...SingleCarrierWithMultipleOrders.parameters?.docs?.source}}},CalculatedRateItemColumnLayout_stories_MultipleCarrierRates.parameters={...CalculatedRateItemColumnLayout_stories_MultipleCarrierRates.parameters,docs:{...CalculatedRateItemColumnLayout_stories_MultipleCarrierRates.parameters?.docs,source:{originalSource:"(args: CalculatedRateItemColumnLayoutProps) => <CalculatedRateItemColumnLayoutWithTranslate {...args} />",...CalculatedRateItemColumnLayout_stories_MultipleCarrierRates.parameters?.docs?.source}}},CalculatedRateItemColumnLayout_stories_MixOrderStatus.parameters={...CalculatedRateItemColumnLayout_stories_MixOrderStatus.parameters,docs:{...CalculatedRateItemColumnLayout_stories_MixOrderStatus.parameters?.docs,source:{originalSource:"(args: CalculatedRateItemColumnLayoutProps) => <CalculatedRateItemColumnLayoutWithTranslate {...args} />",...CalculatedRateItemColumnLayout_stories_MixOrderStatus.parameters?.docs?.source}}},CalculatedRateItemColumnLayout_stories_RefreshCarrierRate.parameters={...CalculatedRateItemColumnLayout_stories_RefreshCarrierRate.parameters,docs:{...CalculatedRateItemColumnLayout_stories_RefreshCarrierRate.parameters?.docs,source:{originalSource:"(args: CalculatedRateItemColumnLayoutProps) => <CalculatedRateItemColumnLayoutWithTranslate {...args} />",...CalculatedRateItemColumnLayout_stories_RefreshCarrierRate.parameters?.docs?.source}}},CalculatedRateItemColumnLayout_stories_NoCarrierRate.parameters={...CalculatedRateItemColumnLayout_stories_NoCarrierRate.parameters,docs:{...CalculatedRateItemColumnLayout_stories_NoCarrierRate.parameters?.docs,source:{originalSource:"(args: CalculatedRateItemColumnLayoutProps) => <CalculatedRateItemColumnLayoutWithTranslate {...args} />",...CalculatedRateItemColumnLayout_stories_NoCarrierRate.parameters?.docs?.source}}}}}]);