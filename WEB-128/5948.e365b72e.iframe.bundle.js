"use strict";(self.webpackChunk_shippo_feron=self.webpackChunk_shippo_feron||[]).push([[5948],{"./app/constants/signatureConfirmation.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Md:()=>STANDARD_COST,mS:()=>getSignatureConfirmationOrDefault,zr:()=>ADULT_COST});var _a,_pages_Orders_Blackbeard_LabelPurchase_modules_types__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./app/pages/Orders/Blackbeard/LabelPurchase/modules/types.ts"),standardSignatureConfirmationOption={value:_pages_Orders_Blackbeard_LabelPurchase_modules_types__WEBPACK_IMPORTED_MODULE_0__.zT.STANDARD,label:"Anyone can sign"},adultSignatureConfirmationOption={value:_pages_Orders_Blackbeard_LabelPurchase_modules_types__WEBPACK_IMPORTED_MODULE_0__.zT.ADULT,label:"An adult must sign",addToolTip:!0},signatureConfirmationMap=((_a={})[_pages_Orders_Blackbeard_LabelPurchase_modules_types__WEBPACK_IMPORTED_MODULE_0__.zT.ADULT]=adultSignatureConfirmationOption,_a[_pages_Orders_Blackbeard_LabelPurchase_modules_types__WEBPACK_IMPORTED_MODULE_0__.zT.STANDARD]=standardSignatureConfirmationOption,_a),getSignatureConfirmationOrDefault=function(value){return value&&signatureConfirmationMap[value]||standardSignatureConfirmationOption},STANDARD_COST=2,ADULT_COST=5},"./app/pages/Orders/Blackbeard/LabelPurchase/modules/ShipmentExtrasCard/utils.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{kB:()=>getInsuranceCost,dc:()=>utils_insuranceModalContent,jX:()=>utils_insuredAmountFromLineItems,Eo:()=>utils_lineItemsFromPartialOrder,EA:()=>paramsForOnSaveInsurance});var lodash=__webpack_require__("./node_modules/lodash/lodash.js"),tslib_es6=(__webpack_require__("./app/utils/segment/index.ts"),__webpack_require__("./node_modules/tslib/tslib.es6.mjs")),constants_currency=__webpack_require__("./app/constants/currency.ts"),index_umd=__webpack_require__("./node_modules/country-to-currency/index.umd.js"),index_umd_default=__webpack_require__.n(index_umd);function orderCurrency(currencyIso){return currencyIso?constants_currency.q[currencyIso]:void 0}var DEFAULT_INSURANCE_MODAL_AMOUNT=125,DEFAULT_INSURANCE_MODAL_AMOUNTS={USD:125,CAD:150,GBP:100,MXN:2e3,EUR:100};function insuranceFormCurrencyAndAmount(extrasInsurance,order,partialOrderLineItems,batchEntry){var _a,_b,_c,_d,itemCurrencies,currency;if((null==extrasInsurance?void 0:extrasInsurance.currency)&&constants_currency.q[extrasInsurance.currency.iso])return{currency:extrasInsurance.currency,amount:+(null==extrasInsurance?void 0:extrasInsurance.amount)||DEFAULT_INSURANCE_MODAL_AMOUNTS[extrasInsurance.currency.iso]||DEFAULT_INSURANCE_MODAL_AMOUNT};if(partialOrderLineItems){var partialOrderCurrencies=(0,tslib_es6.fX)([],(0,tslib_es6.zs)(new Set(partialOrderLineItems.map((function(lineItem){return lineItem.currency})).filter((function(lineItem){return!!(null==lineItem?void 0:lineItem.iso)})))),!1);if(1===partialOrderCurrencies.length)return{currency:partialOrderCurrencies[0],amount:partialOrderLineItems.reduce((function(acc,curr){return acc+ +curr.totalAmount}),0)||DEFAULT_INSURANCE_MODAL_AMOUNT}}if((null==order?void 0:order.lineItems)&&order.lineItems.length>0&&1===(itemCurrencies=(0,tslib_es6.fX)([],(0,tslib_es6.zs)(new Set(order.lineItems.map((function(lineItem){return lineItem.currency})).filter((function(lineItem){return!!(null==lineItem?void 0:lineItem.iso)})))),!1)).length)return{currency:itemCurrencies[0],amount:order.lineItems.reduce((function(acc,curr){return acc+ +curr.totalAmount}),0)||DEFAULT_INSURANCE_MODAL_AMOUNT};if((null==batchEntry?void 0:batchEntry.customsItems)&&batchEntry.customsItems.length>0&&1===(itemCurrencies=(0,tslib_es6.fX)([],(0,tslib_es6.zs)(new Set(batchEntry.customsItems.map((function(customsItem){return customsItem.valueCurrency})).filter((function(customsItem){return!!(null==customsItem?void 0:customsItem.iso)})))),!1)).length)return{currency:itemCurrencies[0],amount:batchEntry.customsItems.reduce((function(acc,curr){return acc+ +curr.valueAmount}),0)||DEFAULT_INSURANCE_MODAL_AMOUNT};return(null==order?void 0:order.currency)&&orderCurrency(order.currency)?{currency:currency=orderCurrency(order.currency)||constants_currency.q.USD,amount:+((null==order?void 0:order.totalPrice)||(null==order?void 0:order.subtotalPrice)||"")||DEFAULT_INSURANCE_MODAL_AMOUNTS[currency.iso]||DEFAULT_INSURANCE_MODAL_AMOUNT}:(null===(_b=null===(_a=null==batchEntry?void 0:batchEntry.addressFrom)||void 0===_a?void 0:_a.country)||void 0===_b?void 0:_b.iso2)&&index_umd_default()[batchEntry.addressFrom.country.iso2]?{currency:currency=constants_currency.q[index_umd_default()[batchEntry.addressFrom.country.iso2]]||constants_currency.q.USD,amount:DEFAULT_INSURANCE_MODAL_AMOUNTS[currency.iso]||DEFAULT_INSURANCE_MODAL_AMOUNT}:(null===(_d=null===(_c=null==order?void 0:order.addressFrom)||void 0===_c?void 0:_c.country)||void 0===_d?void 0:_d.iso2)&&index_umd_default()[order.addressFrom.country.iso2]?{currency:currency=constants_currency.q[index_umd_default()[order.addressFrom.country.iso2]]||constants_currency.q.USD,amount:DEFAULT_INSURANCE_MODAL_AMOUNTS[currency.iso]||DEFAULT_INSURANCE_MODAL_AMOUNT}:{currency:constants_currency.q.USD,amount:DEFAULT_INSURANCE_MODAL_AMOUNTS.USD}}var paramsForOnSaveInsurance=function(newInsuranceValues){return{insurance:newInsuranceValues.hasInsurance?{amount:"".concat(newInsuranceValues.amount.replace(/,/g,"")),currency:newInsuranceValues.currency,useImportedAmount:!1}:null}},utils_insuredAmountFromLineItems=function(lineItems){var output=null==lineItems?void 0:lineItems.map((function(i){return+i.totalAmount})).reduce((function(curr,accum){return curr+accum}),0);return(0,lodash.isFinite)(output)?output:0},utils_insuranceModalContent=function(extrasInsurance,order,partialOrderLineItems,batchEntry){var currencyAndAmount=insuranceFormCurrencyAndAmount(extrasInsurance,order,partialOrderLineItems,batchEntry);return{hasInsurance:!!extrasInsurance,amount:"".concat(currencyAndAmount.amount),useImportedAmount:!1,currency:currencyAndAmount.currency}},utils_lineItemsFromPartialOrder=function(orderLineItems,batchEntryLineItems){if(orderLineItems&&batchEntryLineItems){var targetLineItems=batchEntryLineItems.reduce((function(accum,curr){return accum[curr.objectId]=!0,accum}),{}),output=orderLineItems.filter((function(lineItem){return!!targetLineItems[lineItem.objectId]}));return output.length?output:void 0}},getInsuranceCost=function(userInsuranceRate,declaredValue,numOrdersSelected){return void 0===numOrdersSelected&&(numOrdersSelected=1),userInsuranceRate<1?numOrdersSelected*insuranceUnits(declaredValue)*(100*userInsuranceRate):numOrdersSelected*Math.max(insuranceUnits(declaredValue)*userInsuranceRate,1)},INSURANCE_VALUE_UNIT=100;function insuranceUnits(declaredValue){var units=declaredValue/INSURANCE_VALUE_UNIT;return Math.max(units,0)}},"./app/pages/Orders/Blackbeard/LabelPurchase/modules/types.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{var _a,_b,_c,_d;__webpack_require__.d(__webpack_exports__,{Mx:()=>TransitCarrier,Uf:()=>carrierTransitTimeRange,nB:()=>SelectedParcelType,tf:()=>blackbeardDistanceUnit,zT:()=>blackbeardSignatureConfirmation});var blackbeardDistanceUnit={CM:"cm",IN:"in",MM:"mm"};var TransitCarrier,SelectedParcelType=function(){function SelectedParcelType(oneOffBoxOrTubeSelected,oneOffPolymailerSelected,selectedUserParcelTemplate,selectedCarrierParcelTemplate){this.oneOffBoxOrTubeSelected=oneOffBoxOrTubeSelected,this.oneOffPolymailerSelected=oneOffPolymailerSelected,this.selectedUserParcelTemplate=selectedUserParcelTemplate,this.selectedCarrierParcelTemplate=selectedCarrierParcelTemplate}return SelectedParcelType.unselected=function(){return new SelectedParcelType(!1,!1)},SelectedParcelType.selectCustomBoxOrTube=function(){return new SelectedParcelType(!0,!1)},SelectedParcelType.selectCustomPolymailer=function(){return new SelectedParcelType(!1,!0)},SelectedParcelType.selectUserParcelTemplate=function(template){return new SelectedParcelType(!1,!1,template)},SelectedParcelType.selectCarrierParcelTemplate=function(template){return new SelectedParcelType(!1,!1,void 0,template)},SelectedParcelType.prototype.selectFromTemplate=function(userTemplate,carrierTemplate){return userTemplate||carrierTemplate?new SelectedParcelType(!1,!1,userTemplate,carrierTemplate):this},SelectedParcelType.prototype.isUnselected=function(){return!this.isCustomSelected()&&!this.isTemplateSelected()},SelectedParcelType.prototype.isCustomSelected=function(){return this.isCustomBoxOrTubeSelected()||this.isCustomPolymailerSelected()},SelectedParcelType.prototype.isTemplateSelected=function(){return this.isUserParcelTemplateSelected()||this.isCarrierParcelTemplateSelected()},SelectedParcelType.prototype.isCustomBoxOrTubeSelected=function(){return this.oneOffBoxOrTubeSelected},SelectedParcelType.prototype.isCustomPolymailerSelected=function(){return this.oneOffPolymailerSelected},SelectedParcelType.prototype.isUserParcelTemplateSelected=function(){return void 0!==this.selectedUserParcelTemplate},SelectedParcelType.prototype.isCarrierParcelTemplateSelected=function(){return void 0!==this.selectedCarrierParcelTemplate},SelectedParcelType.prototype.getSelectedUserParcelTemplate=function(){return this.selectedUserParcelTemplate},SelectedParcelType.prototype.getSelectedCarrierParcelTemplate=function(){return this.selectedCarrierParcelTemplate},SelectedParcelType.prototype.getSelectedParcelTemplate=function(){return this.isUserParcelTemplateSelected()?this.getSelectedUserParcelTemplate():this.getSelectedCarrierParcelTemplate()},SelectedParcelType.prototype.isEqual=function(other){return this.isUnselected()?other.isUnselected():this.isCustomBoxOrTubeSelected()?other.isCustomBoxOrTubeSelected():this.isCustomPolymailerSelected()?other.isCustomPolymailerSelected():JSON.stringify(this.getSelectedParcelTemplate())===JSON.stringify(other.getSelectedParcelTemplate())},SelectedParcelType}(),blackbeardSignatureConfirmation={STANDARD:"STANDARD",ADULT:"ADULT",CERTIFIED:"CERTIFIED",INDIRECT:"INDIRECT",CARRIER_CONFIRMATION:"CARRIER_CONFIRMATION"};!function(TransitCarrier){TransitCarrier.USPS="USPS",TransitCarrier.UPS="UPS",TransitCarrier.FedEx="FedEx"}(TransitCarrier||(TransitCarrier={}));var USPS_GroundAdvantage="usps_ground_advantage",USPS_PriorityMail="usps_priority_mail",USPS_PriorityMailExpress="usps_priority_mail_express",UPS_Ground="ups_ground",UPS_GroundSaver="ups_ground_saver",FedEx_HomeDelivery="fedex_home_delivery",FedEx_TwoDay="fedex_2_day",FedEx_GroundEconomy="fedex_ground_economy",carrierTransitTimeRange=((_a={})[TransitCarrier.USPS]=((_b={})[USPS_GroundAdvantage]={min:2,max:5,type:"business"},_b[USPS_PriorityMail]={min:1,max:3,type:"business"},_b[USPS_PriorityMailExpress]={min:2,max:2,type:"calendar"},_b),_a[TransitCarrier.UPS]=((_c={})[UPS_Ground]={min:1,max:5,type:"business"},_c[UPS_GroundSaver]={min:2,max:7,type:"business"},_c),_a[TransitCarrier.FedEx]=((_d={})[FedEx_HomeDelivery]={min:1,max:5,type:"business"},_d[FedEx_TwoDay]={min:2,max:2,type:"business"},_d[FedEx_GroundEconomy]={min:2,max:7,type:"business"},_d),_a)},"./app/pages/Orders/Blackbeard/LabelPurchase/modules/utils.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Cg:()=>isAddressEmpty,HU:()=>getTransitTimeMax,WM:()=>getRateValueTranslated,WW:()=>shouldUseKeep,gG:()=>getEstimatedDaysTranslated});var _constants_currency__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./app/constants/currency.ts"),_types__WEBPACK_IMPORTED_MODULE_4__=(__webpack_require__("./app/constants/signatureConfirmation.ts"),__webpack_require__("./app/types/SignatureConfirmation.ts"),__webpack_require__("./app/pages/Orders/Blackbeard/LabelPurchase/modules/ShipmentExtrasCard/utils.ts"),__webpack_require__("./app/pages/Orders/Blackbeard/LabelPurchase/modules/types.ts")),date_fns__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/date-fns/esm/getDay/index.js"),getEstimatedDaysTranslated=function(estimatedDays,t){return estimatedDays?t("translations:day",{count:estimatedDays}):t("orders:calculateRates:rates:info:etaUnavailable")},getRateValueTranslated=function(amount,currency,t){var noValue="".concat(_constants_currency__WEBPACK_IMPORTED_MODULE_0__.q[currency].symbol,"—");return Number(amount)?t("translations:currency",{value:{value:Number(amount),currency_iso:currency}}):noValue};function shouldUseKeep(mixedSelection){return mixedSelection&&mixedSelection.numberWithInsurance>0&&mixedSelection.numberSelected>1}function calculatePackageTimelines(eta,meanDays){var meanDaysRounded=Math.round(meanDays);return meanDaysRounded<eta?{status:"early",days:eta-meanDaysRounded}:meanDaysRounded>eta?{status:"late",days:meanDaysRounded-eta}:{status:"on time",days:0}}var isTransitCarrier=function(value){var normalizedValue=value.replace(/\s+/g,"");return Object.values(_types__WEBPACK_IMPORTED_MODULE_4__.Mx).includes(normalizedValue)};function getTransitTimeMax(carrierName,serviceLevel,eta,rateTransitServiceLevel,rateTransitLevelMean){if(isTransitCarrier(carrierName)&&function serviceLevelExists(carrier,serviceLevelStr){if(!isTransitCarrier(carrier))return!1;var carrierEnumValue=carrier.replace(/\s+/g,""),serviceLevels=_types__WEBPACK_IMPORTED_MODULE_4__.Uf[carrierEnumValue];return Object.keys(serviceLevels).includes(serviceLevelStr)}(carrierName,serviceLevel)&&rateTransitLevelMean&&rateTransitServiceLevel===serviceLevel){var transitRange=_types__WEBPACK_IMPORTED_MODULE_4__.Uf[carrierName][serviceLevel];if("business"===transitRange.type)if(eta<=function calculateBusinessDayMax(startDate,max){var dayOfWeek=(0,date_fns__WEBPACK_IMPORTED_MODULE_5__.default)(startDate);return 6===dayOfWeek?max+=2:0===dayOfWeek&&(max+=1),max}(new Date,transitRange.max)){var _a=calculatePackageTimelines(eta,rateTransitLevelMean);return{status:_a.status,days:_a.days}}if(!(eta>transitRange.max)){var _b=calculatePackageTimelines(eta,rateTransitLevelMean);return{status:_b.status,days:_b.days}}}}var isAddressEmpty=function(address){if(!address)return!0;var isZipEmpty=!address.zip||"00000"===address.zip,isMissingAllFields=!address.city&&!address.state&&!address.street1;return!(!isZipEmpty||!isMissingAllFields)}}}]);